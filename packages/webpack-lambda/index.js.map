{"version":3,"file":"index.js","mappings":"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","sources":["webpack://b/./src/webpack/common-configs/node_config.ts","webpack://b/external node-commonjs \"node:path\"","webpack://b/./src/webpack/common-configs/base_config.ts","webpack://b/./src/webpack/plugins/define_plugin.ts","webpack://b/external node-commonjs \"webpack\"","webpack://b/./src/webpack/utils.ts","webpack://b/external node-commonjs \"node:crypto\"","webpack://b/external node-commonjs \"node:fs/promises\"","webpack://b/./src/fs.ts","webpack://b/external node-commonjs \"node:child_process\"","webpack://b/external node-commonjs \"node:fs\"","webpack://b/external node-commonjs \"prettier\"","webpack://b/./src/logger.ts","webpack://b/./src/webpack/plugins/eslint_plugin.ts","webpack://b/external node-commonjs \"chokidar\"","webpack://b/external node-commonjs \"eslint\"","webpack://b/./src/webpack/plugins/formatter.ts","webpack://b/./src/webpack/plugins/standalone_plugin.ts","webpack://b/./src/exit_handler.ts","webpack://b/./src/global_error.ts","webpack://b/./src/webpack/plugins/fork_ts_checker_plugin.ts","webpack://b/external node-commonjs \"fork-ts-checker-webpack-plugin\"","webpack://b/./src/webpack/plugins/terser_plugin.ts","webpack://b/external node-commonjs \"terser-webpack-plugin\"","webpack://b/./src/webpack/plugins/yarn_plugin.ts","webpack://b/./src/webpack/loaders/babel_loader_node.ts","webpack://b/external node-commonjs \"@babel/core\"","webpack://b/external node-commonjs \"@babel/preset-env\"","webpack://b/external node-commonjs \"@babel/preset-typescript\"","webpack://b/external node-commonjs \"babel-loader\"","webpack://b/./src/webpack/loaders/source_map_loader.ts","webpack://b/external node-commonjs \"source-map-loader\"","webpack://b/./src/webpack/plugins/dependency_packer_plugin.ts","webpack://b/./src/webpack/plugins/lambda_server_plugin.ts","webpack://b/external node-commonjs \"node:http\"","webpack://b/./src/hash.ts","webpack://b/./src/type_utils.ts","webpack://b/webpack/bootstrap","webpack://b/webpack/runtime/compat get default export","webpack://b/webpack/runtime/define property getters","webpack://b/webpack/runtime/hasOwnProperty shorthand","webpack://b/webpack/runtime/make namespace object","webpack://b/./src/webpack/configs/lambda.ts"],"sourcesContent":["import {join} from 'node:path';\n\nimport {Configuration} from 'webpack';\n\nimport {baseConfig} from '@src/webpack/common-configs/base_config';\nimport {babelLoaderNode} from '@src/webpack/loaders/babel_loader_node';\nimport {sourceMapLoader} from '@src/webpack/loaders/source_map_loader';\nimport {dependencyPackerPlugin} from '@src/webpack/plugins/dependency_packer_plugin';\nimport {findPackageJson} from '@src/webpack/utils';\n\nexport function nodeConfig(opts: {\n  context: string;\n  watch: boolean;\n  isLib: boolean;\n  noEntry?: boolean;\n  packageJsonProperties?: Record<string, unknown>;\n}): Configuration {\n  const {context, watch, isLib, noEntry, packageJsonProperties} = opts;\n  const base = baseConfig({context, watch});\n  return {\n    ...base,\n    target: 'node',\n    entry: noEntry ? {} : {index: join(context, `src/index.ts`)},\n    output: {\n      path: join(context, 'dist'),\n      filename: `[name].js`,\n      clean: {\n        keep: fileName => fileName.startsWith('node_modules') || fileName === 'yarn.lock',\n      },\n      chunkFormat: 'module',\n      ...(isLib ? {library: {type: 'module'}} : {}),\n    },\n    module: {\n      rules: [babelLoaderNode(), sourceMapLoader()],\n      parser: {\n        javascript: {importMeta: false},\n      },\n    },\n    resolve: {\n      extensions: ['.js', '.jsx', '.ts', '.tsx'],\n      modules: ['node_modules', '../shared-node/node_modules', '../shared/node_modules'],\n      alias: {\n        '@src': join(context, 'src'),\n        '@shared': join(context, '../shared/src'),\n        '@shared-node': join(context, '../shared-node/src'),\n      },\n    },\n    plugins: [...(base.plugins ?? []), dependencyPackerPlugin(packageJsonProperties)],\n    externals: (ctx, cb) => {\n      const {request, context, contextInfo, getResolve} = ctx;\n      if (request === undefined) {\n        return cb();\n      }\n      if (request.startsWith('node:')) {\n        return cb(undefined, `node-commonjs ${request}`);\n      }\n\n      const resolver = getResolve?.();\n      if (!resolver) {\n        return cb(new Error('No resolver when checking for externals'));\n      }\n      (resolver as (ctx: string, req: string) => Promise<string>)(context ?? '', request)\n        .then(res => {\n          if (!res.includes('/node_modules/')) {\n            return cb();\n          }\n          findPackageJson(res)\n            .then(packageJson => {\n              if (packageJson && packageJson['type'] === 'module') {\n                return cb(undefined, `module ${request}`);\n              }\n              cb(undefined, `node-commonjs ${request}`);\n            })\n            .catch(() => cb(undefined, `node-commonjs ${request}`));\n        })\n        .catch(() => {\n          cb(new Error(`Can't resolve '${request}' in '${contextInfo?.issuer}'`));\n        });\n    },\n    experiments: {\n      ...base.experiments,\n      outputModule: true,\n    },\n  };\n}\n","module.exports = __WEBPACK_EXTERNAL_createRequire(import.meta.url)(\"node:path\");","import {Configuration} from 'webpack';\n\nimport {definePlugin} from '@src/webpack/plugins/define_plugin';\nimport {eslintPlugin} from '@src/webpack/plugins/eslint_plugin';\nimport {forkTsCheckerPlugin} from '@src/webpack/plugins/fork_ts_checker_plugin';\nimport {terserPlugin} from '@src/webpack/plugins/terser_plugin';\nimport {YarnPlugin} from '@src/webpack/plugins/yarn_plugin';\nimport {isProd} from '@src/webpack/utils';\n\nexport function baseConfig(opts: {context: string; watch: boolean}): Configuration {\n  const {context} = opts;\n\n  return {\n    mode: 'none',\n    context,\n    entry: {},\n    devtool: 'source-map',\n    plugins: [new YarnPlugin(), forkTsCheckerPlugin(context), eslintPlugin(), definePlugin()],\n    stats: false,\n    infrastructureLogging: {level: 'error'},\n    optimization: {\n      minimize: isProd(),\n      minimizer: [terserPlugin()],\n    },\n    experiments: {\n      backCompat: true,\n    },\n  };\n}\n","import webpack from 'webpack'; // eslint-disable-line import/no-named-as-default\n\nimport {WebpackPlugin} from '@src/webpack/models';\nimport {getEnv} from '@src/webpack/utils';\n\nexport function definePlugin(): WebpackPlugin {\n  const envPrefix = 'MATTHIS_';\n  const extraEnv = Object.fromEntries(\n    Object.entries(process.env) // eslint-disable-line node/no-process-env\n      .filter(([name]) => name.startsWith(envPrefix))\n      .map(([name, value]) => [String(name.slice(envPrefix.length)), JSON.stringify(value)])\n  );\n  return new webpack.DefinePlugin({\n    'process.env.NODE_ENV': JSON.stringify(getEnv()),\n    ...extraEnv,\n  });\n}\n","module.exports = __WEBPACK_EXTERNAL_createRequire(import.meta.url)(\"webpack\");","import {createHash} from 'node:crypto';\nimport {mkdir, readdir, readFile, rm, stat} from 'node:fs/promises';\nimport {join, resolve} from 'node:path';\n\nimport {exists, rmDir} from '@src/fs';\nimport {log} from '@src/logger';\n\nexport interface WebpackConfigFragment {\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  config: () => any;\n  dependencies: Record<string, string>;\n}\n\nexport function isProd(): boolean {\n  return process.env['NODE_ENV'] === 'production'; // eslint-disable-line node/no-process-env\n}\n\nexport function isSelenium(): boolean {\n  return process.env['IS_SELENIUM'] === '1'; // eslint-disable-line node/no-process-env\n}\n\nexport function getEnv(): 'production' | 'development' {\n  return isProd() ? 'production' : 'development';\n}\n\nconst packageJsonCache = new Map<string, Record<string, unknown> | undefined>();\n\nexport async function findPackageJson(p: string): Promise<Record<string, unknown> | undefined> {\n  if (packageJsonCache.has(p)) {\n    return packageJsonCache.get(p);\n  }\n  try {\n    const pStat = await stat(p);\n    if (pStat.isDirectory()) {\n      const dir = await readdir(p);\n      if (dir.includes('package.json')) {\n        const fileContent = await readFile(join(p, 'package.json'));\n        const json = JSON.parse(fileContent.toString()) as Record<string, unknown>;\n        packageJsonCache.set(p, json);\n        return json;\n      }\n      if (p === '/') {\n        return undefined;\n      }\n    }\n    const res = await findPackageJson(resolve(`${p}/..`));\n    packageJsonCache.set(p, res);\n    return res;\n  } catch (err: unknown) {\n    log('findPackageJson');\n    log(err);\n    packageJsonCache.set(p, undefined);\n    return undefined;\n  }\n}\n\nexport function getPort(context: string): number {\n  // eslint-disable-next-line @typescript-eslint/no-magic-numbers\n  const hexHash = createHash('md5').update(context).digest('hex').slice(0, 4);\n  const port = 1024 + Math.floor(parseInt(hexHash, 16) / 2);\n  return port;\n}\n\nexport async function initLogFile(context: string, logFileName: string): Promise<string> {\n  // Find the root of the project and create the log dir there\n  try {\n    const root = await lookupRoot(context);\n    const logDir = join(root, 'log');\n    await rmDir(logDir);\n    await mkdir(logDir, {recursive: true});\n    const logFile = join(logDir, logFileName);\n    if (await exists(logFile)) {\n      await rm(logFile);\n    }\n    return logFile;\n  } catch {\n    throw new Error(`Failure to identify project root from ${context}`);\n  }\n}\n\nasync function lookupRoot(fromPath: string): Promise<string> {\n  if (await exists(join(fromPath, 'package.json'))) {\n    return fromPath;\n  }\n  const parent = join(fromPath, '..');\n  if (parent === fromPath) {\n    throw new Error('Failure to lookup root');\n  }\n  return lookupRoot(parent);\n}\n","module.exports = __WEBPACK_EXTERNAL_createRequire(import.meta.url)(\"node:crypto\");","module.exports = __WEBPACK_EXTERNAL_createRequire(import.meta.url)(\"node:fs/promises\");","import {exec} from 'node:child_process';\nimport {promises} from 'node:fs';\nimport {dirname, join} from 'node:path';\n\nimport {BuiltInParserName, format} from 'prettier';\n\nexport const {access, readFile: readFileInternal, readdir, stat} = promises;\nconst {writeFile, mkdir, rm} = promises;\n\nexport async function readFile(path: string): Promise<string> {\n  const buffer = await readFileInternal(path);\n  return buffer.toString();\n}\n\nconst prettierConfig = (parser: BuiltInParserName) =>\n  ({\n    parser,\n    printWidth: 100,\n    singleQuote: true,\n    trailingComma: 'es5',\n    bracketSpacing: false,\n    arrowParens: 'avoid',\n    endOfLine: 'auto',\n  }) as const;\n\nexport async function prettierFormat(str: string, parser: BuiltInParserName): Promise<string> {\n  return format(str, prettierConfig(parser));\n}\n\nexport async function writeRawFile(path: string, content: string): Promise<void> {\n  await mkdir(dirname(path), {recursive: true});\n  await writeFile(path, content);\n}\n\nexport async function prettyJson(json: unknown, opts?: {compact?: boolean}): Promise<string> {\n  const {compact} = opts ?? {};\n  return format(\n    compact ? JSON.stringify(json) : JSON.stringify(json, undefined, 2),\n    prettierConfig('json')\n  );\n}\nexport async function writeJsonFile(path: string, json: unknown): Promise<void> {\n  await writeRawFile(path, await prettyJson(json));\n}\n\nexport async function prettyJs(js: string): Promise<string> {\n  return format(js, prettierConfig('babel'));\n}\nexport async function writeJsFile(path: string, js: string): Promise<void> {\n  await writeRawFile(path, await prettyJs(js));\n}\n\nexport async function prettyTs(ts: string): Promise<string> {\n  return format(ts, prettierConfig('typescript'));\n}\nexport async function writeTsFile(path: string, ts: string): Promise<void> {\n  await writeRawFile(path, await prettyTs(ts));\n}\n\nexport async function writeRawFileIfNotExists(path: string, content: string): Promise<void> {\n  if (await exists(path)) {\n    return;\n  }\n  await writeRawFile(path, content);\n}\n\nexport async function rmDir(dirPath: string): Promise<void> {\n  await rm(dirPath, {recursive: true, force: true});\n}\n\nexport async function cleanDir(dirPath: string): Promise<void> {\n  try {\n    await rmDir(dirPath);\n  } finally {\n    await mkdir(dirPath, {recursive: true});\n  }\n}\n\nexport async function cp(from: string, to: string): Promise<void> {\n  return new Promise((resolve, reject) => {\n    exec(`cp -R ${from} ${to}`, err => (err ? reject(err) : resolve()));\n  });\n}\n\nexport async function exists(path: string): Promise<boolean> {\n  try {\n    await access(path);\n    return true;\n  } catch {\n    return false;\n  }\n}\n\nexport async function maybeReadFile(path: string): Promise<string | undefined> {\n  try {\n    const fileContent = await readFile(path);\n    return fileContent.toString();\n  } catch {\n    return undefined;\n  }\n}\n\nexport async function listFiles(path: string): Promise<string[]> {\n  const files: string[] = [];\n  const ents = await readdir(path, {withFileTypes: true});\n  const promises: Promise<void>[] = [];\n  for (const ent of ents) {\n    const entPath = join(path, ent.name);\n    if (ent.isDirectory()) {\n      promises.push(\n        listFiles(entPath).then(subFiles => {\n          files.push(...subFiles);\n        })\n      );\n    } else if (ent.isFile()) {\n      files.push(entPath);\n    }\n  }\n  await Promise.all(promises);\n  return files;\n}\n","module.exports = __WEBPACK_EXTERNAL_createRequire(import.meta.url)(\"node:child_process\");","module.exports = __WEBPACK_EXTERNAL_createRequire(import.meta.url)(\"node:fs\");","module.exports = __WEBPACK_EXTERNAL_createRequire(import.meta.url)(\"prettier\");","export const {log, error} = console;\n","import {existsSync, readdirSync} from 'node:fs';\nimport {join} from 'node:path';\n\nimport {FSWatcher, watch} from 'chokidar';\nimport {ESLint, Linter} from 'eslint';\nimport {Compilation, Compiler, WebpackError} from 'webpack';\n\nimport {WebpackPlugin} from '@src/webpack/models';\nimport {stripAnsi} from '@src/webpack/plugins/formatter';\nimport {StandalonePlugin} from '@src/webpack/plugins/standalone_plugin';\n\ninterface QueuedFileState {\n  status: 'queued';\n}\n\ninterface InProgressFileState {\n  status: 'in-progress';\n  eslintRunId: number;\n}\n\ninterface SuccessFileState {\n  status: 'success';\n  eslintRunId: number;\n}\n\ninterface FailureFileState {\n  status: 'failed';\n  eslintRunId: number;\n  messages: Linter.LintMessage[];\n}\n\ninterface ErroredFileState {\n  status: 'errored';\n  eslintRunId: number;\n  err: unknown;\n}\n\ntype FileState =\n  | QueuedFileState\n  | InProgressFileState\n  | SuccessFileState\n  | FailureFileState\n  | ErroredFileState;\n\nexport class EslintWebpackError extends WebpackError {\n  public override name = 'EslintWebpackError';\n  public constructor(\n    public readonly eslintRunId: number,\n    message: string,\n    filePath?: string,\n    loc?: WebpackError['loc'],\n    public readonly ruleId?: string\n  ) {\n    super(message);\n    if (filePath !== undefined) {\n      this.file = filePath;\n    }\n    if (loc) {\n      this.loc = loc;\n    }\n  }\n}\n\nconst RUN_ESLINT_INTERVAL = 500;\n\nclass EslintPlugin extends StandalonePlugin {\n  protected name = 'EslintPlugin';\n  private watcher: FSWatcher | undefined;\n  private runEslintInterval: NodeJS.Timeout | undefined;\n  private readonly fileStates = new Map<string, FileState>();\n  private compilation: Compilation | undefined;\n  private resolveAwaitIdlePromise: (() => void) | undefined;\n  private shouldRun = false;\n\n  protected async setup(compiler: Compiler): Promise<void> {\n    return new Promise<void>(resolve => {\n      this.runEslintInterval = setInterval(() => this.runEslint(), RUN_ESLINT_INTERVAL);\n\n      // Generate the patterns of all the files across the workspace\n      const projectPath = this.context;\n      const workspacePath = join(projectPath, '..');\n      const workspaceDirs = readdirSync(workspacePath, {withFileTypes: true})\n        .filter(e => e.isDirectory() && existsSync(join(workspacePath, e.name, 'package.json')))\n        .map(e => join(workspacePath, e.name));\n      const patterns = ['src/**/*.ts', 'src/**/*.tsx'].flatMap(pattern =>\n        workspaceDirs.map(dir => join(dir, pattern))\n      );\n\n      this.watcher = watch(patterns);\n      this.watcher\n        .on('add', path => {\n          this.shouldRun = true;\n          if (path.startsWith(`${projectPath}/`)) {\n            this.fileStates.set(path, {status: 'queued'});\n          }\n        })\n        .on('change', path => {\n          this.shouldRun = true;\n          if (path.startsWith(`${projectPath}/`)) {\n            this.fileStates.set(path, {status: 'queued'});\n          }\n        })\n        .on('unlink', path => {\n          this.shouldRun = true;\n          if (path.startsWith(`${projectPath}/`)) {\n            this.fileStates.delete(path);\n          }\n        })\n        .on('ready', () => {\n          this.runEslint();\n          resolve();\n        });\n      compiler.hooks.compilation.tap(this.name, comp => {\n        this.compilation = comp;\n        this.syncErrorsAndWarnings();\n      });\n      compiler.hooks.afterCompile.tapAsync(this.name, (compilation, cb) => {\n        setTimeout(() => {\n          // eslint-disable-next-line @typescript-eslint/no-floating-promises\n          this.awaitIdle().finally(cb);\n        }, RUN_ESLINT_INTERVAL);\n      });\n    });\n  }\n\n  private runEslint(): void {\n    if (!this.shouldRun) {\n      return;\n    }\n    this.shouldRun = false;\n    const filesQueued = [...this.fileStates.entries()];\n    if (filesQueued.length === 0) {\n      return;\n    }\n\n    const eslintRunId = Math.random();\n    for (const [filePath] of filesQueued) {\n      this.fileStates.set(filePath, {status: 'in-progress', eslintRunId});\n    }\n\n    const handleError = (err: unknown): void => {\n      for (const [filePath] of filesQueued) {\n        const currentState = this.fileStates.get(filePath);\n        if (\n          !currentState ||\n          currentState.status !== 'in-progress' ||\n          currentState.eslintRunId !== eslintRunId\n        ) {\n          continue;\n        }\n        this.fileStates.set(filePath, {status: 'errored', eslintRunId, err});\n      }\n    };\n\n    try {\n      const tsConfigPath = join(this.context, 'tsconfig.json');\n      const eslint = new ESLint({\n        cwd: this.context,\n        overrideConfig: {\n          settings: {\n            'import/resolver': {\n              typescript: {\n                project: tsConfigPath,\n              },\n            },\n          },\n          parserOptions: {\n            project: tsConfigPath,\n          },\n        },\n      });\n      eslint\n        .lintFiles(filesQueued.map(e => e[0]))\n        .then(results => {\n          for (const result of results) {\n            const currentState = this.fileStates.get(result.filePath);\n            if (\n              !currentState ||\n              currentState.status !== 'in-progress' ||\n              currentState.eslintRunId !== eslintRunId\n            ) {\n              continue;\n            }\n            if (result.messages.length > 0) {\n              this.fileStates.set(result.filePath, {\n                status: 'failed',\n                eslintRunId,\n                messages: result.messages,\n              });\n            } else {\n              this.fileStates.set(result.filePath, {status: 'success', eslintRunId});\n            }\n          }\n        })\n        .catch(handleError)\n        .finally(() => {\n          this.syncErrorsAndWarnings();\n          this.checkIdle();\n        });\n    } catch (err: unknown) {\n      handleError(err);\n      this.syncErrorsAndWarnings();\n      this.checkIdle();\n    }\n  }\n\n  private syncErrorsAndWarnings(): void {\n    if (!this.compilation) {\n      return;\n    }\n\n    // Errors\n    let eslintError: EslintWebpackError | undefined;\n    for (const fileState of this.fileStates.values()) {\n      if (fileState.status === 'errored') {\n        eslintError = new EslintWebpackError(\n          fileState.eslintRunId,\n          `Failure to run ESLint:\\n${\n            fileState.err instanceof Error ? fileState.err.stack : String(fileState.err)\n          }`\n        );\n      }\n    }\n    this.compilation.errors = [\n      ...(this.compilation.errors as (EslintWebpackError | WebpackError)[]).filter(\n        w => !('eslintRunId' in w)\n      ),\n      ...(eslintError ? [eslintError] : []),\n    ];\n\n    // Warnings\n    this.compilation.warnings = [\n      ...(this.compilation.warnings as (EslintWebpackError | WebpackError)[]).filter(\n        w => !('eslintRunId' in w)\n      ),\n      ...[...this.fileStates.entries()]\n        .sort((e1, e2) => e1[0].localeCompare(e2[0]))\n        .flatMap(([filePath, fileState]) => {\n          if (fileState.status !== 'failed') {\n            return [];\n          }\n          return fileState.messages.map(\n            msg =>\n              new EslintWebpackError(\n                fileState.eslintRunId,\n                stripAnsi(msg.message),\n                filePath,\n                {\n                  start: {line: msg.line, column: msg.column},\n                  end:\n                    msg.endLine === undefined\n                      ? undefined\n                      : {line: msg.endLine, column: msg.endColumn},\n                },\n                msg.ruleId ?? undefined\n              )\n          );\n        }),\n    ];\n  }\n\n  private checkIdle(): void {\n    if (!this.resolveAwaitIdlePromise) {\n      return;\n    }\n    for (const state of this.fileStates.values()) {\n      if (state.status === 'queued' || state.status === 'in-progress') {\n        return;\n      }\n    }\n    this.resolveAwaitIdlePromise();\n  }\n\n  private async awaitIdle(): Promise<void> {\n    return new Promise<void>(resolve => {\n      this.resolveAwaitIdlePromise = resolve;\n      this.checkIdle();\n    });\n  }\n\n  protected async teardown(): Promise<void> {\n    clearInterval(this.runEslintInterval);\n    await this.watcher?.close();\n  }\n}\n\nexport function eslintPlugin(): WebpackPlugin {\n  return new EslintPlugin();\n}\n","module.exports = __WEBPACK_EXTERNAL_createRequire(import.meta.url)(\"chokidar\");","module.exports = __WEBPACK_EXTERNAL_createRequire(import.meta.url)(\"eslint\");","const ansiRegex = new RegExp(\n  [\n    '[\\\\u001B\\\\u009B][[\\\\]()#;?]*(?:(?:(?:[a-zA-Z\\\\d]*(?:;[-a-zA-Z\\\\d\\\\/#&.:=?%@~_]*)*)?\\\\u0007)',\n    '(?:(?:\\\\d{1,4}(?:;\\\\d{0,4})*)?[\\\\dA-PR-TZcf-ntqry=><~]))',\n  ].join('|'),\n  'gu'\n);\nexport const stripAnsi = (s: string): string => s.replace(ansiRegex, '');\n","import {Compiler} from 'webpack';\n\nimport {registerExitCallback} from '@src/exit_handler';\nimport {globalError} from '@src/global_error';\n\nexport abstract class StandalonePlugin {\n  protected abstract name: string;\n  protected context: string = process.cwd();\n\n  // INITIALIZE\n\n  public apply(compiler: Compiler): void {\n    this.context = compiler.context;\n    compiler.hooks.beforeRun.tapPromise(this.name, async () => this.setupHandler(compiler));\n    compiler.hooks.watchRun.tapPromise(this.name, async () => this.setupHandler(compiler));\n    compiler.hooks.shutdown.tapPromise(this.name, async () => this.exitHandlerAsync(compiler));\n    registerExitCallback(() => this.exitHandler(compiler));\n  }\n\n  protected abstract setup(compiler: Compiler): void | Promise<void>;\n  protected abstract teardown(compiler: Compiler): void | Promise<void>;\n\n  // SETUP\n\n  private hasStarted = false;\n  private async setupHandler(compiler: Compiler): Promise<void> {\n    if (this.hasStarted) {\n      return;\n    }\n    this.hasStarted = true;\n    await this.setup(compiler);\n  }\n\n  // EXIT\n\n  private hasExited = false;\n  private exitHandler(compiler: Compiler): void {\n    if (this.hasExited) {\n      return;\n    }\n    this.hasExited = true;\n    Promise.resolve(this.teardown(compiler)).catch(err => {\n      globalError(`Error during teardown of plugin ${this.name}`, err);\n    });\n  }\n  private async exitHandlerAsync(compiler: Compiler): Promise<void> {\n    if (this.hasExited) {\n      return;\n    }\n    this.hasExited = true;\n    await this.teardown(compiler);\n  }\n}\n","import {globalError} from '@src/global_error';\n\nlet called = false;\nconst callbacks: (() => void | Promise<void>)[] = [];\n\nfunction runCallbacks(): void {\n  if (called) {\n    return;\n  }\n  called = true;\n  for (const fn of callbacks) {\n    Promise.resolve(fn()).catch(err => globalError('Failure to run exit cleanup callback', err));\n  }\n}\n\nprocess.on('beforeExit', () => runCallbacks());\nprocess.on('exit', () => runCallbacks());\nprocess.on('SIGTERM', () => runCallbacks());\nprocess.on('SIGINT', () => runCallbacks());\nprocess.on('uncaughtException', err => {\n  globalError('uncaughtException', err);\n  runCallbacks();\n});\n\nexport function registerExitCallback(cb: () => void | Promise<void>): void {\n  callbacks.push(cb);\n}\n","import {appendFileSync} from 'node:fs';\n\nimport {error} from '@src/logger';\n\nexport function globalError(...val: unknown[]): void {\n  for (const data of val) {\n    try {\n      const str =\n        typeof data === 'string'\n          ? data\n          : data instanceof Error\n            ? data.stack ?? String(data)\n            : JSON.stringify(data);\n      error(str);\n      appendFileSync('error.log', str);\n    } catch {\n      error(String(val));\n      appendFileSync('error.log', String(val));\n    }\n  }\n}\n","import {join} from 'node:path';\n\nimport ForkTsCheckerWebpackPlugin from 'fork-ts-checker-webpack-plugin';\n\nimport {WebpackPlugin} from '@src/webpack/models';\n\nexport function forkTsCheckerPlugin(context: string): WebpackPlugin {\n  return new ForkTsCheckerWebpackPlugin({\n    typescript: {\n      diagnosticOptions: {\n        syntactic: true,\n        semantic: true,\n        declaration: false,\n        global: true,\n      },\n      mode: 'readonly',\n      configFile: join(context, 'tsconfig.json'),\n    },\n    formatter: 'basic',\n    logger: {log: () => {}, error: () => {}},\n  });\n}\n","module.exports = __WEBPACK_EXTERNAL_createRequire(import.meta.url)(\"fork-ts-checker-webpack-plugin\");","import TerserWebpackPlugin from 'terser-webpack-plugin';\n\nimport {WebpackPlugin} from '@src/webpack/models';\n\nexport function terserPlugin(): WebpackPlugin {\n  return new TerserWebpackPlugin({\n    terserOptions: {\n      format: {\n        comments: false,\n      },\n    },\n    extractComments: false,\n  });\n}\n","module.exports = __WEBPACK_EXTERNAL_createRequire(import.meta.url)(\"terser-webpack-plugin\");","import {exec} from 'node:child_process';\nimport {appendFileSync} from 'node:fs';\nimport {join} from 'node:path';\n\nimport {Compiler} from 'webpack';\n\nimport {error} from '@src/logger';\n\nexport class YarnPlugin {\n  public apply(compiler: Compiler): void {\n    compiler.hooks.beforeRun.tapAsync('YarnPlugin', (compiler, cb) => {\n      const command = [\n        'yarn',\n        'install',\n        '--audit',\n        '--check-files',\n        '--ignore-optional',\n        '--non-interactive',\n        '--production=false',\n      ].join(' ');\n      exec(command, {cwd: compiler.context}, (err, stdout, stderr) => {\n        if (err) {\n          error(`Yarn failed in ${compiler.context}`);\n          cb(err);\n          return;\n        }\n        const warnings = stderr.split('\\n').filter(l => l.trim().length > 0);\n        if (warnings.length > 0) {\n          appendFileSync(join(compiler.context, `.yarn-warnings.log`), stderr);\n        }\n        cb();\n      });\n    });\n  }\n}\n","/* eslint-disable import/no-unassigned-import */\nimport '@babel/core';\nimport '@babel/preset-env';\nimport '@babel/preset-typescript';\nimport 'babel-loader';\n\nimport {WebpackLoader} from '@src/webpack/models';\n/* eslint-enable import/no-unassigned-import */\n\nexport function babelLoaderNode(): WebpackLoader {\n  return {\n    test: /\\.tsx?$/u,\n    exclude: /\\/node_modules\\//u,\n    loader: 'babel-loader',\n    options: {\n      presets: [\n        [\n          '@babel/preset-env',\n          {\n            targets: {\n              node: 16,\n            },\n          },\n        ],\n        ['@babel/preset-typescript'],\n      ],\n    },\n  };\n}\n","module.exports = __WEBPACK_EXTERNAL_createRequire(import.meta.url)(\"@babel/core\");","module.exports = __WEBPACK_EXTERNAL_createRequire(import.meta.url)(\"@babel/preset-env\");","module.exports = __WEBPACK_EXTERNAL_createRequire(import.meta.url)(\"@babel/preset-typescript\");","module.exports = __WEBPACK_EXTERNAL_createRequire(import.meta.url)(\"babel-loader\");","/* eslint-disable import/no-unassigned-import */\nimport '@babel/core';\nimport '@babel/preset-env';\nimport '@babel/preset-typescript';\nimport 'babel-loader';\nimport 'source-map-loader';\n\nimport {WebpackLoader} from '@src/webpack/models';\n/* eslint-enable import/no-unassigned-import */\n\nexport function sourceMapLoader(): WebpackLoader {\n  return {\n    test: /\\.js$/u,\n    use: ['source-map-loader'],\n    enforce: 'pre',\n  };\n}\n","module.exports = __WEBPACK_EXTERNAL_createRequire(import.meta.url)(\"source-map-loader\");","import {exec} from 'node:child_process';\nimport {writeFile} from 'node:fs/promises';\n\nimport {Compiler} from 'webpack';\n\nimport {globalError} from '@src/global_error';\nimport {error, log} from '@src/logger';\nimport {WebpackPlugin} from '@src/webpack/models';\nimport {findPackageJson} from '@src/webpack/utils';\n\nclass DependencyPackerPlugin {\n  public constructor(private readonly packageJsonProperties: Record<string, unknown> = {}) {}\n\n  public apply(compiler: Compiler): void {\n    const name = 'DependencyPackerPlugin';\n    const depMap = new Map<string, string>();\n\n    compiler.resolverFactory.hooks.resolver.for('normal').tap(name, resolver => {\n      resolver.hooks.result.tap(name, result => {\n        if (\n          result.descriptionFileRoot !== undefined &&\n          !result.descriptionFileRoot.includes('/node_modules/')\n        ) {\n          return result;\n        }\n        if (\n          result.descriptionFileData &&\n          'name' in result.descriptionFileData &&\n          'version' in result.descriptionFileData\n        ) {\n          const {name, version} = result.descriptionFileData as {name: string; version: string};\n          depMap.set(name, version);\n        } else {\n          log('failure to identify module', result.descriptionFileData);\n        }\n        return result;\n      });\n    });\n\n    compiler.hooks.beforeRun.tap(name, () => depMap.clear());\n    // compiler.hooks.compilation.tap(name, compilation => {\n    //   // compilation.hooks.finishModules.tapPromise(name, async modules => {\n    //   //   await Promise.allSettled(\n    //   //     [...modules].map(async m => {\n    //   //       if (!('userRequest' in m)) {\n    //   //         return;\n    //   //       }\n    //   //       // log(\n    //   //       //   compilation.resolverFactory\n    //   //       //     .get('normal')\n    //   //       //     .resolveSync(m.context, compiler.context, m.request)\n    //   //       // );\n    //   //       const module = m as ExternalModule | NormalModule;\n    //   //       const request = module.userRequest;\n    //   //       if (request.startsWith('node:')) {\n    //   //         return;\n    //   //       }\n    //   //       const res = await matcherAsync(module.userRequest);\n    //   //       if (res === undefined) {\n    //   //         return;\n    //   //       }\n    //   //       const packageJson = await findPackageJson(res);\n    //   //       if (packageJson === undefined) {\n    //   //         return;\n    //   //       }\n    //   //       depMap.set(packageJson['name'] as string, packageJson['version'] as string);\n    //   //     })\n    //   //   );\n    //   // });\n    // });\n    compiler.hooks.done.tapPromise(name, async stats => {\n      const dependencies = Object.fromEntries(\n        [...depMap.entries()].sort((e1, e2) => e1[0].localeCompare(e2[0]))\n      );\n\n      let {name, version, ...extraProps} = this.packageJsonProperties;\n\n      if (name === undefined || version === undefined) {\n        const entryPoints = Object.values(stats.compilation.compiler.options.entry);\n        const [firstEntryPoint] = entryPoints;\n        if (firstEntryPoint === undefined) {\n          return;\n        }\n        const entryPoint = firstEntryPoint.import.at(-1) as string;\n        const entryPackageJson = await findPackageJson(entryPoint);\n        if (!entryPackageJson) {\n          globalError(`Failure to retrieve entryPoint's package.json for ${entryPoint}`);\n          return;\n        }\n\n        name = entryPackageJson['name'] as string;\n        version = entryPackageJson['version'] as string;\n      }\n\n      const outputDirectory = stats.compilation.compiler.options.output.path as string;\n      await writeFile(\n        `${outputDirectory}/package.json`,\n        JSON.stringify(\n          {\n            name,\n            version,\n            type: 'module',\n            main: 'index.js',\n            ...extraProps,\n            dependencies,\n          },\n          undefined,\n          2\n        )\n      );\n\n      await yarnInstall(outputDirectory);\n    });\n  }\n}\n\nasync function yarnInstall(path: string): Promise<void> {\n  return new Promise((resolve, reject) => {\n    exec(\n      `yarn install --non-interactive --ignore-optional --production`,\n      {cwd: path},\n      (err, stdout, stderr) => {\n        if (!err) {\n          resolve();\n        } else {\n          error(`Failure to run \\`yarn install\\` at \"${path}\"\\n${stderr}`);\n          reject(new Error(stderr));\n        }\n      }\n    );\n  });\n}\n\nexport function dependencyPackerPlugin(\n  packageJsonProperties?: Record<string, unknown>\n): WebpackPlugin {\n  return new DependencyPackerPlugin(packageJsonProperties);\n}\n","import {randomUUID} from 'node:crypto';\nimport {appendFileSync, writeFileSync} from 'node:fs';\nimport {createServer, IncomingMessage, Server, ServerResponse} from 'node:http';\nimport {join} from 'node:path';\n\nimport {Compiler} from 'webpack';\n\nimport {maybeReadFile} from '@src/fs';\nimport {md5} from '@src/hash';\nimport {asMap, errorAndStackAsString} from '@src/type_utils';\nimport {WebpackPlugin} from '@src/webpack/models';\nimport {StandalonePlugin} from '@src/webpack/plugins/standalone_plugin';\nimport {getPort, initLogFile} from '@src/webpack/utils';\n\nexport interface LambdaServerStartEvent {\n  event: 'start';\n  port: number;\n}\n\nexport interface LambdaServerErrorEvent {\n  event: 'error';\n  path: string;\n  method: string;\n  err: string;\n}\n\nexport interface LambdaServerRequestEvent {\n  event: 'request';\n  path: string;\n  method: string;\n  bodyLength: number;\n}\n\nexport interface LambdaServerResponseEvent {\n  event: 'response';\n  path: string;\n  method: string;\n  duration: number;\n  statusCode: number;\n  headers: Record<string, string>;\n  bodyLength: number;\n}\n\nexport type LambdaServerEvent =\n  | LambdaServerStartEvent\n  | LambdaServerErrorEvent\n  | LambdaServerRequestEvent\n  | LambdaServerResponseEvent;\nexport type FullLambdaServerEvent = {t: string} & LambdaServerEvent;\n\ninterface LambdaHandler {\n  hash: string;\n  fn: Function;\n}\n\nclass LambdaServerPlugin extends StandalonePlugin {\n  protected name = 'LambdaServerPlugin';\n  private server: Server | undefined;\n  private runtimeLogFile?: string;\n  private appLogFile?: string;\n\n  private handler: LambdaHandler | undefined;\n\n  protected async setup(compiler: Compiler): Promise<void> {\n    // Only starts the lambda server in watch mode\n    if (!compiler.options.watch) {\n      return;\n    }\n\n    this.runtimeLogFile = await initLogFile(compiler.context, 'lambda_server_runtime.txt');\n    this.appLogFile = await initLogFile(compiler.context, 'lambda_server_log.txt');\n\n    return new Promise<void>((resolve, reject) => {\n      const port = getPort(compiler.context);\n      this.server = createServer((req: IncomingMessage, res: ServerResponse) => {\n        const url = req.url ?? '';\n\n        if (url.startsWith('/favicon')) {\n          res.end();\n          return;\n        }\n\n        const method = req.method ?? '';\n\n        const internalError = (err: string): void => {\n          this.runtimeLog({event: 'error', err, path: url, method});\n          res.statusCode = 500;\n          res.end();\n        };\n\n        try {\n          // Parse body\n          let body = '';\n          req.on('data', chunk => {\n            body += chunk;\n          });\n\n          // Parse URL\n          const parsedUrl = new URL(`http://localhost${url}`);\n          const rawQueryString = parsedUrl.search.slice(1);\n          const queryStringParameters = Object.fromEntries([\n            ...new URLSearchParams(decodeURIComponent(rawQueryString)).entries(),\n          ]);\n\n          const sendRes = (\n            body: string | Buffer,\n            duration: number,\n            // eslint-disable-next-line @typescript-eslint/no-magic-numbers\n            statusCode = 200,\n            headers: Record<string, string> = {}\n          ): void => {\n            this.runtimeLog({\n              event: 'response',\n              path: url,\n              method,\n              statusCode,\n              duration,\n              headers,\n              bodyLength: body.length,\n            });\n            res.statusCode = statusCode;\n            for (const [headerName, headerValue] of Object.entries(headers)) {\n              res.setHeader(headerName, headerValue);\n            }\n            res.write(body);\n            res.end();\n          };\n\n          req.on('end', () => {\n            // Log the request\n            this.runtimeLog({event: 'request', path: url, method, bodyLength: body.length});\n\n            // Create the lambda event\n            const event = {\n              version: '2.0',\n              routeKey: '$default',\n              rawPath: parsedUrl.pathname,\n              rawQueryString,\n              headers: req.headers,\n              queryStringParameters,\n              requestContext: {\n                accountId: 'anonymous',\n                // apiId: 'rqez6mmiihukf4yvq2l7rrq2340xpkvp',\n                // domainName: 'rqez6mmiihukf4yvq2l7rrq2340xpkvp.lambda-url.eu-west-3.on.aws',\n                // domainPrefix: 'rqez6mmiihukf4yvq2l7rrq2340xpkvp',\n                http: {\n                  method,\n                  path: parsedUrl.pathname,\n                  // protocol: 'HTTP/1.1',\n                  // sourceIp: '88.138.164.86',\n                  userAgent: req.headers['user-agent'],\n                },\n                requestId: randomUUID(),\n                routeKey: '$default',\n                stage: '$default',\n                timeEpoch: Date.now(),\n              },\n              body,\n              isBase64Encoded: false,\n            };\n\n            // Run the handler\n            this.loadHandler()\n              .then(handler => {\n                if (!handler) {\n                  // eslint-disable-next-line @typescript-eslint/no-magic-numbers\n                  sendRes('Lambda handler not found', 0, 404);\n                  return;\n                }\n                const startTs = Date.now();\n                Promise.resolve(handler.fn(event))\n                  .then(handlerRes => {\n                    const duration = Date.now() - startTs;\n                    try {\n                      if (handlerRes === undefined) {\n                        return internalError(`Invalid response: ${JSON.stringify(handlerRes)}`);\n                      }\n                      res.setHeader('Content-Type', 'application/json');\n                      if (\n                        typeof handlerRes === 'object' &&\n                        // eslint-disable-next-line no-null/no-null\n                        handlerRes !== null &&\n                        !Array.isArray(handlerRes)\n                      ) {\n                        const {body, headers, statusCode, isBase64Encoded} = handlerRes;\n                        if (!('statusCode' in handlerRes)) {\n                          return sendRes(JSON.stringify(handlerRes), duration);\n                        } else if (typeof statusCode !== 'number') {\n                          return internalError(\n                            `statusCode ${JSON.stringify(statusCode)} is not a number`\n                          );\n                        }\n                        const resBody =\n                          typeof body === 'string'\n                            ? typeof isBase64Encoded === 'boolean' && isBase64Encoded\n                              ? Buffer.from(body, 'base64')\n                              : body\n                            : JSON.stringify(body);\n                        // eslint-disable-next-line @typescript-eslint/no-unsafe-argument\n                        return sendRes(resBody, duration, statusCode, headers);\n                      } else if (typeof handlerRes === 'string') {\n                        return sendRes(handlerRes, duration);\n                      }\n                      return sendRes(JSON.stringify(handlerRes), duration);\n                    } catch (err: unknown) {\n                      return internalError(errorAndStackAsString(err));\n                    }\n                  })\n                  .catch((err: unknown) => {\n                    return internalError(errorAndStackAsString(err));\n                  });\n              })\n              .catch((err): void => {\n                internalError(`Error while loading handler: ${errorAndStackAsString(err)}`);\n              });\n          });\n        } catch (err: unknown) {\n          internalError(String(err));\n        }\n      })\n        .listen(port)\n        .on('error', err => {\n          reject(err);\n        })\n        .on('listening', () => {\n          resolve();\n          this.runtimeLog({event: 'start', port});\n        });\n    });\n  }\n\n  protected async teardown(): Promise<void> {\n    return new Promise((resolve, reject) => {\n      this.server?.close(err => {\n        if (err) {\n          reject(err);\n        } else {\n          resolve();\n        }\n      });\n    });\n  }\n\n  // Parse the output (stdout or stderr) of a script and extract the data\n  // that is wrapped by the value of `token`.\n  // parseOutput('Hello###foo###World', '###') => {result: 'foo', logs: 'HelloWorld'}\n  // parseOutput('Hello World', '###') => {result: undefined, logs: 'Hello World'}\n  private parseOutput(output: string, token: string): {result?: string; logs: string} {\n    const tokenIndex1 = output.indexOf(token);\n    if (tokenIndex1 !== -1) {\n      const tokenIndex2 = output.indexOf(token, tokenIndex1 + token.length);\n      if (tokenIndex1 !== -1) {\n        return {\n          result: output.slice(tokenIndex1 + token.length, tokenIndex2),\n          logs: (output.slice(0, tokenIndex1) + output.slice(tokenIndex2 + token.length)).trim(),\n        };\n      }\n    }\n    return {logs: output.trim()};\n  }\n\n  private runtimeLog(event: LambdaServerEvent): void {\n    if (this.runtimeLogFile === undefined) {\n      return;\n    }\n    appendFileSync(\n      this.runtimeLogFile,\n      `${JSON.stringify({t: new Date().toISOString(), ...event})}\\n`\n    );\n  }\n\n  private appLog(\n    appendFileSync: (file: string, content: string) => void,\n    log: string | string[]\n  ): void {\n    const logs = Array.isArray(log) ? log : [log];\n    if (this.appLogFile === undefined || logs.length === 0) {\n      return;\n    }\n    appendFileSync(\n      this.appLogFile,\n      logs.map(log => `[${new Date().toISOString()}] ${log}\\n`).join('')\n    );\n  }\n\n  private clearLogs(): void {\n    if (this.appLogFile !== undefined) {\n      writeFileSync(this.appLogFile, '');\n    }\n    if (this.runtimeLogFile !== undefined) {\n      writeFileSync(this.runtimeLogFile, '');\n    }\n  }\n\n  private async loadHandler(): Promise<LambdaHandler | undefined> {\n    // Find the handler source file and compute its hash\n    const handlerPath = join(this.context, 'dist/index.js');\n    const handlerSource = await maybeReadFile(handlerPath);\n    if (handlerSource === undefined) {\n      // handler has never been compiled\n      this.handler = undefined;\n      return undefined;\n    }\n    const handlerHash = md5(handlerSource);\n\n    // If the hash is the same as the previously loaded handler, return the cached version\n    if (this.handler?.hash === handlerHash) {\n      return this.handler;\n    }\n\n    // If the hash changed (or if this is the first time), we load and validate the lambda handler.\n    // (Override the handler calls to the console)\n    const logger = this.appLog.bind(this, appendFileSync);\n    console.log = (...args: unknown[]) => logger(args.map(arg => JSON.stringify(arg)));\n    console.error = (...args: unknown[]) => logger(args.map(arg => JSON.stringify(arg)));\n    // eslint-disable-next-line node/no-unsupported-features/es-syntax, import/dynamic-import-chunkname\n    const imported = await import(/* webpackIgnore: true */ `${handlerPath}?v=${Date.now()}`);\n    const importedHandler = asMap(imported)?.['handler'];\n    if (typeof importedHandler !== 'function') {\n      // Invalid export\n      this.handler = undefined;\n      return undefined;\n    }\n\n    // Everything looks correct, save in the cache and return\n    this.clearLogs();\n    logger('*** Handler loaded ***');\n    this.handler = {\n      hash: handlerHash,\n      fn: importedHandler,\n    };\n    return this.handler;\n  }\n}\n\nexport function lambdaServerPlugin(): WebpackPlugin {\n  return new LambdaServerPlugin();\n}\n","module.exports = __WEBPACK_EXTERNAL_createRequire(import.meta.url)(\"node:http\");","import {createHash} from 'node:crypto';\n\nexport function md5(data: string | Buffer): string {\n  const content = typeof data === 'string' ? data : data.toString();\n  return createHash('md5').update(content).digest('hex');\n}\n\nexport function hashPassword(password: string, salt: string): string {\n  return createHash('sha256').update(`${password}${salt}`).digest('base64');\n}\n","function notUndefined<T>(val: T | undefined): val is T {\n  return val !== undefined;\n}\n\nexport function isString(val: unknown): val is string {\n  return typeof val === 'string';\n}\n\nexport function isNumber(val: unknown): val is number {\n  return typeof val === 'number';\n}\n\nexport function iterNumberEnum<T extends Record<string, string | number>>(e: T): T[keyof T][] {\n  return Object.values(e).filter(isNumber) as unknown as T[keyof T][];\n}\n\nexport function iterStringEnum<T extends Record<string, string>>(e: T): T[keyof T][] {\n  return Object.values(e).filter(isString) as unknown as T[keyof T][];\n}\n\nexport function removeUndefined<T>(arr: (T | undefined)[]): T[] {\n  return arr.filter(notUndefined);\n}\n\nexport function removeUndefinedOrNullProps<T extends Record<string, unknown>>(obj: T): {} {\n  return Object.fromEntries(\n    // eslint-disable-next-line no-null/no-null\n    Object.entries(obj).filter(e => e[1] !== undefined && e[1] !== null)\n  ) as T;\n}\n\nexport function neverHappens(value: never, errorMessage?: string): never {\n  throw new Error(errorMessage);\n}\n\nexport function asMap(value: unknown): Record<string, unknown> | undefined;\nexport function asMap(\n  value: unknown,\n  defaultValue: Record<string, unknown>\n): Record<string, unknown>;\nexport function asMap(\n  value: unknown,\n  defaultValue?: Record<string, unknown>\n): Record<string, unknown> | undefined {\n  // eslint-disable-next-line no-null/no-null\n  return typeof value === 'object' && value !== null\n    ? (value as Record<string, unknown>)\n    : defaultValue;\n}\nexport function asMapOrThrow(value: unknown): Record<string, unknown> {\n  const valueAsMap = asMap(value);\n  if (valueAsMap === undefined) {\n    throw new Error(`Invalid value: \\`${value}\\` is not a map`);\n  }\n  return valueAsMap;\n}\n\nexport function asJson(value: string): Record<string, unknown> | undefined;\nexport function asJson(\n  value: string,\n  defaultValue: Record<string, unknown>\n): Record<string, unknown>;\nexport function asJson(\n  value: string,\n  defaultValue?: Record<string, unknown>\n): Record<string, unknown> | undefined {\n  try {\n    const json = JSON.parse(value);\n    const res = asMap(json);\n    return res ?? defaultValue;\n  } catch {\n    return defaultValue;\n  }\n}\nexport function asJsonOrThrow(value: string): Record<string, unknown> {\n  const valueAsJson = asJson(value);\n  if (valueAsJson === undefined) {\n    throw new Error(`Invalid value: \\`${value}\\` is not a valid JSON string of a map`);\n  }\n  return valueAsJson;\n}\n\nexport function asJsonString(value: unknown): Record<string, unknown> | undefined;\nexport function asJsonString(\n  value: unknown,\n  defaultValue: Record<string, unknown>\n): Record<string, unknown>;\nexport function asJsonString(\n  value: unknown,\n  defaultValue?: Record<string, unknown>\n): Record<string, unknown> | undefined {\n  const str = asString(value);\n  return str === undefined\n    ? defaultValue\n    : defaultValue === undefined\n      ? asJson(str)\n      : asJson(str, defaultValue);\n}\nexport function asJsonStringOrThrow(value: unknown): Record<string, unknown> {\n  return asJsonOrThrow(asStringOrThrow(value));\n}\n\nexport function asString<T extends string = string>(value: unknown): T | undefined;\nexport function asString<T extends string = string>(value: unknown, defaultValue: string): T;\nexport function asString<T extends string = string>(\n  value: unknown,\n  defaultValue?: string\n): T | undefined {\n  return (typeof value === 'string' ? value : defaultValue) as T;\n}\nexport function asStringOrThrow<T extends string = string>(value: unknown): T {\n  const valueAsString = asString<T>(value);\n  if (valueAsString === undefined) {\n    throw new Error(`Invalid value: \\`${value}\\` is not a string`);\n  }\n  return valueAsString;\n}\n\nexport function asArray<T = unknown>(value: unknown): T[] | undefined;\nexport function asArray<T = unknown>(value: unknown, defaultValue: unknown[]): T[];\nexport function asArray<T = unknown>(value: unknown, defaultValue?: unknown[]): T[] | undefined {\n  return (Array.isArray(value) ? value : defaultValue) as T[];\n}\nexport function asArrayOrThrow<T = unknown>(value: unknown): T[] {\n  if (!Array.isArray(value)) {\n    throw new Error(`Invalid value: \\`${value}\\` is not an array`);\n  }\n  return value as T[];\n}\n\nexport function asStringArray<T extends string = string>(value: unknown): T[] | undefined;\nexport function asStringArray<T extends string = string>(\n  value: unknown,\n  defaultValue: string[]\n): T[];\nexport function asStringArray<T extends string = string>(\n  value: unknown,\n  defaultValue?: string[]\n): T[] | undefined {\n  const arr = asArray(value);\n  if (arr === undefined) {\n    return defaultValue as T[];\n  }\n  return removeUndefined(arr.map(s => asString<T>(s)));\n}\n\nexport function asStringArrayOrThrow<T extends string = string>(value: unknown): T[] {\n  const arr = asArrayOrThrow(value);\n  return arr.map(s => asStringOrThrow<T>(s));\n}\n\nexport function asMapArray(value: unknown): Record<string, unknown>[] | undefined;\nexport function asMapArray(\n  value: unknown,\n  defaultValue: Record<string, unknown>[]\n): Record<string, unknown>[];\nexport function asMapArray(\n  value: unknown,\n  defaultValue?: Record<string, unknown>[]\n): Record<string, unknown>[] | undefined {\n  const arr = asArray(value);\n  if (arr === undefined) {\n    return defaultValue;\n  }\n  return removeUndefined(arr.map(s => asMap(s)));\n}\nexport function asMapArrayOrThrow(value: unknown): Record<string, unknown>[] {\n  const arr = asArrayOrThrow(value);\n  return arr.map(s => asMapOrThrow(s));\n}\n\nexport function asNumber<T extends number = number>(value: unknown): T | undefined;\nexport function asNumber<T extends number = number>(value: unknown, defaultValue: number): T;\nexport function asNumber<T extends number = number>(\n  value: unknown,\n  defaultValue?: number\n): T | undefined {\n  if (typeof value === 'number') {\n    return (!isNaN(value) ? value : defaultValue) as T;\n  }\n  if (typeof value === 'string') {\n    try {\n      const parsedValue = parseFloat(value);\n      return (!isNaN(parsedValue) ? parsedValue : defaultValue) as T;\n    } catch {\n      return defaultValue as T;\n    }\n  }\n  return defaultValue as T;\n}\nexport function asNumberOrThrow<T extends number = number>(value: unknown): T {\n  const valueAsNumber = asNumber(value);\n  if (valueAsNumber === undefined) {\n    throw new Error(`Invalid value: \\`${value}\\` is not a number`);\n  }\n  return valueAsNumber as T;\n}\n\nexport function asBoolean(value: unknown): boolean | undefined;\nexport function asBoolean(value: unknown, defaultValue: boolean): boolean;\nexport function asBoolean(value: unknown, defaultValue?: boolean): boolean | undefined {\n  if (typeof value === 'boolean') {\n    return value;\n  }\n  if (typeof value === 'number') {\n    return !isNaN(value) ? value !== 0 : false;\n  }\n  if (typeof value === 'string') {\n    if (value === '0' || value === 'false') {\n      return false;\n    } else if (value === '1' || value === 'true') {\n      return true;\n    }\n    return defaultValue;\n  }\n  return defaultValue;\n}\n\nexport function asBooleanOrThrow(value: unknown): boolean {\n  const valueAsBoolean = asBoolean(value);\n  if (valueAsBoolean === undefined) {\n    throw new Error(`Invalid value: \\`${value}\\` is not a boolean`);\n  }\n  return valueAsBoolean;\n}\n\nconst TIMESTAMP_REGEX = /^[0-9]{1,15}$/u;\nexport function asDate(value: unknown): Date | undefined;\nexport function asDate(value: unknown, defaultValue: Date): Date;\nexport function asDate(value: unknown, defaultValue?: Date): Date | undefined {\n  const date =\n    value instanceof Date\n      ? value\n      : new Date(\n          typeof value === 'string' && TIMESTAMP_REGEX.test(value)\n            ? parseFloat(value)\n            : String(value)\n        );\n  return isNaN(date.getTime()) ? defaultValue : date;\n}\n\nexport function asDateOrThrow(value: unknown): Date {\n  const valueAsDate = asDate(value);\n  if (valueAsDate === undefined) {\n    throw new Error(`Invalid value: \\`${value}\\` cannot be parsed as a Date`);\n  }\n  return valueAsDate;\n}\n\n// export function asDate(value: unknown): Date | undefined;\n// export function asDate(value: unknown, defaultValue: Date): Date;\n// export function asDate(value: unknown, defaultValue?: Date): Date | undefined {\n//   if (typeof value === 'number') {\n//     return new Date(value);\n//   }\n//   return value instanceof Date ? value : defaultValue;\n// }\n\nexport function isNull<T>(val: T | null): val is null {\n  // eslint-disable-next-line no-null/no-null\n  return val === null;\n}\n\nexport function asError(err: unknown): Error {\n  return err instanceof Error ? err : new Error(typeof err === 'string' ? err : String(err));\n}\n\nexport function errorAsString(err: unknown): string {\n  const errorMap = asMap(err);\n  if (errorMap === undefined) {\n    return asString(err) ?? String(err);\n  }\n\n  const errorMessage = asString(errorMap['message']);\n  if (errorMessage === undefined) {\n    return String(err);\n  }\n  return errorMessage;\n}\n\nexport function errorAndStackAsString(err: unknown): string {\n  const errorMap = asMap(err);\n  if (errorMap === undefined) {\n    return asString(err) ?? String(err);\n  }\n\n  const stack = asString(errorMap['stack']);\n  if (stack === undefined) {\n    return String(err);\n  }\n  return stack;\n}\n\nexport function asConstantOrThrow<T>(value: unknown, expected: T): T {\n  if (value !== expected) {\n    throw new Error(`Invalid value: \\`${value}\\`, expected \\`${expected}\\``);\n  }\n  return value as T;\n}\n\n// export function asParsedJson<T>(json: string): T {\n//   try {\n//     return JSON.parse(json) as T;\n//   } catch {\n//     const defaultValue = {};\n//     return defaultValue as T;\n//   }\n// }\nexport function parseJson(\n  json: string\n): {res: unknown; err: undefined} | {res: undefined; err: unknown} {\n  try {\n    return {res: JSON.parse(json), err: undefined};\n  } catch (err: unknown) {\n    return {err, res: undefined};\n  }\n}\nexport type Brand<Type, Name> = Type & {__brand: Name};\nexport type StringBrand = string & {__brand: string};\nexport type NumberBrand = number & {__brand: number};\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nexport type AnyBrand = (string | number) & {__brand: any};\n\nexport type Untrusted<T> = T extends\n  | Function\n  | Date\n  | boolean\n  | number\n  | string\n  | undefined\n  | null\n  | unknown[]\n  ? unknown\n  : {[P in keyof T]?: Untrusted<T[P]>};\n\nexport type DeepPartial<T> = T extends\n  | Function\n  | Date\n  | boolean\n  | number\n  | string\n  | undefined\n  | null\n  | unknown[]\n  ? T\n  : {[P in keyof T]?: DeepPartial<T[P]>};\n\nexport type MapInterface<I, Type> = {[Key in keyof I]: Type};\n// Get all the keys of a type including the optional attributes\ntype NonHomomorphicKeys<T> = ({[P in keyof T]: P} & None)[keyof T];\nexport type MapInterfaceStrict<I, Type> = {[Key in NonHomomorphicKeys<I>]: Type};\n\ntype KeysOfType<T, Type> = {[Key in keyof T]: T[Key] extends Type ? Key : never}[keyof T];\nexport type RestrictInterface<T, Type> = Pick<T, KeysOfType<T, Type>>;\n\ninterface RecursiveArray<T> extends Array<T | RecursiveArray<T>> {}\nexport type NestedArray<T> = (T | RecursiveArray<T>)[];\n\n// Type for an empty object (ie: {})\nexport type None = Record<string, never>;\n\nexport type NonEmptyArray<T> = [T, ...T[]];\n\nexport type AddPrefix<T, P extends string> = {\n  [K in keyof T as K extends string ? `${P}${K}` : never]: T[K];\n};\nexport function addPrefix<T extends Record<string, unknown>, Prefix extends string>(\n  attr: T,\n  prefix: Prefix\n): AddPrefix<T, Prefix> {\n  return Object.fromEntries(\n    Object.entries(attr).map(([key, value]) => [`${prefix}${key}`, value])\n  ) as AddPrefix<T, Prefix>;\n}\n\nexport type WithNull<T> = {\n  [Key in keyof T]: T[Key] extends Exclude<T[Key], undefined> ? T[Key] : T[Key] | null;\n};\ntype Id<T> = T;\nexport type Flatten<T> = Id<{[k in keyof T]: T[k]}>;\n\nexport type Defined<T> = Exclude<T, undefined>;\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import {Configuration} from 'webpack';\n\nimport {nodeConfig} from '@src/webpack/common-configs/node_config';\nimport {lambdaServerPlugin} from '@src/webpack/plugins/lambda_server_plugin';\n\nexport function config(opts: {context: string; watch: boolean}): Configuration {\n  const baseConfig = nodeConfig({...opts, isLib: true});\n  return {\n    ...baseConfig,\n    plugins: [...(baseConfig.plugins ?? []), lambdaServerPlugin()],\n  };\n}\n"],"names":["join","baseConfig","babelLoaderNode","sourceMapLoader","dependencyPackerPlugin","findPackageJson","nodeConfig","opts","context","watch","isLib","noEntry","packageJsonProperties","base","target","entry","index","output","path","filename","clean","keep","fileName","startsWith","chunkFormat","library","type","module","rules","parser","javascript","importMeta","resolve","extensions","modules","alias","plugins","externals","ctx","cb","request","contextInfo","getResolve","undefined","resolver","Error","then","res","includes","packageJson","catch","issuer","experiments","outputModule","definePlugin","eslintPlugin","forkTsCheckerPlugin","terserPlugin","YarnPlugin","isProd","mode","devtool","stats","infrastructureLogging","level","optimization","minimize","minimizer","backCompat","webpack","getEnv","envPrefix","extraEnv","Object","fromEntries","entries","process","env","filter","name","map","value","String","slice","length","JSON","stringify","DefinePlugin","createHash","mkdir","readdir","readFile","rm","stat","exists","rmDir","log","isSelenium","packageJsonCache","Map","p","has","get","pStat","isDirectory","dir","fileContent","json","parse","toString","set","err","getPort","hexHash","update","digest","port","Math","floor","parseInt","initLogFile","logFileName","root","lookupRoot","logDir","recursive","logFile","fromPath","parent","exec","promises","dirname","format","access","readFileInternal","writeFile","buffer","prettierConfig","printWidth","singleQuote","trailingComma","bracketSpacing","arrowParens","endOfLine","prettierFormat","str","writeRawFile","content","prettyJson","compact","writeJsonFile","prettyJs","js","writeJsFile","prettyTs","ts","writeTsFile","writeRawFileIfNotExists","dirPath","force","cleanDir","cp","from","to","Promise","reject","maybeReadFile","listFiles","files","ents","withFileTypes","ent","entPath","push","subFiles","isFile","all","error","console","existsSync","readdirSync","ESLint","WebpackError","stripAnsi","StandalonePlugin","EslintWebpackError","constructor","eslintRunId","message","filePath","loc","ruleId","file","RUN_ESLINT_INTERVAL","EslintPlugin","fileStates","shouldRun","setup","compiler","runEslintInterval","setInterval","runEslint","projectPath","workspacePath","workspaceDirs","e","patterns","flatMap","pattern","watcher","on","status","delete","hooks","compilation","tap","comp","syncErrorsAndWarnings","afterCompile","tapAsync","setTimeout","awaitIdle","finally","filesQueued","random","handleError","currentState","tsConfigPath","eslint","cwd","overrideConfig","settings","typescript","project","parserOptions","lintFiles","results","result","messages","checkIdle","eslintError","fileState","values","stack","errors","w","warnings","sort","e1","e2","localeCompare","msg","start","line","column","end","endLine","endColumn","resolveAwaitIdlePromise","state","teardown","_this$watcher","clearInterval","close","ansiRegex","RegExp","s","replace","registerExitCallback","globalError","apply","beforeRun","tapPromise","setupHandler","watchRun","shutdown","exitHandlerAsync","exitHandler","hasStarted","hasExited","called","callbacks","runCallbacks","fn","appendFileSync","val","data","ForkTsCheckerWebpackPlugin","diagnosticOptions","syntactic","semantic","declaration","global","configFile","formatter","logger","TerserWebpackPlugin","terserOptions","comments","extractComments","command","stdout","stderr","split","l","trim","test","exclude","loader","options","presets","targets","node","use","enforce","DependencyPackerPlugin","depMap","resolverFactory","for","descriptionFileRoot","descriptionFileData","version","clear","done","dependencies","extraProps","entryPoints","firstEntryPoint","entryPoint","import","at","entryPackageJson","outputDirectory","main","yarnInstall","randomUUID","writeFileSync","createServer","md5","asMap","errorAndStackAsString","LambdaServerPlugin","runtimeLogFile","appLogFile","server","req","url","method","internalError","runtimeLog","event","statusCode","body","chunk","parsedUrl","URL","rawQueryString","search","queryStringParameters","URLSearchParams","decodeURIComponent","sendRes","duration","headers","bodyLength","headerName","headerValue","setHeader","write","routeKey","rawPath","pathname","requestContext","accountId","http","userAgent","requestId","stage","timeEpoch","Date","now","isBase64Encoded","loadHandler","handler","startTs","handlerRes","Array","isArray","resBody","Buffer","listen","_this$server","parseOutput","token","tokenIndex1","indexOf","tokenIndex2","logs","t","toISOString","appLog","clearLogs","_this$handler","_asMap","handlerPath","handlerSource","handlerHash","hash","bind","args","arg","imported","importedHandler","lambdaServerPlugin","hashPassword","password","salt","notUndefined","isString","isNumber","iterNumberEnum","iterStringEnum","removeUndefined","arr","removeUndefinedOrNullProps","obj","neverHappens","errorMessage","defaultValue","asMapOrThrow","valueAsMap","asJson","asJsonOrThrow","valueAsJson","asJsonString","asString","asJsonStringOrThrow","asStringOrThrow","valueAsString","asArray","asArrayOrThrow","asStringArray","asStringArrayOrThrow","asMapArray","asMapArrayOrThrow","asNumber","isNaN","parsedValue","parseFloat","asNumberOrThrow","valueAsNumber","asBoolean","asBooleanOrThrow","valueAsBoolean","TIMESTAMP_REGEX","asDate","date","getTime","asDateOrThrow","valueAsDate","isNull","asError","errorAsString","errorMap","asConstantOrThrow","expected","parseJson","addPrefix","attr","prefix","key","config"],"sourceRoot":""}