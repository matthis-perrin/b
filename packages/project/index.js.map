{"version":3,"file":"index.js","mappings":"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CA;AACA;AACA;AACA;AACA,4BAA4BA,WAAY;AACxC;AACA,oBAAoBA,WAAY;AAChC;AACA;AACA;AACA,kCAAkCA,WAAY;AAC9C,yBAAyBiB,aAAc,IAAGjB,WAAY;AACtD,sCAAsCA,WAAY;AAClD,sCAAsCA,WAAY;AAClD;AACA;AACA,qCAAqCA,WAAY;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAUA,WAAY;AACtB,sCAAsCA,WAAY;AAClD,2CAA2CiB,aAAc,IAAGjB,WAAY;AACxE;AACA;AACA,EACE2F,GAAG,GACE;AACP,sCAAsC3F,WAAY;AAClD,6CAA6CA,WAAY;AACzD;AACA;AACA;AACA,UAAUA,WAAY;AACtB,0CAA0CA,WAAY;AACtD,0CAA0CiB,aAAc,IAAGjB,WAAY;AACvE;AACA,CAAC,CAACsD,IAAI,CAAC,CAAC,GACF,EACL;AACD;AACA,2BAA2BtD,WAAY;AACvC,YAAYiB,aAAc,IAAGjB,WAAY;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAciB,aAAc,IAAGjB,WAAY;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAciB,aAAc,IAAGjB,WAAY;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAciB,aAAc,IAAGjB,WAAY;AAC3C,4CAA4CA,WAAY;AACxD;AACA;AACA,CAAC,CAACsD,IAAI,CAAC,CAAC;AACR;;;;;;;;;;ACpHO,SAASmC,4BAA4BA,CAACxE,aAA4B,EAAU;EACjF,OAAQ;AACV;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmBA,aAAc;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,CAACqC,IAAI,CAAC,CAAC;AACR;;;;;;;;;;AC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","sources":["webpack://b/external node-commonjs \"node:fs/promises\"","webpack://b/external node-commonjs \"node:path\"","webpack://b/external node-commonjs \"prompts\"","webpack://b/./src/fs.ts","webpack://b/external node-commonjs \"node:child_process\"","webpack://b/external node-commonjs \"node:fs\"","webpack://b/external node-commonjs \"prettier\"","webpack://b/./src/models.ts","webpack://b/./src/project/generate_workspace.ts","webpack://b/external node-commonjs \"node:url\"","webpack://b/./src/project/generate_project.ts","webpack://b/./src/project/gitignore.ts","webpack://b/./src/project/package_json.ts","webpack://b/./src/versions.ts","webpack://b/./src/project/terraform/all.ts","webpack://b/./src/project/terraform/cloudfront.ts","webpack://b/./src/project/terraform/lambda.ts","webpack://b/./src/project/terraform/provider.ts","webpack://b/./src/project/terraform/s3.ts","webpack://b/./src/type_utils.ts","webpack://b/./src/project/terraform/dynamo.ts","webpack://b/./src/project/vscode_workspace.ts","webpack://b/webpack/bootstrap","webpack://b/webpack/runtime/compat get default export","webpack://b/webpack/runtime/define property getters","webpack://b/webpack/runtime/hasOwnProperty shorthand","webpack://b/webpack/runtime/make namespace object","webpack://b/./src/project/init_project.ts"],"sourcesContent":["module.exports = __WEBPACK_EXTERNAL_createRequire(import.meta.url)(\"node:fs/promises\");","module.exports = __WEBPACK_EXTERNAL_createRequire(import.meta.url)(\"node:path\");","module.exports = __WEBPACK_EXTERNAL_createRequire(import.meta.url)(\"prompts\");","import {exec} from 'node:child_process';\nimport {promises} from 'node:fs';\nimport {dirname, join} from 'node:path';\n\nimport {BuiltInParserName, format} from 'prettier';\n\nexport const {access, readFile, readdir, stat} = promises;\nconst {writeFile, mkdir, rm} = promises;\n\nexport async function writeJsonFile(path: string, json: unknown): Promise<void> {\n  await writeRawFile(path, `${JSON.stringify(json, undefined, 2)}\\n`);\n}\n\nconst prettierConfig = (parser: BuiltInParserName) =>\n  ({\n    parser,\n    printWidth: 100,\n    singleQuote: true,\n    trailingComma: 'es5',\n    bracketSpacing: false,\n    arrowParens: 'avoid',\n    endOfLine: 'auto',\n  }) as const;\n\nexport async function prettierFormat(str: string, parser: BuiltInParserName): Promise<string> {\n  return format(str, prettierConfig(parser));\n}\n\nasync function writePrettyFile(\n  parser: BuiltInParserName,\n  path: string,\n  code: string\n): Promise<void> {\n  await writeRawFile(path, await prettierFormat(code, parser));\n}\n\nexport async function writeJsFile(path: string, js: string): Promise<void> {\n  return writePrettyFile('babel', path, js);\n}\n\nexport async function writeTsFile(path: string, ts: string): Promise<void> {\n  return writePrettyFile('typescript', path, ts);\n}\n\nexport async function writeRawFile(path: string, content: string): Promise<void> {\n  await mkdir(dirname(path), {recursive: true});\n  await writeFile(path, content);\n}\n\nexport async function rmDir(dirPath: string): Promise<void> {\n  await rm(dirPath, {recursive: true, force: true});\n}\n\nexport async function cleanDir(dirPath: string): Promise<void> {\n  try {\n    await rmDir(dirPath);\n  } finally {\n    await mkdir(dirPath, {recursive: true});\n  }\n}\n\nexport async function cp(from: string, to: string): Promise<void> {\n  return new Promise((resolve, reject) => {\n    exec(`cp -R ${from} ${to}`, err => (err ? reject(err) : resolve()));\n  });\n}\n\nexport async function exists(path: string): Promise<boolean> {\n  try {\n    await access(path);\n    return true;\n  } catch {\n    return false;\n  }\n}\n\nexport async function maybeReadFile(path: string): Promise<string | undefined> {\n  try {\n    const fileContent = await readFile(path);\n    return fileContent.toString();\n  } catch {\n    return undefined;\n  }\n}\n\nexport async function listFiles(path: string): Promise<string[]> {\n  const files: string[] = [];\n  const ents = await readdir(path, {withFileTypes: true});\n  const promises: Promise<void>[] = [];\n  for (const ent of ents) {\n    const entPath = join(path, ent.name);\n    if (ent.isDirectory()) {\n      promises.push(\n        listFiles(entPath).then(subFiles => {\n          files.push(...subFiles);\n        })\n      );\n    } else if (ent.isFile()) {\n      files.push(entPath);\n    }\n  }\n  await Promise.all(promises);\n  return files;\n}\n","module.exports = __WEBPACK_EXTERNAL_createRequire(import.meta.url)(\"node:child_process\");","module.exports = __WEBPACK_EXTERNAL_createRequire(import.meta.url)(\"node:fs\");","module.exports = __WEBPACK_EXTERNAL_createRequire(import.meta.url)(\"prettier\");","import {Brand} from '@src/type_utils';\n\nexport type WorkspaceName = Brand<string, 'WorkspaceName'>;\nexport type ProjectName = Brand<string, 'ProjectName'>;\n\n//\n// Project type\n//\n\nexport enum ProjectType {\n  Web = 'web',\n  LambdaFunction = 'lambda_function',\n  LambdaApi = 'lambda_api',\n  NodeScript = 'node_script',\n  Shared = 'shared',\n  SharedNode = 'shared-node',\n}\n\nexport enum EslintType {\n  Web = 'web',\n  Node = 'node',\n  Lib = 'lib',\n}\n\nexport enum TsConfigType {\n  Web = 'web',\n  Node = 'node',\n  Lib = 'lib',\n}\nexport enum WebpackType {\n  Web = 'web',\n  Lib = 'lib', // shared\n  Lambda = 'lambda',\n  NodeScript = 'node-script',\n}\n\nexport interface ProjectTypeMetadata {\n  eslint: EslintType;\n  tsconfig: TsConfigType;\n  webpack?: WebpackType;\n}\n\nexport const PROJECT_TYPE_TO_METADATA = {\n  [ProjectType.Web]: {\n    eslint: EslintType.Web,\n    tsconfig: TsConfigType.Web,\n    webpack: WebpackType.Web,\n  },\n  [ProjectType.LambdaFunction]: {\n    eslint: EslintType.Node,\n    tsconfig: TsConfigType.Node,\n    webpack: WebpackType.Lambda,\n  },\n  [ProjectType.LambdaApi]: {\n    eslint: EslintType.Node,\n    tsconfig: TsConfigType.Node,\n    webpack: WebpackType.Lambda,\n  },\n  [ProjectType.NodeScript]: {\n    eslint: EslintType.Node,\n    tsconfig: TsConfigType.Node,\n    webpack: WebpackType.NodeScript,\n  },\n  [ProjectType.Shared]: {\n    eslint: EslintType.Lib,\n    tsconfig: TsConfigType.Lib,\n    webpack: WebpackType.Lib,\n  },\n  [ProjectType.SharedNode]: {\n    eslint: EslintType.Node,\n    tsconfig: TsConfigType.Node,\n    webpack: WebpackType.Lib,\n  },\n} satisfies Record<ProjectType, ProjectTypeMetadata>;\n\n//\n// Workspace Fragment type\n//\n\nexport enum WorkspaceFragmentType {\n  StaticWebsite = 'static-website',\n  StandaloneLambda = 'standalone-lambda',\n  WebApp = 'web-app',\n  NodeScript = 'node-script',\n  Shared = 'shared',\n  SharedNode = 'shared-node',\n}\n\ninterface WorkspaceFragmentBase {\n  type: WorkspaceFragmentType;\n}\n\nexport interface WorkspaceFragmentRegistry {\n  [WorkspaceFragmentType.StaticWebsite]: {\n    type: WorkspaceFragmentType.StaticWebsite;\n    websiteName: ProjectName;\n  };\n  [WorkspaceFragmentType.StandaloneLambda]: {\n    type: WorkspaceFragmentType.StandaloneLambda;\n    lambdaName: ProjectName;\n  };\n  [WorkspaceFragmentType.WebApp]: {\n    type: WorkspaceFragmentType.WebApp;\n    websiteName: ProjectName;\n    lambdaName: ProjectName;\n  };\n  [WorkspaceFragmentType.NodeScript]: {\n    type: WorkspaceFragmentType.NodeScript;\n    scriptName: ProjectName;\n  };\n  [WorkspaceFragmentType.Shared]: {\n    type: WorkspaceFragmentType.Shared;\n  };\n  [WorkspaceFragmentType.SharedNode]: {\n    type: WorkspaceFragmentType.SharedNode;\n  };\n}\n\ntype RegistryIsValid = WorkspaceFragmentRegistry extends Record<\n  WorkspaceFragmentType,\n  WorkspaceFragmentBase\n>\n  ? boolean\n  : never;\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nfunction validateRegistry(): RegistryIsValid {\n  return true;\n}\n\nexport type WorkspaceFragment = WorkspaceFragmentRegistry[keyof WorkspaceFragmentRegistry];\n","import {execSync} from 'node:child_process';\nimport {cp} from 'node:fs/promises';\nimport {join, relative} from 'node:path';\nimport {fileURLToPath} from 'node:url';\n\nimport {writeJsonFile, writeRawFile} from '@src/fs';\nimport {\n  ProjectName,\n  ProjectType,\n  WorkspaceFragment,\n  WorkspaceFragmentType,\n  WorkspaceName,\n} from '@src/models';\nimport {generateProject} from '@src/project/generate_project';\nimport {generateGitIgnore} from '@src/project/gitignore';\nimport {generateWorkspacePackageJson} from '@src/project/package_json';\nimport {\n  generateCommonTerraform,\n  generateDummyTerraformCredentials,\n  generateWorkspaceProjectTerraform,\n} from '@src/project/terraform/all';\nimport {generateDynamoTerraform} from '@src/project/terraform/dynamo';\nimport {generateCodeWorkspace} from '@src/project/vscode_workspace';\nimport {neverHappens} from '@src/type_utils';\n\nexport interface WorkspaceProject {\n  projectName: ProjectName;\n  type: ProjectType;\n  vars: Record<string, string>;\n}\n\nexport function getProjectsFromWorkspaceFragment(\n  fragment: WorkspaceFragment,\n  allFragments: WorkspaceFragment[]\n): WorkspaceProject[] {\n  if (fragment.type === WorkspaceFragmentType.StaticWebsite) {\n    return [\n      {\n        projectName: fragment.websiteName,\n        type: ProjectType.Web,\n        vars: {\n          __PROJECT_NAME__: fragment.websiteName,\n        },\n      },\n    ];\n  } else if (fragment.type === WorkspaceFragmentType.StandaloneLambda) {\n    return [\n      {\n        projectName: fragment.lambdaName,\n        type: ProjectType.LambdaFunction,\n        vars: {\n          __PROJECT_NAME__: fragment.lambdaName,\n        },\n      },\n    ];\n  } else if (fragment.type === WorkspaceFragmentType.WebApp) {\n    return [\n      {\n        projectName: fragment.websiteName,\n        type: ProjectType.Web,\n        vars: {\n          __PROJECT_NAME__: fragment.websiteName,\n          __BACKEND_NAME__: fragment.lambdaName,\n          __BACKEND_NAME_UPPERCASE__: fragment.lambdaName.toUpperCase(),\n        },\n      },\n      {\n        projectName: fragment.lambdaName,\n        type: ProjectType.LambdaApi,\n        vars: {\n          __PROJECT_NAME__: fragment.lambdaName,\n          __FRONTEND_NAME__: fragment.websiteName,\n          __FRONTEND_NAME_UPPERCASE__: fragment.websiteName.toUpperCase(),\n        },\n      },\n    ];\n  } else if (fragment.type === WorkspaceFragmentType.NodeScript) {\n    return [\n      {\n        projectName: fragment.scriptName,\n        type: ProjectType.NodeScript,\n        vars: {\n          __PROJECT_NAME__: fragment.scriptName,\n        },\n      },\n    ];\n  } else if (fragment.type === WorkspaceFragmentType.SharedNode) {\n    const projectName = 'shared-node' as ProjectName;\n    return [\n      {\n        projectName,\n        type: ProjectType.SharedNode,\n        vars: {\n          __PROJECT_NAME__: projectName,\n        },\n      },\n    ];\n    // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n  } else if (fragment.type === WorkspaceFragmentType.Shared) {\n    const projectName = 'shared' as ProjectName;\n    const otherVars: Record<string, string> = {};\n    for (const f of allFragments) {\n      if (f.type === WorkspaceFragmentType.WebApp) {\n        otherVars['__BACKEND_NAME__'] = f.lambdaName;\n        otherVars['__BACKEND_NAME_UPPERCASE__'] = f.lambdaName.toUpperCase();\n      }\n    }\n    return [\n      {\n        projectName,\n        type: ProjectType.Shared,\n        vars: {\n          __PROJECT_NAME__: projectName,\n          ...otherVars,\n        },\n      },\n    ];\n  }\n  neverHappens(fragment, `Unknown ProjectType ${(fragment as WorkspaceFragment).type}`);\n}\n\nexport async function generateWorkspace(\n  dst: string,\n  workspaceName: WorkspaceName,\n  workspaceFragments: WorkspaceFragment[],\n  alreadyGenerated: ProjectName[]\n): Promise<void> {\n  const projects = workspaceFragments.flatMap(f =>\n    getProjectsFromWorkspaceFragment(f, workspaceFragments)\n  );\n\n  // Create projects files from templates\n  await Promise.all(\n    projects\n      .filter(p => !alreadyGenerated.includes(p.projectName))\n      .map(async project => generateProject(join(dst, project.projectName), project))\n  );\n\n  // Generate workspace root files\n  const SCRIPTS_PATH = join(fileURLToPath(import.meta.url), '../scripts');\n  await Promise.all([\n    // package.json\n    await writeJsonFile(\n      join(dst, 'package.json'),\n      generateWorkspacePackageJson(workspaceName, projects)\n    ),\n    // .gitignore\n    await writeRawFile(join(dst, '.gitignore'), generateGitIgnore()),\n    // app.code-workspace\n    await writeJsonFile(\n      join(dst, 'app.code-workspace'),\n      generateCodeWorkspace(workspaceName, workspaceFragments)\n    ),\n    // setup.js\n    await cp(join(SCRIPTS_PATH, 'setup.js'), join(dst, 'setup.js')),\n    // deploy.js\n    await cp(join(SCRIPTS_PATH, 'deploy.js'), join(dst, 'deploy.js')),\n    // build.js\n    await cp(join(SCRIPTS_PATH, 'build.js'), join(dst, 'build.js')),\n  ]);\n\n  // Terraform folder generation\n  const terraformPath = join(dst, 'terraform');\n  const userTable = false as boolean;\n  await Promise.all([\n    writeRawFile(join(terraformPath, '.aws-credentials'), generateDummyTerraformCredentials()),\n    userTable\n      ? writeRawFile(\n          join(terraformPath, 'dynamo.tf'),\n          generateDynamoTerraform(workspaceName, {tableName: 'user'})\n        )\n      : Promise.resolve(),\n    writeRawFile(join(terraformPath, 'base.tf'), generateCommonTerraform(workspaceName, projects)),\n    ...projects.map(async p => {\n      const content = generateWorkspaceProjectTerraform(workspaceName, p);\n      if (content === undefined) {\n        return;\n      }\n      const name = `${p.projectName}_terraform`;\n      await writeRawFile(join(terraformPath, `${name}.tf`), content);\n    }),\n  ]);\n\n  // Run setup.js\n  console.log('Running post install script');\n  const commands = [`cd ${dst}`, `node setup.js`, `git init`];\n  execSync(commands.join(' && '), {stdio: ['ignore', 'inherit', 'inherit']});\n\n  // Final instructions\n  console.log(`Run the following to get started:`);\n  console.log(`cd ${relative(process.cwd(), dst)}; code app.code-workspace; yarn watch`);\n}\n","module.exports = __WEBPACK_EXTERNAL_createRequire(import.meta.url)(\"node:url\");","import {writeFile} from 'node:fs/promises';\nimport {join} from 'node:path';\nimport {fileURLToPath} from 'node:url';\n\nimport {cp, listFiles, prettierFormat, readFile, writeJsonFile} from '@src/fs';\nimport {WorkspaceProject} from '@src/project/generate_workspace';\n\nconst TEMPLATES_PATH = join(fileURLToPath(import.meta.url), '../templates');\n\nexport async function generateProject(dst: string, project: WorkspaceProject): Promise<void> {\n  const {projectName, type, vars} = project;\n  // Copy template files\n  await cp(join(TEMPLATES_PATH, type), dst);\n\n  // Replace name in package.json\n  const packageJsonPath = join(dst, 'package.json');\n  const packageJsonbuffer = await readFile(packageJsonPath);\n  const packageJson = JSON.parse(packageJsonbuffer.toString());\n  packageJson['name'] = projectName;\n  await writeJsonFile(packageJsonPath, packageJson);\n\n  // Replace variables\n  const files = await listFiles(dst);\n  await Promise.all(\n    files.map(async file => {\n      const buffer = await readFile(file);\n      const content = buffer.toString();\n      let newContent = content;\n      for (const [varName, varValue] of Object.entries(vars)) {\n        newContent = newContent.replaceAll(varName, varValue);\n      }\n      if (file.endsWith('.ts') || file.endsWith('.tsx')) {\n        newContent = await prettierFormat(newContent, 'typescript');\n      }\n      if (file.endsWith('.json')) {\n        newContent = await prettierFormat(newContent, 'json');\n      }\n      if (newContent !== content) {\n        await writeFile(file, newContent);\n      }\n    })\n  );\n}\n","export function generateGitIgnore(): string {\n  return `\n.DS_Store\nnode_modules\nbuild\ndist\ntmp\nyarn-error.log\n.yarn-warnings.log\nyarn.lock\nterraform/.terraform\nterraform/.terraform*\nterraform/*.tfstate.backup\nterraform/.aws-credentials\nterraform/archives\n*/log\n    `.trim();\n}\n","import {PROJECT_TYPE_TO_METADATA, WorkspaceName} from '@src/models';\nimport {WorkspaceProject} from '@src/project/generate_workspace';\nimport {PACKAGE_VERSIONS, TYPESCRIPT_VERSION} from '@src/versions';\n\nfunction uniq<T>(val: T[]): T[] {\n  return [...new Set(val).values()];\n}\n\nexport function generateWorkspacePackageJson(\n  workspaceName: WorkspaceName,\n  projects: WorkspaceProject[]\n): Record<string, unknown> {\n  const eslintRuntimes = uniq(projects.map(p => PROJECT_TYPE_TO_METADATA[p.type].eslint));\n  const tsconfigRuntimes = uniq(projects.map(p => PROJECT_TYPE_TO_METADATA[p.type].tsconfig));\n  const webpackRuntimes = uniq(projects.map(p => PROJECT_TYPE_TO_METADATA[p.type].webpack));\n\n  return {\n    name: workspaceName,\n    license: 'UNLICENSED',\n    type: 'module',\n    engines: {\n      node: '>=20.10',\n    },\n    scripts: {\n      setup: 'node ./setup.js',\n      deploy: 'node ./deploy.js',\n      build: 'NODE_ENV=production node ./build.js',\n      watch: 'NODE_ENV=development node ./build.js --watch',\n    },\n    eslintConfig: {\n      ignorePatterns: ['**/*.js'],\n    },\n    prettier: '@matthis/prettier-config',\n    devDependencies: Object.fromEntries(\n      (\n        [\n          ...eslintRuntimes.map(runtime => [\n            `@matthis/eslint-config-${runtime}`,\n            PACKAGE_VERSIONS.eslint,\n          ]),\n          ['@matthis/prettier-config', PACKAGE_VERSIONS.prettier],\n          ...tsconfigRuntimes.map(runtime => [\n            `@matthis/tsconfig-${runtime}`,\n            PACKAGE_VERSIONS.tsconfig,\n          ]),\n          ...webpackRuntimes.map(runtime => [\n            `@matthis/webpack-${runtime}`,\n            PACKAGE_VERSIONS.webpack,\n          ]),\n          ['@matthis/webpack-runner', PACKAGE_VERSIONS.runner],\n          ['typescript', TYPESCRIPT_VERSION],\n        ] as [string, string][]\n      ).sort((d1, d2) => d1[0].localeCompare(d2[0]))\n    ),\n  };\n}\n","export const PACKAGE_VERSIONS = {\n  project: '1.8.1',\n  eslint: '1.5.2',\n  prettier: '1.3.0',\n  tsconfig: '1.6.0',\n  webpack: '1.6.1',\n  runner: '1.5.1',\n};\n\nexport const ESLINT_VERSION = '8.56.x';\nexport const PRETTIER_VERSION = '3.1.x';\nexport const TYPESCRIPT_VERSION = '5.3.x';\n\nexport const LIB_VERSIONS = {\n  '@types/react': '18.2.x',\n  '@types/react-dom': '18.2.x',\n  react: '18.2.x',\n  'react-dom': '18.2.x',\n\n  'styled-components': '6.1.x',\n\n  'react-router': '6.4.x',\n  'react-router-dom': '6.4.x',\n};\n","import {ProjectType, WorkspaceName} from '@src/models';\nimport {WorkspaceProject} from '@src/project/generate_workspace';\nimport {generateCloudfrontDistributionTerraform} from '@src/project/terraform/cloudfront';\nimport {generateLambdaTerraform} from '@src/project/terraform/lambda';\nimport {generateAwsProviderTerraform} from '@src/project/terraform/provider';\nimport {generateS3BucketTerraform} from '@src/project/terraform/s3';\nimport {neverHappens} from '@src/type_utils';\n\nexport function generateCommonTerraform(\n  workspaceName: WorkspaceName,\n  projects: WorkspaceProject[]\n): string {\n  return [\n    generateAwsProviderTerraform(workspaceName),\n    generateS3BucketTerraform(\n      workspaceName,\n      projects.filter(p => p.type === ProjectType.Web).map(p => p.projectName)\n    ),\n  ].join('\\n\\n');\n}\n\nexport function generateWorkspaceProjectTerraform(\n  workspaceName: WorkspaceName,\n  project: WorkspaceProject\n): string | undefined {\n  const {projectName, type} = project;\n  if (type === ProjectType.Web) {\n    return generateCloudfrontDistributionTerraform(workspaceName, projectName);\n  } else if (type === ProjectType.LambdaFunction) {\n    return generateLambdaTerraform(workspaceName, projectName, {api: false});\n  } else if (type === ProjectType.LambdaApi) {\n    return generateLambdaTerraform(workspaceName, projectName, {api: true});\n  } else if (type === ProjectType.NodeScript) {\n    return undefined;\n  } else if (type === ProjectType.SharedNode) {\n    return undefined;\n    // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n  } else if (type === ProjectType.Shared) {\n    return undefined;\n  }\n  neverHappens(type, 'ProjectType');\n}\n\nexport function generateDummyTerraformCredentials(): string {\n  return `\n[default]\naws_access_key_id=\naws_secret_access_key=\naws_session_token=\n`;\n}\n","import {ProjectName, WorkspaceName} from '@src/models';\n\nexport function generateCloudfrontDistributionTerraform(\n  workspaceName: WorkspaceName,\n  projectName: ProjectName\n): string {\n  const bucketName = projectName.toLowerCase().replace(/[^\\d.a-z-]+/gu, '-');\n  const originId = `${bucketName}-origin-id`;\n  return `\noutput \"${projectName}_cloudfront_domain_name\" {\n  value       = aws_cloudfront_distribution.${projectName}.domain_name\n  description = \"Domain (from cloudfront) where the \\\\\"${workspaceName}-${projectName}\\\\\" frontend is available.\"\n}\n  \nresource \"aws_cloudfront_distribution\" \"${projectName}\" {\n  origin {\n    domain_name = aws_s3_bucket.code.bucket_regional_domain_name\n    origin_id   = \"${originId}\"\n    origin_path = \"/${projectName}\"\n\n    s3_origin_config {\n      origin_access_identity = aws_cloudfront_origin_access_identity.${projectName}.cloudfront_access_identity_path\n    }\n  }\n  \n  enabled             = true\n  wait_for_deployment = false\n  is_ipv6_enabled     = true\n  price_class         = \"PriceClass_100\"\n  \n  default_root_object   = \"/index.html\"\n  custom_error_response {\n    error_code         = 400\n    response_code      = 200\n    response_page_path = \"/index.html\"\n  }\n  custom_error_response {\n    error_code         = 403\n    response_code      = 200\n    response_page_path = \"/index.html\"\n  }\n  custom_error_response {\n    error_code         = 404\n    response_code      = 200\n    response_page_path = \"/index.html\"\n  }\n\n  default_cache_behavior {\n    allowed_methods  = [\"HEAD\", \"GET\"]\n    cached_methods   = [\"HEAD\", \"GET\"]\n    compress         = true\n    target_origin_id = \"${originId}\"\n    viewer_protocol_policy = \"redirect-to-https\"\n    \n    forwarded_values {\n      query_string = false\n      cookies {\n        forward = \"none\"\n      }\n    }\n  }\n\n  restrictions {\n    geo_restriction {\n      restriction_type = \"none\"\n    }\n  }\n\n  viewer_certificate {\n    cloudfront_default_certificate = true\n  }\n}\n\nresource \"aws_cloudfront_origin_access_identity\" \"${projectName}\" {}\n  `.trim();\n}\n","import {ProjectName, WorkspaceName} from '@src/models';\n\nexport function generateLambdaTerraform(\n  workspaceName: WorkspaceName,\n  projectName: ProjectName,\n  opts: {api: boolean}\n): string {\n  const {api} = opts;\n  return `\n# Define any extra role for the lambda here\ndata \"aws_iam_policy_document\" \"${projectName}_lambda_extra_role\" {\n  statement {\n    actions   = [\"s3:ListAllMyBuckets\"]\n    resources = [\"*\"]\n  }\n}\n\nresource \"aws_s3_object\" \"${projectName}_archive\" {\n  bucket       = aws_s3_bucket.code.id\n  key          = \"${projectName}/dist.zip\"\n  content_base64 = \"UEsDBBQACAAIAGaKwlYAAAAAAAAAADYAAAAIACAAaW5kZXguanNVVA0AB3AIemRyCHpkcAh6ZHV4CwABBPUBAAAEFAAAAEutKMgvKinWy0jMS8lJLVKwVUgsrsxLVkgrzUsuyczPU9DQVKjmUlAoSi0pLcpTUFe35qq15gIAUEsHCP0ak1o4AAAANgAAAFBLAQIUAxQACAAIAGaKwlb9GpNaOAAAADYAAAAIACAAAAAAAAAAAACkgQAAAABpbmRleC5qc1VUDQAHcAh6ZHIIemRwCHpkdXgLAAEE9QEAAAQUAAAAUEsFBgAAAAABAAEAVgAAAI4AAAAAAA==\"\n}\n\nresource \"aws_lambda_function\" \"${projectName}\" {\n  function_name     = \"${workspaceName}-${projectName}\"\n  s3_bucket         = aws_s3_object.${projectName}_archive.bucket\n  s3_key            = aws_s3_object.${projectName}_archive.key\n  handler           = \"index.handler\"\n  runtime           = \"nodejs20.x\"\n  role              = aws_iam_role.${projectName}_lambda_exec.arn\n  timeout           = 900 // 15 minutes\n  environment {\n    variables = {\n      NODE_OPTIONS = \"--enable-source-maps\"\n    }\n  }\n}\n\noutput \"${projectName}_function_name\" {\n  value       = aws_lambda_function.${projectName}.function_name\n  description = \"Function name of the \\\\\"${workspaceName}-${projectName}\\\\\" lambda\"\n}\n\n${\n  api\n    ? `\nresource \"aws_lambda_function_url\" \"${projectName}\" {\n  function_name      = aws_lambda_function.${projectName}.function_name\n  authorization_type = \"NONE\"\n}\n\noutput \"${projectName}_function_url\" {\n  value       = aws_lambda_function_url.${projectName}.function_url\n  description = \"Function url of the \\\\\"${workspaceName}-${projectName}\\\\\" lambda\"\n}\n`.trim()\n    : ''\n}\n\nresource \"aws_iam_role\" \"${projectName}_lambda_exec\" {\n  name = \"${workspaceName}-${projectName}-assume-role\"\n  assume_role_policy = jsonencode({\n    Version = \"2012-10-17\"\n    Statement = [\n      {\n        Action    = \"sts:AssumeRole\"\n        Principal = {\n          Service = \"lambda.amazonaws.com\"\n        }\n        Effect    = \"Allow\"\n        Sid       = \"\"\n      },\n    ]\n  })\n\n  inline_policy {\n    name = \"${workspaceName}-${projectName}-cloudwatch-role\"\n    policy = jsonencode({\n      Version = \"2012-10-17\"\n      Statement = [\n        {\n          Action   = [\n            \"logs:CreateLogGroup\",\n            \"logs:CreateLogStream\",\n            \"logs:PutLogEvents\"\n          ]\n          Effect   = \"Allow\"\n          Resource = \"arn:aws:logs:*:*:*\"\n        },\n      ]\n    })\n  }\n\n  inline_policy {\n    name = \"${workspaceName}-${projectName}-s3-code-bucket\"\n    policy = jsonencode({\n      Version = \"2012-10-17\"\n      Statement = [\n        {\n          Action   = [\n            \"s3:GetObject\",\n            \"s3:GetObjectTagging\"\n          ]\n          Effect   = \"Allow\"\n          Resource = [\n            \"\\${aws_s3_bucket.code.arn}/*\",\n          ]\n        }\n      ]\n    })\n  }\n  \n  inline_policy {\n    name = \"${workspaceName}-${projectName}-extra-role\"\n    policy = data.aws_iam_policy_document.${projectName}_lambda_extra_role.json\n  }\n}\n`.trim();\n}\n","import {WorkspaceName} from '@src/models';\n\nexport function generateAwsProviderTerraform(workspaceName: WorkspaceName): string {\n  return `\nterraform {\n  required_providers {\n    aws = {\n      source  = \"hashicorp/aws\"\n      version = \"~> 5.1\"\n    }\n  }\n}\n\nprovider \"aws\" {\n  region  = \"eu-west-3\"\n  shared_credentials_files = [\"./.aws-credentials\"]\n  default_tags {\n    tags = {\n      Project = \"${workspaceName}\"\n    }\n  }\n}\n\ndata \"aws_region\" \"current\" {}\noutput \"region\" {\n  value = data.aws_region.current.id\n}\n`.trim();\n}\n","import {ProjectName, WorkspaceName} from '@src/models';\n\nexport function generateS3BucketTerraform(\n  workspaceName: WorkspaceName,\n  webProjectNames: ProjectName[]\n): string {\n  const bucketName = workspaceName.toLowerCase().replace(/[^a-z0-9.-]+/gu, '-');\n\n  const CODE_BUCKET = `\nresource \"aws_s3_bucket\" \"code\" {\n  bucket_prefix = \"${bucketName}-code-\"\n}\n\noutput \"code_bucket\" {\n  value = aws_s3_bucket.code.id\n}\n`.trim();\n\n  const CLOUDFRONT_ACCESS = `\ndata \"aws_iam_policy_document\" \"cloudfront_access_to_code\" {\n  ${webProjectNames\n    .map(p =>\n      `\n  statement {\n    actions   = [\"s3:GetObject\"]\n    resources = [\n      \"\\${aws_s3_bucket.code.arn}/${p}/*\",\n    ]\n    principals {\n      type        = \"AWS\"\n      identifiers = [aws_cloudfront_origin_access_identity.${p}.iam_arn]\n    }\n  }\n`.trim()\n    )\n    .join('\\n\\n')}\n}\n\nresource \"aws_s3_bucket_policy\" \"code\" {\n  bucket = aws_s3_bucket.code.id\n  policy = data.aws_iam_policy_document.cloudfront_access_to_code.json\n}\n`.trim();\n\n  const out = [CODE_BUCKET];\n  if (webProjectNames.length > 0) {\n    out.push(CLOUDFRONT_ACCESS);\n  }\n  return out.join('\\n\\n');\n}\n","export type Brand<Type, Name> = Type & {__brand: Name};\n\nexport function neverHappens(value: never, msg?: string): never {\n  throw new Error(msg ?? `Unexpected value ${value}`);\n}\n\nfunction notUndefined<T>(val: T | undefined): val is T {\n  return val !== undefined;\n}\n\nexport function removeUndefined<T>(arr: (T | undefined)[]): T[] {\n  return arr.filter(notUndefined);\n}\n","import {WorkspaceName} from '@src/models';\n\nfunction toPascal(str: string): string {\n  return str\n    .toLowerCase()\n    .split(/[^a-z0-9]/u)\n    .map(str => (str[0]?.toUpperCase() ?? '') + str.slice(1))\n    .join('');\n}\n\nfunction toSnake(str: string): string {\n  return str\n    .toLowerCase()\n    .split(/[^a-z0-9]/u)\n    .join('_');\n}\n\nexport function generateDynamoTerraform(\n  workspaceName: WorkspaceName,\n  opts: {tableName: string}\n): string {\n  const {tableName} = opts;\n  const namePascal = toPascal(workspaceName) + toPascal(tableName);\n  const nameSnake = toSnake(workspaceName) + toSnake(tableName);\n  const tableUpper = toSnake(tableName).toUpperCase();\n  return `\n//\n// ${toPascal(tableName)} table\n//\n\nlocals {\n    ${tableUpper}_TABLE_NAME = \"${namePascal}\"\n    ${tableUpper}_BY_EMAIL_INDEX_NAME = \"${namePascal}_ByEmail_SortedByCreatedAt\"\n}\noutput \"${tableUpper}_TABLE_NAME\" { value = local.${tableUpper}_TABLE_NAME }\noutput \"${tableUpper}_BY_EMAIL_INDEX_NAME\" { value = local.${tableUpper}_BY_EMAIL_INDEX_NAME }\n\nresource \"aws_dynamodb_table\" \"${nameSnake}_table\" {\n  name           = local.${tableUpper}_TABLE_NAME\n  billing_mode   = \"PAY_PER_REQUEST\"\n  hash_key       = \"id\"\n\n  attribute {\n    name = \"id\"\n    type = \"S\"\n  }\n\n  attribute {\n    name = \"email\"\n    type = \"S\"\n  }\n\n  attribute {\n    name = \"createdAt\"\n    type = \"N\"\n  }\n\n  global_secondary_index {\n    name               = local.${tableUpper}_BY_EMAIL_INDEX_NAME\n    hash_key           = \"email\"\n    range_key          = \"createdAt\"\n    projection_type    = \"ALL\"\n  }\n}\n    `.trim();\n}\n","import {join} from 'node:path';\n\nimport {maybeReadFile} from '@src/fs';\nimport {WorkspaceFragment} from '@src/models';\nimport {getProjectsFromWorkspaceFragment} from '@src/project/generate_workspace';\n\nexport function generateCodeWorkspace(\n  workspaceName: string,\n  workspaceFragments: WorkspaceFragment[]\n): Record<string, unknown> {\n  const projects = workspaceFragments.flatMap(f =>\n    getProjectsFromWorkspaceFragment(f, workspaceFragments)\n  );\n  const projectNames = projects.map(p => p.projectName);\n  return {\n    projects: workspaceFragments,\n    folders: [\n      ...projectNames.map(p => ({path: p})),\n      {path: 'terraform'},\n      {path: '.', name: 'root'},\n    ],\n    settings: {\n      'window.title': `${workspaceName}\\${separator}\\${activeEditorShort}`,\n      'files.exclude': Object.fromEntries([\n        ...projectNames.map(p => [p, true]),\n        ['terraform', true],\n      ]),\n      'editor.acceptSuggestionOnCommitCharacter': false,\n      'editor.suggestSelection': 'first',\n      'vsintellicode.modify.editor.suggestSelection': 'automaticallyOverrodeDefaultValue',\n      'explorer.confirmDelete': false,\n      'git.autofetch': true,\n      'git.confirmSync': false,\n      'typescript.preferences.importModuleSpecifier': 'non-relative',\n      'eslint.lintTask.enable': true,\n      'eslint.useESLintClass': true,\n      'eslint.options': {\n        reportUnusedDisableDirectives: 'warn',\n      },\n      'editor.formatOnSave': true,\n      'editor.codeActionsOnSave': {\n        'source.fixAll': false,\n        'source.fixAll.eslint': true,\n      },\n      'editor.defaultFormatter': 'esbenp.prettier-vscode',\n      'editor.linkedEditing': true,\n      'emmet.showExpandedAbbreviation': 'never',\n      'files.associations': {\n        '*.tf': 'terraform',\n      },\n    },\n    extensions: {\n      recommendations: [\n        'dbaeumer.vscode-eslint',\n        'esbenp.prettier-vscode',\n        'VisualStudioExptTeam.vscodeintellicode',\n        'styled-components.vscode-styled-components',\n        'naumovs.color-highlight',\n        'eamodio.gitlens',\n      ],\n    },\n  };\n}\n\nexport async function readWorkspaceFragments(\n  workspacePath: string\n): Promise<WorkspaceFragment[] | undefined> {\n  const workspaceContent = await maybeReadFile(join(workspacePath, 'app.code-workspace'));\n  const workspaceJson = workspaceContent === undefined ? {} : JSON.parse(workspaceContent);\n  const workspaceProjects = Array.isArray(workspaceJson.projects)\n    ? workspaceJson.projects\n    : undefined;\n  return workspaceProjects as WorkspaceFragment[] | undefined;\n}\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import {mkdir} from 'node:fs/promises';\nimport {basename, join} from 'node:path';\n\nimport {prompt} from 'prompts';\n\nimport {rmDir} from '@src/fs';\nimport {ProjectName, WorkspaceFragment, WorkspaceFragmentType, WorkspaceName} from '@src/models';\nimport {generateWorkspace, getProjectsFromWorkspaceFragment} from '@src/project/generate_workspace';\nimport {readWorkspaceFragments} from '@src/project/vscode_workspace';\nimport {neverHappens} from '@src/type_utils';\n\nasync function cancel(workspacePath?: string): Promise<never> {\n  console.log('Cancelling...');\n  if (workspacePath !== undefined) {\n    await rmDir(workspacePath);\n  }\n  // eslint-disable-next-line node/no-process-exit\n  process.exit(0);\n}\n\nasync function initProject(): Promise<void> {\n  let workspaceName: string;\n  let workspacePath = process.cwd();\n  const frags: WorkspaceFragment[] = [];\n  const takenNames = ['terraform'];\n  const alreadyGenerated: ProjectName[] = [];\n\n  // Check if we are already in a workspace\n  const workspaceFragments = await readWorkspaceFragments(workspacePath);\n  if (workspaceFragments !== undefined) {\n    workspaceName = basename(workspacePath);\n    for (const fragment of workspaceFragments) {\n      frags.push(fragment);\n      const projectNames = getProjectsFromWorkspaceFragment(fragment, workspaceFragments).map(\n        p => p.projectName\n      );\n      takenNames.push(...projectNames);\n      alreadyGenerated.push(...projectNames);\n    }\n  } else {\n    frags.push({type: WorkspaceFragmentType.Shared}, {type: WorkspaceFragmentType.SharedNode});\n    // Ask for workspace name\n    const {workspaceName: newWorkspaceName} = await prompt({\n      type: 'text',\n      name: 'workspaceName',\n      message: 'Workspace name',\n      validate: (v: string) => v.length > 0,\n    });\n    workspaceName = newWorkspaceName;\n\n    if (typeof workspaceName !== 'string') {\n      return cancel();\n    }\n\n    workspacePath = join(workspacePath, workspaceName);\n    await mkdir(workspacePath);\n  }\n\n  try {\n    while (true) {\n      let frag;\n      try {\n        frag = await askForWorkspaceFragment(takenNames);\n      } catch (err: unknown) {\n        console.error(String(err));\n        continue;\n      }\n      if (frag) {\n        frags.push(frag);\n        takenNames.push(...getProjectsFromWorkspaceFragment(frag, frags).map(p => p.projectName));\n      } else {\n        break;\n      }\n    }\n\n    const name = workspaceName as WorkspaceName;\n\n    await generateWorkspace(workspacePath, name, frags, alreadyGenerated);\n  } catch (err: unknown) {\n    console.error(String(err));\n    await cancel(workspaceName);\n  }\n}\n\ntype SelectableWorkspaceFragmentType = Exclude<\n  WorkspaceFragmentType,\n  WorkspaceFragmentType.Shared | WorkspaceFragmentType.SharedNode\n>;\n\nconst WorkspaceFragmentTypeToString: Record<SelectableWorkspaceFragmentType, string> = {\n  [WorkspaceFragmentType.WebApp]: 'Web App',\n  [WorkspaceFragmentType.StaticWebsite]: 'Static Website',\n  [WorkspaceFragmentType.StandaloneLambda]: 'Standalone Lambda',\n  [WorkspaceFragmentType.NodeScript]: 'Node Script',\n};\n\nasync function askForWorkspaceFragment(\n  takenNames: string[]\n): Promise<WorkspaceFragment | undefined> {\n  const DONE_GENERATING = 'done_generating';\n  const {workspaceFragmentType} = await prompt({\n    type: 'select',\n    name: 'workspaceFragmentType',\n    message: 'Choose a type of project to add to the workspace',\n    choices: [\n      ...Object.entries(WorkspaceFragmentTypeToString).map(([value, title]) => ({value, title})),\n      {title: `I'm done`, value: DONE_GENERATING},\n    ],\n  });\n  if (workspaceFragmentType === undefined || workspaceFragmentType === DONE_GENERATING) {\n    return undefined;\n  }\n  const type = workspaceFragmentType as SelectableWorkspaceFragmentType;\n\n  if (type === WorkspaceFragmentType.StaticWebsite) {\n    const websiteName = await askForProjectName('Website project name', 'website', takenNames);\n    return {type, websiteName};\n  } else if (type === WorkspaceFragmentType.StandaloneLambda) {\n    const lambdaName = await askForProjectName('Lambda project name', 'lambda', takenNames);\n    return {type, lambdaName};\n  } else if (type === WorkspaceFragmentType.WebApp) {\n    const websiteName = await askForProjectName('Frontend project name', 'frontend', takenNames);\n    const lambdaName = await askForProjectName('Backend project name', 'backend', takenNames);\n    return {type, websiteName, lambdaName};\n    // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n  } else if (type === WorkspaceFragmentType.NodeScript) {\n    const scriptName = await askForProjectName('Script project name', 'script', takenNames);\n    return {type, scriptName};\n  }\n  neverHappens(type, `Unknown WorkspaceFragmentType \"${type}\"`);\n}\n\nconst VALID_PROJECT_NAME = /^[a-zA-Z0-9_]+$/u;\n\nasync function askForProjectName(\n  question: string,\n  defaultValue: string,\n  takenNames: string[]\n): Promise<ProjectName> {\n  let initial = defaultValue;\n  if (takenNames.includes(initial)) {\n    let index = 2;\n    while (takenNames.includes(initial)) {\n      initial = `${defaultValue}_${index}`;\n      index++;\n    }\n  }\n\n  const {value} = await prompt({\n    type: 'text',\n    name: 'value',\n    message: question,\n    initial,\n    validate: (v: string) => v.length > 0,\n  });\n  if (typeof value !== 'string') {\n    throw new Error(`${question} is required`);\n  }\n  if (!VALID_PROJECT_NAME.test(value)) {\n    throw new Error(`Invalid project name \"${value}\". Allowed characters are a-z, A-Z, 0-9 and _`);\n  }\n  if (takenNames.includes(value)) {\n    throw new Error(`${value} is taken`);\n  }\n  return value as ProjectName;\n}\n\ninitProject().catch(console.error);\n"],"names":["exec","promises","dirname","join","format","access","readFile","readdir","stat","writeFile","mkdir","rm","writeJsonFile","path","json","writeRawFile","JSON","stringify","undefined","prettierConfig","parser","printWidth","singleQuote","trailingComma","bracketSpacing","arrowParens","endOfLine","prettierFormat","str","writePrettyFile","code","writeJsFile","js","writeTsFile","ts","content","recursive","rmDir","dirPath","force","cleanDir","cp","from","to","Promise","resolve","reject","err","exists","maybeReadFile","fileContent","toString","listFiles","files","ents","withFileTypes","ent","entPath","name","isDirectory","push","then","subFiles","isFile","all","ProjectType","EslintType","TsConfigType","WebpackType","PROJECT_TYPE_TO_METADATA","Web","eslint","tsconfig","webpack","LambdaFunction","Node","Lambda","LambdaApi","NodeScript","Shared","Lib","SharedNode","WorkspaceFragmentType","validateRegistry","execSync","relative","fileURLToPath","generateProject","generateGitIgnore","generateWorkspacePackageJson","generateCommonTerraform","generateDummyTerraformCredentials","generateWorkspaceProjectTerraform","generateDynamoTerraform","generateCodeWorkspace","neverHappens","getProjectsFromWorkspaceFragment","fragment","allFragments","type","StaticWebsite","projectName","websiteName","vars","__PROJECT_NAME__","StandaloneLambda","lambdaName","WebApp","__BACKEND_NAME__","__BACKEND_NAME_UPPERCASE__","toUpperCase","__FRONTEND_NAME__","__FRONTEND_NAME_UPPERCASE__","scriptName","otherVars","f","generateWorkspace","dst","workspaceName","workspaceFragments","alreadyGenerated","projects","flatMap","filter","p","includes","map","project","SCRIPTS_PATH","import","meta","url","terraformPath","userTable","tableName","console","log","commands","stdio","process","cwd","TEMPLATES_PATH","packageJsonPath","packageJsonbuffer","packageJson","parse","file","buffer","newContent","varName","varValue","Object","entries","replaceAll","endsWith","trim","PACKAGE_VERSIONS","TYPESCRIPT_VERSION","uniq","val","Set","values","eslintRuntimes","tsconfigRuntimes","webpackRuntimes","license","engines","node","scripts","setup","deploy","build","watch","eslintConfig","ignorePatterns","prettier","devDependencies","fromEntries","runtime","runner","sort","d1","d2","localeCompare","ESLINT_VERSION","PRETTIER_VERSION","LIB_VERSIONS","react","generateCloudfrontDistributionTerraform","generateLambdaTerraform","generateAwsProviderTerraform","generateS3BucketTerraform","api","bucketName","toLowerCase","replace","originId","opts","webProjectNames","CODE_BUCKET","CLOUDFRONT_ACCESS","out","length","value","msg","Error","notUndefined","removeUndefined","arr","toPascal","split","_str$","slice","toSnake","namePascal","nameSnake","tableUpper","projectNames","folders","settings","reportUnusedDisableDirectives","extensions","recommendations","readWorkspaceFragments","workspacePath","workspaceContent","workspaceJson","workspaceProjects","Array","isArray","basename","prompt","cancel","exit","initProject","frags","takenNames","newWorkspaceName","message","validate","v","frag","askForWorkspaceFragment","error","String","WorkspaceFragmentTypeToString","DONE_GENERATING","workspaceFragmentType","choices","title","askForProjectName","VALID_PROJECT_NAME","question","defaultValue","initial","index","test","catch"],"sourceRoot":""}