{"version":3,"file":"index.js","mappings":"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;AACA;AACA,0CACI/D,MAAM,GACF;AACR,4BAA4BA,MAAM,CAAC2D,SAAS,IAAI3D,MAAM,CAACyD,UAAU,IAAI,GAC7D,EAAE;AACV;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCACgC0P,QAAQ;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBACInT,MAAM,GACF;AACR,qDAAqD+D,WAAW;AAChE;AACA,8CAA8C,GACtC;AACR,0CAA0C;AAC1C;AACA;AACA,GACG,CAACsL,IAAI,CAAC,CAAC;AACV;;;;;;;;;;;AClK4C;AAYrC,SAASwD,uBAAuBA,CACrCzU,aAA4B,EAC5B2F,WAAwB,EACxBmG,IAAqC,EAC7B;EACR,MAAM;IAACvF,GAAG;IAAEC,UAAU;IAAEC,UAAU;IAAEC,wBAAwB;IAAE9E,MAAM;IAAE+E;EAAc,CAAC,GAAGmF,IAAI;EAC5F,OAAO;AACT;AACA,kCAAkCnG,WAAW;AAC7C,IACIgB,cAAc,EAAE5E,OAAO,GACnB;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBACMyE,UAAU,KAAKlF,SAAS,GACpB,EAAE,GACF;AACV,+BAA+BsC,4DAAS,CAAC4C,UAAU,CAAC;AACpD,+BAA+B5C,4DAAS,CAAC4C,UAAU,CAAC;AACpD,+BAA+B5C,4DAAS,CAAC4C,UAAU,CAAC;AACpD,+BAA+B5C,4DAAS,CAAC4C,UAAU,CAAC;AACpD,KAAK;AACL,IACI,GACI,EAAE,GAENA,UAAU,KAAKlF,SAAS,GACpB;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI,GACI,EAAE;AACV;AACA;AACA,kCACkCqE,WAAW;AAC7C,qBAAqB3F,aAAa,IAAI2F,WAAW;AACjD,kCAAkCA,WAAW;AAC7C,kCAAkCA,WAAW;AAC7C;AACA;AACA,iCAAiCA,WAAW;AAC5C;AACA;AACA;AACA,mBACMY,GAAG,GACC;AACV;AACA,gDAAgDZ,WAAW;AAC3D,gDAAgDA,WAAW,iCAAiC,GAClF;AACV,4CAA4C;AAC5C;AACA;AACA;AACA;AACA,UACUA,WAAW;AACrB,sCAAsCA,WAAW;AACjD,2CAA2C3F,aAAa,IAAI2F,WAAW;AACvE;AACA,EACEY,GAAG,GACC;AACN;AACA;AACA,sCAAsCZ,WAAW;AACjD,6CAA6CA,WAAW;AACxD;AACA;AACA;AACA,UAAUA,WAAW;AACrB,mBACI/D,MAAM,GACF,WAAWA,MAAM,CAAC2D,SAAS,IAAI3D,MAAM,CAACyD,UAAU,GAAG,GACnD,0CAA0CM,WAAW,gBAAgB;AAC7E,6BAC6BA,WAAW;AACxC,GACQ/D,MAAM,KAAKN,SAAS,GAChB;AACZ;AACA;AACA;AACA,2BAA2BqE,WAAW;AACtC,YAAY/D,MAAM,CAACyD,UAAU;AAC7B;AACA;AACA,iCAAiCM,WAAW;AAC5C,oCAAoCA,WAAW;AAC/C,eAAe/D,MAAM,CAAC2D,SAAS,IAAI3D,MAAM,CAACyD,UAAU;AACpD;AACA;AACA;AACA,2DAA2DM,WAAW;AACtE,2DAA2DA,WAAW;AACtE;AACA;AACA;AACA;AACA,iCAAiCA,WAAW;AAC5C,oCAAoCA,WAAW;AAC/C,eAAe/D,MAAM,CAAC2D,SAAS,IAAI3D,MAAM,CAACyD,UAAU;AACpD;AACA;AACA;AACA,2DAA2DM,WAAW;AACtE,2DAA2DA,WAAW;AACtE;AACA;AACA;AACA;AACA,kCAAkCA,WAAW;AAC7C,mCAAmC/D,MAAM,CAAC2D,SAAS,IAAI3D,MAAM,CAACyD,UAAU;AACxE,kCAAkCzD,MAAM,CAAC2D,SAAS,IAAI3D,MAAM,CAACyD,UAAU;AACvE;AACA;AACA;AACA;AACA,iCAAiCM,WAAW;AAC5C;AACA,qCAAqCA,WAAW;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4CAA4CA,WAAW;AACvD;AACA;AACA,6CAA6CA,WAAW;AACxD;AACA,kDAAkDA,WAAW;AAC7D,gEAAgEA,WAAW;AAC3E,EAAE,GACU,EAAE;AACd;AACA;AACA;AACA,4BAC4BA,WAAW;AACvC;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4BA,WAAW;AACvC;AACA;AACA;AACA;AACA,0CAA0CA,WAAW;AACrD;AACA;AACA,4DAA4DA,WAAW;AACvE,wCAAwCA,WAAW;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8BA,WAAW;AACzC,8BAA8BA,WAAW;AACzC;AACA;AACA;AACA;AACA;AACA;AACA,0CACI/D,MAAM,GACF;AACR,4BAA4BA,MAAM,CAAC2D,SAAS,IAAI3D,MAAM,CAACyD,UAAU,IAAI,GAC7D,EAAE;AACV;AACA;AACA;AACA;AACA;AACA,mDACmDM,WAAW;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBACI/D,MAAM,GACF;AACR,qDAAqD+D,WAAW;AAChE;AACA,8CAA8C,GACtC;AACR,0CAA0C;AAC1C;AACA,EACE,GACI,EAAE;AACR,EAEEe,wBAAwB,KAAKpF,SAAS,GAClC;AACN;AACA,sDAAsDqE,WAAW;AACjE;AACA;AACA,wCAAwCA,WAAW;AACnD;AACA,8CAA8CA,WAAW;AACzD;AACA;AACA,wCAAwCA,WAAW;AACnD,2BAA2BA,WAAW,SAASe,wBAAwB;AACvE,gCAAgCA,wBAAwB,UACpDA,wBAAwB,GAAG,CAAC,GAAG,GAAG,GAAG,EAAE;AAC3C;AACA;AACA,0CAC0Cf,WAAW;AACrD,qCAAqCA,WAAW;AAChD,+BAA+BA,WAAW;AAC1C;AACA,CAAC,GACK,EAAE;AACR;AACA;AACA,2BAC2BA,WAAW;AACtC,YAAY3F,aAAa,IAAI2F,WAAW;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB3F,aAAa,IAAI2F,WAAW;AAC5C,4CAA4CA,WAAW;AACvD;AACA;AACA;AACA,UAAUA,WAAW;AACrB,yBAAyBA,WAAW;AACpC;AACA;AACA;AACA;AACA,uCAAuCA,WAAW;AAClD,wBAAwB3F,aAAa,IAAI2F,WAAW;AACpD;AACA;AACA,6BAA6BA,WAAW;AACxC,YAAY3F,aAAa,IAAI2F,WAAW;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyCA,WAAW;AACpD,yCAAyCA,WAAW;AACpD;AACA;AACA;AACA;AACA;AACA;AACA,6CAA6CA,WAAW;AACxD,8BAA8BA,WAAW;AACzC,gCAAgCA,WAAW;AAC3C;AACA,EACEc,UAAU,KAAKnF,SAAS,GACpB;AACN;AACA;AACA,+CAA+CqE,WAAW;AAC1D,sBAAsB3F,aAAa,IAAI2F,WAAW;AAClD;AACA,8CAA8CA,WAAW;AACzD;AACA;AACA,uBAAuB3F,aAAa,IAAI2F,WAAW;AACnD,uBAAuB3F,aAAa;AACpC;AACA;AACA;AACA;AACA;AACA;AACA,0CAA0C2F,WAAW;AACrD,2BAA2B3F,aAAa,IAAI2F,WAAW;AACvD,2DAA2DA,WAAW;AACtE,2DAA2DA,WAAW;AACtE;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyCA,WAAW;AACpD,yCAAyCA,WAAW;AACpD;AACA;AACA;AACA,4BAA4BA,WAAW;AACvC,YAAY3F,aAAa,IAAI2F,WAAW;AACxC;AACA;AACA,yCAAyCA,WAAW;AACpD,iBAAiBc,UAAU;AAC3B;AACA,8BAA8Bd,WAAW;AACzC;AACA,CAAC,GACK,EAAE;AACR;AACA,4BAC4BA,WAAW;AACvC;AACA,sBAAsBA,WAAW;AACjC;AACA;AACA;AACA,CAAC,CAACsL,IAAI,CAAC,CAAC;AACR;;;;;;;;;;AChYO,SAASyD,4BAA4BA,CAC1C1U,aAA4B,EAC5B8L,IAAsB,EACd;EACR,MAAM;IAAC8I;EAAM,CAAC,GAAG9I,IAAI;EACrB,OAAO;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC8I,MAAM;AACtC;AACA;AACA,mBAAmB5U,aAAa;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmBA,aAAa;AAChC;AACA;AACA;AACA;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","sources":["webpack://b/external node-commonjs \"node:fs/promises\"","webpack://b/external node-commonjs \"node:path\"","webpack://b/./src/logger.ts","webpack://b/./src/models.ts","webpack://b/./src/project/ask_for_common.ts","webpack://b/external node-commonjs \"prompts\"","webpack://b/./src/project/generate_workspace.ts","webpack://b/external node-commonjs \"node:child_process\"","webpack://b/external node-commonjs \"node:url\"","webpack://b/./src/fs.ts","webpack://b/external node-commonjs \"node:fs\"","webpack://b/external node-commonjs \"prettier\"","webpack://b/./src/hash.ts","webpack://b/external node-commonjs \"node:crypto\"","webpack://b/./src/project/generate_project.ts","webpack://b/./src/project/dynamic_template.ts","webpack://b/./src/string_utils.ts","webpack://b/./src/rand_safe.ts","webpack://b/./src/project/gitignore.ts","webpack://b/./src/project/package_json.ts","webpack://b/./src/versions.ts","webpack://b/./src/project/terraform/all.ts","webpack://b/./src/project/terraform/frontend.ts","webpack://b/./src/project/terraform/lambda.ts","webpack://b/./src/project/terraform/provider.ts","webpack://b/./src/project/terraform/s3.ts","webpack://b/./src/type_utils.ts","webpack://b/./src/project/terraform/dynamo_user.ts","webpack://b/./src/project/terraform/dynamo_user_session.ts","webpack://b/./src/project/vscode_workspace.ts","webpack://b/./src/project/ask_for_workspace_fragments.ts","webpack://b/./src/project/ask_for_new_workspace_fragment.ts","webpack://b/./src/project/ask_for_workspace_update.ts","webpack://b/webpack/bootstrap","webpack://b/webpack/runtime/compat get default export","webpack://b/webpack/runtime/define property getters","webpack://b/webpack/runtime/hasOwnProperty shorthand","webpack://b/webpack/runtime/make namespace object","webpack://b/./src/project/init_project.ts"],"sourcesContent":["module.exports = __WEBPACK_EXTERNAL_createRequire(import.meta.url)(\"node:fs/promises\");","module.exports = __WEBPACK_EXTERNAL_createRequire(import.meta.url)(\"node:path\");","export const error: (message?: unknown, ...optionalParams: unknown[]) => void = console.error;\nexport const log: (message?: unknown, ...optionalParams: unknown[]) => void = console.log;\n","import {Brand} from '@src/type_utils';\n\nexport type WorkspaceName = Brand<string, 'WorkspaceName'>;\nexport type ProjectName = Brand<string, 'ProjectName'>;\n\n//\n// Project type\n//\n\nexport enum ProjectType {\n  Web = 'web',\n  LambdaFunction = 'lambda_function',\n  LambdaApi = 'lambda_api',\n  LambdaWebApi = 'lambda_web_api',\n  NodeScript = 'node_script',\n  Shared = 'shared',\n  SharedNode = 'shared-node',\n  SharedWeb = 'shared-web',\n}\n\nexport enum EslintType {\n  Web = 'web',\n  Node = 'node',\n  Lib = 'lib',\n}\n\nexport enum TsConfigType {\n  Web = 'web',\n  Node = 'node',\n  Lib = 'lib',\n}\nexport enum WebpackType {\n  Web = 'web',\n  Lib = 'lib', // shared\n  Lambda = 'lambda',\n  NodeScript = 'node-script',\n}\n\nexport interface ProjectTypeMetadata {\n  eslint: EslintType;\n  tsconfig: TsConfigType;\n  webpack?: WebpackType;\n}\n\nexport const PROJECT_TYPE_TO_METADATA = {\n  [ProjectType.Web]: {\n    eslint: EslintType.Web,\n    tsconfig: TsConfigType.Web,\n    webpack: WebpackType.Web,\n  },\n  [ProjectType.LambdaFunction]: {\n    eslint: EslintType.Node,\n    tsconfig: TsConfigType.Node,\n    webpack: WebpackType.Lambda,\n  },\n  [ProjectType.LambdaApi]: {\n    eslint: EslintType.Node,\n    tsconfig: TsConfigType.Node,\n    webpack: WebpackType.Lambda,\n  },\n  [ProjectType.LambdaWebApi]: {\n    eslint: EslintType.Node,\n    tsconfig: TsConfigType.Node,\n    webpack: WebpackType.Lambda,\n  },\n  [ProjectType.NodeScript]: {\n    eslint: EslintType.Node,\n    tsconfig: TsConfigType.Node,\n    webpack: WebpackType.NodeScript,\n  },\n  [ProjectType.Shared]: {\n    eslint: EslintType.Lib,\n    tsconfig: TsConfigType.Lib,\n    webpack: WebpackType.Lib,\n  },\n  [ProjectType.SharedNode]: {\n    eslint: EslintType.Node,\n    tsconfig: TsConfigType.Node,\n    webpack: WebpackType.Lib,\n  },\n  [ProjectType.SharedWeb]: {\n    eslint: EslintType.Web,\n    tsconfig: TsConfigType.Web,\n    webpack: WebpackType.Lib,\n  },\n} satisfies Record<ProjectType, ProjectTypeMetadata>;\n\n//\n// Workspace Fragment type\n//\n\nexport enum WorkspaceFragmentType {\n  StaticWebsite = 'static-website',\n  StandaloneLambda = 'standalone-lambda',\n  ApiLambda = 'api-lambda',\n  WebApp = 'web-app',\n  NodeScript = 'node-script',\n  Shared = 'shared',\n  SharedNode = 'shared-node',\n  SharedWeb = 'shared-web',\n}\n\ninterface WorkspaceFragmentBase {\n  type: WorkspaceFragmentType;\n}\n\nexport interface WebAppAuthentication {\n  enabled: boolean;\n}\n\nexport interface WorkspaceFragmentRegistry {\n  [WorkspaceFragmentType.StaticWebsite]: {\n    type: WorkspaceFragmentType.StaticWebsite;\n    websiteName: ProjectName;\n    domain: string | undefined;\n  };\n  [WorkspaceFragmentType.StandaloneLambda]: {\n    type: WorkspaceFragmentType.StandaloneLambda;\n    lambdaName: ProjectName;\n    alarmEmail: string | undefined;\n    cloudwatchTriggerMinutes: number | undefined;\n  };\n  [WorkspaceFragmentType.ApiLambda]: {\n    type: WorkspaceFragmentType.ApiLambda;\n    apiName: ProjectName;\n    alarmEmail: string | undefined;\n    domain: string | undefined;\n  };\n  [WorkspaceFragmentType.WebApp]: {\n    type: WorkspaceFragmentType.WebApp;\n    appName: string;\n    alarmEmail: string | undefined;\n    domain: string | undefined;\n    authentication: WebAppAuthentication;\n  };\n  [WorkspaceFragmentType.NodeScript]: {\n    type: WorkspaceFragmentType.NodeScript;\n    scriptName: ProjectName;\n  };\n  [WorkspaceFragmentType.Shared]: {\n    type: WorkspaceFragmentType.Shared;\n  };\n  [WorkspaceFragmentType.SharedNode]: {\n    type: WorkspaceFragmentType.SharedNode;\n  };\n  [WorkspaceFragmentType.SharedWeb]: {\n    type: WorkspaceFragmentType.SharedWeb;\n  };\n}\n\ntype RegistryIsValid =\n  WorkspaceFragmentRegistry extends Record<WorkspaceFragmentType, WorkspaceFragmentBase>\n    ? boolean\n    : never;\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nfunction validateRegistry(): RegistryIsValid {\n  return true;\n}\n\nexport function filterFragments<T extends WorkspaceFragmentType>(\n  frags: WorkspaceFragment[],\n  type: T\n): WorkspaceFragmentRegistry[T][] {\n  return frags.filter(frag => frag.type === type) as WorkspaceFragmentRegistry[T][];\n}\n\nexport type WorkspaceFragment = WorkspaceFragmentRegistry[keyof WorkspaceFragmentRegistry];\n","import {prompt} from 'prompts';\n\nimport {ProjectName, WebAppAuthentication} from '@src/models';\nimport {DEFAULT_REGION} from '@src/project/generate_workspace';\nimport {asStringOrThrow} from '@src/type_utils';\n\n//\n// WORKSPACE NAME\n//\n\nexport async function askForWorkspaceName(): Promise<string> {\n  const {workspaceName} = await prompt({\n    type: 'text',\n    name: 'workspaceName',\n    message: 'Workspace name',\n    validate: (v: string) => v.length > 0,\n  });\n  return asStringOrThrow(workspaceName);\n}\n\n//\n// WORKSPACE REGION\n//\n\nexport async function askForWorkspaceRegion(): Promise<string> {\n  const {workspaceRegion} = await prompt({\n    type: 'text',\n    name: 'workspaceRegion',\n    message: 'AWS Region',\n    initial: DEFAULT_REGION,\n    validate: (v: string) => v.length > 0,\n  });\n  return asStringOrThrow(workspaceRegion);\n}\n\n//\n// PROJECT NAME\n//\n\nconst VALID_PROJECT_NAME = /^[a-zA-Z0-9_]+$/u;\n\nexport async function askForProjectName(\n  question: string,\n  defaultValue: string,\n  takenNames: string[]\n): Promise<ProjectName> {\n  let initial = defaultValue;\n  if (takenNames.includes(initial)) {\n    let index = 2;\n    while (takenNames.includes(initial)) {\n      initial = `${defaultValue}_${index}`;\n      index++;\n    }\n  }\n\n  const {value} = await prompt({\n    type: 'text',\n    name: 'value',\n    message: question,\n    initial,\n    validate: (v: string) => v.length > 0,\n  });\n  if (typeof value !== 'string') {\n    throw new Error(`${question} is required`);\n  }\n  if (!VALID_PROJECT_NAME.test(value)) {\n    throw new Error(`Invalid project name \"${value}\". Allowed characters are a-z, A-Z, 0-9 and _`);\n  }\n  if (takenNames.includes(value)) {\n    throw new Error(`${value} is taken`);\n  }\n  return value as ProjectName;\n}\n\n//\n// ALARM EMAIL\n//\n\nexport async function askForAlarmEmail(defaultVal: boolean): Promise<string | undefined> {\n  const alarm = await prompt({\n    type: 'confirm',\n    name: 'value',\n    message: 'Add an alarm when an error is logged?',\n    initial: defaultVal,\n  });\n  if (alarm.value !== true) {\n    return undefined;\n  }\n  const email = await prompt({\n    type: 'text',\n    name: 'value',\n    message: 'Which email to send the alarm to?',\n  });\n  if (typeof email.value !== 'string') {\n    return undefined;\n  }\n  return email.value;\n}\n\nexport async function askForAlarmEmailValue(): Promise<string | undefined> {\n  const email = await prompt({\n    type: 'text',\n    name: 'value',\n    message: 'Enter the email the alarm will be sent to (leave empty for no alarm).',\n  });\n  if (typeof email.value !== 'string') {\n    return undefined;\n  }\n  return email.value;\n}\n\n//\n// DOMAIN NAME\n//\n\nexport async function askForDomainName(): Promise<string | undefined> {\n  const useDomain = await prompt({\n    type: 'confirm',\n    name: 'value',\n    message: 'Use a custom domain?',\n  });\n  if (useDomain.value !== true) {\n    return undefined;\n  }\n  return await askForDomainNameValue();\n}\n\nexport async function askForDomainNameValue(): Promise<string | undefined> {\n  const domain = await prompt({\n    type: 'text',\n    name: 'value',\n    message: 'Enter the domain name (leave empty for no domain).',\n  });\n  if (typeof domain.value !== 'string' || domain.value.length === 0) {\n    return undefined;\n  }\n  return domain.value;\n}\n\n//\n// AUTHENTICATION\n//\n\nexport async function askForAuthentication(): Promise<WebAppAuthentication> {\n  const authenticationEnabled = await prompt({\n    type: 'confirm',\n    name: 'value',\n    message: 'Use authentication?',\n  });\n  return {enabled: authenticationEnabled.value === true};\n}\n\n//\n// CLOUDWATCH TRIGGER\n//\n\nexport async function askForCloudwatchTrigger(): Promise<number | undefined> {\n  const trigger = await prompt({\n    type: 'confirm',\n    name: 'value',\n    message: 'Add a Cloudwatch trigger?',\n    initial: true,\n  });\n  if (trigger.value !== true) {\n    return undefined;\n  }\n  return await askForCloudwatchTriggerValue();\n}\n\nexport async function askForCloudwatchTriggerValue(): Promise<number | undefined> {\n  const minutes = await prompt({\n    type: 'text',\n    name: 'value',\n    message: 'Enter the trigger period in minutes (leave empty for no trigger)',\n    initial: 1,\n  });\n  // eslint-disable-next-line @typescript-eslint/no-unsafe-argument\n  const minutesValue = parseFloat(minutes.value);\n  if (Number.isNaN(minutesValue) || minutesValue <= 0) {\n    return undefined;\n  }\n  return minutesValue;\n}\n","module.exports = __WEBPACK_EXTERNAL_createRequire(import.meta.url)(\"prompts\");","import {execSync} from 'node:child_process';\nimport {join, relative} from 'node:path';\nimport {fileURLToPath} from 'node:url';\n\nimport {listFiles, prettyJs, prettyJson, prettyJsonc, readFile, writeRawFile} from '@src/fs';\nimport {md5} from '@src/hash';\nimport {log} from '@src/logger';\nimport {\n  ProjectName,\n  ProjectType,\n  WorkspaceFragment,\n  WorkspaceFragmentType,\n  WorkspaceName,\n} from '@src/models';\nimport {generateProject} from '@src/project/generate_project';\nimport {generateGitIgnore} from '@src/project/gitignore';\nimport {generateWorkspacePackageJson} from '@src/project/package_json';\nimport {\n  AppDomain,\n  generateCommonTerraform,\n  generateWorkspaceProjectTerraform,\n} from '@src/project/terraform/all';\nimport {generateDynamoUserTerraform} from '@src/project/terraform/dynamo_user';\nimport {generateDynamoUserSessionTerraform} from '@src/project/terraform/dynamo_user_session';\nimport {WorkspaceProjectTerraformFrontend} from '@src/project/terraform/frontend';\nimport {WorkspaceProjectTerraformLambda} from '@src/project/terraform/lambda';\nimport {\n  FileHash,\n  generateCodeWorkspace,\n  Workspace,\n  WorkspaceOptions,\n  writeWorkspace,\n} from '@src/project/vscode_workspace';\nimport {lowerCase, pascalCase} from '@src/string_utils';\nimport {neverHappens, removeUndefined} from '@src/type_utils';\nimport {PACKAGE_VERSIONS} from '@src/versions';\n\nexport const DEFAULT_REGION = 'eu-west-3';\nconst TEMPLATES_PATH = join(fileURLToPath(import.meta.url), '../templates');\n\ntype Flag = Record<string, string>;\nconst booleanFlag = (bool: boolean): string => (bool ? 'true' : 'false');\n\nexport function hasApi(allFragments: WorkspaceFragment[]): boolean {\n  return (\n    allFragments.find(\n      f => f.type === WorkspaceFragmentType.ApiLambda || f.type === WorkspaceFragmentType.WebApp\n    ) !== undefined\n  );\n}\n\nexport type WorkspaceProjectTerraform =\n  | WorkspaceProjectTerraformLambda\n  | WorkspaceProjectTerraformFrontend\n  | {type: 'no-terraform'};\n\nexport interface WorkspaceProject {\n  projectName: ProjectName;\n  type: ProjectType;\n  fromFragment: WorkspaceFragment;\n  vars: Record<string, string>;\n  flags: (allFragments: WorkspaceFragment[]) => Flag;\n  terraform: WorkspaceProjectTerraform;\n}\n\nfunction fragmentFlags(baseFlags: Flag): (allFragments: WorkspaceFragment[]) => Flag {\n  return (allFragments: WorkspaceFragment[]): Flag => {\n    const workspaceFlags: Flag = {\n      HAS_API: booleanFlag(hasApi(allFragments)),\n    };\n    return {...workspaceFlags, ...baseFlags};\n  };\n}\n\n// Parse a string into its domain/subdomain.\n// We assume the root domain (the hosted zone registered in AWS)\n// is the in form of <second-level-domain>.<first-level-domain> (eg: \"matthis.link\")\nfunction parseDomain(domainStr?: string): AppDomain | undefined {\n  if (domainStr === undefined) {\n    return undefined;\n  }\n  const parts = domainStr.split('.');\n  const rootDomain = parts.slice(-2).join('.'); // eslint-disable-line @typescript-eslint/no-magic-numbers\n  const subDomain = parts.slice(0, -2).join('.'); // eslint-disable-line @typescript-eslint/no-magic-numbers\n  return {subDomain, rootDomain};\n}\n\nexport function getProjectsFromWorkspaceFragment(fragment: WorkspaceFragment): WorkspaceProject[] {\n  if (fragment.type === WorkspaceFragmentType.StaticWebsite) {\n    return [\n      {\n        projectName: fragment.websiteName,\n        type: ProjectType.Web,\n        fromFragment: fragment,\n        vars: {\n          __PROJECT_NAME__: fragment.websiteName,\n          __APP_NAME__: fragment.websiteName,\n        },\n        flags: fragmentFlags({}),\n        terraform: {\n          type: 'frontend',\n          domain: parseDomain(fragment.domain),\n        },\n      },\n    ];\n  } else if (fragment.type === WorkspaceFragmentType.StandaloneLambda) {\n    return [\n      {\n        projectName: fragment.lambdaName,\n        type: ProjectType.LambdaFunction,\n        fromFragment: fragment,\n        vars: {\n          __PROJECT_NAME__: fragment.lambdaName,\n          __PROJECT_NAME_UPPERCASE__: fragment.lambdaName.toUpperCase(),\n        },\n        flags: fragmentFlags({}),\n        terraform: {\n          type: 'lambda',\n          api: false,\n          webAppName: undefined,\n          alarmEmail: fragment.alarmEmail,\n          cloudwatchTriggerMinutes: fragment.cloudwatchTriggerMinutes,\n          domain: undefined,\n          authentication: undefined,\n        },\n      },\n    ];\n  } else if (fragment.type === WorkspaceFragmentType.ApiLambda) {\n    return [\n      {\n        projectName: fragment.apiName,\n        type: ProjectType.LambdaApi,\n        fromFragment: fragment,\n        vars: {\n          __PROJECT_NAME__: fragment.apiName,\n          __PROJECT_NAME_UPPERCASE__: fragment.apiName.toUpperCase(),\n        },\n        flags: fragmentFlags({}),\n        terraform: {\n          type: 'lambda',\n          api: true,\n          webAppName: undefined,\n          alarmEmail: fragment.alarmEmail,\n          cloudwatchTriggerMinutes: undefined,\n          domain: parseDomain(fragment.domain),\n          authentication: undefined,\n        },\n      },\n    ];\n  } else if (fragment.type === WorkspaceFragmentType.WebApp) {\n    const backendName = `${fragment.appName}_backend` as ProjectName;\n    const frontendName = `${fragment.appName}_frontend` as ProjectName;\n    const vars = {\n      __APP_NAME__: fragment.appName,\n      __APP_NAME_UPPERCASE__: fragment.appName.toUpperCase(),\n      __APP_NAME_PASCALCASE__: pascalCase(fragment.appName),\n    };\n    const flags = fragmentFlags({\n      AUTHENTICATION: booleanFlag(fragment.authentication.enabled),\n    });\n    return [\n      {\n        projectName: frontendName,\n        type: ProjectType.Web,\n        fromFragment: fragment,\n        vars,\n        flags,\n        terraform: {\n          type: 'frontend',\n          domain:\n            fragment.domain === undefined ? undefined : parseDomain(`static.${fragment.domain}`),\n        },\n      },\n      {\n        projectName: backendName,\n        type: ProjectType.LambdaWebApi,\n        fromFragment: fragment,\n        vars,\n        flags,\n        terraform: {\n          type: 'lambda',\n          api: true,\n          webAppName: fragment.appName,\n          alarmEmail: fragment.alarmEmail,\n          cloudwatchTriggerMinutes: undefined,\n          domain: parseDomain(fragment.domain),\n          authentication: fragment.authentication,\n        },\n      },\n    ];\n  } else if (fragment.type === WorkspaceFragmentType.NodeScript) {\n    return [\n      {\n        projectName: fragment.scriptName,\n        type: ProjectType.NodeScript,\n        fromFragment: fragment,\n        vars: {\n          __PROJECT_NAME__: fragment.scriptName,\n        },\n        flags: fragmentFlags({}),\n        terraform: {\n          type: 'no-terraform',\n        },\n      },\n    ];\n  } else if (fragment.type === WorkspaceFragmentType.SharedNode) {\n    const projectName = 'shared-node' as ProjectName;\n    return [\n      {\n        projectName,\n        type: ProjectType.SharedNode,\n        fromFragment: fragment,\n        vars: {\n          __PROJECT_NAME__: projectName,\n        },\n        flags: fragmentFlags({}),\n        terraform: {\n          type: 'no-terraform',\n        },\n      },\n    ];\n  } else if (fragment.type === WorkspaceFragmentType.SharedWeb) {\n    const projectName = 'shared-web' as ProjectName;\n    return [\n      {\n        projectName,\n        type: ProjectType.SharedWeb,\n        fromFragment: fragment,\n        vars: {\n          __PROJECT_NAME__: projectName,\n        },\n        flags: fragmentFlags({}),\n        terraform: {\n          type: 'no-terraform',\n        },\n      },\n    ];\n    // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n  } else if (fragment.type === WorkspaceFragmentType.Shared) {\n    const projectName = 'shared' as ProjectName;\n    return [\n      {\n        projectName,\n        type: ProjectType.Shared,\n        fromFragment: fragment,\n        vars: {\n          __PROJECT_NAME__: projectName,\n        },\n        flags: fragmentFlags({}),\n        terraform: {\n          type: 'no-terraform',\n        },\n      },\n    ];\n  }\n  neverHappens(fragment, `Unknown ProjectType ${(fragment as WorkspaceFragment).type}`);\n}\n\nexport async function generateWorkspace(\n  dst: string,\n  workspaceName: WorkspaceName,\n  workspaceFragments: WorkspaceFragment[],\n  workspaceOptions: WorkspaceOptions,\n  workspace: Workspace | undefined\n): Promise<void> {\n  const projects = workspaceFragments.flatMap(f => getProjectsFromWorkspaceFragment(f));\n\n  // Create projects files from templates\n  const projectFiles = await Promise.all(\n    projects.map(\n      async project =>\n        await generateProject({\n          dst,\n          project,\n          allFragments: workspaceFragments,\n          workspace,\n          workspaceName,\n        })\n    )\n  );\n\n  // Generate workspace root files\n  const SCRIPTS_PATH = join(fileURLToPath(import.meta.url), '../scripts');\n  const writeFile = async (path: string, file: string): Promise<FileHash> =>\n    await writeWorkspaceFile(workspace, dst, path, file);\n  const workspaceFiles = await Promise.all([\n    // package.json\n    writeFile(\n      'package.json',\n      await prettyJson(generateWorkspacePackageJson(workspaceName, projects))\n    ),\n    // app.code-workspace\n    writeFile(\n      'app.code-workspace',\n      await prettyJsonc(generateCodeWorkspace(workspaceName, workspaceFragments))\n    ),\n    // .gitignore\n    writeFile('.gitignore', generateGitIgnore()),\n    // setup.js\n    writeFile('setup.js', await prettyJs(await readFile(join(SCRIPTS_PATH, 'setup.js')))),\n    // deploy.js\n    writeFile(\n      'deploy.js',\n      await prettyJs(\n        await readFile(join(SCRIPTS_PATH, 'deploy.js')).then(res =>\n          res.replaceAll('__WORKSPACE_NAME__', workspaceName)\n        )\n      )\n    ),\n    // build.js\n    writeFile('build.js', await prettyJs(await readFile(join(SCRIPTS_PATH, 'build.js')))),\n  ]);\n\n  // Vscode folder\n  const vscodePath = join(TEMPLATES_PATH, '.vscode');\n  const vscodeFileList = await listFiles(vscodePath);\n  const vscodeFiles = await Promise.all(\n    vscodeFileList.map(async file => {\n      const relativePath = relative(vscodePath, file);\n      const dstPath = join('.vscode', relativePath);\n      const content = await readFile(file);\n      return await writeFile(dstPath, content);\n    })\n  );\n\n  // Terraform folder generation\n  const terraformFiles = await Promise.all([\n    ...workspaceFragments\n      .filter(frag => frag.type === WorkspaceFragmentType.WebApp)\n      .filter(frag => frag.authentication.enabled)\n      .flatMap(frag => {\n        return [\n          writeFile(\n            join('terraform', `dynamo_table_${lowerCase(frag.appName)}_user.tf`),\n            addLineBreak(generateDynamoUserTerraform(workspaceName, frag.appName))\n          ),\n          writeFile(\n            join('terraform', `dynamo_table_${lowerCase(frag.appName)}_user_session.tf`),\n            addLineBreak(generateDynamoUserSessionTerraform(workspaceName, frag.appName))\n          ),\n        ];\n      }),\n    writeFile(\n      join('terraform', 'base.tf'),\n      addLineBreak(generateCommonTerraform(workspaceName, projects, workspaceOptions))\n    ),\n    ...projects.map(async p => {\n      const content = generateWorkspaceProjectTerraform(workspaceName, p);\n      if (content === undefined) {\n        return;\n      }\n      const name = `${p.projectName}_terraform`;\n      return await writeFile(join('terraform', `${name}.tf`), addLineBreak(content));\n    }),\n  ]);\n\n  await writeWorkspace(dst, {\n    files: removeUndefined([\n      ...projectFiles.flat(),\n      ...workspaceFiles,\n      ...terraformFiles,\n      ...vscodeFiles,\n    ]),\n    fragments: workspaceFragments,\n    version: PACKAGE_VERSIONS.project,\n    options: workspaceOptions,\n  });\n\n  // Run setup.js\n  log('Running post install script');\n  const commands = [`cd ${dst}`, `node setup.js`, `git init`];\n  execSync(commands.join(' && '), {stdio: ['ignore', 'inherit', 'inherit']});\n\n  // Final instructions\n  log(`Run the following to get started:`);\n  log(`cd ${relative(process.cwd(), dst)}; code app.code-workspace; yarn watch`);\n}\n\nexport async function writeWorkspaceFile(\n  workspace: Workspace | undefined,\n  root: string,\n  path: string,\n  file: string\n): Promise<FileHash> {\n  const fileLines = file.split('\\n');\n  const fileToHash = fileLines.filter(line => !line.endsWith(' // @matthis/ignore')).join('\\n');\n  const newHash = md5(fileToHash);\n  const oldHash = workspace?.files.find(f => f.path === path)?.hash;\n  // Only write the file if it is different since last time we've generated the project.\n  // Prevent needlessly overwriting changes made in the project in between.\n  if (newHash !== oldHash) {\n    const fileToWrite = fileLines.map(l => l.replaceAll(' // @matthis/ignore', '')).join('\\n');\n    await writeRawFile(join(root, path), fileToWrite);\n  }\n  return {path, hash: newHash};\n}\n\nconst addLineBreak = (content: string): string =>\n  content.endsWith('\\n') ? content : `${content}\\n`;\n","module.exports = __WEBPACK_EXTERNAL_createRequire(import.meta.url)(\"node:child_process\");","module.exports = __WEBPACK_EXTERNAL_createRequire(import.meta.url)(\"node:url\");","import {exec} from 'node:child_process';\nimport {promises, readFileSync} from 'node:fs';\nimport {dirname, join} from 'node:path';\n\nimport {BuiltInParserName, format} from 'prettier';\n\nexport const {access, readFile: readFileInternal, readdir, stat} = promises;\nconst {writeFile, mkdir, rm} = promises;\n\nexport async function readFile(path: string): Promise<string> {\n  const buffer = await readFileInternal(path);\n  return buffer.toString();\n}\n\nconst prettierConfig = (parser: BuiltInParserName) =>\n  ({\n    parser,\n    printWidth: 100,\n    singleQuote: true,\n    trailingComma: 'es5',\n    bracketSpacing: false,\n    arrowParens: 'avoid',\n    endOfLine: 'auto',\n  }) as const;\n\nexport async function prettierFormat(str: string, parser: BuiltInParserName): Promise<string> {\n  return await format(str, prettierConfig(parser));\n}\n\nexport async function writeRawFile(path: string, content: string): Promise<void> {\n  await mkdir(dirname(path), {recursive: true});\n  await writeFile(path, content);\n}\n\nexport async function prettyJson(json: unknown, opts?: {compact?: boolean}): Promise<string> {\n  const {compact} = opts ?? {};\n  return await format(\n    compact ? JSON.stringify(json) : JSON.stringify(json, undefined, 2),\n    prettierConfig('json')\n  );\n}\nexport async function prettyJsonc(json: unknown, opts?: {compact?: boolean}): Promise<string> {\n  const {compact} = opts ?? {};\n  return await format(\n    compact ? JSON.stringify(json) : JSON.stringify(json, undefined, 2),\n    prettierConfig('jsonc')\n  );\n}\nexport async function writeJsonFile(path: string, json: unknown): Promise<void> {\n  await writeRawFile(path, await prettyJson(json));\n}\n\nexport async function prettyJs(js: string): Promise<string> {\n  return await format(js, prettierConfig('babel'));\n}\nexport async function writeJsFile(path: string, js: string): Promise<void> {\n  await writeRawFile(path, await prettyJs(js));\n}\n\nexport async function prettyTs(ts: string): Promise<string> {\n  return await format(ts, prettierConfig('typescript'));\n}\nexport async function writeTsFile(path: string, ts: string): Promise<void> {\n  await writeRawFile(path, await prettyTs(ts));\n}\n\nexport async function writeRawFileIfNotExists(path: string, content: string): Promise<void> {\n  if (await exists(path)) {\n    return;\n  }\n  await writeRawFile(path, content);\n}\n\nexport async function rmDir(dirPath: string): Promise<void> {\n  await rm(dirPath, {recursive: true, force: true});\n}\n\nexport async function cleanDir(dirPath: string): Promise<void> {\n  try {\n    await rmDir(dirPath);\n  } finally {\n    await mkdir(dirPath, {recursive: true});\n  }\n}\n\nexport async function cp(from: string, to: string): Promise<void> {\n  return await new Promise((resolve, reject) => {\n    exec(`cp -R ${from} ${to}`, err => (err ? reject(err) : resolve()));\n  });\n}\n\nexport async function exists(path: string): Promise<boolean> {\n  try {\n    await access(path);\n    return true;\n  } catch {\n    return false;\n  }\n}\n\nexport async function maybeReadFile(path: string): Promise<string | undefined> {\n  try {\n    const fileContent = await readFile(path);\n    return fileContent.toString();\n  } catch {\n    return undefined;\n  }\n}\n\nexport function maybeReadFileSync(path: string): string | undefined {\n  try {\n    const fileContent = readFileSync(path);\n    return fileContent.toString();\n  } catch {\n    return undefined;\n  }\n}\n\nexport async function listFiles(path: string): Promise<string[]> {\n  const files: string[] = [];\n  const ents = await readdir(path, {withFileTypes: true});\n  const promises: Promise<void>[] = [];\n  for (const ent of ents) {\n    const entPath = join(path, ent.name);\n    if (ent.isDirectory()) {\n      promises.push(\n        listFiles(entPath).then(subFiles => {\n          files.push(...subFiles);\n        })\n      );\n    } else if (ent.isFile()) {\n      files.push(entPath);\n    }\n  }\n  await Promise.all(promises);\n  return files;\n}\n","module.exports = __WEBPACK_EXTERNAL_createRequire(import.meta.url)(\"node:fs\");","module.exports = __WEBPACK_EXTERNAL_createRequire(import.meta.url)(\"prettier\");","import {createHash} from 'node:crypto';\n\nexport function md5(data: string | Buffer): string {\n  const content = typeof data === 'string' ? data : data.toString();\n  return createHash('md5').update(content).digest('hex');\n}\n\nexport function hashPassword(password: string, salt: string): string {\n  return createHash('sha256').update(`${password}${salt}`).digest('base64');\n}\n","module.exports = __WEBPACK_EXTERNAL_createRequire(import.meta.url)(\"node:crypto\");","import {join, relative} from 'node:path';\nimport {fileURLToPath} from 'node:url';\n\nimport {listFiles, prettierFormat, readFile} from '@src/fs';\nimport {ProjectType, WorkspaceFragment} from '@src/models';\nimport {generateSharedFiles} from '@src/project/dynamic_template';\nimport {WorkspaceProject, writeWorkspaceFile} from '@src/project/generate_workspace';\nimport {FileHash, Workspace} from '@src/project/vscode_workspace';\nimport {randomStringSafe} from '@src/rand_safe';\nimport {upperCase} from '@src/string_utils';\n\nconst TEMPLATES_PATH = join(fileURLToPath(import.meta.url), '../templates');\n\nexport async function generateProject(opts: {\n  dst: string;\n  project: WorkspaceProject;\n  allFragments: WorkspaceFragment[];\n  workspace: Workspace | undefined;\n  workspaceName: string;\n}): Promise<FileHash[]> {\n  const {dst, project, allFragments, workspace, workspaceName} = opts;\n\n  const written: FileHash[] = [];\n  const {projectName, type, vars} = project;\n  const defaultVars = {\n    __WORKSPACE_NAME__: workspaceName,\n    __WORKSPACE_NAME_UPPERCASE__: upperCase(workspaceName),\n    // eslint-disable-next-line @typescript-eslint/no-magic-numbers\n    __COOKIE_ENCRYPTION_KEY__: randomStringSafe(32),\n  };\n\n  // Copy template files\n  const templatePath = join(TEMPLATES_PATH, type);\n  const files = await listFiles(templatePath);\n  const filesToWrite = [\n    ...(await Promise.all(\n      files.map(async file => {\n        const relativePath = relative(templatePath, file);\n        const dstPath = join(projectName, relativePath);\n\n        let content = await readFile(file);\n        if (file.endsWith('package.json')) {\n          const packageJson = JSON.parse(await readFile(file));\n          packageJson['name'] = projectName;\n          content = JSON.stringify(packageJson, undefined, 2);\n        }\n        for (const [varName, varValue] of Object.entries({...vars, ...defaultVars})) {\n          content = content.replaceAll(varName, varValue);\n        }\n\n        return {path: dstPath, content};\n      })\n    )),\n  ];\n  if (type === ProjectType.Shared) {\n    filesToWrite.push(...generateSharedFiles(allFragments));\n  }\n\n  await Promise.all(\n    filesToWrite.map(async ({path, content}) => {\n      let formattedContent = content;\n\n      // Handle @matthis/skip-file directives\n      const skipFileMatches = content.matchAll(\n        /\\/\\/ @matthis\\/skip-file:(?<flagName>[^:]+)(?<negate>:not)?:(?<flagValue>[^\\s]*)/gu\n      );\n      for (const skipFileMatch of skipFileMatches) {\n        const {flagName, negate, flagValue} = skipFileMatch.groups ?? {};\n        if (flagMatch({flagName, negate, flagValue}, project, allFragments)) {\n          return;\n        }\n      }\n      // Remove the lines that contain the @matthis/skip-file directives\n      formattedContent = formattedContent.replaceAll(\n        / *\\/\\/ @matthis\\/skip-file:[^:]+(?::not)?:[^\\n]*\\n/gu,\n        ''\n      );\n\n      // Handle @matthis/start and @matthis/end directives\n      const fileLines: string[] = [];\n      const depth: ('include' | 'exclude')[] = ['include'];\n      for (const line of formattedContent.split('\\n')) {\n        // Look for @matthis/end\n        if (line.includes('@matthis/end')) {\n          depth.pop();\n          continue;\n        }\n\n        // Look for @matthis/start\n        const matchStart =\n          /.*\\/\\/ @matthis\\/start:(?<flagName>[^:]+)(?<negate>:not)?:(?<flagValue>[^\\s]*).*/u.exec(\n            line\n          );\n        if (matchStart) {\n          const {flagName, negate, flagValue} = matchStart.groups ?? {};\n          depth.push(\n            flagMatch({flagName, negate, flagValue}, project, allFragments) ? 'include' : 'exclude'\n          );\n          continue;\n        }\n\n        if (depth.at(-1) === 'include') {\n          fileLines.push(line);\n        }\n      }\n      formattedContent = fileLines.join('\\n');\n\n      if (path.endsWith('.ts') || path.endsWith('.tsx')) {\n        formattedContent = await prettierFormat(formattedContent, 'typescript');\n      }\n      if (path.endsWith('.json')) {\n        formattedContent = await prettierFormat(formattedContent, 'json');\n      }\n      written.push(await writeWorkspaceFile(workspace, dst, path, formattedContent));\n    })\n  );\n\n  return written;\n}\n\nfunction flagMatch(\n  flag: {flagName?: string; negate?: string; flagValue?: string},\n  project: WorkspaceProject,\n  allFragments: WorkspaceFragment[]\n): boolean {\n  const {flagName, negate, flagValue} = flag;\n  if (flagName === undefined || flagValue === undefined) {\n    return false;\n  }\n  const projectFlagValue = project.flags(allFragments)[flagName];\n  const projectFlagMatchValue = projectFlagValue === flagValue;\n  return negate !== undefined ? !projectFlagMatchValue : projectFlagMatchValue;\n}\n","import {\n  filterFragments,\n  WorkspaceFragment,\n  WorkspaceFragmentRegistry,\n  WorkspaceFragmentType,\n} from '@src/models';\nimport {hasApi} from '@src/project/generate_workspace';\nimport {pascalCase} from '@src/string_utils';\n\ninterface TemplateFile {\n  path: string;\n  content: string;\n}\n\nexport function generateSharedFiles(allFragments: WorkspaceFragment[]): TemplateFile[] {\n  const webApps = filterFragments(allFragments, WorkspaceFragmentType.WebApp);\n  const apiLambdas = filterFragments(allFragments, WorkspaceFragmentType.ApiLambda);\n  const webAppsWithAuth = webApps.filter(app => app.authentication.enabled);\n  return [\n    ...(hasApi(allFragments) ? [generateSharedApiFile({webApps, apiLambdas})] : []),\n    ...webApps.map(webApp => {\n      const userType = `${pascalCase(webApp.appName)}User`;\n      return {\n        path: `shared/src/api/${webApp.appName}_api.ts`,\n        content: webApp.authentication.enabled\n          ? `\nimport {Obj, SchemaToType, Str} from '@shared/api/core/api_schema';\nimport {${userType}Id} from '@shared/models';\n\nconst Frontend${userType}Schema = Obj({\n    id: Str<${userType}Id>(),\n});\nexport type Frontend${userType} = SchemaToType<typeof Frontend${userType}Schema>;\n\nexport const ${webApp.appName.toUpperCase()}_API = {\n    '/login': {\n        POST: {\n            req: Obj({id: Str(), password: Str()}),\n            res: Frontend${userType}Schema,\n        },\n    },\n    '/test': {\n        POST: {\n            req: Obj({query: Str()}),\n            res: Obj({data: Str()}),\n        },\n    },\n};\n      `\n          : `\nimport {Obj, Str} from '@shared/api/core/api_schema';\n\nexport const ${webApp.appName.toUpperCase()}_API = {\n    '/test': {\n        POST: {\n            req: Obj({query: Str()}),\n            res: Obj({data: Str()}),\n        },\n    },\n};\n          `,\n      };\n    }),\n    ...apiLambdas.map(apiLambda => ({\n      path: `shared/src/api/${apiLambda.apiName}.ts`,\n      content: `\n  import {Unknown} from '@shared/api/core/api_schema';\n  \n  export const ${apiLambda.apiName.toUpperCase()} = {\n      '/test': {\n          GET: {\n              req: Unknown(),\n              res: Unknown(),\n          },\n      },\n  };\n        `,\n    })),\n    ...(webAppsWithAuth.length === 0 ? [] : [generateSharedModelFile(webAppsWithAuth)]),\n  ];\n}\n\nfunction generateSharedApiFile(opts: {\n  webApps: WorkspaceFragmentRegistry['web-app'][];\n  apiLambdas: WorkspaceFragmentRegistry['api-lambda'][];\n}): TemplateFile {\n  const {webApps, apiLambdas} = opts;\n\n  // IMPORTS\n  const imports = [\n    ...webApps.map(\n      webApp =>\n        `import {${webApp.appName.toUpperCase()}_API} from '@shared/api/${webApp.appName}_api';`\n    ),\n    ...apiLambdas.map(\n      apiLambda =>\n        `import {${apiLambda.apiName.toUpperCase()}} from '@shared/api/${apiLambda.apiName}';`\n    ),\n    `import {AllApiSchema} from '@shared/api/core/api_schema';`,\n    `import {ApiConfig, ApiName} from '@shared/api/core/api_types';`,\n    `import {${[\n      ...webApps.map(webApp => `${webApp.appName.toUpperCase()}_BACKEND_URL`),\n      ...apiLambdas.map(apiLambda => `${apiLambda.apiName.toUpperCase()}_URL`),\n    ].join(', ')}} from '@shared/env';`,\n  ].join('\\n');\n\n  // APIs DEF\n  const apisDef = `\n    export const ALL = {\n      ${[\n        ...webApps.map(webApp => `${webApp.appName}_backend: ${webApp.appName.toUpperCase()}_API,`),\n        ...apiLambdas.map(apiLambda => `${apiLambda.apiName}: ${apiLambda.apiName.toUpperCase()},`),\n      ].join('\\n')}\n    } satisfies AllApiSchema;\n  `.trim();\n\n  // APIs CONFIG\n  const apisConfig = `\n    export const API_CONFIGS = {\n      ${[\n        ...webApps.map(\n          webApp =>\n            `${webApp.appName}_backend: {host: ${webApp.appName.toUpperCase()}_BACKEND_URL},`\n        ),\n        ...apiLambdas.map(\n          apiLambda => `${apiLambda.apiName}: {host: ${apiLambda.apiName.toUpperCase()}_URL},`\n        ),\n      ].join('\\n')}\n    } satisfies Record<ApiName, ApiConfig>;\n  `.trim();\n\n  return {\n    path: 'shared/src/api/api.ts',\n    content: [imports, apisDef, apisConfig].join('\\n\\n'),\n  };\n}\n\nfunction generateSharedModelFile(\n  webAppsWithAuth: WorkspaceFragmentRegistry['web-app'][]\n): TemplateFile {\n  return {\n    path: 'shared/src/models.ts',\n    content: `\nimport {Brand} from '@shared/lib/type_utils';\n\n${webAppsWithAuth\n  .map(webApp => {\n    const userType = `${pascalCase(webApp.appName)}User`;\n    return `\nexport type ${userType}Id = Brand<'${userType}Id', string>;\n\nexport interface ${userType}Item {\nid: ${userType}Id;\nhash: string;\nsalt: string;\nsessionDuration: number; // in seconds\n}\n`.trim();\n  })\n  .join('\\n\\n')}\n`,\n  };\n}\n","export function capitalize(value: string): string {\n  const [firstChar] = value;\n  return firstChar === undefined ? '' : firstChar.toUpperCase() + value.slice(1);\n}\n\nexport function uncapitalize(value: string): string {\n  const [firstChar] = value;\n  return firstChar === undefined ? '' : firstChar.toLowerCase() + value.slice(1);\n}\n\nexport function pascalCase(str: string): string {\n  return str\n    .toLowerCase()\n    .split(/[^a-z]+/u)\n    .map(s => capitalize(s))\n    .join('');\n}\n\nexport function upperCase(str: string): string {\n  return str\n    .toUpperCase()\n    .split(/[^A-Z]+/u)\n    .join('_');\n}\n\nexport function lowerCase(str: string): string {\n  return str\n    .toLowerCase()\n    .split(/[^a-z]+/u)\n    .join('_');\n}\n","import {randomBytes} from 'node:crypto';\n\nconst ALPHANUM = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';\nexport function randomStringSafe(length: number, set?: string): string {\n  let result = '';\n  const characters = set ?? ALPHANUM;\n  const bytes = randomBytes(length);\n  for (const byte of bytes) {\n    // eslint-disable-next-line @typescript-eslint/no-magic-numbers\n    result += characters[Math.floor((byte / 255) * (characters.length - 1))];\n  }\n  return result;\n}\n\nconst UID_LENGTH = 16;\nexport function uidSafe(prefix?: string): string {\n  const id = randomStringSafe(UID_LENGTH);\n  return prefix === undefined ? id : `${prefix}${id}`;\n}\n\nconst NONCE_BYTE_SIZE = 16;\nexport function generateNonce(): string {\n  return randomBytes(NONCE_BYTE_SIZE).toString('base64');\n}\n","export function generateGitIgnore(): string {\n  return `\n.DS_Store\nnode_modules\nbuild\ndist\ntmp\nyarn-error.log\n.yarn-warnings.log\nyarn.lock\nterraform/.terraform\nterraform/.terraform*\nterraform/*.tfstate.backup\nterraform/archives\n*/log\n/shared/src/env.ts\n/.build.lock\n    `.trim();\n}\n","import {PROJECT_TYPE_TO_METADATA, WorkspaceName} from '@src/models';\nimport {WorkspaceProject} from '@src/project/generate_workspace';\nimport {NODE_VERSION, PACKAGE_VERSIONS, TYPESCRIPT_VERSION} from '@src/versions';\n\nfunction uniq<T>(val: T[]): T[] {\n  return [...new Set(val).values()];\n}\n\nexport function generateWorkspacePackageJson(\n  workspaceName: WorkspaceName,\n  projects: WorkspaceProject[]\n): Record<string, unknown> {\n  const eslintRuntimes = uniq(projects.map(p => PROJECT_TYPE_TO_METADATA[p.type].eslint));\n  const tsconfigRuntimes = uniq(projects.map(p => PROJECT_TYPE_TO_METADATA[p.type].tsconfig));\n  const webpackRuntimes = uniq(projects.map(p => PROJECT_TYPE_TO_METADATA[p.type].webpack));\n\n  return {\n    name: workspaceName,\n    license: 'UNLICENSED',\n    type: 'module',\n    engines: {\n      node: NODE_VERSION,\n    },\n    scripts: {\n      setup: 'node ./setup.js',\n      deploy: 'node ./deploy.js',\n      build: 'NODE_ENV=production node ./build.js',\n      watch: 'NODE_ENV=development node ./build.js --watch',\n    },\n    prettier: '@matthis/prettier-config',\n    devDependencies: Object.fromEntries(\n      (\n        [\n          ...eslintRuntimes.map(runtime => [\n            `@matthis/eslint-config-${runtime}`,\n            PACKAGE_VERSIONS.eslint,\n          ]),\n          ['@matthis/prettier-config', PACKAGE_VERSIONS.prettier],\n          ...tsconfigRuntimes.map(runtime => [\n            `@matthis/tsconfig-${runtime}`,\n            PACKAGE_VERSIONS.tsconfig,\n          ]),\n          ...webpackRuntimes.map(runtime => [\n            `@matthis/webpack-${runtime}`,\n            PACKAGE_VERSIONS.webpack,\n          ]),\n          ['@matthis/webpack-runner', PACKAGE_VERSIONS.runner],\n          ['typescript', TYPESCRIPT_VERSION],\n        ] as [string, string][]\n      ).sort((d1, d2) => d1[0].localeCompare(d2[0]))\n    ),\n  };\n}\n","export const PACKAGE_VERSIONS = {\n  project: '1.11.42',\n  eslint: '1.8.5',\n  prettier: '1.5.0',\n  tsconfig: '1.7.4',\n  webpack: '1.7.7',\n  runner: '1.5.31',\n  lambdaServerRuntime: '1.0.7',\n};\n\nexport const ESLINT_VERSION = '9.8.x';\nexport const PRETTIER_VERSION = '3.3.3';\nexport const TYPESCRIPT_VERSION = '5.5.x';\nexport const MIN_NODE_VERSION = '20.10';\nexport const NODE_VERSION = `>=${MIN_NODE_VERSION}`;\nexport const CORE_JS_VERSION = '3.37';\n\nexport const LIB_VERSIONS = {\n  '@types/react': '18.2.x',\n  '@types/react-dom': '18.2.x',\n  react: '18.2.x',\n  'react-dom': '18.2.x',\n  'styled-components': '6.1.x',\n};\n","import {ProjectType, WorkspaceName} from '@src/models';\nimport {WorkspaceProject} from '@src/project/generate_workspace';\nimport {generateFrontendTerraform} from '@src/project/terraform/frontend';\nimport {generateLambdaTerraform} from '@src/project/terraform/lambda';\nimport {generateAwsProviderTerraform} from '@src/project/terraform/provider';\nimport {generateS3BucketTerraform} from '@src/project/terraform/s3';\nimport {WorkspaceOptions} from '@src/project/vscode_workspace';\nimport {neverHappens} from '@src/type_utils';\n\nexport interface AppDomain {\n  rootDomain: string;\n  subDomain: string;\n}\n\nexport function generateCommonTerraform(\n  workspaceName: WorkspaceName,\n  projects: WorkspaceProject[],\n  workspaceOptions: WorkspaceOptions\n): string {\n  const {region} = workspaceOptions;\n  return [\n    generateAwsProviderTerraform(workspaceName, {region}),\n    generateS3BucketTerraform(\n      workspaceName,\n      projects.filter(p => p.type === ProjectType.Web).map(p => p.projectName)\n    ),\n  ].join('\\n\\n');\n}\n\nexport function generateWorkspaceProjectTerraform(\n  workspaceName: WorkspaceName,\n  project: WorkspaceProject\n): string | undefined {\n  const {projectName, terraform} = project;\n\n  if (terraform.type === 'frontend') {\n    return generateFrontendTerraform(projectName, terraform);\n  } else if (terraform.type === 'lambda') {\n    return generateLambdaTerraform(workspaceName, projectName, terraform);\n  }\n  // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n  else if (terraform.type === 'no-terraform') {\n    return undefined;\n  }\n  neverHappens(terraform, 'Terraform type');\n}\n","import {ProjectName} from '@src/models';\nimport {AppDomain} from '@src/project/terraform/all';\n\nexport interface WorkspaceProjectTerraformFrontend {\n  type: 'frontend';\n  domain: AppDomain | undefined;\n}\n\nexport function generateFrontendTerraform(\n  projectName: ProjectName,\n  opts: WorkspaceProjectTerraformFrontend\n): string {\n  const {domain} = opts;\n  const bucketName = projectName.toLowerCase().replace(/[^\\d.a-z-]+/gu, '-');\n  const originId = `${bucketName}-origin-id`;\n  return `\noutput \"${projectName}_cloudfront_domain_name\" {\n  value       = ${\n    domain\n      ? `\"${domain.subDomain}.${domain.rootDomain}\"`\n      : `aws_cloudfront_distribution.${projectName}.domain_name`\n  }\n  description = \"Domain (from cloudfront) where the \\\\\"${projectName}\\\\\" is available.\"\n}${\n    domain !== undefined\n      ? `\n\n# Domain\n\ndata \"aws_route53_zone\" \"${projectName}\" {\n  name = \"${domain.rootDomain}\"\n}\n\nresource \"aws_route53_record\" \"${projectName}_a\" {\n  zone_id = data.aws_route53_zone.${projectName}.zone_id\n  name    = \"${domain.subDomain}.${domain.rootDomain}\"\n  type    = \"A\"\n\n  alias {\n    name                   = aws_cloudfront_distribution.${projectName}.domain_name\n    zone_id                = aws_cloudfront_distribution.${projectName}.hosted_zone_id\n    evaluate_target_health = false\n  }\n}\n\nresource \"aws_route53_record\" \"${projectName}_aaaa\" {\n  zone_id = data.aws_route53_zone.${projectName}.zone_id\n  name    = \"${domain.subDomain}.${domain.rootDomain}\"\n  type    = \"AAAA\"\n\n  alias {\n    name                   = aws_cloudfront_distribution.${projectName}.domain_name\n    zone_id                = aws_cloudfront_distribution.${projectName}.hosted_zone_id\n    evaluate_target_health = false\n  }\n}\n\nresource \"aws_acm_certificate\" \"${projectName}\" {\n  domain_name               = \"*.${domain.subDomain}.${domain.rootDomain}\"\n  subject_alternative_names = [\"${domain.subDomain}.${domain.rootDomain}\"]\n  validation_method         = \"DNS\"\n  provider                  = aws.us-east-1\n}\n\nresource \"aws_route53_record\" \"${projectName}_certificate_validation\" {\n  for_each = {\n    for dvo in aws_acm_certificate.${projectName}.domain_validation_options : dvo.domain_name => {\n      name   = dvo.resource_record_name\n      record = dvo.resource_record_value\n      type   = dvo.resource_record_type\n    }\n  }\n  provider        = aws.us-east-1\n  allow_overwrite = true\n  name            = each.value.name\n  records         = [each.value.record]\n  ttl             = 60\n  type            = each.value.type\n  zone_id         = data.aws_route53_zone.${projectName}.zone_id\n}\n\nresource \"aws_acm_certificate_validation\" \"${projectName}\" {\n  provider                = aws.us-east-1\n  certificate_arn         = aws_acm_certificate.${projectName}.arn\n  validation_record_fqdns = [for record in aws_route53_record.${projectName}_certificate_validation : record.fqdn]\n}`\n      : ''\n  }\n\n# Cloudfront Distribution\n\nresource \"aws_cloudfront_origin_access_identity\" \"${projectName}\" {}\n  \nresource \"aws_cloudfront_distribution\" \"${projectName}\" {\n  origin {\n    domain_name = aws_s3_bucket.code.bucket_regional_domain_name\n    origin_id   = \"${originId}\"\n    origin_path = \"/${projectName}\"\n\n    s3_origin_config {\n      origin_access_identity = aws_cloudfront_origin_access_identity.${projectName}.cloudfront_access_identity_path\n    }\n  }\n  \n  enabled             = true\n  wait_for_deployment = false\n  is_ipv6_enabled     = true\n  price_class         = \"PriceClass_100\"${\n    domain\n      ? `\n  aliases             = [\"${domain.subDomain}.${domain.rootDomain}\"]`\n      : ''\n  }\n  \n  default_root_object = \"/index.html\"\n  custom_error_response {\n    error_code         = 400\n    response_code      = 200\n    response_page_path = \"/index.html\"\n  }\n  custom_error_response {\n    error_code         = 403\n    response_code      = 200\n    response_page_path = \"/index.html\"\n  }\n  custom_error_response {\n    error_code         = 404\n    response_code      = 200\n    response_page_path = \"/index.html\"\n  }\n\n  default_cache_behavior {\n    allowed_methods        = [\"HEAD\", \"GET\"]\n    cached_methods         = [\"HEAD\", \"GET\"]\n    compress               = true\n    target_origin_id       = \"${originId}\"\n    viewer_protocol_policy = \"redirect-to-https\"\n    \n    forwarded_values {\n      query_string = false\n      cookies {\n        forward = \"none\"\n      }\n    }\n  }\n\n  restrictions {\n    geo_restriction {\n      restriction_type = \"none\"\n    }\n  }\n\n  viewer_certificate {${\n    domain\n      ? `\n    acm_certificate_arn      = aws_acm_certificate.${projectName}.arn\n    ssl_support_method       = \"sni-only\"\n    minimum_protocol_version = \"TLSv1.2_2021\"`\n      : `\n    cloudfront_default_certificate = true`\n  }\n  }\n}\n  `.trim();\n}\n","import {ProjectName, WebAppAuthentication, WorkspaceName} from '@src/models';\nimport {AppDomain} from '@src/project/terraform/all';\nimport {lowerCase} from '@src/string_utils';\n\nexport interface WorkspaceProjectTerraformLambda {\n  type: 'lambda';\n  api: boolean;\n  webAppName: string | undefined;\n  alarmEmail: string | undefined;\n  cloudwatchTriggerMinutes: number | undefined;\n  domain: AppDomain | undefined;\n  authentication: WebAppAuthentication | undefined;\n}\n\nexport function generateLambdaTerraform(\n  workspaceName: WorkspaceName,\n  projectName: ProjectName,\n  opts: WorkspaceProjectTerraformLambda\n): string {\n  const {api, webAppName, alarmEmail, cloudwatchTriggerMinutes, domain, authentication} = opts;\n  return `\n# Define any extra role for the lambda here\ndata \"aws_iam_policy_document\" \"${projectName}_extra_policy\" {\n  ${\n    authentication?.enabled\n      ? `statement {\n    actions = [\n      \"dynamodb:GetItem\",\n      \"dynamodb:BatchGetItem\",\n      \"dynamodb:Query\",\n      \"dynamodb:Scan\",\n      \"dynamodb:PutItem\",\n      \"dynamodb:UpdateItem\",\n      \"dynamodb:DeleteItem\",\n    ]\n    resources = [${\n      webAppName === undefined\n        ? ''\n        : `\n      \"\\${aws_dynamodb_table.${lowerCase(webAppName)}_user_table.arn}\",\n      \"\\${aws_dynamodb_table.${lowerCase(webAppName)}_user_table.arn}/index/*\",\n      \"\\${aws_dynamodb_table.${lowerCase(webAppName)}_user_session_table.arn}\",\n      \"\\${aws_dynamodb_table.${lowerCase(webAppName)}_user_session_table.arn}/index/*\",\n    `\n    }]\n  }`\n      : ''\n  }${\n    webAppName !== undefined\n      ? `\n\n  statement {\n    actions = [\n      \"s3:GetObject\",\n      \"s3:GetObjectTagging\"\n    ]\n    resources = [\n      \"\\${aws_s3_bucket.code.arn}/*\"\n    ]\n  }`\n      : ''\n  }\n}\n\nresource \"aws_lambda_function\" \"${projectName}\" {\n  function_name = \"${workspaceName}-${projectName}\"\n  s3_bucket     = aws_s3_object.${projectName}_archive.bucket\n  s3_key        = aws_s3_object.${projectName}_archive.key\n  handler       = \"index.handler\"\n  runtime       = \"nodejs20.x\"\n  role          = aws_iam_role.${projectName}_role.arn\n  timeout       = 900 // 15 minutes\n  memory_size   = 128 // Mo\n  environment {\n    variables = {${\n      api\n        ? `\n      NODE_OPTIONS            = \"--enable-source-maps\"\n      CLOUDFRONT_HEADER_NAME  = random_string.${projectName}_cloudfront_header_name.result\n      CLOUDFRONT_HEADER_VALUE = random_string.${projectName}_cloudfront_header_value.result`\n        : `\n      NODE_OPTIONS = \"--enable-source-maps\"`\n    }\n    }\n  }\n}\n\noutput \"${projectName}_function_name\" {\n  value       = aws_lambda_function.${projectName}.function_name\n  description = \"Function name of the \\\\\"${workspaceName}-${projectName}\\\\\" lambda\"\n}\n${\n  api\n    ? `\n# Lambda URL\n\nresource \"aws_lambda_function_url\" \"${projectName}\" {\n  function_name      = aws_lambda_function.${projectName}.function_name\n  authorization_type = \"NONE\"\n}\n\noutput \"${projectName}_url\" {\n  value       = \"${\n    domain\n      ? `https://${domain.subDomain}.${domain.rootDomain}/`\n      : `https://\\${aws_cloudfront_distribution.${projectName}.domain_name}/`\n  }\"\n  description = \"URL of \\\\\"${projectName}\\\\\"\"\n}${\n        domain !== undefined\n          ? `\n\n# Domain\n\ndata \"aws_route53_zone\" \"${projectName}\" {\n  name = \"${domain.rootDomain}\"\n}\n\nresource \"aws_route53_record\" \"${projectName}_a\" {\n  zone_id = data.aws_route53_zone.${projectName}.zone_id\n  name    = \"${domain.subDomain}.${domain.rootDomain}\"\n  type    = \"A\"\n\n  alias {\n    name                   = aws_cloudfront_distribution.${projectName}.domain_name\n    zone_id                = aws_cloudfront_distribution.${projectName}.hosted_zone_id\n    evaluate_target_health = false\n  }\n}\n\nresource \"aws_route53_record\" \"${projectName}_aaaa\" {\n  zone_id = data.aws_route53_zone.${projectName}.zone_id\n  name    = \"${domain.subDomain}.${domain.rootDomain}\"\n  type    = \"AAAA\"\n\n  alias {\n    name                   = aws_cloudfront_distribution.${projectName}.domain_name\n    zone_id                = aws_cloudfront_distribution.${projectName}.hosted_zone_id\n    evaluate_target_health = false\n  }\n}\n\nresource \"aws_acm_certificate\" \"${projectName}\" {\n  domain_name               = \"*.${domain.subDomain}.${domain.rootDomain}\"\n  subject_alternative_names = [\"${domain.subDomain}.${domain.rootDomain}\"]\n  validation_method         = \"DNS\"\n  provider                  = aws.us-east-1\n}\n\nresource \"aws_route53_record\" \"${projectName}_certificate_validation\" {\n  for_each = {\n    for dvo in aws_acm_certificate.${projectName}.domain_validation_options : dvo.domain_name => {\n      name   = dvo.resource_record_name\n      record = dvo.resource_record_value\n      type   = dvo.resource_record_type\n    }\n  }\n  provider        = aws.us-east-1\n  allow_overwrite = true\n  name            = each.value.name\n  records         = [each.value.record]\n  ttl             = 60\n  type            = each.value.type\n  zone_id         = data.aws_route53_zone.${projectName}.zone_id\n}\n\nresource \"aws_acm_certificate_validation\" \"${projectName}\" {\n  provider                = aws.us-east-1\n  certificate_arn         = aws_acm_certificate.${projectName}.arn\n  validation_record_fqdns = [for record in aws_route53_record.${projectName}_certificate_validation : record.fqdn]\n}`\n          : ''\n      }\n\n# Cloudfront Distribution\n\nresource \"random_string\" \"${projectName}_cloudfront_header_name\" {\n  length  = 16\n  upper   = false\n  numeric = false\n  special = false\n}\n\nresource \"random_string\" \"${projectName}_cloudfront_header_value\" {\n  length  = 32\n  special = false\n}\n\nresource \"aws_cloudfront_distribution\" \"${projectName}\" {\n  origin {\n    # Remove \"https://\" prefix and \"/\" suffix\n    domain_name = replace(replace(aws_lambda_function_url.${projectName}.function_url, \"https://\", \"\"), \"/\", \"\")\n    origin_id   = aws_lambda_function.${projectName}.function_name\n\n    custom_origin_config {\n      https_port             = 443\n      http_port              = 80\n      origin_protocol_policy = \"https-only\"\n      origin_ssl_protocols   = [\"TLSv1.2\"]\n    }\n\n    custom_header {\n      name  = random_string.${projectName}_cloudfront_header_name.result\n      value = random_string.${projectName}_cloudfront_header_value.result\n    }\n  }\n\n  enabled             = true\n  wait_for_deployment = false\n  is_ipv6_enabled     = true\n  price_class         = \"PriceClass_100\"${\n    domain\n      ? `\n  aliases             = [\"${domain.subDomain}.${domain.rootDomain}\"]`\n      : ''\n  }\n\n  default_cache_behavior {\n    allowed_methods        = [\"DELETE\", \"GET\", \"HEAD\", \"OPTIONS\", \"PATCH\", \"POST\", \"PUT\"]\n    cached_methods         = [\"HEAD\", \"GET\"]\n    compress               = true\n    target_origin_id       = aws_lambda_function.${projectName}.function_name\n    viewer_protocol_policy = \"redirect-to-https\"\n    # Managed-CachingDisabled\n    cache_policy_id = \"4135ea2d-6df8-44a3-9df3-4b5a84be39ad\"\n    # Managed-AllViewerExceptHostHeader\n    origin_request_policy_id = \"b689b0a8-53d0-40ab-baf2-68738e2966ac\"\n  }\n\n  restrictions {\n    geo_restriction {\n      restriction_type = \"none\"\n    }\n  }\n\n  viewer_certificate {${\n    domain\n      ? `\n    acm_certificate_arn      = aws_acm_certificate.${projectName}.arn\n    ssl_support_method       = \"sni-only\"\n    minimum_protocol_version = \"TLSv1.2_2021\"`\n      : `\n    cloudfront_default_certificate = true`\n  }\n  }\n}`\n    : ''\n}\n${\n  cloudwatchTriggerMinutes !== undefined\n    ? `# Cloudwatch trigger\n\nresource \"aws_lambda_permission\" \"cloudwatch_invoke_${projectName}\" {\n  statement_id  = \"AllowExecutionFromCloudWatch\"\n  action        = \"lambda:InvokeFunction\"\n  function_name = aws_lambda_function.${projectName}.arn\n  principal     = \"events.amazonaws.com\"\n  source_arn    = aws_cloudwatch_event_rule.${projectName}_trigger_rate.arn\n}\n\nresource \"aws_cloudwatch_event_rule\" \"${projectName}_trigger_rate\" {\n  name_prefix         = \"${projectName}.rate-${cloudwatchTriggerMinutes}-minutes.\"\n  schedule_expression = \"rate(${cloudwatchTriggerMinutes} minute${\n    cloudwatchTriggerMinutes > 1 ? 's' : ''\n  })\"\n}\n\nresource \"aws_cloudwatch_event_target\" \"${projectName}_trigger_target\" {\n  rule = aws_cloudwatch_event_rule.${projectName}_trigger_rate.name\n  arn  = aws_lambda_function.${projectName}.arn\n}\n`\n    : ''\n}\n# IAM role\n\nresource \"aws_iam_role\" \"${projectName}_role\" {\n  name = \"${workspaceName}-${projectName}-role\"\n  assume_role_policy = jsonencode({\n    Version = \"2012-10-17\"\n    Statement = [\n      {\n        Action = \"sts:AssumeRole\"\n        Principal = {\n          Service = \"lambda.amazonaws.com\"\n          AWS     = data.aws_iam_roles.administrator_roles.arns\n        }\n        Effect = \"Allow\"\n      },\n    ]\n  })\n  \n  inline_policy {\n    name   = \"${workspaceName}-${projectName}-extra-policy\"\n    policy = data.aws_iam_policy_document.${projectName}_extra_policy.json\n  }\n}\n\noutput \"${projectName}_role_arn\" {\n  value = aws_iam_role.${projectName}_role.arn\n}\n\n# Cloudwatch logging\n\nresource \"aws_cloudwatch_log_group\" \"${projectName}\" {\n  name = \"/aws/lambda/${workspaceName}-${projectName}\"\n}\n\nresource \"aws_iam_policy\" \"${projectName}_cloudwatch\" {\n  name = \"${workspaceName}-${projectName}-cloudwatch-policy\"\n  policy = jsonencode({\n    Version = \"2012-10-17\"\n    Statement = [\n      {\n        Action = [\n          \"logs:CreateLogStream\",\n          \"logs:PutLogEvents\",\n        ]\n        Effect = \"Allow\"\n        Resource = [\n          \"\\${aws_cloudwatch_log_group.${projectName}.arn}\",\n          \"\\${aws_cloudwatch_log_group.${projectName}.arn}:*\",\n        ]\n      }\n    ]\n  })\n}\n\nresource \"aws_iam_role_policy_attachment\" \"${projectName}_cloudwatch\" {\n  role       = aws_iam_role.${projectName}_role.name\n  policy_arn = aws_iam_policy.${projectName}_cloudwatch.arn\n}\n${\n  alarmEmail !== undefined\n    ? `\n# Cloudwatch error monitoring\n\nresource \"aws_cloudwatch_log_metric_filter\" \"${projectName}_log_errors\" {\n  name           = \"${workspaceName}-${projectName}-log-error-metric-filter\"\n  pattern        = \"[ts, id, level = \\\\\"ERROR\\\\\", msg]\"\n  log_group_name = aws_cloudwatch_log_group.${projectName}.name\n\n  metric_transformation {\n    name          = \"${workspaceName}-${projectName}-errors\"\n    namespace     = \"${workspaceName}\"\n    value         = \"1\"\n    default_value = \"0\"\n    unit          = \"Count\"\n  }\n}\n\nresource \"aws_cloudwatch_metric_alarm\" \"${projectName}_log_errors\" {\n  alarm_name          = \"${workspaceName}-${projectName}-log-error-metric-alarm\"\n  metric_name         = aws_cloudwatch_log_metric_filter.${projectName}_log_errors.metric_transformation[0].name\n  namespace           = aws_cloudwatch_log_metric_filter.${projectName}_log_errors.metric_transformation[0].namespace\n  evaluation_periods  = 1\n  period              = 3600\n  statistic           = \"Sum\"\n  comparison_operator = \"GreaterThanOrEqualToThreshold\"\n  threshold           = 1\n  actions_enabled     = true\n  alarm_actions       = [aws_sns_topic.${projectName}_log_errors.arn]\n  ok_actions          = [aws_sns_topic.${projectName}_log_errors.arn]\n  treat_missing_data  = \"notBreaching\"\n}\n\nresource \"aws_sns_topic\" \"${projectName}_log_errors\" {\n  name = \"${workspaceName}-${projectName}-log-error-sns-topic\"\n}\n\nresource \"aws_sns_topic_subscription\" \"${projectName}_log_errors\" {\n  endpoint  = \"${alarmEmail}\"\n  protocol  = \"email\"\n  topic_arn = aws_sns_topic.${projectName}_log_errors.arn\n}\n`\n    : ''\n}\n# Dummy source code useful only during the initial setup\nresource \"aws_s3_object\" \"${projectName}_archive\" {\n  bucket         = aws_s3_bucket.code.id\n  key            = \"${projectName}/dist.zip\"\n  content_base64 = \"UEsDBBQACAAIAGaKwlYAAAAAAAAAADYAAAAIACAAaW5kZXguanNVVA0AB3AIemRyCHpkcAh6ZHV4CwABBPUBAAAEFAAAAEutKMgvKinWy0jMS8lJLVKwVUgsrsxLVkgrzUsuyczPU9DQVKjmUlAoSi0pLcpTUFe35qq15gIAUEsHCP0ak1o4AAAANgAAAFBLAQIUAxQACAAIAGaKwlb9GpNaOAAAADYAAAAIACAAAAAAAAAAAACkgQAAAABpbmRleC5qc1VUDQAHcAh6ZHIIemRwCHpkdXgLAAEE9QEAAAQUAAAAUEsFBgAAAAABAAEAVgAAAI4AAAAAAA==\"\n}\n\n`.trim();\n}\n","import {WorkspaceName} from '@src/models';\n\nexport function generateAwsProviderTerraform(\n  workspaceName: WorkspaceName,\n  opts: {region: string}\n): string {\n  const {region} = opts;\n  return `\nterraform {\n  required_providers {\n    aws = {\n      source  = \"hashicorp/aws\"\n      version = \"~> 5.1\"\n    }\n  }\n}\n\nprovider \"aws\" {\n  region                   = \"${region}\"\n  default_tags {\n    tags = {\n      Project = \"${workspaceName}\"\n    }\n  }\n}\n\nprovider \"aws\" {\n  alias                    = \"us-east-1\"\n  region                   = \"us-east-1\"\n  default_tags {\n    tags = {\n      Project = \"${workspaceName}\"\n    }\n  }\n}\n\ndata \"aws_region\" \"current\" {}\noutput \"region\" {\n  value = data.aws_region.current.id\n}\n\ndata \"aws_caller_identity\" \"current\" {}\noutput \"account_id\" {\n  value = data.aws_caller_identity.current.account_id\n}\n\ndata \"aws_iam_roles\" \"administrator_roles\" {\n  name_regex = \"AdministratorAccess\"\n}\noutput \"administrator_role_arn\" {\n  value = tolist(data.aws_iam_roles.administrator_roles.arns)[0]\n}\n`.trim();\n}\n","import {ProjectName, WorkspaceName} from '@src/models';\n\nexport function generateS3BucketTerraform(\n  workspaceName: WorkspaceName,\n  webProjectNames: ProjectName[]\n): string {\n  const bucketName = workspaceName.toLowerCase().replace(/[^a-z0-9.-]+/gu, '-');\n\n  const CODE_BUCKET = `\nresource \"aws_s3_bucket\" \"code\" {\n  bucket_prefix = \"${bucketName}-code-\"\n}\n\noutput \"code_bucket\" {\n  value = aws_s3_bucket.code.id\n}\n`.trim();\n\n  const CLOUDFRONT_ACCESS = `\ndata \"aws_iam_policy_document\" \"cloudfront_access_to_code_policy\" {\n  ${webProjectNames\n    .map(p =>\n      `\n  statement {\n    actions = [\"s3:GetObject\"]\n    resources = [\n      \"\\${aws_s3_bucket.code.arn}/${p}/*\",\n    ]\n    principals {\n      type        = \"AWS\"\n      identifiers = [aws_cloudfront_origin_access_identity.${p}.iam_arn]\n    }\n  }\n`.trim()\n    )\n    .join('\\n\\n')}\n}\n\nresource \"aws_s3_bucket_policy\" \"cloudfront_access_to_code\" {\n  bucket = aws_s3_bucket.code.id\n  policy = data.aws_iam_policy_document.cloudfront_access_to_code_policy.json\n}\n`.trim();\n\n  const out = [CODE_BUCKET];\n  if (webProjectNames.length > 0) {\n    out.push(CLOUDFRONT_ACCESS);\n  }\n  return out.join('\\n\\n');\n}\n","function notUndefined<T>(val: T | undefined): val is T {\n  return val !== undefined;\n}\n\nexport function isString(val: unknown): val is string {\n  return typeof val === 'string';\n}\n\nexport function isNumber(val: unknown): val is number {\n  return typeof val === 'number';\n}\n\nexport function iterNumberEnum<T extends Record<string, string | number>>(e: T): T[keyof T][] {\n  return Object.values(e).filter(isNumber) as unknown as T[keyof T][];\n}\n\nexport function iterStringEnum<T extends Record<string, string>>(e: T): T[keyof T][] {\n  return Object.values(e).filter(isString) as unknown as T[keyof T][];\n}\n\nexport function removeUndefined<T>(arr: (T | undefined)[]): T[] {\n  return arr.filter(notUndefined);\n}\n\nexport function removeUndefinedOrNullProps<T extends Record<string, unknown>>(obj: T): {} {\n  return Object.fromEntries(\n    Object.entries(obj).filter(e => e[1] !== undefined && e[1] !== null)\n  ) as T;\n}\n\nexport function neverHappens(value: never, errorMessage?: string): never {\n  throw new Error(errorMessage);\n}\n\nexport type AnyInterface<T> = {[K in keyof T]: unknown};\n\nexport function asMap(value: unknown): Record<string, unknown> | undefined;\nexport function asMap(\n  value: unknown,\n  defaultValue: Record<string, unknown>\n): Record<string, unknown>;\nexport function asMap(\n  value: unknown,\n  defaultValue?: Record<string, unknown>\n): Record<string, unknown> | undefined {\n  return typeof value === 'object' && value !== null && !Array.isArray(value)\n    ? (value as Record<string, unknown>)\n    : defaultValue;\n}\nexport function asMapOrThrow(value: unknown): Record<string, unknown> {\n  const valueAsMap = asMap(value);\n  if (valueAsMap === undefined) {\n    throw new Error(`Invalid value: \\`${value}\\` is not a map`);\n  }\n  return valueAsMap;\n}\n\nexport function asJson(value: string): Record<string, unknown> | undefined;\nexport function asJson(\n  value: string,\n  defaultValue: Record<string, unknown>\n): Record<string, unknown>;\nexport function asJson(\n  value: string,\n  defaultValue?: Record<string, unknown>\n): Record<string, unknown> | undefined {\n  try {\n    const json = JSON.parse(value);\n    const res = asMap(json);\n    return res ?? defaultValue;\n  } catch {\n    return defaultValue;\n  }\n}\nexport function asJsonOrThrow(value: string): Record<string, unknown> {\n  const valueAsJson = asJson(value);\n  if (valueAsJson === undefined) {\n    throw new Error(`Invalid value: \\`${value}\\` is not a valid JSON string of a map`);\n  }\n  return valueAsJson;\n}\n\nexport function asJsonString(value: unknown): Record<string, unknown> | undefined;\nexport function asJsonString(\n  value: unknown,\n  defaultValue: Record<string, unknown>\n): Record<string, unknown>;\nexport function asJsonString(\n  value: unknown,\n  defaultValue?: Record<string, unknown>\n): Record<string, unknown> | undefined {\n  const str = asString(value);\n  return str === undefined\n    ? defaultValue\n    : defaultValue === undefined\n      ? asJson(str)\n      : asJson(str, defaultValue);\n}\nexport function asJsonStringOrThrow(value: unknown): Record<string, unknown> {\n  return asJsonOrThrow(asStringOrThrow(value));\n}\n\nexport function asString<T extends string = string>(value: unknown): T | undefined;\nexport function asString<T extends string = string>(value: unknown, defaultValue: string): T;\nexport function asString<T extends string = string>(\n  value: unknown,\n  defaultValue?: string\n): T | undefined {\n  return (typeof value === 'string' ? value : defaultValue) as T;\n}\nexport function asStringOrThrow<T extends string = string>(value: unknown): T {\n  const valueAsString = asString<T>(value);\n  if (valueAsString === undefined) {\n    throw new Error(`Invalid value: \\`${value}\\` is not a string`);\n  }\n  return valueAsString;\n}\n\nexport function asStringEnum<T extends Record<string, string>>(\n  value: unknown,\n  enu: T\n): T[keyof T] | undefined;\nexport function asStringEnum<T extends Record<string, string>>(\n  value: unknown,\n  enu: T,\n  defaultValue: T[keyof T]\n): T[keyof T];\nexport function asStringEnum<T extends Record<string, string>>(\n  value: unknown,\n  enu: T,\n  defaultValue?: T[keyof T]\n): T[keyof T] | undefined {\n  return (\n    typeof value === 'string' && Object.values(enu).includes(value as T[keyof T])\n      ? value\n      : defaultValue\n  ) as T[keyof T];\n}\nexport function asStringEnumOrThrow<T extends Record<string, string>>(\n  value: unknown,\n  enu: T\n): T[keyof T] {\n  const valueAsString = asStringEnum<T>(value, enu);\n  if (valueAsString === undefined) {\n    throw new Error(\n      `Invalid value: \\`${value}\\` is not a string or not one of ${JSON.stringify(\n        Object.values(enu)\n      )}`\n    );\n  }\n  return valueAsString;\n}\n\nexport function asArray<T = unknown>(value: unknown): T[] | undefined;\nexport function asArray<T = unknown>(value: unknown, defaultValue: unknown[]): T[];\nexport function asArray<T = unknown>(value: unknown, defaultValue?: unknown[]): T[] | undefined {\n  return (Array.isArray(value) ? value : defaultValue) as T[];\n}\nexport function asArrayOrThrow<T = unknown>(value: unknown): T[] {\n  if (!Array.isArray(value)) {\n    throw new Error(`Invalid value: \\`${value}\\` is not an array`);\n  }\n  return value as T[];\n}\n\nexport function asStringArray<T extends string = string>(value: unknown): T[] | undefined;\nexport function asStringArray<T extends string = string>(\n  value: unknown,\n  defaultValue: string[]\n): T[];\nexport function asStringArray<T extends string = string>(\n  value: unknown,\n  defaultValue?: string[]\n): T[] | undefined {\n  const arr = asArray(value);\n  if (arr === undefined) {\n    return defaultValue as T[];\n  }\n  return removeUndefined(arr.map(s => asString<T>(s)));\n}\n\nexport function asStringArrayOrThrow<T extends string = string>(value: unknown): T[] {\n  const arr = asArrayOrThrow(value);\n  return arr.map(s => asStringOrThrow<T>(s));\n}\n\nexport function asMapArray(value: unknown): Record<string, unknown>[] | undefined;\nexport function asMapArray(\n  value: unknown,\n  defaultValue: Record<string, unknown>[]\n): Record<string, unknown>[];\nexport function asMapArray(\n  value: unknown,\n  defaultValue?: Record<string, unknown>[]\n): Record<string, unknown>[] | undefined {\n  const arr = asArray(value);\n  if (arr === undefined) {\n    return defaultValue;\n  }\n  return removeUndefined(arr.map(s => asMap(s)));\n}\nexport function asMapArrayOrThrow(value: unknown): Record<string, unknown>[] {\n  const arr = asArrayOrThrow(value);\n  return arr.map(s => asMapOrThrow(s));\n}\n\nexport function asNumber<T extends number = number>(value: unknown): T | undefined;\nexport function asNumber<T extends number = number>(value: unknown, defaultValue: number): T;\nexport function asNumber<T extends number = number>(\n  value: unknown,\n  defaultValue?: number\n): T | undefined {\n  if (typeof value === 'number') {\n    return (!isNaN(value) ? value : defaultValue) as T;\n  }\n  if (typeof value === 'string') {\n    try {\n      const parsedValue = parseFloat(value);\n      return (!isNaN(parsedValue) ? parsedValue : defaultValue) as T;\n    } catch {\n      return defaultValue as T;\n    }\n  }\n  return defaultValue as T;\n}\nexport function asNumberOrThrow<T extends number = number>(value: unknown): T {\n  const valueAsNumber = asNumber(value);\n  if (valueAsNumber === undefined) {\n    throw new Error(`Invalid value: \\`${value}\\` is not a number`);\n  }\n  return valueAsNumber as T;\n}\n\nexport function asBoolean(value: unknown): boolean | undefined;\nexport function asBoolean(value: unknown, defaultValue: boolean): boolean;\nexport function asBoolean(value: unknown, defaultValue?: boolean): boolean | undefined {\n  if (typeof value === 'boolean') {\n    return value;\n  }\n  if (typeof value === 'number') {\n    return !isNaN(value) ? value !== 0 : false;\n  }\n  if (typeof value === 'string') {\n    if (value === '0' || value === 'false') {\n      return false;\n    } else if (value === '1' || value === 'true') {\n      return true;\n    }\n    return defaultValue;\n  }\n  return defaultValue;\n}\n\nexport function asBooleanOrThrow(value: unknown): boolean {\n  const valueAsBoolean = asBoolean(value);\n  if (valueAsBoolean === undefined) {\n    throw new Error(`Invalid value: \\`${value}\\` is not a boolean`);\n  }\n  return valueAsBoolean;\n}\n\nconst TIMESTAMP_REGEX = /^[0-9]{1,15}$/u;\nexport function asDate(value: unknown): Date | undefined;\nexport function asDate(value: unknown, defaultValue: Date): Date;\nexport function asDate(value: unknown, defaultValue?: Date): Date | undefined {\n  const date =\n    value instanceof Date\n      ? value\n      : new Date(\n          typeof value === 'string' && TIMESTAMP_REGEX.test(value)\n            ? parseFloat(value)\n            : String(value)\n        );\n  return isNaN(date.getTime()) ? defaultValue : date;\n}\n\nexport function asDateOrThrow(value: unknown): Date {\n  const valueAsDate = asDate(value);\n  if (valueAsDate === undefined) {\n    throw new Error(`Invalid value: \\`${value}\\` cannot be parsed as a Date`);\n  }\n  return valueAsDate;\n}\n\n// export function asDate(value: unknown): Date | undefined;\n// export function asDate(value: unknown, defaultValue: Date): Date;\n// export function asDate(value: unknown, defaultValue?: Date): Date | undefined {\n//   if (typeof value === 'number') {\n//     return new Date(value);\n//   }\n//   return value instanceof Date ? value : defaultValue;\n// }\n\nexport function isNull<T>(val: T | null): val is null {\n  return val === null;\n}\n\nexport function asError(err: unknown): Error {\n  return err instanceof Error ? err : new Error(typeof err === 'string' ? err : String(err));\n}\n\nexport function errorAsString(err: unknown): string {\n  const errorMap = asMap(err);\n  if (errorMap === undefined) {\n    return asString(err) ?? String(err);\n  }\n\n  const errorMessage = asString(errorMap['message']);\n  if (errorMessage === undefined) {\n    return String(err);\n  }\n  return errorMessage;\n}\n\nexport function errorAndStackAsString(err: unknown): string {\n  const errorMap = asMap(err);\n  if (errorMap === undefined) {\n    return asString(err) ?? String(err);\n  }\n\n  const stack = asString(errorMap['stack']);\n  if (stack === undefined) {\n    return String(err);\n  }\n  return stack;\n}\n\nexport function asConstantOrThrow<T>(value: unknown, expected: T): T {\n  if (value !== expected) {\n    throw new Error(`Invalid value: \\`${value}\\`, expected \\`${expected}\\``);\n  }\n  return value as T;\n}\n\n// export function asParsedJson<T>(json: string): T {\n//   try {\n//     return JSON.parse(json) as T;\n//   } catch {\n//     const defaultValue = {};\n//     return defaultValue as T;\n//   }\n// }\nexport function parseJson(\n  json: string\n): {res: unknown; err: undefined} | {res: undefined; err: unknown} {\n  try {\n    return {res: JSON.parse(json), err: undefined};\n  } catch (err: unknown) {\n    return {err, res: undefined};\n  }\n}\nexport type Brand<Type, Name> = Type & {__brand: Name};\nexport type StringBrand = string & {__brand: string};\nexport type NumberBrand = number & {__brand: number};\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nexport type AnyBrand = (string | number) & {__brand: any};\n\nexport type Untrusted<T> = T extends\n  | Function\n  | Date\n  | boolean\n  | number\n  | string\n  | undefined\n  | null\n  | unknown[]\n  ? unknown\n  : {[P in keyof T]?: Untrusted<T[P]>};\n\nexport type DeepPartial<T> = T extends\n  | Function\n  | Date\n  | boolean\n  | number\n  | string\n  | undefined\n  | null\n  | unknown[]\n  ? T\n  : {[P in keyof T]?: DeepPartial<T[P]>};\n\nexport type MapInterface<I, Type> = {[Key in keyof I]: Type};\n// Get all the keys of a type including the optional attributes\ntype NonHomomorphicKeys<T> = ({[P in keyof T]: P} & None)[keyof T];\nexport type MapInterfaceStrict<I, Type> = {[Key in NonHomomorphicKeys<I>]: Type};\n\ntype KeysOfType<T, Type> = {[Key in keyof T]: T[Key] extends Type ? Key : never}[keyof T];\nexport type RestrictInterface<T, Type> = Pick<T, KeysOfType<T, Type>>;\n\ninterface RecursiveArray<T> extends Array<T | RecursiveArray<T>> {}\nexport type NestedArray<T> = (T | RecursiveArray<T>)[];\n\n// Type for an empty object (ie: {})\nexport type None = Record<string, never>;\n\nexport type NonEmptyArray<T> = [T, ...T[]];\nexport function isNonEmptyArray<T>(val: T[]): val is NonEmptyArray<T> {\n  return val.length > 0;\n}\nexport function nonEmptyArray<T>(val: T[]): NonEmptyArray<T> | undefined {\n  return val.length === 0 ? undefined : (val as NonEmptyArray<T>);\n}\n\nexport type AddPrefix<T, P extends string> = {\n  [K in keyof T as K extends string ? `${P}${K}` : never]: T[K];\n};\nexport function addPrefix<T extends Record<string, unknown>, Prefix extends string>(\n  attr: T,\n  prefix: Prefix\n): AddPrefix<T, Prefix> {\n  return Object.fromEntries(\n    Object.entries(attr).map(([key, value]) => [`${prefix}${key}`, value])\n  ) as AddPrefix<T, Prefix>;\n}\n\nexport type WithNull<T> = {\n  [Key in keyof T]: T[Key] extends Exclude<T[Key], undefined> ? T[Key] : T[Key] | null;\n};\ntype Id<T> = T;\nexport type Flatten<T> = Id<{[k in keyof T]: T[k]}>;\n\nexport type Defined<T> = Exclude<T, undefined>;\n","import {WorkspaceName} from '@src/models';\nimport {lowerCase, pascalCase} from '@src/string_utils';\n\nexport function generateDynamoUserTerraform(workspaceName: WorkspaceName, appName: string): string {\n  const prefixLower = lowerCase(appName);\n  const prefixPascal = `${pascalCase(workspaceName)}${pascalCase(appName)}`;\n  return `\noutput \"${prefixLower}_user_table_name\" {\n  value = aws_dynamodb_table.${prefixLower}_user_table.name\n}\n\noutput \"${prefixLower}_user_index_name\" {\n  value = {\n    for obj in aws_dynamodb_table.${prefixLower}_user_table.global_secondary_index : \"${prefixLower}_user_by_\\${obj.hash_key}\\${length(obj.range_key) > 0 ? \"_sorted_by_\\${obj.range_key}\" : \"\"}\" => obj.name\n  }\n}\n\nresource \"aws_dynamodb_table\" \"${prefixLower}_user_table\" {\n  name         = \"${prefixPascal}User\"\n  billing_mode = \"PAY_PER_REQUEST\"\n  hash_key     = \"id\"\n\n  attribute {\n    name = \"id\"\n    type = \"S\"\n  }\n}`.trim();\n}\n","import {WorkspaceName} from '@src/models';\nimport {lowerCase, pascalCase} from '@src/string_utils';\n\nexport function generateDynamoUserSessionTerraform(\n  workspaceName: WorkspaceName,\n  appName: string\n): string {\n  const prefixLower = lowerCase(appName);\n  const prefixPascal = `${pascalCase(workspaceName)}${pascalCase(appName)}`;\n  return `output \"${prefixLower}_user_session_table_name\" {\n  value = aws_dynamodb_table.${prefixLower}_user_session_table.name\n}\n\noutput \"${prefixLower}_user_session_index_name\" {\n  value = {\n    for obj in aws_dynamodb_table.${prefixLower}_user_session_table.global_secondary_index : \"${prefixLower}_user_session_by_\\${obj.hash_key}\\${ length(obj.range_key) > 0 ? \"_sorted_by_\\${obj.range_key}\" : \"\" }\" => obj.name\n  }\n}\n\nresource \"aws_dynamodb_table\" \"${prefixLower}_user_session_table\" {\n  name         = \"${prefixPascal}UserSession\"\n  billing_mode = \"PAY_PER_REQUEST\"\n  hash_key     = \"token\"\n\n  attribute {\n    name = \"token\"\n    type = \"S\"\n  }\n\n  ttl {\n    attribute_name = \"expiresAt\"\n    enabled        = true\n  }\n}`.trim();\n}\n","import {join} from 'node:path';\n\nimport {maybeReadFile, prettyJson, writeRawFile} from '@src/fs';\nimport {ProjectName, WorkspaceFragment, WorkspaceFragmentType} from '@src/models';\nimport {DEFAULT_REGION, getProjectsFromWorkspaceFragment} from '@src/project/generate_workspace';\nimport {\n  asBoolean,\n  asMap,\n  asMapArray,\n  asNumber,\n  asString,\n  asStringOrThrow,\n  removeUndefined,\n} from '@src/type_utils';\n\nexport function generateCodeWorkspace(\n  workspaceName: string,\n  workspaceFragments: WorkspaceFragment[]\n): Record<string, unknown> {\n  const projects = workspaceFragments.flatMap(f => getProjectsFromWorkspaceFragment(f));\n  const projectNames = projects.map(p => p.projectName);\n  return {\n    folders: [\n      ...projectNames.map(p => ({path: p})),\n      {path: 'terraform'},\n      {path: '.', name: 'root'},\n    ],\n    settings: {\n      'window.title': `${workspaceName}\\${separator}\\${activeEditorShort}`,\n      'files.exclude': Object.fromEntries([\n        ...projectNames.map(p => [p, true]),\n        ['terraform', true],\n      ]),\n      'editor.acceptSuggestionOnCommitCharacter': false,\n      'editor.suggestSelection': 'first',\n      'vsintellicode.modify.editor.suggestSelection': 'automaticallyOverrodeDefaultValue',\n      'explorer.confirmDelete': false,\n      'git.autofetch': true,\n      'git.confirmSync': false,\n      'typescript.preferences.importModuleSpecifier': 'non-relative',\n      'eslint.lintTask.enable': true,\n      'eslint.useESLintClass': true,\n      'editor.formatOnSave': true,\n      'editor.codeActionsOnSave': {\n        'source.fixAll': 'never',\n        'source.fixAll.eslint': 'explicit',\n      },\n      'editor.defaultFormatter': 'esbenp.prettier-vscode',\n      'editor.linkedEditing': true,\n      'emmet.showExpandedAbbreviation': 'never',\n      'files.associations': {\n        '*.tf': 'terraform',\n      },\n      '[typescript]': {\n        'editor.defaultFormatter': 'esbenp.prettier-vscode',\n      },\n      '[typescriptreact]': {\n        'editor.defaultFormatter': 'esbenp.prettier-vscode',\n      },\n      '[terraform]': {\n        'editor.defaultFormatter': 'hashicorp.terraform',\n      },\n    },\n    extensions: {\n      recommendations: [\n        'dbaeumer.vscode-eslint',\n        'esbenp.prettier-vscode',\n        'VisualStudioExptTeam.vscodeintellicode',\n        'styled-components.vscode-styled-components',\n        'naumovs.color-highlight',\n        'eamodio.gitlens',\n        'hashicorp.terraform',\n      ],\n    },\n  };\n}\n\nexport interface FileHash {\n  path: string;\n  hash: string;\n}\n\nexport interface WorkspaceOptions {\n  region: string;\n}\n\nexport interface Workspace {\n  fragments: WorkspaceFragment[];\n  version: string;\n  files: FileHash[];\n  options: WorkspaceOptions;\n}\n\nexport async function readWorkspace(workspacePath: string): Promise<Workspace | undefined> {\n  const workspaceContent = await maybeReadFile(join(workspacePath, '.workspace'));\n  if (workspaceContent === undefined) {\n    return undefined;\n  }\n  const workspaceData = asMap(JSON.parse(workspaceContent), {});\n\n  const fragments = removeUndefined(\n    asMapArray(workspaceData['fragments'], []).map<WorkspaceFragment | undefined>(fragData => {\n      const type = asString<WorkspaceFragmentType>(fragData['type']);\n      if (type === undefined) {\n        return undefined;\n      } else if (type === WorkspaceFragmentType.Shared) {\n        const frag: WorkspaceFragment = {type: WorkspaceFragmentType.Shared};\n        return frag;\n      } else if (type === WorkspaceFragmentType.SharedWeb) {\n        const frag: WorkspaceFragment = {type: WorkspaceFragmentType.SharedWeb};\n        return frag;\n      } else if (type === WorkspaceFragmentType.SharedNode) {\n        const frag: WorkspaceFragment = {type: WorkspaceFragmentType.SharedNode};\n        return frag;\n      } else if (type === WorkspaceFragmentType.WebApp) {\n        const alarmEmail = asString(fragData['alarmEmail']);\n        const appName = asStringOrThrow(fragData['appName']);\n        const authenticationData = asMap(fragData['authentication'], {});\n        const enabled = asBoolean(authenticationData['enabled'], false);\n        const domain = asString(fragData['domain']);\n        const frag: WorkspaceFragment = {\n          type: WorkspaceFragmentType.WebApp,\n          alarmEmail,\n          appName,\n          authentication: {enabled},\n          domain,\n        };\n        return frag;\n      } else if (type === WorkspaceFragmentType.StaticWebsite) {\n        const websiteName = asStringOrThrow<ProjectName>(fragData['websiteName']);\n        const domain = asString(fragData['domain']);\n        const frag: WorkspaceFragment = {\n          type: WorkspaceFragmentType.StaticWebsite,\n          websiteName,\n          domain,\n        };\n        return frag;\n      } else if (type === WorkspaceFragmentType.ApiLambda) {\n        const alarmEmail = asString(fragData['alarmEmail']);\n        const apiName = asStringOrThrow<ProjectName>(fragData['apiName']);\n        const domain = asString(fragData['domain']);\n        const frag: WorkspaceFragment = {\n          type: WorkspaceFragmentType.ApiLambda,\n          alarmEmail,\n          apiName,\n          domain,\n        };\n        return frag;\n      } else if (type === WorkspaceFragmentType.NodeScript) {\n        const scriptName = asStringOrThrow<ProjectName>(fragData['scriptName']);\n        const frag: WorkspaceFragment = {\n          type: WorkspaceFragmentType.NodeScript,\n          scriptName,\n        };\n        return frag;\n      }\n      // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n      else if (type === WorkspaceFragmentType.StandaloneLambda) {\n        const lambdaName = asStringOrThrow<ProjectName>(fragData['lambdaName']);\n        const alarmEmail = asString(fragData['alarmEmail']);\n        const cloudwatchTriggerMinutes = asNumber(fragData['cloudwatchTriggerMinutes']);\n        const frag: WorkspaceFragment = {\n          type: WorkspaceFragmentType.StandaloneLambda,\n          lambdaName,\n          alarmEmail,\n          cloudwatchTriggerMinutes,\n        };\n        return frag;\n      }\n      return undefined;\n    })\n  );\n\n  const version = asStringOrThrow(workspaceData['version']);\n  const files = removeUndefined(\n    asMapArray(workspaceData['files'], []).map<FileHash | undefined>(fileData => {\n      const path = asString(fileData['path']);\n      const hash = asString(fileData['hash']);\n      if (path === undefined || hash === undefined) {\n        return undefined;\n      }\n      return {path, hash};\n    })\n  );\n\n  const optionsData = asMap(workspaceData['options'], {});\n  const region = asString(optionsData['region'], DEFAULT_REGION);\n  const options: WorkspaceOptions = {region};\n\n  return {fragments, version, files, options};\n}\n\nexport async function writeWorkspace(workspacePath: string, workspace: Workspace): Promise<void> {\n  workspace.files.sort((f1, f2) => f1.path.localeCompare(f2.path));\n  await writeRawFile(join(workspacePath, '.workspace'), await prettyJson(workspace));\n}\n","import {prompt} from 'prompts';\n\nimport {WorkspaceFragment} from '@src/models';\nimport {askForNewWorkspaceFragment} from '@src/project/ask_for_new_workspace_fragment';\nimport {askForWorkspaceUpdate} from '@src/project/ask_for_workspace_update';\n\nconst I_AM_DONE = 'i_am_done';\n\nexport async function askForWorkspaceFragments(\n  frags: WorkspaceFragment[]\n): Promise<WorkspaceFragment[]> {\n  const {action} = await prompt({\n    type: 'select',\n    name: 'action',\n    message: 'What do you want to do',\n    choices: [\n      {title: `Add a project`, value: 'add'},\n      {title: `Update a project`, value: 'update'},\n      {title: `I'm done`, value: I_AM_DONE},\n    ],\n  });\n\n  if (action === undefined || action === I_AM_DONE) {\n    return frags;\n  }\n\n  if (action === 'add') {\n    const newFrags = await askForNewWorkspaceFragment(frags);\n    return await askForWorkspaceFragments(newFrags);\n  }\n\n  if (action === 'update') {\n    const newFrags = await askForWorkspaceUpdate(frags);\n    return await askForWorkspaceFragments(newFrags);\n  }\n\n  return frags;\n}\n","import {prompt} from 'prompts';\n\nimport {WorkspaceFragment, WorkspaceFragmentType} from '@src/models';\nimport {\n  askForAlarmEmail,\n  askForAuthentication,\n  askForCloudwatchTrigger,\n  askForDomainName,\n  askForProjectName,\n} from '@src/project/ask_for_common';\nimport {getProjectsFromWorkspaceFragment} from '@src/project/generate_workspace';\nimport {neverHappens} from '@src/type_utils';\n\nconst I_AM_DONE = 'i_am_done';\n\ntype SelectableWorkspaceFragmentType = Exclude<\n  WorkspaceFragmentType,\n  WorkspaceFragmentType.Shared | WorkspaceFragmentType.SharedNode | WorkspaceFragmentType.SharedWeb\n>;\n\nconst WorkspaceFragmentTypeToString: Record<SelectableWorkspaceFragmentType, string> = {\n  [WorkspaceFragmentType.WebApp]: 'Web App',\n  [WorkspaceFragmentType.StaticWebsite]: 'Static Website',\n  [WorkspaceFragmentType.StandaloneLambda]: 'Standalone Lambda',\n  [WorkspaceFragmentType.ApiLambda]: 'API Lambda',\n  [WorkspaceFragmentType.NodeScript]: 'Node Script',\n};\n\nexport async function askForNewWorkspaceFragment(\n  frags: WorkspaceFragment[]\n): Promise<WorkspaceFragment[]> {\n  const takenNames = [\n    'terraform',\n    'shared',\n    'shared-web',\n    'shared-node',\n    ...frags.flatMap(frag => getProjectsFromWorkspaceFragment(frag).map(p => p.projectName)),\n  ];\n\n  const {workspaceFragmentType} = await prompt({\n    type: 'select',\n    name: 'workspaceFragmentType',\n    message: 'Choose a type of project to add to the workspace',\n    choices: [\n      ...Object.entries(WorkspaceFragmentTypeToString).map(([value, title]) => ({value, title})),\n      {title: `I'm done`, value: I_AM_DONE},\n    ],\n  });\n  if (workspaceFragmentType === undefined || workspaceFragmentType === I_AM_DONE) {\n    return frags;\n  }\n\n  const type = workspaceFragmentType as SelectableWorkspaceFragmentType;\n\n  if (type === WorkspaceFragmentType.StaticWebsite) {\n    const websiteName = await askForProjectName('Website project name', 'website', takenNames);\n    const domain = await askForDomainName();\n    return [...frags, {type, websiteName, domain}];\n  } else if (type === WorkspaceFragmentType.StandaloneLambda) {\n    const lambdaName = await askForProjectName('Lambda project name', 'lambda', takenNames);\n    const alarmEmail = await askForAlarmEmail(true);\n    const cloudwatchTriggerMinutes = await askForCloudwatchTrigger();\n    return [...frags, {type, lambdaName, alarmEmail, cloudwatchTriggerMinutes}];\n  } else if (type === WorkspaceFragmentType.ApiLambda) {\n    const apiName = await askForProjectName('API name', 'api', takenNames);\n    const alarmEmail = await askForAlarmEmail(false);\n    const domain = await askForDomainName();\n    return [...frags, {type, apiName, alarmEmail, domain}];\n  } else if (type === WorkspaceFragmentType.WebApp) {\n    const appName = await askForProjectName('App name', 'app', takenNames);\n    const alarmEmail = await askForAlarmEmail(false);\n    const domain = await askForDomainName();\n    const authentication = await askForAuthentication();\n    return [...frags, {type, appName, alarmEmail, domain, authentication}];\n  }\n  // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n  else if (type === WorkspaceFragmentType.NodeScript) {\n    const scriptName = await askForProjectName('Script project name', 'script', takenNames);\n    return [...frags, {type, scriptName}];\n  }\n  neverHappens(type, `Unknown WorkspaceFragmentType \"${type}\"`);\n}\n","import {prompt} from 'prompts';\n\nimport {WorkspaceFragment, WorkspaceFragmentRegistry, WorkspaceFragmentType} from '@src/models';\nimport {\n  askForAlarmEmailValue,\n  askForAuthentication,\n  askForCloudwatchTriggerValue,\n  askForDomainNameValue,\n} from '@src/project/ask_for_common';\nimport {neverHappens} from '@src/type_utils';\n\nconst I_AM_DONE = 'i_am_done';\n\nexport async function askForWorkspaceUpdate(\n  frags: WorkspaceFragment[]\n): Promise<WorkspaceFragment[]> {\n  // Ask which project they want to update (get the index)\n  const {workspaceFragmentIndex} = await prompt({\n    type: 'select',\n    name: 'workspaceFragmentIndex',\n    message: 'Which project do you want to update',\n    choices: [\n      ...frags.map((frag, index) => ({value: index, title: workspaceFragmentString(frag)})),\n      {title: `I'm done`, value: I_AM_DONE},\n    ],\n  });\n  if (workspaceFragmentIndex === undefined || workspaceFragmentIndex === I_AM_DONE) {\n    return frags;\n  }\n\n  // Retrieve the workspace fragment\n  const index = workspaceFragmentIndex as number;\n  const frag = frags[index];\n  if (!frag) {\n    return frags;\n  }\n\n  // Ask for the updates\n  let hasChanged = true;\n  let newFrag = frag;\n  while (hasChanged) {\n    const nextNewFrag = await askForWorkspaceFragmentUpdate(newFrag);\n    hasChanged = nextNewFrag !== newFrag;\n    newFrag = nextNewFrag;\n  }\n\n  // Update the workspace\n  const newFrags = [...frags];\n  newFrags[index] = newFrag;\n  return newFrags;\n}\n\nasync function askForWorkspaceFragmentUpdate(frag: WorkspaceFragment): Promise<WorkspaceFragment> {\n  // Base fragments can not be updated\n  if (\n    frag.type === WorkspaceFragmentType.Shared ||\n    frag.type === WorkspaceFragmentType.SharedNode ||\n    frag.type === WorkspaceFragmentType.SharedWeb\n  ) {\n    return frag;\n  }\n\n  if (frag.type === WorkspaceFragmentType.StaticWebsite) {\n    return await askForStaticWebsiteFragmentUpdate(frag);\n  } else if (frag.type === WorkspaceFragmentType.StandaloneLambda) {\n    return await askForStandaloneLambdaFragmentUpdate(frag);\n  } else if (frag.type === WorkspaceFragmentType.ApiLambda) {\n    return await askForApiLambdaFragmentUpdate(frag);\n  } else if (frag.type === WorkspaceFragmentType.WebApp) {\n    return await askForWebAppFragmentUpdate(frag);\n  }\n  // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n  else if (frag.type === WorkspaceFragmentType.NodeScript) {\n    return await askForNodeScriptFragmentUpdate(frag);\n  }\n  neverHappens(frag);\n}\n\nasync function askForStaticWebsiteFragmentUpdate(\n  frag: WorkspaceFragmentRegistry['static-website']\n): Promise<WorkspaceFragmentRegistry['static-website']> {\n  const {type, websiteName, domain} = frag;\n  const {attribute} = await prompt({\n    type: 'select',\n    name: 'attribute',\n    message: 'What do you want to update?',\n    choices: [\n      {title: `Domain name: ${domain ?? '<not set>'}`, value: 'domain'},\n      {title: `I'm done`, value: I_AM_DONE},\n    ],\n  });\n\n  if (attribute === undefined || attribute === I_AM_DONE) {\n    return frag;\n  }\n\n  if (attribute === 'domain') {\n    const domain = await askForDomainNameValue();\n    return {type, websiteName, domain};\n  }\n\n  return frag;\n}\n\nasync function askForStandaloneLambdaFragmentUpdate(\n  frag: WorkspaceFragmentRegistry['standalone-lambda']\n): Promise<WorkspaceFragmentRegistry['standalone-lambda']> {\n  const {type, lambdaName, alarmEmail, cloudwatchTriggerMinutes} = frag;\n  const {attribute} = await prompt({\n    type: 'select',\n    name: 'attribute',\n    message: 'What do you want to update?',\n    choices: [\n      {title: `Alarm email: ${alarmEmail ?? '<not set>'}`, value: 'alarmEmail'},\n      {\n        title: `Cloudwatch trigger (in min): ${cloudwatchTriggerMinutes ?? '<not set>'}`,\n        value: 'cloudwatchTriggerMinutes',\n      },\n      {title: `I'm done`, value: I_AM_DONE},\n    ],\n  });\n\n  if (attribute === undefined || attribute === I_AM_DONE) {\n    return frag;\n  }\n\n  if (attribute === 'alarmEmail') {\n    const alarmEmail = await askForAlarmEmailValue();\n    return {type, lambdaName, alarmEmail, cloudwatchTriggerMinutes};\n  }\n\n  if (attribute === 'cloudwatchTriggerMinutes') {\n    const cloudwatchTriggerMinutes = await askForCloudwatchTriggerValue();\n    return {type, lambdaName, alarmEmail, cloudwatchTriggerMinutes};\n  }\n\n  return frag;\n}\n\nasync function askForApiLambdaFragmentUpdate(\n  frag: WorkspaceFragmentRegistry['api-lambda']\n): Promise<WorkspaceFragmentRegistry['api-lambda']> {\n  const {type, apiName, alarmEmail, domain} = frag;\n  const {attribute} = await prompt({\n    type: 'select',\n    name: 'attribute',\n    message: 'What do you want to update?',\n    choices: [\n      {title: `Domain name: ${domain ?? '<not set>'}`, value: 'domain'},\n      {title: `Alarm email: ${alarmEmail ?? '<not set>'}`, value: 'alarmEmail'},\n      {title: `I'm done`, value: I_AM_DONE},\n    ],\n  });\n\n  if (attribute === undefined || attribute === I_AM_DONE) {\n    return frag;\n  }\n\n  if (attribute === 'domain') {\n    const domain = await askForDomainNameValue();\n    return {type, apiName, alarmEmail, domain};\n  }\n\n  if (attribute === 'alarmEmail') {\n    const alarmEmail = await askForAlarmEmailValue();\n    return {type, apiName, alarmEmail, domain};\n  }\n\n  return frag;\n}\n\nasync function askForWebAppFragmentUpdate(\n  frag: WorkspaceFragmentRegistry['web-app']\n): Promise<WorkspaceFragmentRegistry['web-app']> {\n  const {type, appName, alarmEmail, authentication, domain} = frag;\n  const {attribute} = await prompt({\n    type: 'select',\n    name: 'attribute',\n    message: 'What do you want to update?',\n    choices: [\n      {title: `Domain name: ${domain ?? '<not set>'}`, value: 'domain'},\n      {title: `Alarm email: ${alarmEmail ?? '<not set>'}`, value: 'alarmEmail'},\n      {title: `Authentication: ${authentication.enabled ? 'yes' : 'no'}`, value: 'authentication'},\n      {title: `I'm done`, value: I_AM_DONE},\n    ],\n  });\n\n  if (attribute === undefined || attribute === I_AM_DONE) {\n    return frag;\n  }\n\n  if (attribute === 'domain') {\n    const domain = await askForDomainNameValue();\n    return {type, appName, alarmEmail, authentication, domain};\n  }\n\n  if (attribute === 'alarmEmail') {\n    const alarmEmail = await askForAlarmEmailValue();\n    return {type, appName, alarmEmail, authentication, domain};\n  }\n\n  if (attribute === 'authentication') {\n    const authentication = await askForAuthentication();\n    return {type, appName, alarmEmail, authentication, domain};\n  }\n\n  return frag;\n}\n\nasync function askForNodeScriptFragmentUpdate(\n  frag: WorkspaceFragmentRegistry['node-script']\n): Promise<WorkspaceFragmentRegistry['node-script']> {\n  // const {type, scriptName} = frag;\n  const {attribute} = await prompt({\n    type: 'select',\n    name: 'attribute',\n    message: 'What do you want to update?',\n    choices: [{title: `I'm done`, value: I_AM_DONE}],\n  });\n\n  if (attribute === undefined || attribute === I_AM_DONE) {\n    return frag;\n  }\n\n  return frag;\n}\n\nfunction workspaceFragmentString(frag: WorkspaceFragment): string {\n  if (frag.type === WorkspaceFragmentType.Shared) {\n    return 'shared';\n  } else if (frag.type === WorkspaceFragmentType.SharedNode) {\n    return 'shared-node';\n  } else if (frag.type === WorkspaceFragmentType.SharedWeb) {\n    return 'shared-web';\n  } else if (frag.type === WorkspaceFragmentType.ApiLambda) {\n    return `${frag.apiName} (lambda api)`;\n  } else if (frag.type === WorkspaceFragmentType.NodeScript) {\n    return `${frag.scriptName} (node script)`;\n  } else if (frag.type === WorkspaceFragmentType.StandaloneLambda) {\n    return `${frag.lambdaName} (lambda function)`;\n  } else if (frag.type === WorkspaceFragmentType.StaticWebsite) {\n    return `${frag.websiteName} (static website)`;\n  }\n  // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n  else if (frag.type === WorkspaceFragmentType.WebApp) {\n    return `${frag.appName} (web app)`;\n  }\n  neverHappens(frag);\n}\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import {mkdir} from 'node:fs/promises';\nimport {basename, join} from 'node:path';\n\nimport {error} from '@src/logger';\nimport {\n  WorkspaceFragment,\n  WorkspaceFragmentRegistry,\n  WorkspaceFragmentType,\n  WorkspaceName,\n} from '@src/models';\nimport {askForWorkspaceName, askForWorkspaceRegion} from '@src/project/ask_for_common';\nimport {askForWorkspaceFragments} from '@src/project/ask_for_workspace_fragments';\nimport {generateWorkspace} from '@src/project/generate_workspace';\nimport {readWorkspace, WorkspaceOptions} from '@src/project/vscode_workspace';\nimport {neverHappens} from '@src/type_utils';\n\nasync function initProject(): Promise<void> {\n  let workspaceName: string;\n  let workspacePath = process.cwd();\n  let frags: WorkspaceFragment[] = [];\n  let workspaceOptions: WorkspaceOptions;\n\n  // Check if we are already in a workspace, otherwise ask for the workspace name\n  const workspace = await readWorkspace(workspacePath);\n\n  if (workspace === undefined) {\n    workspaceName = await askForWorkspaceName();\n    workspacePath = join(workspacePath, workspaceName);\n    workspaceOptions = {region: await askForWorkspaceRegion()};\n    await mkdir(workspacePath);\n  } else {\n    workspaceName = basename(workspacePath);\n    workspaceOptions = workspace.options;\n    frags = removeBaseFragments(workspace.fragments);\n  }\n\n  // Ask for changes on the workspace\n  while (true) {\n    try {\n      frags = await askForWorkspaceFragments(frags);\n      break;\n    } catch (err: unknown) {\n      error(String(err));\n    }\n  }\n\n  const name = workspaceName as WorkspaceName;\n  await generateWorkspace(\n    workspacePath,\n    name,\n    refreshBaseFragments(frags),\n    workspaceOptions,\n    workspace\n  );\n}\n\ntype BaseFragment =\n  | WorkspaceFragmentRegistry['shared']\n  | WorkspaceFragmentRegistry['shared-node']\n  | WorkspaceFragmentRegistry['shared-web'];\ntype NonBaseFragment = Exclude<WorkspaceFragment, BaseFragment>;\n\nfunction removeBaseFragments(frags: WorkspaceFragment[]): NonBaseFragment[] {\n  return frags.filter(\n    frag =>\n      ![\n        WorkspaceFragmentType.Shared,\n        WorkspaceFragmentType.SharedNode,\n        WorkspaceFragmentType.SharedWeb,\n      ].includes(frag.type)\n  ) as NonBaseFragment[];\n}\n\nfunction refreshBaseFragments(frags: WorkspaceFragment[]): WorkspaceFragment[] {\n  // Remove base fragments\n  const newFrags: WorkspaceFragment[] = removeBaseFragments(frags);\n\n  // Analyze what type of base fragments we need\n  let needSharedWeb = false;\n  let needSharedNode = false;\n  for (const frag of frags) {\n    if (\n      frag.type === WorkspaceFragmentType.Shared ||\n      frag.type === WorkspaceFragmentType.SharedNode ||\n      frag.type === WorkspaceFragmentType.SharedWeb\n    ) {\n      // should never happen\n    } else if (\n      frag.type === WorkspaceFragmentType.ApiLambda ||\n      frag.type === WorkspaceFragmentType.NodeScript ||\n      frag.type === WorkspaceFragmentType.StandaloneLambda\n    ) {\n      needSharedNode = true;\n    } else if (frag.type === WorkspaceFragmentType.WebApp) {\n      needSharedNode = true;\n      needSharedWeb = true;\n    }\n    // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n    else if (frag.type === WorkspaceFragmentType.StaticWebsite) {\n      needSharedWeb = true;\n    } else {\n      neverHappens(frag);\n    }\n  }\n\n  // Add the necessary fragments\n  newFrags.push({type: WorkspaceFragmentType.Shared});\n  if (needSharedNode) {\n    newFrags.push({type: WorkspaceFragmentType.SharedNode});\n  }\n  if (needSharedWeb) {\n    newFrags.push({type: WorkspaceFragmentType.SharedWeb});\n  }\n  return newFrags;\n}\n\ninitProject().catch(error);\n"],"names":["error","console","log","ProjectType","EslintType","TsConfigType","WebpackType","PROJECT_TYPE_TO_METADATA","Web","eslint","tsconfig","webpack","LambdaFunction","Node","Lambda","LambdaApi","LambdaWebApi","NodeScript","Shared","Lib","SharedNode","SharedWeb","WorkspaceFragmentType","validateRegistry","filterFragments","frags","type","filter","frag","prompt","DEFAULT_REGION","asStringOrThrow","askForWorkspaceName","workspaceName","name","message","validate","v","length","askForWorkspaceRegion","workspaceRegion","initial","VALID_PROJECT_NAME","askForProjectName","question","defaultValue","takenNames","includes","index","value","Error","test","askForAlarmEmail","defaultVal","alarm","undefined","email","askForAlarmEmailValue","askForDomainName","useDomain","askForDomainNameValue","domain","askForAuthentication","authenticationEnabled","enabled","askForCloudwatchTrigger","trigger","askForCloudwatchTriggerValue","minutes","minutesValue","parseFloat","Number","isNaN","execSync","join","relative","fileURLToPath","listFiles","prettyJs","prettyJson","prettyJsonc","readFile","writeRawFile","md5","generateProject","generateGitIgnore","generateWorkspacePackageJson","generateCommonTerraform","generateWorkspaceProjectTerraform","generateDynamoUserTerraform","generateDynamoUserSessionTerraform","generateCodeWorkspace","writeWorkspace","lowerCase","pascalCase","neverHappens","removeUndefined","PACKAGE_VERSIONS","TEMPLATES_PATH","import","meta","url","booleanFlag","bool","hasApi","allFragments","find","f","ApiLambda","WebApp","fragmentFlags","baseFlags","workspaceFlags","HAS_API","parseDomain","domainStr","parts","split","rootDomain","slice","subDomain","getProjectsFromWorkspaceFragment","fragment","StaticWebsite","projectName","websiteName","fromFragment","vars","__PROJECT_NAME__","__APP_NAME__","flags","terraform","StandaloneLambda","lambdaName","__PROJECT_NAME_UPPERCASE__","toUpperCase","api","webAppName","alarmEmail","cloudwatchTriggerMinutes","authentication","apiName","backendName","appName","frontendName","__APP_NAME_UPPERCASE__","__APP_NAME_PASCALCASE__","AUTHENTICATION","scriptName","generateWorkspace","dst","workspaceFragments","workspaceOptions","workspace","projects","flatMap","projectFiles","Promise","all","map","project","SCRIPTS_PATH","writeFile","path","file","writeWorkspaceFile","workspaceFiles","then","res","replaceAll","vscodePath","vscodeFileList","vscodeFiles","relativePath","dstPath","content","terraformFiles","addLineBreak","p","files","flat","fragments","version","options","commands","stdio","process","cwd","root","fileLines","fileToHash","line","endsWith","newHash","oldHash","hash","fileToWrite","l","exec","promises","readFileSync","dirname","format","access","readFileInternal","readdir","stat","mkdir","rm","buffer","toString","prettierConfig","parser","printWidth","singleQuote","trailingComma","bracketSpacing","arrowParens","endOfLine","prettierFormat","str","recursive","json","opts","compact","JSON","stringify","writeJsonFile","js","writeJsFile","prettyTs","ts","writeTsFile","writeRawFileIfNotExists","exists","rmDir","dirPath","force","cleanDir","cp","from","to","resolve","reject","err","maybeReadFile","fileContent","maybeReadFileSync","ents","withFileTypes","ent","entPath","isDirectory","push","subFiles","isFile","createHash","data","update","digest","hashPassword","password","salt","generateSharedFiles","randomStringSafe","upperCase","written","defaultVars","__WORKSPACE_NAME__","__WORKSPACE_NAME_UPPERCASE__","__COOKIE_ENCRYPTION_KEY__","templatePath","filesToWrite","packageJson","parse","varName","varValue","Object","entries","formattedContent","skipFileMatches","matchAll","skipFileMatch","flagName","negate","flagValue","groups","flagMatch","depth","pop","matchStart","at","flag","projectFlagValue","projectFlagMatchValue","webApps","apiLambdas","webAppsWithAuth","app","generateSharedApiFile","webApp","userType","apiLambda","generateSharedModelFile","imports","apisDef","trim","apisConfig","capitalize","firstChar","uncapitalize","toLowerCase","s","randomBytes","ALPHANUM","set","result","characters","bytes","byte","Math","floor","UID_LENGTH","uidSafe","prefix","id","NONCE_BYTE_SIZE","generateNonce","NODE_VERSION","TYPESCRIPT_VERSION","uniq","val","Set","values","eslintRuntimes","tsconfigRuntimes","webpackRuntimes","license","engines","node","scripts","setup","deploy","build","watch","prettier","devDependencies","fromEntries","runtime","runner","sort","d1","d2","localeCompare","lambdaServerRuntime","ESLINT_VERSION","PRETTIER_VERSION","MIN_NODE_VERSION","CORE_JS_VERSION","LIB_VERSIONS","react","generateFrontendTerraform","generateLambdaTerraform","generateAwsProviderTerraform","generateS3BucketTerraform","region","bucketName","replace","originId","webProjectNames","CODE_BUCKET","CLOUDFRONT_ACCESS","out","notUndefined","isString","isNumber","iterNumberEnum","e","iterStringEnum","arr","removeUndefinedOrNullProps","obj","errorMessage","asMap","Array","isArray","asMapOrThrow","valueAsMap","asJson","asJsonOrThrow","valueAsJson","asJsonString","asString","asJsonStringOrThrow","valueAsString","asStringEnum","enu","asStringEnumOrThrow","asArray","asArrayOrThrow","asStringArray","asStringArrayOrThrow","asMapArray","asMapArrayOrThrow","asNumber","parsedValue","asNumberOrThrow","valueAsNumber","asBoolean","asBooleanOrThrow","valueAsBoolean","TIMESTAMP_REGEX","asDate","date","Date","String","getTime","asDateOrThrow","valueAsDate","isNull","asError","errorAsString","errorMap","errorAndStackAsString","stack","asConstantOrThrow","expected","parseJson","isNonEmptyArray","nonEmptyArray","addPrefix","attr","key","prefixLower","prefixPascal","projectNames","folders","settings","extensions","recommendations","readWorkspace","workspacePath","workspaceContent","workspaceData","fragData","authenticationData","fileData","optionsData","f1","f2","askForNewWorkspaceFragment","askForWorkspaceUpdate","I_AM_DONE","askForWorkspaceFragments","action","choices","title","newFrags","WorkspaceFragmentTypeToString","workspaceFragmentType","workspaceFragmentIndex","workspaceFragmentString","hasChanged","newFrag","nextNewFrag","askForWorkspaceFragmentUpdate","askForStaticWebsiteFragmentUpdate","askForStandaloneLambdaFragmentUpdate","askForApiLambdaFragmentUpdate","askForWebAppFragmentUpdate","askForNodeScriptFragmentUpdate","attribute","basename","initProject","removeBaseFragments","refreshBaseFragments","needSharedWeb","needSharedNode","catch"],"sourceRoot":""}