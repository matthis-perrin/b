#!/usr/bin/env node --experimental-modules --no-warnings
/*
 * ATTENTION: The "eval" devtool has been used (maybe by default in mode: "development").
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
import { createRequire as __WEBPACK_EXTERNAL_createRequire } from "module";
/******/ var __webpack_modules__ = ([
/* 0 */
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var node_fs_promises__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(1);\n/* harmony import */ var node_fs_promises__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(node_fs_promises__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var node_path__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(2);\n/* harmony import */ var node_path__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(node_path__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var prompts__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(3);\n/* harmony import */ var prompts__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(prompts__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _src_fs__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(4);\n/* harmony import */ var _src_models__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(8);\n/* harmony import */ var _src_project_generate_workspace__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(9);\n/* harmony import */ var _src_project_vscode_workspace__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(21);\n/* harmony import */ var _src_type_utils__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(20);\n\n\n\n\n\n\n\n\nasync function cancel(workspacePath) {\n  console.log('Cancelling...');\n  if (workspacePath !== undefined) {\n    await (0,_src_fs__WEBPACK_IMPORTED_MODULE_3__.rmDir)(workspacePath);\n  }\n  // eslint-disable-next-line node/no-process-exit\n  process.exit(0);\n}\nasync function initProject() {\n  let workspaceName;\n  let workspacePath = process.cwd();\n  const frags = [];\n  const takenNames = ['terraform'];\n  const alreadyGenerated = [];\n\n  // Check if we are already in a workspace\n  const workspaceProjects = await (0,_src_project_vscode_workspace__WEBPACK_IMPORTED_MODULE_6__.readProjectsFromWorkspace)(workspacePath);\n  if (workspaceProjects !== undefined) {\n    workspaceName = (0,node_path__WEBPACK_IMPORTED_MODULE_1__.basename)(workspacePath);\n    for (const project of workspaceProjects) {\n      frags.push(project);\n      const projectNames = (0,_src_project_generate_workspace__WEBPACK_IMPORTED_MODULE_5__.getProjectsFromWorkspaceFragment)(project).map(p => p.projectName);\n      takenNames.push(...projectNames);\n      alreadyGenerated.push(...projectNames);\n    }\n  } else {\n    frags.push({\n      type: _src_models__WEBPACK_IMPORTED_MODULE_4__.WorkspaceFragmentType.Shared\n    });\n    // Ask for workspace name\n    const promptResponse = await (0,prompts__WEBPACK_IMPORTED_MODULE_2__.prompt)({\n      type: 'text',\n      name: 'workspaceName',\n      message: 'Workspace name',\n      validate: v => v.length > 0\n    });\n    workspaceName = promptResponse.workspaceName;\n    if (typeof workspaceName !== 'string') {\n      return cancel();\n    }\n    workspacePath = (0,node_path__WEBPACK_IMPORTED_MODULE_1__.join)(workspacePath, workspaceName);\n    await (0,node_fs_promises__WEBPACK_IMPORTED_MODULE_0__.mkdir)(workspacePath);\n  }\n  try {\n    while (true) {\n      let frag;\n      try {\n        // eslint-disable-next-line no-await-in-loop\n        frag = await askForWorkspaceFragment(takenNames);\n      } catch (err) {\n        console.error(String(err));\n        continue;\n      }\n      if (frag) {\n        frags.push(frag);\n        takenNames.push(...(0,_src_project_generate_workspace__WEBPACK_IMPORTED_MODULE_5__.getProjectsFromWorkspaceFragment)(frag).map(p => p.projectName));\n      } else {\n        break;\n      }\n    }\n    const name = workspaceName;\n    await (0,_src_project_generate_workspace__WEBPACK_IMPORTED_MODULE_5__.generateWorkspace)(workspacePath, name, frags, alreadyGenerated);\n  } catch (err) {\n    console.error(String(err));\n    await cancel(workspaceName);\n  }\n}\nconst WorkspaceFragmentTypeToString = {\n  [_src_models__WEBPACK_IMPORTED_MODULE_4__.WorkspaceFragmentType.WebApp]: 'Web App',\n  [_src_models__WEBPACK_IMPORTED_MODULE_4__.WorkspaceFragmentType.StaticWebsite]: 'Static Website',\n  [_src_models__WEBPACK_IMPORTED_MODULE_4__.WorkspaceFragmentType.StandaloneLambda]: 'Standalone Lambda',\n  [_src_models__WEBPACK_IMPORTED_MODULE_4__.WorkspaceFragmentType.NodeLib]: 'Node Lib',\n  [_src_models__WEBPACK_IMPORTED_MODULE_4__.WorkspaceFragmentType.NodeScript]: 'Node Script'\n};\nasync function askForWorkspaceFragment(takenNames) {\n  const DONE_GENERATING = 'done_generating';\n  const {\n    workspaceFragmentType\n  } = await (0,prompts__WEBPACK_IMPORTED_MODULE_2__.prompt)({\n    type: 'select',\n    name: 'workspaceFragmentType',\n    message: 'Choose a type of project to add to the workspace',\n    choices: [...Object.entries(WorkspaceFragmentTypeToString).map(([value, title]) => ({\n      value,\n      title\n    })), {\n      title: `I'm done`,\n      value: DONE_GENERATING\n    }]\n  });\n  if (workspaceFragmentType === undefined || workspaceFragmentType === DONE_GENERATING) {\n    return undefined;\n  }\n  const type = workspaceFragmentType;\n  if (type === _src_models__WEBPACK_IMPORTED_MODULE_4__.WorkspaceFragmentType.StaticWebsite) {\n    const websiteName = await askForProjectName('Website project name', 'website', takenNames);\n    return {\n      type,\n      websiteName\n    };\n  } else if (type === _src_models__WEBPACK_IMPORTED_MODULE_4__.WorkspaceFragmentType.StandaloneLambda) {\n    const lambdaName = await askForProjectName('Lambda project name', 'lambda', takenNames);\n    return {\n      type,\n      lambdaName\n    };\n  } else if (type === _src_models__WEBPACK_IMPORTED_MODULE_4__.WorkspaceFragmentType.WebApp) {\n    const websiteName = await askForProjectName('Frontend project name', 'frontend', takenNames);\n    const lambdaName = await askForProjectName('Backend project name', 'backend', takenNames);\n    return {\n      type,\n      websiteName,\n      lambdaName\n    };\n  } else if (type === _src_models__WEBPACK_IMPORTED_MODULE_4__.WorkspaceFragmentType.NodeLib) {\n    const libName = await askForProjectName('Lib project name', 'lib', takenNames);\n    return {\n      type,\n      libName\n    };\n    // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n  } else if (type === _src_models__WEBPACK_IMPORTED_MODULE_4__.WorkspaceFragmentType.NodeScript) {\n    const scriptName = await askForProjectName('Script project name', 'script', takenNames);\n    return {\n      type,\n      scriptName\n    };\n  }\n  (0,_src_type_utils__WEBPACK_IMPORTED_MODULE_7__.neverHappens)(type, `Unknown WorkspaceFragmentType \"${type}\"`);\n}\nconst VALID_PROJECT_NAME = /^[a-zA-Z0-9_]+$/u;\nasync function askForProjectName(question, defaultValue, takenNames) {\n  let initial = defaultValue;\n  if (takenNames.includes(initial)) {\n    let index = 2;\n    while (takenNames.includes(initial)) {\n      initial = `${defaultValue}_${index}`;\n      index++;\n    }\n  }\n  const {\n    value\n  } = await (0,prompts__WEBPACK_IMPORTED_MODULE_2__.prompt)({\n    type: 'text',\n    name: 'value',\n    message: question,\n    initial,\n    validate: v => v.length > 0\n  });\n  if (typeof value !== 'string') {\n    throw new Error(`${question} is required`);\n  }\n  if (!VALID_PROJECT_NAME.test(value)) {\n    throw new Error(`Invalid project name \"${value}\". Allowed characters are a-z, A-Z, 0-9 and _`);\n  }\n  if (takenNames.includes(value)) {\n    throw new Error(`${value} is taken`);\n  }\n  return value;\n}\ninitProject().catch(console.error);\n\n//# sourceURL=webpack://b/./src/project/init_project.ts?");

/***/ }),
/* 1 */
/***/ ((module) => {

module.exports = __WEBPACK_EXTERNAL_createRequire(import.meta.url)("node:fs/promises");

/***/ }),
/* 2 */
/***/ ((module) => {

module.exports = __WEBPACK_EXTERNAL_createRequire(import.meta.url)("node:path");

/***/ }),
/* 3 */
/***/ ((module) => {

module.exports = __WEBPACK_EXTERNAL_createRequire(import.meta.url)("prompts");

/***/ }),
/* 4 */
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"access\": () => (/* binding */ access),\n/* harmony export */   \"cleanDir\": () => (/* binding */ cleanDir),\n/* harmony export */   \"cp\": () => (/* binding */ cp),\n/* harmony export */   \"exists\": () => (/* binding */ exists),\n/* harmony export */   \"listFiles\": () => (/* binding */ listFiles),\n/* harmony export */   \"maybeReadFile\": () => (/* binding */ maybeReadFile),\n/* harmony export */   \"readFile\": () => (/* binding */ readFile),\n/* harmony export */   \"readdir\": () => (/* binding */ readdir),\n/* harmony export */   \"rmDir\": () => (/* binding */ rmDir),\n/* harmony export */   \"stat\": () => (/* binding */ stat),\n/* harmony export */   \"writeJsFile\": () => (/* binding */ writeJsFile),\n/* harmony export */   \"writeJsonFile\": () => (/* binding */ writeJsonFile),\n/* harmony export */   \"writeRawFile\": () => (/* binding */ writeRawFile),\n/* harmony export */   \"writeTsFile\": () => (/* binding */ writeTsFile)\n/* harmony export */ });\n/* harmony import */ var node_child_process__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(5);\n/* harmony import */ var node_child_process__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(node_child_process__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var node_fs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(6);\n/* harmony import */ var node_fs__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(node_fs__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var node_path__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(2);\n/* harmony import */ var node_path__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(node_path__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var prettier__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(7);\n/* harmony import */ var prettier__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(prettier__WEBPACK_IMPORTED_MODULE_3__);\n\n\n\n\nconst {\n  access,\n  readFile,\n  readdir,\n  stat\n} = node_fs__WEBPACK_IMPORTED_MODULE_1__.promises;\nconst {\n  writeFile,\n  mkdir,\n  rm\n} = node_fs__WEBPACK_IMPORTED_MODULE_1__.promises;\nasync function writeJsonFile(path, json) {\n  await writeRawFile(path, `${JSON.stringify(json, undefined, 2)}\\n`);\n}\nasync function writePrettyFile(parser, path, code) {\n  await writeRawFile(path, (0,prettier__WEBPACK_IMPORTED_MODULE_3__.format)(code, {\n    parser,\n    printWidth: 100,\n    singleQuote: true,\n    trailingComma: 'es5',\n    bracketSpacing: false,\n    arrowParens: 'avoid',\n    endOfLine: 'auto'\n  }));\n}\nasync function writeJsFile(path, js) {\n  return writePrettyFile('babel', path, js);\n}\nasync function writeTsFile(path, ts) {\n  return writePrettyFile('typescript', path, ts);\n}\nasync function writeRawFile(path, content) {\n  console.log(`write ${path}`);\n  await mkdir((0,node_path__WEBPACK_IMPORTED_MODULE_2__.dirname)(path), {\n    recursive: true\n  });\n  await writeFile(path, content);\n}\nasync function rmDir(dirPath) {\n  await rm(dirPath, {\n    recursive: true,\n    force: true\n  });\n}\nasync function cleanDir(dirPath) {\n  console.log('clean', dirPath);\n  try {\n    await rmDir(dirPath);\n  } finally {\n    await mkdir(dirPath, {\n      recursive: true\n    });\n  }\n}\nasync function cp(from, to) {\n  return new Promise((resolve, reject) => {\n    (0,node_child_process__WEBPACK_IMPORTED_MODULE_0__.exec)(`cp -R ${from} ${to}`, err => err ? reject(err) : resolve());\n  });\n}\nasync function exists(path) {\n  try {\n    await access(path);\n    return true;\n  } catch {\n    return false;\n  }\n}\nasync function maybeReadFile(path) {\n  try {\n    const fileContent = await readFile(path);\n    return fileContent.toString();\n  } catch {\n    return undefined;\n  }\n}\nasync function listFiles(path) {\n  const files = [];\n  const ents = await readdir(path, {\n    withFileTypes: true\n  });\n  const promises = [];\n  for (const ent of ents) {\n    const entPath = (0,node_path__WEBPACK_IMPORTED_MODULE_2__.join)(path, ent.name);\n    if (ent.isDirectory()) {\n      promises.push(listFiles(entPath).then(subFiles => {\n        files.push(...subFiles);\n      }));\n    } else if (ent.isFile()) {\n      files.push(entPath);\n    }\n  }\n  await Promise.all(promises);\n  return files;\n}\n\n//# sourceURL=webpack://b/./src/fs.ts?");

/***/ }),
/* 5 */
/***/ ((module) => {

module.exports = __WEBPACK_EXTERNAL_createRequire(import.meta.url)("node:child_process");

/***/ }),
/* 6 */
/***/ ((module) => {

module.exports = __WEBPACK_EXTERNAL_createRequire(import.meta.url)("node:fs");

/***/ }),
/* 7 */
/***/ ((module) => {

module.exports = __WEBPACK_EXTERNAL_createRequire(import.meta.url)("prettier");

/***/ }),
/* 8 */
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"PROJECT_TYPE_TO_METADATA\": () => (/* binding */ PROJECT_TYPE_TO_METADATA),\n/* harmony export */   \"ProjectType\": () => (/* binding */ ProjectType),\n/* harmony export */   \"RUNTIME_TYPE_TO_METADATA\": () => (/* binding */ RUNTIME_TYPE_TO_METADATA),\n/* harmony export */   \"RuntimeType\": () => (/* binding */ RuntimeType),\n/* harmony export */   \"WorkspaceFragmentType\": () => (/* binding */ WorkspaceFragmentType)\n/* harmony export */ });\n//\n// Runtime types\n//\nlet RuntimeType = /*#__PURE__*/function (RuntimeType) {\n  RuntimeType[\"Web\"] = \"web\";\n  RuntimeType[\"Node\"] = \"node\";\n  RuntimeType[\"Lib\"] = \"lib\";\n  RuntimeType[\"Lambda\"] = \"lambda\";\n  RuntimeType[\"ReactNative\"] = \"react-native\";\n  RuntimeType[\"NodeLib\"] = \"node-lib\";\n  RuntimeType[\"NodeScript\"] = \"node-script\";\n  return RuntimeType;\n}({});\nconst RUNTIME_TYPE_TO_METADATA = {\n  [RuntimeType.Web]: {\n    eslint: RuntimeType.Web,\n    tsconfig: RuntimeType.Web,\n    webpack: RuntimeType.Web\n  },\n  [RuntimeType.Node]: {\n    eslint: RuntimeType.Node,\n    tsconfig: RuntimeType.Node,\n    webpack: RuntimeType.Node\n  },\n  [RuntimeType.Lib]: {\n    eslint: RuntimeType.Lib,\n    tsconfig: RuntimeType.Lib,\n    webpack: RuntimeType.Lib\n  },\n  [RuntimeType.Lambda]: {\n    eslint: RuntimeType.Node,\n    tsconfig: RuntimeType.Node,\n    webpack: RuntimeType.Lambda\n  },\n  [RuntimeType.ReactNative]: {\n    eslint: RuntimeType.ReactNative,\n    tsconfig: RuntimeType.ReactNative\n  },\n  [RuntimeType.NodeLib]: {\n    eslint: RuntimeType.Node,\n    tsconfig: RuntimeType.Node,\n    webpack: RuntimeType.NodeLib\n  },\n  [RuntimeType.NodeScript]: {\n    eslint: RuntimeType.Node,\n    tsconfig: RuntimeType.Node,\n    webpack: RuntimeType.NodeScript\n  }\n};\n\n//\n// Project type\n//\n\nlet ProjectType = /*#__PURE__*/function (ProjectType) {\n  ProjectType[\"Web\"] = \"web\";\n  ProjectType[\"LambdaFunction\"] = \"lambda_function\";\n  ProjectType[\"LambdaApi\"] = \"lambda_api\";\n  ProjectType[\"NodeLib\"] = \"node_lib\";\n  ProjectType[\"NodeScript\"] = \"node_script\";\n  ProjectType[\"Shared\"] = \"shared\";\n  return ProjectType;\n}({});\nconst PROJECT_TYPE_TO_METADATA = {\n  [ProjectType.Web]: {\n    runtimeType: RuntimeType.Web\n  },\n  [ProjectType.LambdaFunction]: {\n    runtimeType: RuntimeType.Lambda\n  },\n  [ProjectType.LambdaApi]: {\n    runtimeType: RuntimeType.Lambda\n  },\n  [ProjectType.NodeLib]: {\n    runtimeType: RuntimeType.NodeLib\n  },\n  [ProjectType.NodeScript]: {\n    runtimeType: RuntimeType.NodeScript\n  },\n  [ProjectType.Shared]: {\n    runtimeType: RuntimeType.Lib\n  }\n};\n\n//\n// Workspace Fragment type\n//\n\nlet WorkspaceFragmentType = /*#__PURE__*/function (WorkspaceFragmentType) {\n  WorkspaceFragmentType[\"StaticWebsite\"] = \"static-website\";\n  WorkspaceFragmentType[\"StandaloneLambda\"] = \"standalone-lambda\";\n  WorkspaceFragmentType[\"WebApp\"] = \"web-app\";\n  WorkspaceFragmentType[\"NodeLib\"] = \"node-lib\";\n  WorkspaceFragmentType[\"NodeScript\"] = \"node-script\";\n  WorkspaceFragmentType[\"Shared\"] = \"shared\";\n  return WorkspaceFragmentType;\n}({});\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nfunction validateRegistry() {\n  return true;\n}\n\n//# sourceURL=webpack://b/./src/models.ts?");

/***/ }),
/* 9 */
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"generateWorkspace\": () => (/* binding */ generateWorkspace),\n/* harmony export */   \"getProjectsFromWorkspaceFragment\": () => (/* binding */ getProjectsFromWorkspaceFragment)\n/* harmony export */ });\n/* harmony import */ var node_child_process__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(5);\n/* harmony import */ var node_child_process__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(node_child_process__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var node_fs_promises__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(1);\n/* harmony import */ var node_fs_promises__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(node_fs_promises__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var node_path__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(2);\n/* harmony import */ var node_path__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(node_path__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var node_url__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(10);\n/* harmony import */ var node_url__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(node_url__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var _src_fs__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(4);\n/* harmony import */ var _src_models__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(8);\n/* harmony import */ var _src_project_generate_project__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(11);\n/* harmony import */ var _src_project_gitignore__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(12);\n/* harmony import */ var _src_project_package_json__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(13);\n/* harmony import */ var _src_project_terraform_all__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(15);\n/* harmony import */ var _src_project_vscode_workspace__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(21);\n/* harmony import */ var _src_type_utils__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(20);\n\n\n\n\n\n\n\n\n\n\n\n\nfunction getProjectsFromWorkspaceFragment(fragment) {\n  if (fragment.type === _src_models__WEBPACK_IMPORTED_MODULE_5__.WorkspaceFragmentType.StaticWebsite) {\n    return [{\n      projectName: fragment.websiteName,\n      type: _src_models__WEBPACK_IMPORTED_MODULE_5__.ProjectType.Web\n    }];\n  } else if (fragment.type === _src_models__WEBPACK_IMPORTED_MODULE_5__.WorkspaceFragmentType.StandaloneLambda) {\n    return [{\n      projectName: fragment.lambdaName,\n      type: _src_models__WEBPACK_IMPORTED_MODULE_5__.ProjectType.LambdaFunction\n    }];\n  } else if (fragment.type === _src_models__WEBPACK_IMPORTED_MODULE_5__.WorkspaceFragmentType.WebApp) {\n    return [{\n      projectName: fragment.websiteName,\n      type: _src_models__WEBPACK_IMPORTED_MODULE_5__.ProjectType.Web\n    }, {\n      projectName: fragment.lambdaName,\n      type: _src_models__WEBPACK_IMPORTED_MODULE_5__.ProjectType.LambdaApi\n    }];\n  } else if (fragment.type === _src_models__WEBPACK_IMPORTED_MODULE_5__.WorkspaceFragmentType.NodeLib) {\n    return [{\n      projectName: fragment.libName,\n      type: _src_models__WEBPACK_IMPORTED_MODULE_5__.ProjectType.NodeLib\n    }];\n  } else if (fragment.type === _src_models__WEBPACK_IMPORTED_MODULE_5__.WorkspaceFragmentType.NodeScript) {\n    return [{\n      projectName: fragment.scriptName,\n      type: _src_models__WEBPACK_IMPORTED_MODULE_5__.ProjectType.NodeScript\n    }];\n    // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n  } else if (fragment.type === _src_models__WEBPACK_IMPORTED_MODULE_5__.WorkspaceFragmentType.Shared) {\n    return [{\n      projectName: 'shared',\n      type: _src_models__WEBPACK_IMPORTED_MODULE_5__.ProjectType.Shared\n    }];\n  }\n  (0,_src_type_utils__WEBPACK_IMPORTED_MODULE_11__.neverHappens)(fragment, `Unknown ProjectType ${fragment.type}`);\n}\nasync function generateWorkspace(dst, workspaceName, workspaceFragments, alreadyGenerated) {\n  const projects = workspaceFragments.flatMap(getProjectsFromWorkspaceFragment);\n\n  // Create projects files from templates\n  await Promise.all(projects.filter(p => !alreadyGenerated.includes(p.projectName)).map(async project => (0,_src_project_generate_project__WEBPACK_IMPORTED_MODULE_6__.generateProject)((0,node_path__WEBPACK_IMPORTED_MODULE_2__.join)(dst, project.projectName), project)));\n\n  // Generate workspace root files\n  const SCRIPTS_PATH = (0,node_path__WEBPACK_IMPORTED_MODULE_2__.join)((0,node_url__WEBPACK_IMPORTED_MODULE_3__.fileURLToPath)(import.meta.url), '../scripts');\n  await Promise.all([\n  // package.json\n  await (0,_src_fs__WEBPACK_IMPORTED_MODULE_4__.writeJsonFile)((0,node_path__WEBPACK_IMPORTED_MODULE_2__.join)(dst, 'package.json'), (0,_src_project_package_json__WEBPACK_IMPORTED_MODULE_8__.generateWorkspacePackageJson)(workspaceName, projects)),\n  // .gitignore\n  await (0,_src_fs__WEBPACK_IMPORTED_MODULE_4__.writeRawFile)((0,node_path__WEBPACK_IMPORTED_MODULE_2__.join)(dst, '.gitignore'), (0,_src_project_gitignore__WEBPACK_IMPORTED_MODULE_7__.generateGitIgnore)()),\n  // app.code-workspace\n  await (0,_src_fs__WEBPACK_IMPORTED_MODULE_4__.writeJsonFile)((0,node_path__WEBPACK_IMPORTED_MODULE_2__.join)(dst, 'app.code-workspace'), (0,_src_project_vscode_workspace__WEBPACK_IMPORTED_MODULE_10__.generateCodeWorkspace)(workspaceFragments)),\n  // setup.js\n  await (0,node_fs_promises__WEBPACK_IMPORTED_MODULE_1__.cp)((0,node_path__WEBPACK_IMPORTED_MODULE_2__.join)(SCRIPTS_PATH, 'setup.js'), (0,node_path__WEBPACK_IMPORTED_MODULE_2__.join)(dst, 'setup.js')),\n  // deploy.js\n  await (0,node_fs_promises__WEBPACK_IMPORTED_MODULE_1__.cp)((0,node_path__WEBPACK_IMPORTED_MODULE_2__.join)(SCRIPTS_PATH, 'deploy.js'), (0,node_path__WEBPACK_IMPORTED_MODULE_2__.join)(dst, 'deploy.js')),\n  // build.js\n  await (0,node_fs_promises__WEBPACK_IMPORTED_MODULE_1__.cp)((0,node_path__WEBPACK_IMPORTED_MODULE_2__.join)(SCRIPTS_PATH, 'build.js'), (0,node_path__WEBPACK_IMPORTED_MODULE_2__.join)(dst, 'build.js'))]);\n\n  // Terraform folder generation\n  const terraformPath = (0,node_path__WEBPACK_IMPORTED_MODULE_2__.join)(dst, 'terraform');\n  await Promise.all([(0,_src_fs__WEBPACK_IMPORTED_MODULE_4__.writeRawFile)((0,node_path__WEBPACK_IMPORTED_MODULE_2__.join)(terraformPath, 'base.tf'), (0,_src_project_terraform_all__WEBPACK_IMPORTED_MODULE_9__.generateCommonTerraform)(workspaceName, projects)), ...projects.map(async p => {\n    const content = (0,_src_project_terraform_all__WEBPACK_IMPORTED_MODULE_9__.generateWorkspaceProjectTerraform)(workspaceName, p);\n    if (content === undefined) {\n      return;\n    }\n    const name = `${p.projectName}_terraform`;\n    await (0,_src_fs__WEBPACK_IMPORTED_MODULE_4__.writeRawFile)((0,node_path__WEBPACK_IMPORTED_MODULE_2__.join)(terraformPath, `${name}.tf`), content);\n  })]);\n\n  // Run setup.js\n  console.log('Running post install script');\n  const commands = [`cd ${dst}`, `node setup.js`, `git init`];\n  (0,node_child_process__WEBPACK_IMPORTED_MODULE_0__.execSync)(commands.join(' && '), {\n    stdio: ['ignore', 'inherit', 'inherit']\n  });\n}\n\n//# sourceURL=webpack://b/./src/project/generate_workspace.ts?");

/***/ }),
/* 10 */
/***/ ((module) => {

module.exports = __WEBPACK_EXTERNAL_createRequire(import.meta.url)("node:url");

/***/ }),
/* 11 */
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"generateProject\": () => (/* binding */ generateProject)\n/* harmony export */ });\n/* harmony import */ var node_child_process__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(5);\n/* harmony import */ var node_child_process__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(node_child_process__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var node_fs_promises__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(1);\n/* harmony import */ var node_fs_promises__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(node_fs_promises__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var node_path__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(2);\n/* harmony import */ var node_path__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(node_path__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var node_url__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(10);\n/* harmony import */ var node_url__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(node_url__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var _src_fs__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(4);\n/* harmony import */ var _src_models__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(8);\n\n\n\n\n\n\nconst TEMPLATES_PATH = (0,node_path__WEBPACK_IMPORTED_MODULE_2__.join)((0,node_url__WEBPACK_IMPORTED_MODULE_3__.fileURLToPath)(import.meta.url), '../templates');\nasync function generateProject(dst, project) {\n  const {\n    projectName,\n    type\n  } = project;\n  // Copy template files\n  await (0,_src_fs__WEBPACK_IMPORTED_MODULE_4__.cp)((0,node_path__WEBPACK_IMPORTED_MODULE_2__.join)(TEMPLATES_PATH, type), dst);\n\n  // Replace name in package.json\n  const packageJsonPath = (0,node_path__WEBPACK_IMPORTED_MODULE_2__.join)(dst, 'package.json');\n  const packageJsonbuffer = await (0,_src_fs__WEBPACK_IMPORTED_MODULE_4__.readFile)(packageJsonPath);\n  const packageJson = JSON.parse(packageJsonbuffer.toString());\n  packageJson['name'] = projectName;\n  await (0,_src_fs__WEBPACK_IMPORTED_MODULE_4__.writeJsonFile)(packageJsonPath, packageJson);\n\n  // Replace variables\n  const files = await (0,_src_fs__WEBPACK_IMPORTED_MODULE_4__.listFiles)(dst);\n  await Promise.all(files.map(async file => {\n    const buffer = await (0,_src_fs__WEBPACK_IMPORTED_MODULE_4__.readFile)(file);\n    const content = buffer.toString();\n    const newContent = content.replaceAll('{{PROJECT_NAME}}', projectName);\n    if (newContent !== content) {\n      await (0,node_fs_promises__WEBPACK_IMPORTED_MODULE_1__.writeFile)(file, newContent);\n    }\n  }));\n\n  // Post generation script for React Native project\n  if (_src_models__WEBPACK_IMPORTED_MODULE_5__.PROJECT_TYPE_TO_METADATA[type].runtimeType === _src_models__WEBPACK_IMPORTED_MODULE_5__.RuntimeType.ReactNative) {\n    console.log('Running post install script');\n    const commands = [`pushd ${dst}`, `npx --yes react-native init ${projectName}`, `mv ${projectName}/ios .`, `mv ${projectName}/android .`, `rm -rf ${projectName}`, `popd`];\n    (0,node_child_process__WEBPACK_IMPORTED_MODULE_0__.execSync)(commands.join(' && '));\n  }\n}\n\n//# sourceURL=webpack://b/./src/project/generate_project.ts?");

/***/ }),
/* 12 */
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"generateGitIgnore\": () => (/* binding */ generateGitIgnore)\n/* harmony export */ });\nfunction generateGitIgnore() {\n  return `\n.DS_Store\nnode_modules\nbuild\ndist\ntmp\nyarn-error.log\n.yarn-warnings.log\nyarn.lock\nterraform/.terraform\nterraform/.terraform*\nterraform/*.tfstate.backup\nterraform/.aws-credentials\nterraform/archives\n*/log\n    `.trim();\n}\n\n//# sourceURL=webpack://b/./src/project/gitignore.ts?");

/***/ }),
/* 13 */
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"generateWorkspacePackageJson\": () => (/* binding */ generateWorkspacePackageJson)\n/* harmony export */ });\n/* harmony import */ var _src_models__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(8);\n/* harmony import */ var _src_versions__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(14);\n\n\nfunction uniq(runtimes) {\n  return [...new Set(runtimes.filter(r => r !== undefined)).values()];\n}\nfunction projectMetadata(p) {\n  return _src_models__WEBPACK_IMPORTED_MODULE_0__.RUNTIME_TYPE_TO_METADATA[_src_models__WEBPACK_IMPORTED_MODULE_0__.PROJECT_TYPE_TO_METADATA[p.type].runtimeType];\n}\nfunction generateWorkspacePackageJson(workspaceName, projects) {\n  const eslintRuntimes = uniq(projects.map(p => projectMetadata(p).eslint));\n  const tsconfigRuntimes = uniq(projects.map(p => projectMetadata(p).tsconfig));\n  const webpackRuntimes = uniq(projects.map(p => projectMetadata(p).webpack));\n  return {\n    name: workspaceName,\n    license: 'UNLICENSED',\n    type: 'module',\n    scripts: {\n      setup: 'node ./setup.js',\n      deploy: 'node ./deploy.js',\n      build: 'node ./build.js',\n      watch: 'node ./build.js --watch'\n    },\n    eslintConfig: {\n      ignorePatterns: ['**/*.js']\n    },\n    prettier: '@matthis/prettier-config',\n    devDependencies: Object.fromEntries([...eslintRuntimes.map(runtime => [`@matthis/eslint-config-${runtime}`, _src_versions__WEBPACK_IMPORTED_MODULE_1__.PACKAGE_VERSIONS.eslint]), ['@matthis/prettier-config', _src_versions__WEBPACK_IMPORTED_MODULE_1__.PACKAGE_VERSIONS.prettier], ...tsconfigRuntimes.map(runtime => [`@matthis/tsconfig-${runtime}`, _src_versions__WEBPACK_IMPORTED_MODULE_1__.PACKAGE_VERSIONS.tsconfig]), ...webpackRuntimes.map(runtime => [`@matthis/webpack-${runtime}`, _src_versions__WEBPACK_IMPORTED_MODULE_1__.PACKAGE_VERSIONS.webpack]), ['@matthis/webpack-runner', _src_versions__WEBPACK_IMPORTED_MODULE_1__.PACKAGE_VERSIONS.runner], ['typescript', _src_versions__WEBPACK_IMPORTED_MODULE_1__.TYPESCRIPT_VERSION]].sort((d1, d2) => d1[0].localeCompare(d2[0])))\n  };\n}\n\n//# sourceURL=webpack://b/./src/project/package_json.ts?");

/***/ }),
/* 14 */
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"ESLINT_VERSION\": () => (/* binding */ ESLINT_VERSION),\n/* harmony export */   \"LIB_VERSIONS\": () => (/* binding */ LIB_VERSIONS),\n/* harmony export */   \"PACKAGE_VERSIONS\": () => (/* binding */ PACKAGE_VERSIONS),\n/* harmony export */   \"PRETTIER_VERSION\": () => (/* binding */ PRETTIER_VERSION),\n/* harmony export */   \"TYPESCRIPT_VERSION\": () => (/* binding */ TYPESCRIPT_VERSION)\n/* harmony export */ });\nconst PACKAGE_VERSIONS = {\n  project: '1.3.23',\n  eslint: '1.1.4',\n  prettier: '1.1.1',\n  tsconfig: '1.1.7',\n  webpack: '1.2.16',\n  runner: '1.1.11'\n};\nconst ESLINT_VERSION = '8.23.x';\nconst PRETTIER_VERSION = '2.7.x';\nconst TYPESCRIPT_VERSION = '4.8.x';\n\n/* eslint-disable @typescript-eslint/naming-convention */\nconst LIB_VERSIONS = {\n  '@types/react': '17.0.x',\n  '@types/react-dom': '17.0.x',\n  react: '17.0.x',\n  'react-dom': '17.0.x',\n  '@types/react-native': '0.66.x',\n  'react-native': '0.66.x',\n  '@types/styled-components': '5.1.x',\n  'styled-components': '5.1.x',\n  'react-router': '5.2.x',\n  'react-router-dom': '5.2.x'\n};\n/* eslint-enable @typescript-eslint/naming-convention */\n\n//# sourceURL=webpack://b/./src/versions.ts?");

/***/ }),
/* 15 */
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"generateCommonTerraform\": () => (/* binding */ generateCommonTerraform),\n/* harmony export */   \"generateWorkspaceProjectTerraform\": () => (/* binding */ generateWorkspaceProjectTerraform)\n/* harmony export */ });\n/* harmony import */ var _src_models__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(8);\n/* harmony import */ var _src_project_terraform_cloudfront__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(16);\n/* harmony import */ var _src_project_terraform_lambda__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(17);\n/* harmony import */ var _src_project_terraform_provider__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(18);\n/* harmony import */ var _src_project_terraform_s3__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(19);\n/* harmony import */ var _src_type_utils__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(20);\n\n\n\n\n\n\nfunction generateCommonTerraform(workspaceName, projects) {\n  return [(0,_src_project_terraform_provider__WEBPACK_IMPORTED_MODULE_3__.generateAwsProviderTerraform)(workspaceName), (0,_src_project_terraform_s3__WEBPACK_IMPORTED_MODULE_4__.generateS3BucketTerraform)(workspaceName, projects.filter(p => _src_models__WEBPACK_IMPORTED_MODULE_0__.PROJECT_TYPE_TO_METADATA[p.type].runtimeType === _src_models__WEBPACK_IMPORTED_MODULE_0__.RuntimeType.Web).map(p => p.projectName))].join('\\n\\n');\n}\nfunction generateWorkspaceProjectTerraform(workspaceName, project) {\n  const {\n    projectName,\n    type\n  } = project;\n  if (type === _src_models__WEBPACK_IMPORTED_MODULE_0__.ProjectType.Web) {\n    return (0,_src_project_terraform_cloudfront__WEBPACK_IMPORTED_MODULE_1__.generateCloudfrontDistributionTerraform)(workspaceName, projectName);\n  } else if (type === _src_models__WEBPACK_IMPORTED_MODULE_0__.ProjectType.LambdaFunction) {\n    return (0,_src_project_terraform_lambda__WEBPACK_IMPORTED_MODULE_2__.generateLambdaTerraform)(workspaceName, projectName, {\n      api: false\n    });\n  } else if (type === _src_models__WEBPACK_IMPORTED_MODULE_0__.ProjectType.LambdaApi) {\n    return (0,_src_project_terraform_lambda__WEBPACK_IMPORTED_MODULE_2__.generateLambdaTerraform)(workspaceName, projectName, {\n      api: true\n    });\n  } else if (type === _src_models__WEBPACK_IMPORTED_MODULE_0__.ProjectType.NodeLib) {\n    return undefined;\n  } else if (type === _src_models__WEBPACK_IMPORTED_MODULE_0__.ProjectType.NodeScript) {\n    return undefined;\n    // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n  } else if (type === _src_models__WEBPACK_IMPORTED_MODULE_0__.ProjectType.Shared) {\n    return undefined;\n  }\n  (0,_src_type_utils__WEBPACK_IMPORTED_MODULE_5__.neverHappens)(type, 'ProjectType');\n}\n\n//# sourceURL=webpack://b/./src/project/terraform/all.ts?");

/***/ }),
/* 16 */
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"generateCloudfrontDistributionTerraform\": () => (/* binding */ generateCloudfrontDistributionTerraform)\n/* harmony export */ });\nfunction generateCloudfrontDistributionTerraform(workspaceName, projectName) {\n  const bucketName = projectName.toLowerCase().replace(/[^\\d.a-z-]+/gu, '-');\n  const originId = `${bucketName}-origin-id`;\n  return `\nresource \"aws_cloudfront_distribution\" \"${projectName}\" {\n  origin {\n    domain_name = aws_s3_bucket.code.bucket_regional_domain_name\n    origin_id   = \"${originId}\"\n    origin_path = \"/${projectName}\"\n\n    s3_origin_config {\n      origin_access_identity = aws_cloudfront_origin_access_identity.${projectName}.cloudfront_access_identity_path\n    }\n  }\n  \n  enabled             = true\n  wait_for_deployment = false\n  is_ipv6_enabled     = true\n  price_class         = \"PriceClass_100\"\n  \n  default_root_object   = \"/index.html\"\n  custom_error_response {\n    error_code         = 400\n    response_code      = 200\n    response_page_path = \"/index.html\"\n  }\n  custom_error_response {\n    error_code         = 403\n    response_code      = 200\n    response_page_path = \"/index.html\"\n  }\n  custom_error_response {\n    error_code         = 404\n    response_code      = 200\n    response_page_path = \"/index.html\"\n  }\n\n  default_cache_behavior {\n    allowed_methods  = [\"HEAD\", \"GET\"]\n    cached_methods   = [\"HEAD\", \"GET\"]\n    compress         = true\n    target_origin_id = \"${originId}\"\n    viewer_protocol_policy = \"redirect-to-https\"\n    \n    forwarded_values {\n      query_string = false\n      cookies {\n        forward = \"none\"\n      }\n    }\n  }\n\n  restrictions {\n    geo_restriction {\n      restriction_type = \"none\"\n    }\n  }\n\n  viewer_certificate {\n    cloudfront_default_certificate = true\n  }\n}\n\nresource \"aws_cloudfront_origin_access_identity\" \"${projectName}\" {}\n  `.trim();\n}\n\n//# sourceURL=webpack://b/./src/project/terraform/cloudfront.ts?");

/***/ }),
/* 17 */
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"generateLambdaTerraform\": () => (/* binding */ generateLambdaTerraform)\n/* harmony export */ });\nfunction generateLambdaTerraform(workspaceName, projectName, opts) {\n  const {\n    api\n  } = opts;\n  return `\n# Define any extra role for the lambda here\ndata \"aws_iam_policy_document\" \"${projectName}_lambda_extra_role\" {\n  statement {\n    actions   = [\"s3:ListAllMyBuckets\"]\n    resources = [\"*\"]\n  }\n}\n\nresource \"aws_s3_object\" \"${projectName}_archive\" {\n  bucket       = aws_s3_bucket.code.id\n  key          = \"${projectName}/dist.zip\"\n  content_base64 = \"UEsDBBQACAAIAGaKwlYAAAAAAAAAADYAAAAIACAAaW5kZXguanNVVA0AB3AIemRyCHpkcAh6ZHV4CwABBPUBAAAEFAAAAEutKMgvKinWy0jMS8lJLVKwVUgsrsxLVkgrzUsuyczPU9DQVKjmUlAoSi0pLcpTUFe35qq15gIAUEsHCP0ak1o4AAAANgAAAFBLAQIUAxQACAAIAGaKwlb9GpNaOAAAADYAAAAIACAAAAAAAAAAAACkgQAAAABpbmRleC5qc1VUDQAHcAh6ZHIIemRwCHpkdXgLAAEE9QEAAAQUAAAAUEsFBgAAAAABAAEAVgAAAI4AAAAAAA==\"\n}\n\nresource \"aws_lambda_function\" \"${projectName}\" {\n  function_name     = \"${workspaceName}-${projectName}\"\n  s3_bucket         = aws_s3_object.${projectName}_archive.bucket\n  s3_key            = aws_s3_object.${projectName}_archive.key\n  handler           = \"index.handler\"\n  runtime           = \"nodejs14.x\"\n  role              = aws_iam_role.${projectName}_lambda_exec.arn\n}\n\noutput \"${projectName}_function_name\" {\n  value       = aws_lambda_function.${projectName}.function_name\n  description = \"Function name of the \\\\\"${workspaceName}-${projectName}\\\\\" lambda\"\n}\n\n${api ? `\nresource \"aws_lambda_function_url\" \"${projectName}\" {\n  function_name      = aws_lambda_function.${projectName}.function_name\n  authorization_type = \"NONE\"\n}\n\noutput \"${projectName}_function_url\" {\n  value       = aws_lambda_function_url.${projectName}.function_url\n  description = \"Function url of the \\\\\"${workspaceName}-${projectName}\\\\\" lambda\"\n}\n`.trim() : ''}\n\nresource \"aws_iam_role\" \"${projectName}_lambda_exec\" {\n  name = \"${workspaceName}-${projectName}-assume-role\"\n  assume_role_policy = jsonencode({\n    Version = \"2012-10-17\"\n    Statement = [\n      {\n        Action    = \"sts:AssumeRole\"\n        Principal = {\n          Service = \"lambda.amazonaws.com\"\n        }\n        Effect    = \"Allow\"\n        Sid       = \"\"\n      },\n    ]\n  })\n\n  inline_policy {\n    name = \"${workspaceName}-${projectName}-cloudwatch-role\"\n    policy = jsonencode({\n      Version = \"2012-10-17\"\n      Statement = [\n        {\n          Action   = [\n            \"logs:CreateLogGroup\",\n            \"logs:CreateLogStream\",\n            \"logs:PutLogEvents\"\n          ]\n          Effect   = \"Allow\"\n          Resource = \"arn:aws:logs:*:*:*\"\n        },\n      ]\n    })\n  }\n  \n  inline_policy {\n    name = \"${workspaceName}-${projectName}-extra-role\"\n    policy = data.aws_iam_policy_document.${projectName}_lambda_extra_role.json\n  }\n}\n`.trim();\n}\n\n//# sourceURL=webpack://b/./src/project/terraform/lambda.ts?");

/***/ }),
/* 18 */
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"generateAwsProviderTerraform\": () => (/* binding */ generateAwsProviderTerraform)\n/* harmony export */ });\nfunction generateAwsProviderTerraform(workspaceName) {\n  return `\nterraform {\n  required_providers {\n    aws = {\n      source  = \"hashicorp/aws\"\n      version = \"~> 5.1\"\n    }\n  }\n}\n\nprovider \"aws\" {\n  region  = \"eu-west-3\"\n  shared_credentials_files = [\"./.aws-credentials\"]\n  default_tags {\n    tags = {\n      Project = \"${workspaceName}\"\n    }\n  }\n}\n\ndata \"aws_region\" \"current\" {}\noutput \"region\" {\n  value = data.aws_region.current.id\n}\n`.trim();\n}\n\n//# sourceURL=webpack://b/./src/project/terraform/provider.ts?");

/***/ }),
/* 19 */
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"generateS3BucketTerraform\": () => (/* binding */ generateS3BucketTerraform)\n/* harmony export */ });\nfunction generateS3BucketTerraform(workspaceName, webProjectNames) {\n  const bucketName = workspaceName.toLowerCase().replace(/[^a-z0-9.-]+/gu, '-');\n  const CODE_BUCKET = `\nresource \"aws_s3_bucket\" \"code\" {\n  bucket_prefix = \"${bucketName}-\"\n}\n\noutput \"code_bucket\" {\n  value = aws_s3_bucket.code.id\n}\n`.trim();\n  const CLOUDFRONT_ACCESS = `\ndata \"aws_iam_policy_document\" \"cloudfront_access_to_code\" {\n  ${webProjectNames.map(p => `\n  statement {\n    actions   = [\"s3:GetObject\"]\n    resources = [\n      \"\\${aws_s3_bucket.code.arn}/${p}/*\",\n    ]\n    principals {\n      type        = \"AWS\"\n      identifiers = [aws_cloudfront_origin_access_identity.${p}.iam_arn]\n    }\n  }\n`.trim()).join('\\n\\n')}\n}\n\nresource \"aws_s3_bucket_policy\" \"code\" {\n  bucket = aws_s3_bucket.code.id\n  policy = data.aws_iam_policy_document.cloudfront_access_to_code.json\n}\n`.trim();\n  const out = [CODE_BUCKET];\n  if (webProjectNames.length > 0) {\n    out.push(CLOUDFRONT_ACCESS);\n  }\n  return out.join('\\n\\n');\n}\n\n//# sourceURL=webpack://b/./src/project/terraform/s3.ts?");

/***/ }),
/* 20 */
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"neverHappens\": () => (/* binding */ neverHappens)\n/* harmony export */ });\nfunction neverHappens(value, msg) {\n  throw new Error(msg ?? `Unexpected value ${value}`);\n}\n\n//# sourceURL=webpack://b/./src/type_utils.ts?");

/***/ }),
/* 21 */
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"generateCodeWorkspace\": () => (/* binding */ generateCodeWorkspace),\n/* harmony export */   \"readProjectsFromWorkspace\": () => (/* binding */ readProjectsFromWorkspace)\n/* harmony export */ });\n/* harmony import */ var node_path__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(2);\n/* harmony import */ var node_path__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(node_path__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _src_fs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(4);\n/* harmony import */ var _src_project_generate_workspace__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(9);\n\n\n\nfunction generateCodeWorkspace(workspaceFragments) {\n  const projects = workspaceFragments.flatMap(_src_project_generate_workspace__WEBPACK_IMPORTED_MODULE_2__.getProjectsFromWorkspaceFragment);\n  const projectNames = projects.map(p => p.projectName);\n  return {\n    projects: workspaceFragments,\n    folders: [...projectNames.map(p => ({\n      path: p\n    })), {\n      path: 'terraform'\n    }, {\n      path: '.',\n      name: 'root'\n    }],\n    settings: {\n      /* eslint-disable @typescript-eslint/naming-convention */\n      'files.exclude': Object.fromEntries([...projectNames.map(p => [p, true]), ['terraform', true]]),\n      'editor.acceptSuggestionOnCommitCharacter': false,\n      'editor.suggestSelection': 'first',\n      'vsintellicode.modify.editor.suggestSelection': 'automaticallyOverrodeDefaultValue',\n      'explorer.confirmDelete': false,\n      'git.autofetch': true,\n      'git.confirmSync': false,\n      'typescript.preferences.importModuleSpecifier': 'non-relative',\n      'eslint.lintTask.enable': true,\n      'eslint.useESLintClass': true,\n      'eslint.options': {\n        reportUnusedDisableDirectives: 'warn'\n      },\n      'editor.formatOnSave': true,\n      'editor.codeActionsOnSave': {\n        'source.fixAll': false,\n        'source.fixAll.eslint': true\n      },\n      'editor.defaultFormatter': 'esbenp.prettier-vscode',\n      'emmet.showExpandedAbbreviation': 'never'\n      /* eslint-enable @typescript-eslint/naming-convention, no-null/no-null */\n    },\n\n    extensions: {\n      recommendations: ['dbaeumer.vscode-eslint', 'esbenp.prettier-vscode', 'VisualStudioExptTeam.vscodeintellicode', 'styled-components.vscode-styled-components', 'naumovs.color-highlight', 'eamodio.gitlens']\n    }\n  };\n}\nasync function readProjectsFromWorkspace(workspacePath) {\n  const workspaceContent = await (0,_src_fs__WEBPACK_IMPORTED_MODULE_1__.maybeReadFile)((0,node_path__WEBPACK_IMPORTED_MODULE_0__.join)(workspacePath, 'app.code-workspace'));\n  const workspaceJson = workspaceContent === undefined ? {} : JSON.parse(workspaceContent);\n  const workspaceProjects = Array.isArray(workspaceJson.projects) ? workspaceJson.projects : undefined;\n  return workspaceProjects;\n}\n\n//# sourceURL=webpack://b/./src/project/vscode_workspace.ts?");

/***/ })
/******/ ]);
/************************************************************************/
/******/ // The module cache
/******/ var __webpack_module_cache__ = {};
/******/ 
/******/ // The require function
/******/ function __webpack_require__(moduleId) {
/******/ 	// Check if module is in cache
/******/ 	var cachedModule = __webpack_module_cache__[moduleId];
/******/ 	if (cachedModule !== undefined) {
/******/ 		return cachedModule.exports;
/******/ 	}
/******/ 	// Create a new module (and put it into the cache)
/******/ 	var module = __webpack_module_cache__[moduleId] = {
/******/ 		// no module.id needed
/******/ 		// no module.loaded needed
/******/ 		exports: {}
/******/ 	};
/******/ 
/******/ 	// Execute the module function
/******/ 	__webpack_modules__[moduleId](module, module.exports, __webpack_require__);
/******/ 
/******/ 	// Return the exports of the module
/******/ 	return module.exports;
/******/ }
/******/ 
/************************************************************************/
/******/ /* webpack/runtime/compat get default export */
/******/ (() => {
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = (module) => {
/******/ 		var getter = module && module.__esModule ?
/******/ 			() => (module['default']) :
/******/ 			() => (module);
/******/ 		__webpack_require__.d(getter, { a: getter });
/******/ 		return getter;
/******/ 	};
/******/ })();
/******/ 
/******/ /* webpack/runtime/define property getters */
/******/ (() => {
/******/ 	// define getter functions for harmony exports
/******/ 	__webpack_require__.d = (exports, definition) => {
/******/ 		for(var key in definition) {
/******/ 			if(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {
/******/ 				Object.defineProperty(exports, key, { enumerable: true, get: definition[key] });
/******/ 			}
/******/ 		}
/******/ 	};
/******/ })();
/******/ 
/******/ /* webpack/runtime/hasOwnProperty shorthand */
/******/ (() => {
/******/ 	__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))
/******/ })();
/******/ 
/******/ /* webpack/runtime/make namespace object */
/******/ (() => {
/******/ 	// define __esModule on exports
/******/ 	__webpack_require__.r = (exports) => {
/******/ 		if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 			Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 		}
/******/ 		Object.defineProperty(exports, '__esModule', { value: true });
/******/ 	};
/******/ })();
/******/ 
/************************************************************************/
/******/ 
/******/ // startup
/******/ // Load entry module and return exports
/******/ // This entry module can't be inlined because the eval devtool is used.
/******/ var __webpack_exports__ = __webpack_require__(0);
/******/ 
