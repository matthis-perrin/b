{"version":3,"file":"index.js","mappings":"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;AACA;AACA;AACA,4BAA4BA,WAAY;AACxC;AACA,oBAAoBA,WAAY;AAChC;AACA;AACA;AACA,kCAAkCA,WAAY;AAC9C,yBAAyBS,aAAc,IAAGT,WAAY;AACtD,sCAAsCA,WAAY;AAClD,sCAAsCA,WAAY;AAClD;AACA;AACA,qCAAqCA,WAAY;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAUA,WAAY;AACtB,sCAAsCA,WAAY;AAClD,2CAA2CS,aAAc,IAAGT,WAAY;AACxE;AACA;AACA,EACEyE,GAAG,GACE;AACP,sCAAsCzE,WAAY;AAClD,6CAA6CA,WAAY;AACzD;AACA;AACA;AACA,UAAUA,WAAY;AACtB,0CAA0CA,WAAY;AACtD,0CAA0CS,aAAc,IAAGT,WAAY;AACvE;AACA,CAAC,CAACmC,IAAI,CAAC,CAAC,GACF,EACL;AACD;AACA,2BAA2BnC,WAAY;AACvC,YAAYS,aAAc,IAAGT,WAAY;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAcS,aAAc,IAAGT,WAAY;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAcS,aAAc,IAAGT,WAAY;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAcS,aAAc,IAAGT,WAAY;AAC3C,4CAA4CA,WAAY;AACxD;AACA;AACA,CAAC,CAACmC,IAAI,CAAC,CAAC;AACR;;;;;;;;;;ACnHO,SAASoC,4BAA4BA,CAAC9D,aAA4B,EAAU;EACjF,OAAQ;AACV;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmBA,aAAc;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,CAAC0B,IAAI,CAAC,CAAC;AACR;;;;;;;;;;AC1BO,SAASqC,yBAAyBA,CACvC/D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","sources":["webpack://b/external node-commonjs \"node:path\"","webpack://b/external node-commonjs \"ansi-colors\"","webpack://b/external node-commonjs \"webpack\"","webpack://b/external node-commonjs \"webpack-dev-server\"","webpack://b/./src/exit_handler.ts","webpack://b/./src/global_error.ts","webpack://b/external node-commonjs \"node:fs\"","webpack://b/./src/fs.ts","webpack://b/external node-commonjs \"node:child_process\"","webpack://b/external node-commonjs \"prettier\"","webpack://b/./src/models.ts","webpack://b/./src/project/generate_workspace.ts","webpack://b/external node-commonjs \"node:fs/promises\"","webpack://b/external node-commonjs \"node:url\"","webpack://b/./src/project/generate_project.ts","webpack://b/./src/project/gitignore.ts","webpack://b/./src/project/package_json.ts","webpack://b/./src/versions.ts","webpack://b/./src/project/terraform/all.ts","webpack://b/./src/project/terraform/cloudfront.ts","webpack://b/./src/project/terraform/lambda.ts","webpack://b/./src/project/terraform/provider.ts","webpack://b/./src/project/terraform/s3.ts","webpack://b/./src/type_utils.ts","webpack://b/./src/project/vscode_workspace.ts","webpack://b/./src/webpack-runner/env_definition_file.ts","webpack://b/./src/webpack/utils.ts","webpack://b/external node-commonjs \"node:crypto\"","webpack://b/./src/webpack-runner/error_grouper.ts","webpack://b/./src/webpack-runner/error_parser.ts","webpack://b/./src/webpack-runner/line_reader.ts","webpack://b/./src/webpack-runner/renderer.ts","webpack://b/./src/webpack-runner/error_formatter.ts","webpack://b/./src/webpack-runner/text_table.ts","webpack://b/webpack/bootstrap","webpack://b/webpack/runtime/compat get default export","webpack://b/webpack/runtime/define property getters","webpack://b/webpack/runtime/hasOwnProperty shorthand","webpack://b/webpack/runtime/make namespace object","webpack://b/./src/webpack-runner/runner.ts"],"sourcesContent":["module.exports = __WEBPACK_EXTERNAL_createRequire(import.meta.url)(\"node:path\");","module.exports = __WEBPACK_EXTERNAL_createRequire(import.meta.url)(\"ansi-colors\");","module.exports = __WEBPACK_EXTERNAL_createRequire(import.meta.url)(\"webpack\");","module.exports = __WEBPACK_EXTERNAL_createRequire(import.meta.url)(\"webpack-dev-server\");","import {globalError} from '@src/global_error';\n\nlet called = false;\nconst callbacks: (() => void | Promise<void>)[] = [];\n\nfunction runCallbacks(): void {\n  if (called) {\n    return;\n  }\n  called = true;\n  for (const fn of callbacks) {\n    Promise.resolve(fn()).catch(err => globalError('Failure to run exit cleanup callback', err));\n  }\n}\n\nprocess.on('beforeExit', () => runCallbacks());\nprocess.on('exit', () => runCallbacks());\nprocess.on('SIGTERM', () => runCallbacks());\nprocess.on('SIGINT', () => runCallbacks());\nprocess.on('uncaughtException', err => {\n  globalError('uncaughtException', err);\n  runCallbacks();\n});\n\nexport function registerExitCallback(cb: () => void | Promise<void>): void {\n  callbacks.push(cb);\n}\n","import {appendFileSync} from 'node:fs';\n\nexport function globalError(...val: unknown[]): void {\n  for (const data of val) {\n    try {\n      const str =\n        typeof data === 'string'\n          ? data\n          : data instanceof Error\n          ? data.stack ?? String(data)\n          : JSON.stringify(data);\n      console.error(str);\n      appendFileSync('error.log', str);\n    } catch {\n      console.error(String(val));\n      appendFileSync('error.log', String(val));\n    }\n  }\n}\n","module.exports = __WEBPACK_EXTERNAL_createRequire(import.meta.url)(\"node:fs\");","import {exec} from 'node:child_process';\nimport {mkdirSync, promises, writeFileSync} from 'node:fs';\nimport {dirname, join} from 'node:path';\n\nimport {BuiltInParserName, format} from 'prettier';\n\nexport const {access, readFile, readdir, stat} = promises;\nconst {writeFile, mkdir, rm} = promises;\n\nlet logEnabled = true;\nexport const setLogging = (enabled: boolean): void => {\n  logEnabled = enabled;\n};\n\nexport async function writeJsonFile(path: string, json: unknown): Promise<void> {\n  await writeRawFile(path, `${JSON.stringify(json, undefined, 2)}\\n`);\n}\n\nconst prettierConfig = (parser: BuiltInParserName) =>\n  ({\n    parser,\n    printWidth: 100,\n    singleQuote: true,\n    trailingComma: 'es5',\n    bracketSpacing: false,\n    arrowParens: 'avoid',\n    endOfLine: 'auto',\n  } as const);\n\nasync function writePrettyFile(\n  parser: BuiltInParserName,\n  path: string,\n  code: string\n): Promise<void> {\n  await writeRawFile(path, format(code, prettierConfig(parser)));\n}\n\nfunction writePrettyFileSync(parser: BuiltInParserName, path: string, code: string): void {\n  writeRawFileSync(path, format(code, prettierConfig(parser)));\n}\n\nexport async function writeJsFile(path: string, js: string): Promise<void> {\n  return writePrettyFile('babel', path, js);\n}\n\nexport function writeJsFileSync(path: string, js: string): void {\n  return writePrettyFileSync('babel', path, js);\n}\n\nexport async function writeTsFile(path: string, ts: string): Promise<void> {\n  return writePrettyFile('typescript', path, ts);\n}\n\nexport function writeTsFileSync(path: string, ts: string): void {\n  return writePrettyFileSync('typescript', path, ts);\n}\n\nexport async function writeRawFile(path: string, content: string): Promise<void> {\n  if (logEnabled) {\n    console.log(`write ${path}`);\n  }\n  await mkdir(dirname(path), {recursive: true});\n  await writeFile(path, content);\n}\n\nexport function writeRawFileSync(path: string, content: string): void {\n  if (logEnabled) {\n    console.log(`write ${path}`);\n  }\n  mkdirSync(dirname(path), {recursive: true});\n  writeFileSync(path, content);\n}\n\nexport async function rmDir(dirPath: string): Promise<void> {\n  await rm(dirPath, {recursive: true, force: true});\n}\n\nexport async function cleanDir(dirPath: string): Promise<void> {\n  if (logEnabled) {\n    console.log('clean', dirPath);\n  }\n  try {\n    await rmDir(dirPath);\n  } finally {\n    await mkdir(dirPath, {recursive: true});\n  }\n}\n\nexport async function cp(from: string, to: string): Promise<void> {\n  return new Promise((resolve, reject) => {\n    exec(`cp -R ${from} ${to}`, err => (err ? reject(err) : resolve()));\n  });\n}\n\nexport async function exists(path: string): Promise<boolean> {\n  try {\n    await access(path);\n    return true;\n  } catch {\n    return false;\n  }\n}\n\nexport async function maybeReadFile(path: string): Promise<string | undefined> {\n  try {\n    const fileContent = await readFile(path);\n    return fileContent.toString();\n  } catch {\n    return undefined;\n  }\n}\n\nexport async function listFiles(path: string): Promise<string[]> {\n  const files: string[] = [];\n  const ents = await readdir(path, {withFileTypes: true});\n  const promises: Promise<void>[] = [];\n  for (const ent of ents) {\n    const entPath = join(path, ent.name);\n    if (ent.isDirectory()) {\n      promises.push(\n        listFiles(entPath).then(subFiles => {\n          files.push(...subFiles);\n        })\n      );\n    } else if (ent.isFile()) {\n      files.push(entPath);\n    }\n  }\n  await Promise.all(promises);\n  return files;\n}\n","module.exports = __WEBPACK_EXTERNAL_createRequire(import.meta.url)(\"node:child_process\");","module.exports = __WEBPACK_EXTERNAL_createRequire(import.meta.url)(\"prettier\");","import {Brand} from '@src/type_utils';\n\nexport type WorkspaceName = Brand<string, 'WorkspaceName'>;\nexport type ProjectName = Brand<string, 'ProjectName'>;\n\n//\n// Runtime types\n//\n\nexport enum RuntimeType {\n  Web = 'web',\n  Node = 'node',\n  Lib = 'lib',\n  Lambda = 'lambda',\n  ReactNative = 'react-native',\n  NodeLib = 'node-lib',\n  NodeScript = 'node-script',\n}\n\nexport interface RuntimeTypeMetadata {\n  eslint: RuntimeType;\n  tsconfig: RuntimeType;\n  webpack?: RuntimeType;\n}\n\nexport const RUNTIME_TYPE_TO_METADATA: Record<RuntimeType, RuntimeTypeMetadata> = {\n  [RuntimeType.Web]: {\n    eslint: RuntimeType.Web,\n    tsconfig: RuntimeType.Web,\n    webpack: RuntimeType.Web,\n  },\n  [RuntimeType.Node]: {\n    eslint: RuntimeType.Node,\n    tsconfig: RuntimeType.Node,\n    webpack: RuntimeType.Node,\n  },\n  [RuntimeType.Lib]: {\n    eslint: RuntimeType.Lib,\n    tsconfig: RuntimeType.Lib,\n    webpack: RuntimeType.Lib,\n  },\n  [RuntimeType.Lambda]: {\n    eslint: RuntimeType.Node,\n    tsconfig: RuntimeType.Node,\n    webpack: RuntimeType.Lambda,\n  },\n  [RuntimeType.ReactNative]: {\n    eslint: RuntimeType.ReactNative,\n    tsconfig: RuntimeType.ReactNative,\n  },\n  [RuntimeType.NodeLib]: {\n    eslint: RuntimeType.Node,\n    tsconfig: RuntimeType.Node,\n    webpack: RuntimeType.NodeLib,\n  },\n  [RuntimeType.NodeScript]: {\n    eslint: RuntimeType.Node,\n    tsconfig: RuntimeType.Node,\n    webpack: RuntimeType.NodeScript,\n  },\n};\n\n//\n// Project type\n//\n\nexport enum ProjectType {\n  Web = 'web',\n  LambdaFunction = 'lambda_function',\n  LambdaApi = 'lambda_api',\n  NodeLib = 'node_lib',\n  NodeScript = 'node_script',\n  Shared = 'shared',\n}\n\ninterface ProjectTypeMetadata {\n  runtimeType: RuntimeType;\n}\n\nexport const PROJECT_TYPE_TO_METADATA: Record<ProjectType, ProjectTypeMetadata> = {\n  [ProjectType.Web]: {runtimeType: RuntimeType.Web},\n  [ProjectType.LambdaFunction]: {runtimeType: RuntimeType.Lambda},\n  [ProjectType.LambdaApi]: {runtimeType: RuntimeType.Lambda},\n  [ProjectType.NodeLib]: {runtimeType: RuntimeType.NodeLib},\n  [ProjectType.NodeScript]: {runtimeType: RuntimeType.NodeScript},\n  [ProjectType.Shared]: {runtimeType: RuntimeType.Lib},\n};\n\n//\n// Workspace Fragment type\n//\n\nexport enum WorkspaceFragmentType {\n  StaticWebsite = 'static-website',\n  StandaloneLambda = 'standalone-lambda',\n  WebApp = 'web-app',\n  NodeLib = 'node-lib',\n  NodeScript = 'node-script',\n  Shared = 'shared',\n}\n\ninterface WorkspaceFragmentBase {\n  type: WorkspaceFragmentType;\n}\n\nexport interface WorkspaceFragmentRegistry {\n  [WorkspaceFragmentType.StaticWebsite]: {\n    type: WorkspaceFragmentType.StaticWebsite;\n    websiteName: ProjectName;\n  };\n  [WorkspaceFragmentType.StandaloneLambda]: {\n    type: WorkspaceFragmentType.StandaloneLambda;\n    lambdaName: ProjectName;\n  };\n  [WorkspaceFragmentType.WebApp]: {\n    type: WorkspaceFragmentType.WebApp;\n    websiteName: ProjectName;\n    lambdaName: ProjectName;\n  };\n  [WorkspaceFragmentType.NodeLib]: {\n    type: WorkspaceFragmentType.NodeLib;\n    libName: ProjectName;\n  };\n  [WorkspaceFragmentType.NodeScript]: {\n    type: WorkspaceFragmentType.NodeScript;\n    scriptName: ProjectName;\n  };\n  [WorkspaceFragmentType.Shared]: {\n    type: WorkspaceFragmentType.Shared;\n  };\n}\n\ntype RegistryIsValid = WorkspaceFragmentRegistry extends Record<\n  WorkspaceFragmentType,\n  WorkspaceFragmentBase\n>\n  ? boolean\n  : never;\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nfunction validateRegistry(): RegistryIsValid {\n  return true;\n}\n\nexport type WorkspaceFragment = WorkspaceFragmentRegistry[keyof WorkspaceFragmentRegistry];\n","import {execSync} from 'node:child_process';\nimport {cp} from 'node:fs/promises';\nimport {join} from 'node:path';\nimport {fileURLToPath} from 'node:url';\n\nimport {writeJsonFile, writeRawFile} from '@src/fs';\nimport {\n  ProjectName,\n  ProjectType,\n  WorkspaceFragment,\n  WorkspaceFragmentType,\n  WorkspaceName,\n} from '@src/models';\nimport {generateProject} from '@src/project/generate_project';\nimport {generateGitIgnore} from '@src/project/gitignore';\nimport {generateWorkspacePackageJson} from '@src/project/package_json';\nimport {\n  generateCommonTerraform,\n  generateWorkspaceProjectTerraform,\n} from '@src/project/terraform/all';\nimport {generateCodeWorkspace} from '@src/project/vscode_workspace';\nimport {neverHappens} from '@src/type_utils';\n\nexport interface WorkspaceProject {\n  projectName: ProjectName;\n  type: ProjectType;\n}\n\nexport function getProjectsFromWorkspaceFragment(fragment: WorkspaceFragment): WorkspaceProject[] {\n  if (fragment.type === WorkspaceFragmentType.StaticWebsite) {\n    return [\n      {\n        projectName: fragment.websiteName,\n        type: ProjectType.Web,\n      },\n    ];\n  } else if (fragment.type === WorkspaceFragmentType.StandaloneLambda) {\n    return [\n      {\n        projectName: fragment.lambdaName,\n        type: ProjectType.LambdaFunction,\n      },\n    ];\n  } else if (fragment.type === WorkspaceFragmentType.WebApp) {\n    return [\n      {\n        projectName: fragment.websiteName,\n        type: ProjectType.Web,\n      },\n      {\n        projectName: fragment.lambdaName,\n        type: ProjectType.LambdaApi,\n      },\n    ];\n  } else if (fragment.type === WorkspaceFragmentType.NodeLib) {\n    return [\n      {\n        projectName: fragment.libName,\n        type: ProjectType.NodeLib,\n      },\n    ];\n  } else if (fragment.type === WorkspaceFragmentType.NodeScript) {\n    return [\n      {\n        projectName: fragment.scriptName,\n        type: ProjectType.NodeScript,\n      },\n    ];\n    // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n  } else if (fragment.type === WorkspaceFragmentType.Shared) {\n    return [\n      {\n        projectName: 'shared' as ProjectName,\n        type: ProjectType.Shared,\n      },\n    ];\n  }\n  neverHappens(fragment, `Unknown ProjectType ${(fragment as WorkspaceFragment).type}`);\n}\n\nexport async function generateWorkspace(\n  dst: string,\n  workspaceName: WorkspaceName,\n  workspaceFragments: WorkspaceFragment[],\n  alreadyGenerated: ProjectName[]\n): Promise<void> {\n  const projects = workspaceFragments.flatMap(getProjectsFromWorkspaceFragment);\n\n  // Create projects files from templates\n  await Promise.all(\n    projects\n      .filter(p => !alreadyGenerated.includes(p.projectName))\n      .map(async project => generateProject(join(dst, project.projectName), project))\n  );\n\n  // Generate workspace root files\n  const SCRIPTS_PATH = join(fileURLToPath(import.meta.url), '../scripts');\n  await Promise.all([\n    // package.json\n    await writeJsonFile(\n      join(dst, 'package.json'),\n      generateWorkspacePackageJson(workspaceName, projects)\n    ),\n    // .gitignore\n    await writeRawFile(join(dst, '.gitignore'), generateGitIgnore()),\n    // app.code-workspace\n    await writeJsonFile(join(dst, 'app.code-workspace'), generateCodeWorkspace(workspaceFragments)),\n    // setup.js\n    await cp(join(SCRIPTS_PATH, 'setup.js'), join(dst, 'setup.js')),\n    // deploy.js\n    await cp(join(SCRIPTS_PATH, 'deploy.js'), join(dst, 'deploy.js')),\n    // build.js\n    await cp(join(SCRIPTS_PATH, 'build.js'), join(dst, 'build.js')),\n  ]);\n\n  // Terraform folder generation\n  const terraformPath = join(dst, 'terraform');\n  await Promise.all([\n    writeRawFile(join(terraformPath, 'base.tf'), generateCommonTerraform(workspaceName, projects)),\n    ...projects.map(async p => {\n      const content = generateWorkspaceProjectTerraform(workspaceName, p);\n      if (content === undefined) {\n        return;\n      }\n      const name = `${p.projectName}_terraform`;\n      await writeRawFile(join(terraformPath, `${name}.tf`), content);\n    }),\n  ]);\n\n  // Run setup.js\n  console.log('Running post install script');\n  const commands = [`cd ${dst}`, `node setup.js`, `git init`];\n  execSync(commands.join(' && '), {stdio: ['ignore', 'inherit', 'inherit']});\n}\n","module.exports = __WEBPACK_EXTERNAL_createRequire(import.meta.url)(\"node:fs/promises\");","module.exports = __WEBPACK_EXTERNAL_createRequire(import.meta.url)(\"node:url\");","import {execSync} from 'node:child_process';\nimport {writeFile} from 'node:fs/promises';\nimport {join} from 'node:path';\nimport {fileURLToPath} from 'node:url';\n\nimport {cp, listFiles, readFile, writeJsonFile} from '@src/fs';\nimport {PROJECT_TYPE_TO_METADATA, RuntimeType} from '@src/models';\nimport {WorkspaceProject} from '@src/project/generate_workspace';\n\nconst TEMPLATES_PATH = join(fileURLToPath(import.meta.url), '../templates');\n\nexport async function generateProject(dst: string, project: WorkspaceProject): Promise<void> {\n  const {projectName, type} = project;\n  // Copy template files\n  await cp(join(TEMPLATES_PATH, type), dst);\n\n  // Replace name in package.json\n  const packageJsonPath = join(dst, 'package.json');\n  const packageJsonbuffer = await readFile(packageJsonPath);\n  const packageJson = JSON.parse(packageJsonbuffer.toString());\n  packageJson['name'] = projectName;\n  await writeJsonFile(packageJsonPath, packageJson);\n\n  // Replace variables\n  const files = await listFiles(dst);\n  await Promise.all(\n    files.map(async file => {\n      const buffer = await readFile(file);\n      const content = buffer.toString();\n      const newContent = content.replaceAll('{{PROJECT_NAME}}', projectName);\n      if (newContent !== content) {\n        await writeFile(file, newContent);\n      }\n    })\n  );\n\n  // Post generation script for React Native project\n  if (PROJECT_TYPE_TO_METADATA[type].runtimeType === RuntimeType.ReactNative) {\n    console.log('Running post install script');\n    const commands = [\n      `pushd ${dst}`,\n      `npx --yes react-native init ${projectName}`,\n      `mv ${projectName}/ios .`,\n      `mv ${projectName}/android .`,\n      `rm -rf ${projectName}`,\n      `popd`,\n    ];\n    execSync(commands.join(' && '));\n  }\n}\n","export function generateGitIgnore(): string {\n  return `\n.DS_Store\nnode_modules\nbuild\ndist\ntmp\nyarn-error.log\n.yarn-warnings.log\nyarn.lock\nterraform/.terraform\nterraform/.terraform*\nterraform/*.tfstate.backup\nterraform/.aws-credentials\nterraform/archives\n*/log\n    `.trim();\n}\n","import {\n  PROJECT_TYPE_TO_METADATA,\n  RUNTIME_TYPE_TO_METADATA,\n  RuntimeType,\n  RuntimeTypeMetadata,\n  WorkspaceName,\n} from '@src/models';\nimport {WorkspaceProject} from '@src/project/generate_workspace';\nimport {PACKAGE_VERSIONS, TYPESCRIPT_VERSION} from '@src/versions';\n\nfunction uniq(runtimes: (RuntimeType | undefined)[]): RuntimeType[] {\n  return [...new Set(runtimes.filter((r): r is RuntimeType => r !== undefined)).values()];\n}\n\nfunction projectMetadata(p: WorkspaceProject): RuntimeTypeMetadata {\n  return RUNTIME_TYPE_TO_METADATA[PROJECT_TYPE_TO_METADATA[p.type].runtimeType];\n}\n\nexport function generateWorkspacePackageJson(\n  workspaceName: WorkspaceName,\n  projects: WorkspaceProject[]\n): Record<string, unknown> {\n  const eslintRuntimes = uniq(projects.map(p => projectMetadata(p).eslint));\n  const tsconfigRuntimes = uniq(projects.map(p => projectMetadata(p).tsconfig));\n  const webpackRuntimes = uniq(projects.map(p => projectMetadata(p).webpack));\n\n  return {\n    name: workspaceName,\n    license: 'UNLICENSED',\n    type: 'module',\n    scripts: {\n      setup: 'node ./setup.js',\n      deploy: 'node ./deploy.js',\n      build: 'NODE_ENV=production node ./build.js',\n      watch: 'NODE_ENV=development node ./build.js --watch',\n    },\n    eslintConfig: {\n      ignorePatterns: ['**/*.js'],\n    },\n    prettier: '@matthis/prettier-config',\n    devDependencies: Object.fromEntries(\n      (\n        [\n          ...eslintRuntimes.map(runtime => [\n            `@matthis/eslint-config-${runtime}`,\n            PACKAGE_VERSIONS.eslint,\n          ]),\n          ['@matthis/prettier-config', PACKAGE_VERSIONS.prettier],\n          ...tsconfigRuntimes.map(runtime => [\n            `@matthis/tsconfig-${runtime}`,\n            PACKAGE_VERSIONS.tsconfig,\n          ]),\n          ...webpackRuntimes.map(runtime => [\n            `@matthis/webpack-${runtime}`,\n            PACKAGE_VERSIONS.webpack,\n          ]),\n          ['@matthis/webpack-runner', PACKAGE_VERSIONS.runner],\n          ['typescript', TYPESCRIPT_VERSION],\n        ] as [string, string][]\n      ).sort((d1, d2) => d1[0].localeCompare(d2[0]))\n    ),\n  };\n}\n","export const PACKAGE_VERSIONS = {\n  project: '1.4.17',\n  eslint: '1.2.8',\n  prettier: '1.2.0',\n  tsconfig: '1.2.7',\n  webpack: '1.3.7',\n  runner: '1.2.2',\n};\n\nexport const ESLINT_VERSION = '8.43.x';\nexport const PRETTIER_VERSION = '2.8.x';\nexport const TYPESCRIPT_VERSION = '5.0.4';\n\n/* eslint-disable @typescript-eslint/naming-convention */\nexport const LIB_VERSIONS = {\n  '@types/react': '18.2.x',\n  '@types/react-dom': '18.2.x',\n  react: '18.2.x',\n  'react-dom': '18.2.x',\n\n  '@types/react-native': '0.66.x',\n  'react-native': '0.66.x',\n\n  'styled-components': '6.0.x',\n\n  'react-router': '6.4.x',\n  'react-router-dom': '6.4.x',\n};\n/* eslint-enable @typescript-eslint/naming-convention */\n","import {PROJECT_TYPE_TO_METADATA, ProjectType, RuntimeType, WorkspaceName} from '@src/models';\nimport {WorkspaceProject} from '@src/project/generate_workspace';\nimport {generateCloudfrontDistributionTerraform} from '@src/project/terraform/cloudfront';\nimport {generateLambdaTerraform} from '@src/project/terraform/lambda';\nimport {generateAwsProviderTerraform} from '@src/project/terraform/provider';\nimport {generateS3BucketTerraform} from '@src/project/terraform/s3';\nimport {neverHappens} from '@src/type_utils';\n\nexport function generateCommonTerraform(\n  workspaceName: WorkspaceName,\n  projects: WorkspaceProject[]\n): string {\n  return [\n    generateAwsProviderTerraform(workspaceName),\n    generateS3BucketTerraform(\n      workspaceName,\n      projects\n        .filter(p => PROJECT_TYPE_TO_METADATA[p.type].runtimeType === RuntimeType.Web)\n        .map(p => p.projectName)\n    ),\n  ].join('\\n\\n');\n}\n\nexport function generateWorkspaceProjectTerraform(\n  workspaceName: WorkspaceName,\n  project: WorkspaceProject\n): string | undefined {\n  const {projectName, type} = project;\n  if (type === ProjectType.Web) {\n    return generateCloudfrontDistributionTerraform(workspaceName, projectName);\n  } else if (type === ProjectType.LambdaFunction) {\n    return generateLambdaTerraform(workspaceName, projectName, {api: false});\n  } else if (type === ProjectType.LambdaApi) {\n    return generateLambdaTerraform(workspaceName, projectName, {api: true});\n  } else if (type === ProjectType.NodeLib) {\n    return undefined;\n  } else if (type === ProjectType.NodeScript) {\n    return undefined;\n    // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n  } else if (type === ProjectType.Shared) {\n    return undefined;\n  }\n  neverHappens(type, 'ProjectType');\n}\n","import {ProjectName, WorkspaceName} from '@src/models';\n\nexport function generateCloudfrontDistributionTerraform(\n  workspaceName: WorkspaceName,\n  projectName: ProjectName\n): string {\n  const bucketName = projectName.toLowerCase().replace(/[^\\d.a-z-]+/gu, '-');\n  const originId = `${bucketName}-origin-id`;\n  return `\noutput \"${projectName}_cloudfront_domain_name\" {\n  value       = aws_cloudfront_distribution.${projectName}.domain_name\n  description = \"Domain (from cloudfront) where the \\\\\"${workspaceName}-${projectName}\\\\\" frontend is available.\"\n}\n  \nresource \"aws_cloudfront_distribution\" \"${projectName}\" {\n  origin {\n    domain_name = aws_s3_bucket.code.bucket_regional_domain_name\n    origin_id   = \"${originId}\"\n    origin_path = \"/${projectName}\"\n\n    s3_origin_config {\n      origin_access_identity = aws_cloudfront_origin_access_identity.${projectName}.cloudfront_access_identity_path\n    }\n  }\n  \n  enabled             = true\n  wait_for_deployment = false\n  is_ipv6_enabled     = true\n  price_class         = \"PriceClass_100\"\n  \n  default_root_object   = \"/index.html\"\n  custom_error_response {\n    error_code         = 400\n    response_code      = 200\n    response_page_path = \"/index.html\"\n  }\n  custom_error_response {\n    error_code         = 403\n    response_code      = 200\n    response_page_path = \"/index.html\"\n  }\n  custom_error_response {\n    error_code         = 404\n    response_code      = 200\n    response_page_path = \"/index.html\"\n  }\n\n  default_cache_behavior {\n    allowed_methods  = [\"HEAD\", \"GET\"]\n    cached_methods   = [\"HEAD\", \"GET\"]\n    compress         = true\n    target_origin_id = \"${originId}\"\n    viewer_protocol_policy = \"redirect-to-https\"\n    \n    forwarded_values {\n      query_string = false\n      cookies {\n        forward = \"none\"\n      }\n    }\n  }\n\n  restrictions {\n    geo_restriction {\n      restriction_type = \"none\"\n    }\n  }\n\n  viewer_certificate {\n    cloudfront_default_certificate = true\n  }\n}\n\nresource \"aws_cloudfront_origin_access_identity\" \"${projectName}\" {}\n  `.trim();\n}\n","import {ProjectName, WorkspaceName} from '@src/models';\n\nexport function generateLambdaTerraform(\n  workspaceName: WorkspaceName,\n  projectName: ProjectName,\n  opts: {api: boolean}\n): string {\n  const {api} = opts;\n  return `\n# Define any extra role for the lambda here\ndata \"aws_iam_policy_document\" \"${projectName}_lambda_extra_role\" {\n  statement {\n    actions   = [\"s3:ListAllMyBuckets\"]\n    resources = [\"*\"]\n  }\n}\n\nresource \"aws_s3_object\" \"${projectName}_archive\" {\n  bucket       = aws_s3_bucket.code.id\n  key          = \"${projectName}/dist.zip\"\n  content_base64 = \"UEsDBBQACAAIAGaKwlYAAAAAAAAAADYAAAAIACAAaW5kZXguanNVVA0AB3AIemRyCHpkcAh6ZHV4CwABBPUBAAAEFAAAAEutKMgvKinWy0jMS8lJLVKwVUgsrsxLVkgrzUsuyczPU9DQVKjmUlAoSi0pLcpTUFe35qq15gIAUEsHCP0ak1o4AAAANgAAAFBLAQIUAxQACAAIAGaKwlb9GpNaOAAAADYAAAAIACAAAAAAAAAAAACkgQAAAABpbmRleC5qc1VUDQAHcAh6ZHIIemRwCHpkdXgLAAEE9QEAAAQUAAAAUEsFBgAAAAABAAEAVgAAAI4AAAAAAA==\"\n}\n\nresource \"aws_lambda_function\" \"${projectName}\" {\n  function_name     = \"${workspaceName}-${projectName}\"\n  s3_bucket         = aws_s3_object.${projectName}_archive.bucket\n  s3_key            = aws_s3_object.${projectName}_archive.key\n  handler           = \"index.handler\"\n  runtime           = \"nodejs18.x\"\n  role              = aws_iam_role.${projectName}_lambda_exec.arn\n  environment {\n    variables = {\n      NODE_OPTIONS = \"--enable-source-maps\"\n    }\n  }\n}\n\noutput \"${projectName}_function_name\" {\n  value       = aws_lambda_function.${projectName}.function_name\n  description = \"Function name of the \\\\\"${workspaceName}-${projectName}\\\\\" lambda\"\n}\n\n${\n  api\n    ? `\nresource \"aws_lambda_function_url\" \"${projectName}\" {\n  function_name      = aws_lambda_function.${projectName}.function_name\n  authorization_type = \"NONE\"\n}\n\noutput \"${projectName}_function_url\" {\n  value       = aws_lambda_function_url.${projectName}.function_url\n  description = \"Function url of the \\\\\"${workspaceName}-${projectName}\\\\\" lambda\"\n}\n`.trim()\n    : ''\n}\n\nresource \"aws_iam_role\" \"${projectName}_lambda_exec\" {\n  name = \"${workspaceName}-${projectName}-assume-role\"\n  assume_role_policy = jsonencode({\n    Version = \"2012-10-17\"\n    Statement = [\n      {\n        Action    = \"sts:AssumeRole\"\n        Principal = {\n          Service = \"lambda.amazonaws.com\"\n        }\n        Effect    = \"Allow\"\n        Sid       = \"\"\n      },\n    ]\n  })\n\n  inline_policy {\n    name = \"${workspaceName}-${projectName}-cloudwatch-role\"\n    policy = jsonencode({\n      Version = \"2012-10-17\"\n      Statement = [\n        {\n          Action   = [\n            \"logs:CreateLogGroup\",\n            \"logs:CreateLogStream\",\n            \"logs:PutLogEvents\"\n          ]\n          Effect   = \"Allow\"\n          Resource = \"arn:aws:logs:*:*:*\"\n        },\n      ]\n    })\n  }\n\n  inline_policy {\n    name = \"${workspaceName}-${projectName}-s3-code-bucket\"\n    policy = jsonencode({\n      Version = \"2012-10-17\"\n      Statement = [\n        {\n          Action   = [\n            \"s3:GetObject\",\n            \"s3:GetObjectTagging\"\n          ]\n          Effect   = \"Allow\"\n          Resource = [\n            \"\\${aws_s3_bucket.code.arn}/*\",\n          ]\n        }\n      ]\n    })\n  }\n  \n  inline_policy {\n    name = \"${workspaceName}-${projectName}-extra-role\"\n    policy = data.aws_iam_policy_document.${projectName}_lambda_extra_role.json\n  }\n}\n`.trim();\n}\n","import {WorkspaceName} from '@src/models';\n\nexport function generateAwsProviderTerraform(workspaceName: WorkspaceName): string {\n  return `\nterraform {\n  required_providers {\n    aws = {\n      source  = \"hashicorp/aws\"\n      version = \"~> 5.1\"\n    }\n  }\n}\n\nprovider \"aws\" {\n  region  = \"eu-west-3\"\n  shared_credentials_files = [\"./.aws-credentials\"]\n  default_tags {\n    tags = {\n      Project = \"${workspaceName}\"\n    }\n  }\n}\n\ndata \"aws_region\" \"current\" {}\noutput \"region\" {\n  value = data.aws_region.current.id\n}\n`.trim();\n}\n","import {ProjectName, WorkspaceName} from '@src/models';\n\nexport function generateS3BucketTerraform(\n  workspaceName: WorkspaceName,\n  webProjectNames: ProjectName[]\n): string {\n  const bucketName = workspaceName.toLowerCase().replace(/[^a-z0-9.-]+/gu, '-');\n\n  const CODE_BUCKET = `\nresource \"aws_s3_bucket\" \"code\" {\n  bucket_prefix = \"${bucketName}-code-\"\n}\n\noutput \"code_bucket\" {\n  value = aws_s3_bucket.code.id\n}\n`.trim();\n\n  const CLOUDFRONT_ACCESS = `\ndata \"aws_iam_policy_document\" \"cloudfront_access_to_code\" {\n  ${webProjectNames\n    .map(p =>\n      `\n  statement {\n    actions   = [\"s3:GetObject\"]\n    resources = [\n      \"\\${aws_s3_bucket.code.arn}/${p}/*\",\n    ]\n    principals {\n      type        = \"AWS\"\n      identifiers = [aws_cloudfront_origin_access_identity.${p}.iam_arn]\n    }\n  }\n`.trim()\n    )\n    .join('\\n\\n')}\n}\n\nresource \"aws_s3_bucket_policy\" \"code\" {\n  bucket = aws_s3_bucket.code.id\n  policy = data.aws_iam_policy_document.cloudfront_access_to_code.json\n}\n`.trim();\n\n  const out = [CODE_BUCKET];\n  if (webProjectNames.length > 0) {\n    out.push(CLOUDFRONT_ACCESS);\n  }\n  return out.join('\\n\\n');\n}\n","export type Brand<Type, Name> = Type & {__brand: Name};\n\nexport function neverHappens(value: never, msg?: string): never {\n  throw new Error(msg ?? `Unexpected value ${value}`);\n}\n\nfunction notUndefined<T>(val: T | undefined): val is T {\n  return val !== undefined;\n}\n\nexport function removeUndefined<T>(arr: (T | undefined)[]): T[] {\n  return arr.filter(notUndefined);\n}\n","import {join} from 'node:path';\n\nimport {maybeReadFile} from '@src/fs';\nimport {WorkspaceFragment} from '@src/models';\nimport {getProjectsFromWorkspaceFragment} from '@src/project/generate_workspace';\n\nexport function generateCodeWorkspace(\n  workspaceFragments: WorkspaceFragment[]\n): Record<string, unknown> {\n  const projects = workspaceFragments.flatMap(getProjectsFromWorkspaceFragment);\n  const projectNames = projects.map(p => p.projectName);\n  return {\n    projects: workspaceFragments,\n    folders: [\n      ...projectNames.map(p => ({path: p})),\n      {path: 'terraform'},\n      {path: '.', name: 'root'},\n    ],\n    settings: {\n      /* eslint-disable @typescript-eslint/naming-convention */\n      'files.exclude': Object.fromEntries([\n        ...projectNames.map(p => [p, true]),\n        ['terraform', true],\n      ]),\n      'editor.acceptSuggestionOnCommitCharacter': false,\n      'editor.suggestSelection': 'first',\n      'vsintellicode.modify.editor.suggestSelection': 'automaticallyOverrodeDefaultValue',\n      'explorer.confirmDelete': false,\n      'git.autofetch': true,\n      'git.confirmSync': false,\n      'typescript.preferences.importModuleSpecifier': 'non-relative',\n      'eslint.lintTask.enable': true,\n      'eslint.useESLintClass': true,\n      'eslint.options': {\n        reportUnusedDisableDirectives: 'warn',\n      },\n      'editor.formatOnSave': true,\n      'editor.codeActionsOnSave': {\n        'source.fixAll': false,\n        'source.fixAll.eslint': true,\n      },\n      'editor.defaultFormatter': 'esbenp.prettier-vscode',\n      'emmet.showExpandedAbbreviation': 'never',\n      /* eslint-enable @typescript-eslint/naming-convention, no-null/no-null */\n    },\n    extensions: {\n      recommendations: [\n        'dbaeumer.vscode-eslint',\n        'esbenp.prettier-vscode',\n        'VisualStudioExptTeam.vscodeintellicode',\n        'styled-components.vscode-styled-components',\n        'naumovs.color-highlight',\n        'eamodio.gitlens',\n      ],\n    },\n  };\n}\n\nexport async function readProjectsFromWorkspace(\n  workspacePath: string\n): Promise<WorkspaceFragment[] | undefined> {\n  const workspaceContent = await maybeReadFile(join(workspacePath, 'app.code-workspace'));\n  const workspaceJson = workspaceContent === undefined ? {} : JSON.parse(workspaceContent);\n  const workspaceProjects = Array.isArray(workspaceJson.projects)\n    ? workspaceJson.projects\n    : undefined;\n  return workspaceProjects as WorkspaceFragment[] | undefined;\n}\n","import {execSync} from 'node:child_process';\nimport {join} from 'node:path';\n\nimport {writeTsFileSync} from '@src/fs';\nimport {removeUndefined} from '@src/type_utils';\nimport {getEnv} from '@src/webpack/utils';\n\nexport function generateEnvFile(overrides: Record<string, string>): void {\n  const terraformPath = join(process.cwd(), 'terraform');\n  const res: Record<string, {type: string; value: unknown; sensitive: boolean}> = JSON.parse(\n    execSync(`terraform output -json`, {cwd: terraformPath}).toString()\n  );\n\n  const outputsEntries = removeUndefined(\n    Object.entries(res).map(([key, value]) => {\n      if (value.sensitive || value.type !== 'string' || typeof value.value !== 'string') {\n        return undefined;\n      }\n      return [key.toUpperCase(), value.value] as const;\n    })\n  );\n  const envConstants = {\n    ...Object.fromEntries(outputsEntries),\n    ...overrides,\n    // eslint-disable-next-line @typescript-eslint/naming-convention\n    NODE_ENV: getEnv(),\n  };\n\n  writeTsFileSync(\n    join(process.cwd(), 'shared', 'src', 'env.ts'),\n    Object.entries(envConstants)\n      .map(([key, value]) => `export const ${key} = ${JSON.stringify(value)} as string;`)\n      .join('\\n')\n  );\n}\n","import {createHash} from 'node:crypto';\nimport {mkdir, readdir, readFile, rm, stat} from 'node:fs/promises';\nimport {join, resolve} from 'node:path';\n\nimport {exists, rmDir} from '@src/fs';\n\nexport interface WebpackConfigFragment {\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  config: () => any;\n  dependencies: Record<string, string>;\n}\n\nexport function isProd(): boolean {\n  return process.env['NODE_ENV'] === 'production'; // eslint-disable-line node/no-process-env\n}\n\nexport function isSelenium(): boolean {\n  return process.env['IS_SELENIUM'] === '1'; // eslint-disable-line node/no-process-env\n}\n\nexport function getEnv(): 'production' | 'development' {\n  return isProd() ? 'production' : 'development';\n}\n\nconst packageJsonCache = new Map<string, Record<string, unknown> | undefined>();\n\nexport async function findPackageJson(p: string): Promise<Record<string, unknown> | undefined> {\n  if (packageJsonCache.has(p)) {\n    return packageJsonCache.get(p);\n  }\n  try {\n    const pStat = await stat(p);\n    if (pStat.isDirectory()) {\n      const dir = await readdir(p);\n      if (dir.includes('package.json')) {\n        const fileContent = await readFile(join(p, 'package.json'));\n        const json = JSON.parse(fileContent.toString()) as Record<string, unknown>;\n        packageJsonCache.set(p, json);\n        return json;\n      }\n      if (p === '/') {\n        return undefined;\n      }\n    }\n    const res = await findPackageJson(resolve(`${p}/..`));\n    packageJsonCache.set(p, res);\n    return res;\n  } catch (err: unknown) {\n    console.log('findPackageJson');\n    console.log(err);\n    packageJsonCache.set(p, undefined);\n    return undefined;\n  }\n}\n\nexport function getPort(context: string): number {\n  // eslint-disable-next-line @typescript-eslint/no-magic-numbers\n  const hexHash = createHash('md5').update(context).digest('hex').slice(0, 4);\n  const port = 1024 + Math.floor(parseInt(hexHash, 16) / 2);\n  return port;\n}\n\nexport async function initLogFile(context: string, logFileName: string): Promise<string> {\n  // Find the root of the project and create the log dir there\n  try {\n    const root = await lookupRoot(context);\n    const logDir = join(root, 'log');\n    await rmDir(logDir);\n    await mkdir(logDir, {recursive: true});\n    const logFile = join(logDir, logFileName);\n    if (await exists(logFile)) {\n      await rm(logFile);\n    }\n    return logFile;\n  } catch {\n    throw new Error(`Failure to identify project root from ${context}`);\n  }\n}\n\nasync function lookupRoot(fromPath: string): Promise<string> {\n  if (await exists(join(fromPath, 'package.json'))) {\n    return fromPath;\n  }\n  const parent = join(fromPath, '..');\n  if (parent === fromPath) {\n    throw new Error('Failure to lookup root');\n  }\n  return lookupRoot(parent);\n}\n","module.exports = __WEBPACK_EXTERNAL_createRequire(import.meta.url)(\"node:crypto\");","import {DetailedError, GlobalError, ParsedError} from '@src/webpack-runner/error_parser';\n\nexport interface GroupedErrors {\n  errorsByProjectByFile: Map<string, Map<string, DetailedError[]>>;\n  globalErrors: GlobalError[];\n}\n\nexport function groupAndSortErrors(errors: ParsedError[]): GroupedErrors {\n  const errorsByProjectByFile = new Map<string, Map<string, DetailedError[]>>();\n  const globalErrors: GlobalError[] = [];\n  for (const err of errors) {\n    if (!('type' in err)) {\n      globalErrors.push(err);\n    } else {\n      let projectErrors = errorsByProjectByFile.get(err.project);\n      if (!projectErrors) {\n        projectErrors = new Map<string, DetailedError[]>();\n        errorsByProjectByFile.set(err.project, projectErrors);\n      }\n      let fileErrors = projectErrors.get(err.loc.absolutePath);\n      if (!fileErrors) {\n        fileErrors = [];\n        projectErrors.set(err.loc.absolutePath, fileErrors);\n      }\n      fileErrors.push(err);\n    }\n  }\n  for (const byFile of errorsByProjectByFile.values()) {\n    for (const errors of byFile.values()) {\n      errors.sort((err1, err2) => {\n        if (!err1.loc.start) {\n          return -1;\n        } else if (!err2.loc.start) {\n          return 1;\n        }\n        const diffLine = err1.loc.start.line - err2.loc.start.line;\n        if (diffLine !== 0) {\n          return diffLine;\n        }\n        if (err1.loc.start.column === undefined) {\n          return -1;\n        } else if (err2.loc.start.column === undefined) {\n          return 1;\n        }\n        const diffColumn = err1.loc.start.column - err2.loc.start.column;\n        if (diffColumn !== 0) {\n          return diffColumn;\n        }\n        return err1.message.localeCompare(err2.message);\n      });\n    }\n  }\n  return {errorsByProjectByFile, globalErrors};\n}\n","import {relative, sep} from 'node:path';\n\nimport {Issue} from 'fork-ts-checker-webpack-plugin/lib/issue';\nimport {WebpackError} from 'webpack';\n\nimport {EslintWebpackError} from '@src/webpack/plugins/eslint_plugin';\n\nexport type ErrorSeverity = 'warning' | 'error';\nexport type ErrorType = 'eslint' | 'tsc' | 'module-not-found';\n\nexport interface DetailedError {\n  project: string;\n  type: 'eslint' | 'tsc' | 'module-not-found';\n  severity: ErrorSeverity;\n  message: string;\n  code: string;\n  loc: {\n    relativePath: string;\n    absolutePath: string;\n    start?: {\n      line: number;\n      column?: number;\n    };\n    end?: {\n      line: number;\n      column?: number;\n    };\n  };\n}\n\nexport interface GlobalError {\n  severity: ErrorSeverity;\n  message: string;\n}\n\nexport type ParsedError = DetailedError | GlobalError;\n\nfunction parseFilePath(root: string, path: string): {project: string; relativePath: string} {\n  const relativePath = relative(root, path);\n  const project = relativePath.split(sep)[0] ?? '';\n  return {project, relativePath};\n}\n\nexport function parseError(\n  err: WebpackError,\n  opts: {root: string; severity: ErrorSeverity}\n): ParsedError {\n  const {root, severity} = opts;\n  if (err.name === 'EslintWebpackError') {\n    const eslintError = err as EslintWebpackError;\n    const absolutePath = err.file;\n    if (absolutePath === undefined) {\n      return {severity, message: err.message};\n    }\n    const {relativePath, project} = parseFilePath(root, absolutePath);\n    return {\n      project,\n      type: 'eslint',\n      severity,\n      message: err.message,\n      code: eslintError.ruleId,\n      loc: {\n        relativePath,\n        absolutePath,\n        start: err.loc && 'start' in err.loc ? err.loc.start : undefined,\n        end: err.loc && 'end' in err.loc ? err.loc.end : undefined,\n      },\n    };\n  } else if ('issue' in err) {\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    const issue = (err as any)['issue'] as Issue;\n    const absolutePath = issue.file;\n    if (absolutePath === undefined) {\n      return {severity, message: err.message};\n    }\n    const {relativePath, project} = parseFilePath(root, absolutePath);\n    return {\n      project,\n      type: 'tsc',\n      severity,\n      message: issue.message,\n      code: issue.code,\n      loc: {\n        relativePath,\n        absolutePath,\n        ...issue.location,\n      },\n    };\n  } else if (err.name === 'ModuleNotFoundError') {\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    const msg = (err as any).error.message as string;\n    const match = /(?<msg>Can't resolve '[^']+') in '(?<file>[^']+)'/u.exec(msg);\n\n    if (!match) {\n      return {severity, message: err.message};\n    }\n    const absolutePath = match[2];\n    const message = match[1];\n    if (absolutePath === undefined || message === undefined) {\n      return {severity, message: err.message};\n    }\n    const {relativePath, project} = parseFilePath(root, absolutePath);\n    return {\n      project,\n      type: 'tsc',\n      severity,\n      message,\n      loc: {\n        relativePath,\n        absolutePath,\n      },\n    };\n  }\n  return {severity, message: err.message};\n}\n","import {spawn} from 'node:child_process';\n\nimport {registerExitCallback} from '@src/exit_handler';\n\nexport function readLines(filePath: string, cb: (newLines: string[]) => void): () => void {\n  const p = spawn('tail', ['-F', filePath], {stdio: 'pipe'});\n  const cleanup = (): void => {\n    if (!p.killed) {\n      p.kill();\n    }\n  };\n  registerExitCallback(cleanup);\n  let data = '';\n  p.stdout.on('data', chunk => {\n    data += chunk;\n    const lines = data.split('\\n');\n    // eslint-disable-next-line node/callback-return\n    cb(lines.slice(0, -1));\n    data = lines.at(-1) ?? '';\n  });\n  p.on('error', err => {\n    console.log(err);\n  });\n  return cleanup;\n}\n","import {bgRed, bgYellow, cyan, gray, green, red} from 'ansi-colors';\n\nimport {WorkspaceProject} from '@src/project/generate_workspace';\nimport {neverHappens} from '@src/type_utils';\nimport {LambdaServerEvent} from '@src/webpack/plugins/lambda_server_plugin';\nimport {WebpackDevServerEvent} from '@src/webpack/plugins/webpack_dev_server';\nimport {formatError, formatFilePath, formatProject} from '@src/webpack-runner/error_formatter';\nimport {GroupedErrors} from '@src/webpack-runner/error_grouper';\nimport {ParsedError} from '@src/webpack-runner/error_parser';\nimport {LambdaServerEvents, WebpackDevServerEvents} from '@src/webpack-runner/runner';\n\nexport function renderErrors(errors: GroupedErrors): string {\n  const {errorsByProjectByFile, globalErrors} = errors;\n  const blocks: string[] = [];\n\n  for (const globalError of globalErrors) {\n    blocks.push(formatError(globalError));\n  }\n\n  for (const [projectName, projectErrors] of errorsByProjectByFile.entries()) {\n    blocks.push(cyan(projectName));\n    for (const [file, errors] of projectErrors.entries()) {\n      blocks.push([formatFilePath(file), ...errors.map(err => formatError(err))].join('\\n'));\n    }\n  }\n\n  return blocks.join('\\n\\n');\n}\n\nexport function renderProjectStatus(\n  project: WorkspaceProject,\n  firstRun: boolean,\n  isRunning: boolean,\n  errors: GroupedErrors,\n  compilationFailure: string | undefined,\n  lambdaServerEvents: LambdaServerEvents,\n  webpackDevServerEvents: WebpackDevServerEvents\n): string[] {\n  // First column\n  const column1 = formatProject(project);\n\n  // Second column\n  let column2 = '';\n  const projectErrors = errors.errorsByProjectByFile.get(project.projectName);\n  if (projectErrors) {\n    column2 = renderErrorWarningCount([...projectErrors.values()].flat());\n  } else if (!firstRun) {\n    column2 = green('success');\n  } else if (isRunning) {\n    column2 = gray('in progress');\n  }\n\n  // Third column\n  const column3: string[] = [];\n  if (lambdaServerEvents.startEvent) {\n    column3.push(renderLambdaServerEvent(lambdaServerEvents.startEvent));\n  }\n  if (webpackDevServerEvents.startEvent) {\n    column3.push(renderWebpackDevServerEvent(webpackDevServerEvents.startEvent));\n  }\n  if (compilationFailure !== undefined) {\n    column3.push(red(compilationFailure));\n  }\n  if (lambdaServerEvents.lastEvent) {\n    column3.push(renderLambdaServerEvent(lambdaServerEvents.lastEvent));\n  }\n\n  return [column1, column2, column3.join(' ')];\n}\n\nexport function renderErrorWarningCount(errors: ParsedError[]): string {\n  const errorCount = errors.filter(err => err.severity === 'error').length;\n  const warnCount = errors.filter(err => err.severity === 'warning').length;\n  const diag: string[] = [];\n\n  if (errorCount > 0) {\n    const plural = errorCount > 1 ? 's' : '';\n    diag.push(bgRed.whiteBright(` ${errorCount} error${plural} `));\n  }\n  if (warnCount > 0) {\n    const plural = warnCount > 1 ? 's' : '';\n    diag.push(bgYellow.whiteBright(` ${warnCount} warning${plural} `));\n  }\n  return diag.join(' ');\n}\n\nexport function renderLambdaServerEvent(event: LambdaServerEvent): string {\n  const type = event.event;\n  if (type === 'start') {\n    return `http://localhost:${event.port}`;\n  }\n  const req = gray(`${event.method} ${event.path}`);\n  if (type === 'error') {\n    return `${req} ${red(event.err)}`;\n  } else if (type === 'request') {\n    return `${req} ${gray('running lambda...')}`;\n    // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n  } else if (type === 'response') {\n    const httpCode = `[HTTP ${event.statusCode}]`;\n    const size = `[${event.body.length.toLocaleString()}b]`;\n    const duration = `[${event.duration.toLocaleString()}ms]`;\n    // eslint-disable-next-line @typescript-eslint/no-magic-numbers\n    const color = event.statusCode >= 400 ? red : green;\n    return `${req} ${color(`${httpCode} ${size} ${duration}`)}`;\n  }\n  neverHappens(type);\n}\n\nexport function renderWebpackDevServerEvent(event: WebpackDevServerEvent): string {\n  const type = event.event;\n  // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n  if (type === 'start') {\n    return `http://localhost:${event.port}`;\n  }\n  // const req = gray(`${event.method} ${event.path}`);\n  // if (type === 'error') {\n  //   return `${req} ${red(event.err)}`;\n  // } else if (type === 'request') {\n  //   return `${req} ${gray('running lambda...')}`;\n  //   // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n  // } else if (type === 'response') {\n  //   const httpCode = `[HTTP ${event.statusCode}]`;\n  //   const size = `[${event.byteLength.toLocaleString()}b]`;\n  //   const duration = `[${event.duration.toLocaleString()}ms]`;\n  //   // eslint-disable-next-line @typescript-eslint/no-magic-numbers\n  //   const color = event.statusCode >= 400 ? red : green;\n  //   return `${req} ${color(`${httpCode} ${size} ${duration}`)}`;\n  // }\n  neverHappens(type);\n}\n","import {cyan, gray, red, underline, yellow} from 'ansi-colors';\n\nimport {WorkspaceProject} from '@src/project/generate_workspace';\nimport {ErrorSeverity, ErrorType, ParsedError} from '@src/webpack-runner/error_parser';\n\nexport function formatProject(project: WorkspaceProject): string {\n  return `${cyan(project.projectName)} ${gray(project.type)}`;\n}\n\nexport function formatFilePath(filePath: string): string {\n  return underline(filePath);\n}\n\nfunction formatMessage(msg: string, severity: ErrorSeverity): string {\n  return severity === 'warning' ? yellow(msg) : red(msg);\n}\n\nconst padLeft = (value: string, size: number): string =>\n  value.length >= size ? value : padLeft(` ${value}`, size);\nconst padRight = (value: string, size: number): string =>\n  value.length >= size ? value : padRight(`${value} `, size);\n\nfunction formatLocation(loc?: {line: number; column?: number}): string {\n  const {line, column} = loc ?? {};\n  const padValue = 3;\n  const lineStr = String(line ?? '');\n  const columnStr = String(column ?? '');\n  if (lineStr.length === 0 && columnStr.length === 0) {\n    return padLeft('', 2 * padValue + 1);\n  }\n  return gray(`${padLeft(lineStr, padValue)}:${padRight(columnStr, padValue)}`);\n}\n\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nfunction formatLabel(code: string, type: ErrorType): string {\n  return gray(code);\n}\n\nexport function formatError(err: ParsedError): string {\n  if ('type' in err) {\n    return `${formatLocation(err.loc.start)} ${formatMessage(\n      err.message,\n      err.severity\n    )} ${formatLabel(err.code, err.type)}`;\n  }\n  return formatMessage(`[${err.severity}] ${err.message}`, err.severity);\n}\n","const ansiRegex = new RegExp(\n  [\n    '[\\\\u001B\\\\u009B][[\\\\]()#;?]*(?:(?:(?:[a-zA-Z\\\\d]*(?:;[-a-zA-Z\\\\d\\\\/#&.:=?%@~_]*)*)?\\\\u0007)',\n    '(?:(?:\\\\d{1,4}(?:;\\\\d{0,4})*)?[\\\\dA-PR-TZcf-ntqry=><~]))',\n  ].join('|'),\n  'gu'\n);\nconst stripAnsi = (s: string): string => s.replace(ansiRegex, '');\n\ntype AlignType = 'l' | 'r';\ntype Cell = string | number;\n\ninterface TextTableOptions {\n  align?: AlignType[];\n}\n\nfunction formatCell(cell: Cell): string {\n  return typeof cell === 'string' ? cell : cell.toLocaleString();\n}\n\nfunction padString(value: string, indent: number, right: boolean): string {\n  let valueStr = value;\n  for (let i = 0; i < indent; i++) {\n    valueStr = right ? `${valueStr} ` : ` ${valueStr}`;\n  }\n  return valueStr;\n}\n\nexport function table(data: Cell[][], options?: TextTableOptions): string {\n  if (data.length === 0) {\n    return '';\n  }\n  const {align = []} = options ?? {};\n  const maxWidths: number[] = [];\n  for (const line of data) {\n    for (const [columnIndex, cell] of line.entries()) {\n      maxWidths[columnIndex] = Math.max(\n        maxWidths[columnIndex] ?? 0,\n        stripAnsi(formatCell(cell)).length\n      );\n    }\n  }\n\n  return data\n    .map(line =>\n      line\n        .map((cell, colIndex) => {\n          const content = formatCell(cell);\n          return padString(\n            content,\n            (maxWidths[colIndex] ?? 0) - stripAnsi(content).length,\n            align[colIndex] !== 'r'\n          );\n        })\n        .join(' ')\n    )\n    .join('\\n');\n}\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import {join} from 'node:path';\n\nimport {underline} from 'ansi-colors';\nimport {Configuration, Stats, webpack} from 'webpack';\nimport WebpackDevServer from 'webpack-dev-server';\n\nimport {registerExitCallback} from '@src/exit_handler';\nimport {setLogging} from '@src/fs';\nimport {globalError} from '@src/global_error';\nimport {ProjectName, ProjectType, WorkspaceFragment} from '@src/models';\nimport {getProjectsFromWorkspaceFragment, WorkspaceProject} from '@src/project/generate_workspace';\nimport {readProjectsFromWorkspace} from '@src/project/vscode_workspace';\nimport {neverHappens, removeUndefined} from '@src/type_utils';\nimport {\n  FullLambdaServerEvent,\n  LambdaServerEvent,\n  LambdaServerStartEvent,\n} from '@src/webpack/plugins/lambda_server_plugin';\nimport {\n  FullWebpackDevServerEvent,\n  WebpackDevServerStartEvent,\n} from '@src/webpack/plugins/webpack_dev_server';\nimport {generateEnvFile} from '@src/webpack-runner/env_definition_file';\nimport {groupAndSortErrors} from '@src/webpack-runner/error_grouper';\nimport {ParsedError, parseError} from '@src/webpack-runner/error_parser';\nimport {readLines} from '@src/webpack-runner/line_reader';\nimport {\n  renderErrors,\n  renderErrorWarningCount,\n  renderProjectStatus,\n} from '@src/webpack-runner/renderer';\nimport {table} from '@src/webpack-runner/text_table';\n\nsetLogging(false);\n\ninterface RunWebpacksOptions {\n  root: string;\n  workspaceFragments: WorkspaceFragment[];\n  watch: boolean;\n}\n\nexport interface LambdaServerEvents {\n  startEvent?: LambdaServerStartEvent;\n  lastEvent?: Exclude<LambdaServerEvent, LambdaServerStartEvent>;\n}\n\nexport interface WebpackDevServerEvents {\n  startEvent?: WebpackDevServerStartEvent;\n  // lastEvent?: Exclude<WebpackDevServerEvent, WebpackDevServerStartEvent>;\n}\n\ninterface ProjectStatus {\n  project: WorkspaceProject;\n  firstRun: boolean;\n  isRunning: boolean;\n  errors: ParsedError[];\n  compilationFailure?: string;\n  lambdaServerEvents: LambdaServerEvents;\n  webpackDevServerEvents: WebpackDevServerEvents;\n}\n\nconst name = 'WebpackRunner';\n\nexport async function runWebpacks(opts: RunWebpacksOptions): Promise<void> {\n  const {root, workspaceFragments, watch} = opts;\n  const statuses = new Map<ProjectName, ProjectStatus>();\n  const projects = workspaceFragments.flatMap(getProjectsFromWorkspaceFragment);\n\n  function regenerateEnvFile(): void {\n    const overrides = Object.fromEntries(\n      removeUndefined(\n        [...statuses.values()].map(({project, lambdaServerEvents, webpackDevServerEvents}) => {\n          if (project.type === ProjectType.LambdaApi && lambdaServerEvents.startEvent) {\n            return [\n              `${project.projectName.toUpperCase()}_FUNCTION_URL`,\n              `http://localhost:${lambdaServerEvents.startEvent.port}/`,\n            ];\n          }\n          if (project.type === ProjectType.Web && webpackDevServerEvents.startEvent) {\n            return [\n              `${project.projectName.toUpperCase()}_CLOUDFRONT_DOMAIN_NAME`,\n              `localhost:${webpackDevServerEvents.startEvent.port}`,\n            ];\n          }\n          return undefined;\n        })\n      )\n    );\n    generateEnvFile(overrides);\n  }\n  regenerateEnvFile();\n\n  function handleStart(project: WorkspaceProject): void {\n    const {projectName} = project;\n    const current = statuses.get(projectName) ?? {\n      project,\n      firstRun: true,\n      isRunning: true,\n      errors: [],\n      lambdaServerEvents: {},\n      webpackDevServerEvents: {},\n    };\n    statuses.set(projectName, {...current, isRunning: true});\n    onChange({isCompleted: false, projectName});\n  }\n\n  function handleResults(project: WorkspaceProject, stats: Stats): void {\n    const {projectName} = project;\n    const errors = [\n      ...stats.compilation.errors.map(err => parseError(err, {root, severity: 'error'})),\n      ...stats.compilation.warnings.map(warn => parseError(warn, {root, severity: 'warning'})),\n    ];\n    const lambdaServerEvents = statuses.get(projectName)?.lambdaServerEvents ?? {};\n    const webpackDevServerEvents = statuses.get(projectName)?.webpackDevServerEvents ?? {};\n    const compilationFailure = statuses.get(projectName)?.compilationFailure;\n    statuses.set(projectName, {\n      project,\n      firstRun: false,\n      isRunning: false,\n      errors,\n      compilationFailure,\n      lambdaServerEvents,\n      webpackDevServerEvents,\n    });\n    onChange({isCompleted: false, projectName});\n  }\n\n  function redraw(): void {\n    const errors = [...statuses.values()].flatMap(v => v.errors);\n    const groupedErrors = groupAndSortErrors(errors);\n\n    const summary = [...statuses.values()].map(status => {\n      return renderProjectStatus(\n        status.project,\n        status.firstRun,\n        status.isRunning,\n        groupedErrors,\n        status.compilationFailure,\n        status.lambdaServerEvents,\n        status.webpackDevServerEvents\n      );\n    });\n    summary.unshift([\n      underline(`Projects (${projects.length})`),\n      underline('Status'),\n      underline('Run'),\n    ]);\n    const report = renderErrors(groupedErrors);\n\n    if (watch) {\n      process.stdout.write('\\u001B[2J\\u001B[3J\\u001B[H'); // clear terminal\n    }\n    console.log(table(summary));\n    if (report.length > 0) {\n      console.log(`\\nBuild completed with ${renderErrorWarningCount(errors)}\\n`);\n      console.log(report);\n    }\n  }\n\n  const completed = new Set<ProjectName>();\n  function onChange(opts: {projectName: ProjectName; isCompleted: boolean}): void {\n    if (watch) {\n      redraw();\n      return;\n    }\n\n    const {projectName, isCompleted} = opts;\n    if (isCompleted) {\n      completed.add(projectName);\n    }\n    const allDone = [...statuses.keys()].every(projectName => completed.has(projectName));\n    if (!allDone) {\n      return;\n    }\n\n    const errors = [...statuses.values()].flatMap(v => v.errors);\n    const {globalErrors} = groupAndSortErrors(errors);\n    const noGlobalErrors =\n      globalErrors.length === 0 &&\n      [...statuses.values()].every(status => status.compilationFailure === undefined);\n    if (noGlobalErrors) {\n      resolve();\n    } else {\n      reject();\n    }\n  }\n\n  const cleanupFunctions = await Promise.all(\n    projects.map(async project => {\n      const {projectName} = project;\n      const projectPath = join(root, projectName);\n      const intialStatus = {\n        project,\n        firstRun: true,\n        isRunning: true,\n        errors: [],\n        lambdaServerEvents: {},\n        webpackDevServerEvents: {},\n      };\n      statuses.set(projectName, intialStatus);\n      // eslint-disable-next-line import/dynamic-import-chunkname, node/no-unsupported-features/es-syntax\n      const config: Configuration = await import(\n        /*webpackIgnore: true*/ join(projectPath, 'webpack.config.js')\n      ).then(({getConfig}) => getConfig({context: projectPath, watch}));\n\n      const reportCompilationFailure = (error: string): void => {\n        updateStatus(curr => {\n          curr.compilationFailure = error;\n        });\n      };\n\n      const updateLambdaServerEvents = (fn: (curr: LambdaServerEvents) => void): void => {\n        updateStatus(curr => fn(curr.lambdaServerEvents));\n      };\n\n      const updateWebpackDevServerEvents = (fn: (curr: WebpackDevServerEvents) => void): void => {\n        updateStatus(curr => fn(curr.webpackDevServerEvents));\n      };\n\n      const updateStatus = (fn: (curr: ProjectStatus) => void): void => {\n        let current = statuses.get(projectName);\n        if (!current) {\n          current = intialStatus;\n          statuses.set(projectName, current);\n        }\n        fn(current);\n      };\n\n      // Read events in the lambda server logs to update the globalInfo\n      let lastProcessedLambdaLog = Date.now();\n      const tailLambdaServerCleanup = watch\n        ? readLines(join(projectPath, 'log', 'lambda_server_runtime.txt'), lines => {\n            const logs = lines\n              .map(l => l.trim())\n              .filter(l => l.length > 0)\n              .map(l => JSON.parse(l) as FullLambdaServerEvent);\n            let shouldRedraw = false;\n            for (const log of logs) {\n              const date = new Date(log.t).getTime();\n              if (date < lastProcessedLambdaLog) {\n                continue;\n              }\n              lastProcessedLambdaLog = date;\n              shouldRedraw = true;\n              if (log.event === 'start') {\n                updateLambdaServerEvents(curr => {\n                  curr.startEvent = log;\n                });\n                regenerateEnvFile();\n              } else {\n                updateLambdaServerEvents(curr => {\n                  curr.lastEvent = log;\n                });\n              }\n            }\n            if (shouldRedraw) {\n              redraw();\n            }\n          })\n        : undefined;\n\n      // Read events in the webpack dev server logs to update the globalInfo\n      let lastProcessedDevServerLog = Date.now();\n      const tailWebpackServerCleanup = watch\n        ? readLines(join(projectPath, 'log', 'webpack_dev_server.txt'), lines => {\n            const logs = lines\n              .map(l => l.trim())\n              .filter(l => l.length > 0)\n              .map(l => JSON.parse(l) as FullWebpackDevServerEvent);\n            let shouldRedraw = false;\n            for (const log of logs) {\n              const date = new Date(log.t).getTime();\n              if (date < lastProcessedDevServerLog) {\n                continue;\n              }\n              lastProcessedDevServerLog = date;\n              shouldRedraw = true;\n              // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n              if (log.event === 'start') {\n                updateWebpackDevServerEvents(curr => {\n                  curr.startEvent = log;\n                });\n              } else {\n                neverHappens(log.event);\n                //   updateWebpackDevServerEvents(curr => {\n                //     curr.lastEvent = log;\n                //   });\n              }\n            }\n            if (shouldRedraw) {\n              redraw();\n            }\n          })\n        : undefined;\n\n      const compiler = webpack({...config, watch}, (err?: Error, res?: Stats) => {\n        if (err || !res) {\n          reportCompilationFailure(err ? String(err) : 'No result after compilation');\n          if (!watch) {\n            onChange({isCompleted: true, projectName});\n            resolve();\n            return;\n          }\n        }\n        onChange({isCompleted: true, projectName});\n      });\n      compiler.hooks.beforeRun.tap(name, () => handleStart(project));\n      compiler.hooks.watchRun.tap(name, () => handleStart(project));\n      compiler.hooks.done.tap(name, stats => handleResults(project, stats));\n\n      let devServer: WebpackDevServer | undefined;\n      if (config.devServer) {\n        devServer = new WebpackDevServer(config.devServer, compiler);\n        await devServer.start();\n      }\n      return async (): Promise<void> => {\n        return new Promise<void>((resolve, reject) => {\n          const closeCompiler = (): void => {\n            tailLambdaServerCleanup?.();\n            tailWebpackServerCleanup?.();\n            compiler.close(err => (err ? reject(err) : resolve()));\n          };\n          if (devServer) {\n            devServer.stop().then(closeCompiler).catch(reject);\n          } else {\n            closeCompiler();\n          }\n        });\n      };\n    })\n  );\n\n  let resolvePromise: () => void;\n  let rejectPromise: (err?: unknown) => void;\n  const globalPromise = new Promise<void>((resolve, reject) => {\n    resolvePromise = resolve;\n    rejectPromise = reject;\n  });\n\n  let cleanupCalled = false;\n  const cleanup = async (): Promise<void> => {\n    if (cleanupCalled) {\n      return;\n    }\n    cleanupCalled = true;\n    await Promise.all(cleanupFunctions.map(async fn => fn()));\n    redraw();\n  };\n\n  const reject = (err?: unknown): void => {\n    cleanup()\n      .then(() => rejectPromise(err))\n      .catch(cleanupErr => {\n        globalError('webpack runner cleanup error', cleanupErr);\n        rejectPromise(err);\n      });\n  };\n  const resolve = (): void => {\n    cleanup()\n      .then(resolvePromise)\n      .catch(cleanupErr => {\n        globalError('webpack runner cleanup error', cleanupErr);\n        resolvePromise();\n      });\n  };\n\n  registerExitCallback(cleanup);\n  return globalPromise;\n}\n\nexport async function runAllWebpacks(\n  options: Omit<RunWebpacksOptions, 'projectPaths'>\n): Promise<void> {\n  const {root, watch} = options;\n\n  const workspaceFragments = await readProjectsFromWorkspace(root);\n  if (!workspaceFragments) {\n    throw new Error(`No workspace projects at path ${root}`);\n  }\n  await runWebpacks({\n    root,\n    workspaceFragments,\n    watch,\n  });\n}\n"],"names":["globalError","called","callbacks","runCallbacks","fn","Promise","resolve","catch","err","process","on","registerExitCallback","cb","push","appendFileSync","val","data","str","Error","stack","String","JSON","stringify","console","error","exec","mkdirSync","promises","writeFileSync","dirname","join","format","access","readFile","readdir","stat","writeFile","mkdir","rm","logEnabled","setLogging","enabled","writeJsonFile","path","json","writeRawFile","undefined","prettierConfig","parser","printWidth","singleQuote","trailingComma","bracketSpacing","arrowParens","endOfLine","writePrettyFile","code","writePrettyFileSync","writeRawFileSync","writeJsFile","js","writeJsFileSync","writeTsFile","ts","writeTsFileSync","content","log","recursive","rmDir","dirPath","force","cleanDir","cp","from","to","reject","exists","maybeReadFile","fileContent","toString","listFiles","files","ents","withFileTypes","ent","entPath","name","isDirectory","then","subFiles","isFile","all","RuntimeType","RUNTIME_TYPE_TO_METADATA","Web","eslint","tsconfig","webpack","Node","Lib","Lambda","ReactNative","NodeLib","NodeScript","ProjectType","PROJECT_TYPE_TO_METADATA","runtimeType","LambdaFunction","LambdaApi","Shared","WorkspaceFragmentType","validateRegistry","execSync","fileURLToPath","generateProject","generateGitIgnore","generateWorkspacePackageJson","generateCommonTerraform","generateWorkspaceProjectTerraform","generateCodeWorkspace","neverHappens","getProjectsFromWorkspaceFragment","fragment","type","StaticWebsite","projectName","websiteName","StandaloneLambda","lambdaName","WebApp","libName","scriptName","generateWorkspace","dst","workspaceName","workspaceFragments","alreadyGenerated","projects","flatMap","filter","p","includes","map","project","SCRIPTS_PATH","import","meta","url","terraformPath","commands","stdio","TEMPLATES_PATH","packageJsonPath","packageJsonbuffer","packageJson","parse","file","buffer","newContent","replaceAll","trim","PACKAGE_VERSIONS","TYPESCRIPT_VERSION","uniq","runtimes","Set","r","values","projectMetadata","eslintRuntimes","tsconfigRuntimes","webpackRuntimes","license","scripts","setup","deploy","build","watch","eslintConfig","ignorePatterns","prettier","devDependencies","Object","fromEntries","runtime","runner","sort","d1","d2","localeCompare","ESLINT_VERSION","PRETTIER_VERSION","LIB_VERSIONS","react","generateCloudfrontDistributionTerraform","generateLambdaTerraform","generateAwsProviderTerraform","generateS3BucketTerraform","api","bucketName","toLowerCase","replace","originId","opts","webProjectNames","CODE_BUCKET","CLOUDFRONT_ACCESS","out","length","value","msg","notUndefined","removeUndefined","arr","projectNames","folders","settings","reportUnusedDisableDirectives","extensions","recommendations","readProjectsFromWorkspace","workspacePath","workspaceContent","workspaceJson","workspaceProjects","Array","isArray","getEnv","generateEnvFile","overrides","cwd","res","outputsEntries","entries","key","sensitive","toUpperCase","envConstants","NODE_ENV","createHash","isProd","env","isSelenium","packageJsonCache","Map","findPackageJson","has","get","pStat","dir","set","getPort","context","hexHash","update","digest","slice","port","Math","floor","parseInt","initLogFile","logFileName","root","lookupRoot","logDir","logFile","fromPath","parent","groupAndSortErrors","errors","errorsByProjectByFile","globalErrors","projectErrors","fileErrors","loc","absolutePath","byFile","err1","err2","start","diffLine","line","column","diffColumn","message","relative","sep","parseFilePath","relativePath","split","parseError","severity","eslintError","ruleId","end","issue","location","match","spawn","readLines","filePath","cleanup","killed","kill","stdout","chunk","lines","at","bgRed","bgYellow","cyan","gray","green","red","formatError","formatFilePath","formatProject","renderErrors","blocks","renderProjectStatus","firstRun","isRunning","compilationFailure","lambdaServerEvents","webpackDevServerEvents","column1","column2","renderErrorWarningCount","flat","column3","startEvent","renderLambdaServerEvent","renderWebpackDevServerEvent","lastEvent","errorCount","warnCount","diag","plural","whiteBright","event","req","method","httpCode","statusCode","size","body","toLocaleString","duration","color","underline","yellow","formatMessage","padLeft","padRight","formatLocation","padValue","lineStr","columnStr","formatLabel","ansiRegex","RegExp","stripAnsi","s","formatCell","cell","padString","indent","right","valueStr","i","table","options","align","maxWidths","columnIndex","max","colIndex","WebpackDevServer","runWebpacks","statuses","regenerateEnvFile","handleStart","current","onChange","isCompleted","handleResults","stats","_statuses$get","_statuses$get2","_statuses$get3","compilation","warnings","warn","redraw","v","groupedErrors","summary","status","unshift","report","write","completed","add","allDone","keys","every","noGlobalErrors","cleanupFunctions","projectPath","intialStatus","config","getConfig","reportCompilationFailure","updateStatus","curr","updateLambdaServerEvents","updateWebpackDevServerEvents","lastProcessedLambdaLog","Date","now","tailLambdaServerCleanup","logs","l","shouldRedraw","date","t","getTime","lastProcessedDevServerLog","tailWebpackServerCleanup","compiler","hooks","beforeRun","tap","watchRun","done","devServer","closeCompiler","close","stop","resolvePromise","rejectPromise","globalPromise","cleanupCalled","cleanupErr","runAllWebpacks"],"sourceRoot":""}