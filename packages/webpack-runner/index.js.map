{"version":3,"file":"index.js","mappings":"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AIY,MAAM,CAACd,UAAU,IAAI,GAC7D,EAAE;AACV;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCACgCuP,QAAQ;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBACIzO,MAAM,GACF;AACR,qDAAqDR,WAAW;AAChE;AACA,8CAA8C,GACtC;AACR,0CAA0C;AAC1C;AACA;AACA,GACG,CAACmL,IAAI,CAAC,CAAC;AACV;;;;;;;;;;;AClK4C;AAYrC,SAASwD,uBAAuBA,CACrC9M,aAA4B,EAC5B7B,WAAwB,EACxBoG,IAAqC,EAC7B;EACR,MAAM;IAACvF,GAAG;IAAEC,UAAU;IAAEC,UAAU;IAAEC,wBAAwB;IAAER,MAAM;IAAES;EAAc,CAAC,GAAGmF,IAAI;EAC5F,OAAO;AACT;AACA,kCAAkCpG,WAAW;AAC7C,IACIiB,cAAc,EAAEQ,OAAO,GACnB;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBACMX,UAAU,KAAK7B,SAAS,GACpB,EAAE,GACF;AACV,+BAA+BlB,4DAAS,CAAC+C,UAAU,CAAC;AACpD,+BAA+B/C,4DAAS,CAAC+C,UAAU,CAAC;AACpD,+BAA+B/C,4DAAS,CAAC+C,UAAU,CAAC;AACpD,+BAA+B/C,4DAAS,CAAC+C,UAAU,CAAC;AACpD,KAAK;AACL,IACI,GACI,EAAE,GAENA,UAAU,KAAK7B,SAAS,GACpB;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI,GACI,EAAE;AACV;AACA;AACA,kCACkCe,WAAW;AAC7C,qBAAqB6B,aAAa,IAAI7B,WAAW;AACjD,kCAAkCA,WAAW;AAC7C,kCAAkCA,WAAW;AAC7C;AACA;AACA,iCAAiCA,WAAW;AAC5C;AACA;AACA;AACA,mBACMa,GAAG,GACC;AACV;AACA,gDAAgDb,WAAW;AAC3D,gDAAgDA,WAAW,iCAAiC,GAClF;AACV,4CAA4C;AAC5C;AACA;AACA;AACA;AACA,UACUA,WAAW;AACrB,sCAAsCA,WAAW;AACjD,2CAA2C6B,aAAa,IAAI7B,WAAW;AACvE;AACA,EACEa,GAAG,GACC;AACN;AACA;AACA,sCAAsCb,WAAW;AACjD,6CAA6CA,WAAW;AACxD;AACA;AACA;AACA,UAAUA,WAAW;AACrB,mBACIQ,MAAM,GACF,WAAWA,MAAM,CAACZ,SAAS,IAAIY,MAAM,CAACd,UAAU,GAAG,GACnD,0CAA0CM,WAAW,gBAAgB;AAC7E,6BAC6BA,WAAW;AACxC,GACQQ,MAAM,KAAKvB,SAAS,GAChB;AACZ;AACA;AACA;AACA,2BAA2Be,WAAW;AACtC,YAAYQ,MAAM,CAACd,UAAU;AAC7B;AACA;AACA,iCAAiCM,WAAW;AAC5C,oCAAoCA,WAAW;AAC/C,eAAeQ,MAAM,CAACZ,SAAS,IAAIY,MAAM,CAACd,UAAU;AACpD;AACA;AACA;AACA,2DAA2DM,WAAW;AACtE,2DAA2DA,WAAW;AACtE;AACA;AACA;AACA;AACA,iCAAiCA,WAAW;AAC5C,oCAAoCA,WAAW;AAC/C,eAAeQ,MAAM,CAACZ,SAAS,IAAIY,MAAM,CAACd,UAAU;AACpD;AACA;AACA;AACA,2DAA2DM,WAAW;AACtE,2DAA2DA,WAAW;AACtE;AACA;AACA;AACA;AACA,kCAAkCA,WAAW;AAC7C,mCAAmCQ,MAAM,CAACZ,SAAS,IAAIY,MAAM,CAACd,UAAU;AACxE,kCAAkCc,MAAM,CAACZ,SAAS,IAAIY,MAAM,CAACd,UAAU;AACvE;AACA;AACA;AACA;AACA,iCAAiCM,WAAW;AAC5C;AACA,qCAAqCA,WAAW;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4CAA4CA,WAAW;AACvD;AACA;AACA,6CAA6CA,WAAW;AACxD;AACA,kDAAkDA,WAAW;AAC7D,gEAAgEA,WAAW;AAC3E,EAAE,GACU,EAAE;AACd;AACA;AACA;AACA,4BAC4BA,WAAW;AACvC;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4BA,WAAW;AACvC;AACA;AACA;AACA;AACA,0CAA0CA,WAAW;AACrD;AACA;AACA,4DAA4DA,WAAW;AACvE,wCAAwCA,WAAW;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8BA,WAAW;AACzC,8BAA8BA,WAAW;AACzC;AACA;AACA;AACA;AACA;AACA;AACA,0CACIQ,MAAM,GACF;AACR,4BAA4BA,MAAM,CAACZ,SAAS,IAAIY,MAAM,CAACd,UAAU,IAAI,GAC7D,EAAE;AACV;AACA;AACA;AACA;AACA;AACA,mDACmDM,WAAW;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBACIQ,MAAM,GACF;AACR,qDAAqDR,WAAW;AAChE;AACA,8CAA8C,GACtC;AACR,0CAA0C;AAC1C;AACA,EACE,GACI,EAAE;AACR,EAEEgB,wBAAwB,KAAK/B,SAAS,GAClC;AACN;AACA,sDAAsDe,WAAW;AACjE;AACA;AACA,wCAAwCA,WAAW;AACnD;AACA,8CAA8CA,WAAW;AACzD;AACA;AACA,wCAAwCA,WAAW;AACnD,2BAA2BA,WAAW,SAASgB,wBAAwB;AACvE,gCAAgCA,wBAAwB,UACpDA,wBAAwB,GAAG,CAAC,GAAG,GAAG,GAAG,EAAE;AAC3C;AACA;AACA,0CAC0ChB,WAAW;AACrD,qCAAqCA,WAAW;AAChD,+BAA+BA,WAAW;AAC1C;AACA,CAAC,GACK,EAAE;AACR;AACA;AACA,2BAC2BA,WAAW;AACtC,YAAY6B,aAAa,IAAI7B,WAAW;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB6B,aAAa,IAAI7B,WAAW;AAC5C,4CAA4CA,WAAW;AACvD;AACA;AACA;AACA,UAAUA,WAAW;AACrB,yBAAyBA,WAAW;AACpC;AACA;AACA;AACA;AACA,uCAAuCA,WAAW;AAClD,wBAAwB6B,aAAa,IAAI7B,WAAW;AACpD;AACA;AACA,6BAA6BA,WAAW;AACxC,YAAY6B,aAAa,IAAI7B,WAAW;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyCA,WAAW;AACpD,yCAAyCA,WAAW;AACpD;AACA;AACA;AACA;AACA;AACA;AACA,6CAA6CA,WAAW;AACxD,8BAA8BA,WAAW;AACzC,gCAAgCA,WAAW;AAC3C;AACA,EACEe,UAAU,KAAK9B,SAAS,GACpB;AACN;AACA;AACA,+CAA+Ce,WAAW;AAC1D,sBAAsB6B,aAAa,IAAI7B,WAAW;AAClD;AACA,8CAA8CA,WAAW;AACzD;AACA;AACA,uBAAuB6B,aAAa,IAAI7B,WAAW;AACnD,uBAAuB6B,aAAa;AACpC;AACA;AACA;AACA;AACA;AACA;AACA,0CAA0C7B,WAAW;AACrD,2BAA2B6B,aAAa,IAAI7B,WAAW;AACvD,2DAA2DA,WAAW;AACtE,2DAA2DA,WAAW;AACtE;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyCA,WAAW;AACpD,yCAAyCA,WAAW;AACpD;AACA;AACA;AACA,4BAA4BA,WAAW;AACvC,YAAY6B,aAAa,IAAI7B,WAAW;AACxC;AACA;AACA,yCAAyCA,WAAW;AACpD,iBAAiBe,UAAU;AAC3B;AACA,8BAA8Bf,WAAW;AACzC;AACA,CAAC,GACK,EAAE;AACR;AACA,4BAC4BA,WAAW;AACvC;AACA,sBAAsBA,WAAW;AACjC;AACA;AACA;AACA,CAAC,CAACmL,IAAI,CAAC,CAAC;AACR;;;;;;;;;;AChYO,SAASyD,4BAA4BA,CAC1C/M,aAA4B,EAC5BuE,IAAsB,EACd;EACR,MAAM;IAAC0I;EAAM,CAAC,GAAG1I,IAAI;EACrB,OAAO;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC0I,MAAM;AACtC;AACA;AACA,mBAAmBjN,aAAa;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmBA,aAAa;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,CAACsJ,IAAI,CAAC,CAAC;AACR;;;;;;;;;;ACnDO,SAAS0D,yBAAyBA,CACvChN,aAA4B,EAC5BqN,eAA8B,EACtB;EACR,MAAMH,UAAU,GAAGlN,aAAa,CAAC4J,WAAW,CAAC,CAAC,CAACuD,OAAO,CAAC,gBAAgB,EAAE,GAAG,CAAC;EAE7E,MAAMG,WAAW,GAAG;AACtB;AACA,qBAAqBJ,UAAU;AAC/B;AACA;AACA;AACA;AACA;AACA,CAAC,CAAC5D,IAAI,CAAC,CAAC;EAEN,MAAMiE,iBAAiB,GAAG;AAC5B;AACA,IAAIF,eAAe,CACd7M,GAAG,CAACmB,CAAC,IACJ;AACN;AACA;AACA;AACA,oCAAoCA,CAAC;AACrC;AACA;AACA;AACA,6DAA6DA,CAAC;AAC9D;AACA;AACA,CAAC,CAAC2H,IAAI,CAAC,CACH,CAAC,CACAvO,IAAI,CAAC,MAAM,CAAC;AACjB;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,CAACuO,IAAI,CAAC,CAAC;EAEN,MAAMkE,GAAG,GAAG,CAACF,WAAW,CAAC;EACzB,IAAID,eAAe,CAACnE,MAAM,GAAG,CAAC,EAAE;IAC9BsE,GAAG,CAACjV,IAAI,CAACgV,iBAAiB,CAAC;EAC7B;EACA,OAAOC,GAAG,CAACzS,IAAI,CAAC,MAAM,CAAC;AACzB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACjDA,SAAS0S,YAAYA,CAAI/U,GAAkB,EAAY;EACrD,OAAOA,GAAG,KAAK0E,SAAS;AAC1B;AAEO,SAASsQ,QAAQA,CAAChV,GAAY,EAAiB;EACpD,OAAO,OAAOA,GAAG,KAAK,QAAQ;AAChC;AAEO,SAASiV,QAAQA,CAACjV,GAAY,EAAiB;EACpD,OAAO,OAAOA,GAAG,KAAK,QAAQ;AAChC;AAEO,SAASkV,cAAcA,CAA4CC,CAAI,EAAgB;EAC5F,OAAOtG,MAAM,CAAC0D,MAAM,CAAC4C,CAAC,CAAC,CAACjT,MAAM,CAAC+S,QAAQ,CAAC;AAC1C;AAEO,SAASG,cAAcA,CAAmCD,CAAI,EAAgB;EACnF,OAAOtG,MAAM,CAAC0D,MAAM,CAAC4C,CAAC,CAAC,CAACjT,MAAM,CAAC8S,QAAQ,CAAC;AAC1C;AAEO,SAASrR,eAAeA,CAAI0R,GAAsB,EAAO;EAC9D,OAAOA,GAAG,CAACnT,MAAM,CAAC6S,YAAY,CAAC;AACjC;AAEO,SAASO,0BAA0BA,CAAoCC,GAAM,EAAM;EACxF,OAAO1G,MAAM,CAACwE,WAAW,CACvBxE,MAAM,CAACC,OAAO,CAACyG,GAAG,CAAC,CAACrT,MAAM,CAACiT,CAAC,IAAIA,CAAC,CAAC,CAAC,CAAC,KAAKzQ,SAAS,IAAIyQ,CAAC,CAAC,CAAC,CAAC,KAAK,IAAI,CACrE,CAAC;AACH;AAEO,SAASzR,YAAYA,CAACqN,KAAY,EAAEyE,YAAqB,EAAS;EACvE,MAAM,IAAIrV,KAAK,CAACqV,YAAY,CAAC;AAC/B;AASO,SAASC,KAAKA,CACnB1E,KAAc,EACd2E,YAAsC,EACD;EACrC,OAAO,OAAO3E,KAAK,KAAK,QAAQ,IAAIA,KAAK,KAAK,IAAI,IAAI,CAAC4E,KAAK,CAACC,OAAO,CAAC7E,KAAK,CAAC,GACtEA,KAAK,GACN2E,YAAY;AAClB;AACO,SAASG,YAAYA,CAAC9E,KAAc,EAA2B;EACpE,MAAM+E,UAAU,GAAGL,KAAK,CAAC1E,KAAK,CAAC;EAC/B,IAAI+E,UAAU,KAAKpR,SAAS,EAAE;IAC5B,MAAM,IAAIvE,KAAK,CAAC,oBAAoB4Q,KAAK,iBAAiB,CAAC;EAC7D;EACA,OAAO+E,UAAU;AACnB;AAOO,SAASC,MAAMA,CACpBhF,KAAa,EACb2E,YAAsC,EACD;EACrC,IAAI;IACF,MAAM9J,IAAI,GAAGtL,IAAI,CAACoO,KAAK,CAACqC,KAAK,CAAC;IAC9B,MAAMxI,GAAG,GAAGkN,KAAK,CAAC7J,IAAI,CAAC;IACvB,OAAOrD,GAAG,IAAImN,YAAY;EAC5B,CAAC,CAAC,MAAM;IACN,OAAOA,YAAY;EACrB;AACF;AACO,SAASM,aAAaA,CAACjF,KAAa,EAA2B;EACpE,MAAMkF,WAAW,GAAGF,MAAM,CAAChF,KAAK,CAAC;EACjC,IAAIkF,WAAW,KAAKvR,SAAS,EAAE;IAC7B,MAAM,IAAIvE,KAAK,CAAC,oBAAoB4Q,KAAK,wCAAwC,CAAC;EACpF;EACA,OAAOkF,WAAW;AACpB;AAOO,SAASC,YAAYA,CAC1BnF,KAAc,EACd2E,YAAsC,EACD;EACrC,MAAMxV,GAAG,GAAGiW,QAAQ,CAACpF,KAAK,CAAC;EAC3B,OAAO7Q,GAAG,KAAKwE,SAAS,GACpBgR,YAAY,GACZA,YAAY,KAAKhR,SAAS,GACxBqR,MAAM,CAAC7V,GAAG,CAAC,GACX6V,MAAM,CAAC7V,GAAG,EAAEwV,YAAY,CAAC;AACjC;AACO,SAASU,mBAAmBA,CAACrF,KAAc,EAA2B;EAC3E,OAAOiF,aAAa,CAACK,eAAe,CAACtF,KAAK,CAAC,CAAC;AAC9C;AAIO,SAASoF,QAAQA,CACtBpF,KAAc,EACd2E,YAAqB,EACN;EACf,OAAQ,OAAO3E,KAAK,KAAK,QAAQ,GAAGA,KAAK,GAAG2E,YAAY;AAC1D;AACO,SAASW,eAAeA,CAA4BtF,KAAc,EAAK;EAC5E,MAAMuF,aAAa,GAAGH,QAAQ,CAAIpF,KAAK,CAAC;EACxC,IAAIuF,aAAa,KAAK5R,SAAS,EAAE;IAC/B,MAAM,IAAIvE,KAAK,CAAC,oBAAoB4Q,KAAK,oBAAoB,CAAC;EAChE;EACA,OAAOuF,aAAa;AACtB;AAWO,SAASC,YAAYA,CAC1BxF,KAAc,EACdyF,GAAM,EACNd,YAAyB,EACD;EACxB,OACE,OAAO3E,KAAK,KAAK,QAAQ,IAAIlC,MAAM,CAAC0D,MAAM,CAACiE,GAAG,CAAC,CAAC/G,QAAQ,CAACsB,KAAmB,CAAC,GACzEA,KAAK,GACL2E,YAAY;AAEpB;AACO,SAASe,mBAAmBA,CACjC1F,KAAc,EACdyF,GAAM,EACM;EACZ,MAAMF,aAAa,GAAGC,YAAY,CAAIxF,KAAK,EAAEyF,GAAG,CAAC;EACjD,IAAIF,aAAa,KAAK5R,SAAS,EAAE;IAC/B,MAAM,IAAIvE,KAAK,CACb,oBAAoB4Q,KAAK,oCAAoCzQ,IAAI,CAACC,SAAS,CACzEsO,MAAM,CAAC0D,MAAM,CAACiE,GAAG,CACnB,CAAC,EACH,CAAC;EACH;EACA,OAAOF,aAAa;AACtB;AAIO,SAASI,OAAOA,CAAc3F,KAAc,EAAE2E,YAAwB,EAAmB;EAC9F,OAAQC,KAAK,CAACC,OAAO,CAAC7E,KAAK,CAAC,GAAGA,KAAK,GAAG2E,YAAY;AACrD;AACO,SAASiB,cAAcA,CAAc5F,KAAc,EAAO;EAC/D,IAAI,CAAC4E,KAAK,CAACC,OAAO,CAAC7E,KAAK,CAAC,EAAE;IACzB,MAAM,IAAI5Q,KAAK,CAAC,oBAAoB4Q,KAAK,oBAAoB,CAAC;EAChE;EACA,OAAOA,KAAK;AACd;AAOO,SAAS6F,aAAaA,CAC3B7F,KAAc,EACd2E,YAAuB,EACN;EACjB,MAAML,GAAG,GAAGqB,OAAO,CAAC3F,KAAK,CAAC;EAC1B,IAAIsE,GAAG,KAAK3Q,SAAS,EAAE;IACrB,OAAOgR,YAAY;EACrB;EACA,OAAO/R,eAAe,CAAC0R,GAAG,CAACvN,GAAG,CAACqJ,CAAC,IAAIgF,QAAQ,CAAIhF,CAAC,CAAC,CAAC,CAAC;AACtD;AAEO,SAAS0F,oBAAoBA,CAA4B9F,KAAc,EAAO;EACnF,MAAMsE,GAAG,GAAGsB,cAAc,CAAC5F,KAAK,CAAC;EACjC,OAAOsE,GAAG,CAACvN,GAAG,CAACqJ,CAAC,IAAIkF,eAAe,CAAIlF,CAAC,CAAC,CAAC;AAC5C;AAOO,SAAS2F,UAAUA,CACxB/F,KAAc,EACd2E,YAAwC,EACD;EACvC,MAAML,GAAG,GAAGqB,OAAO,CAAC3F,KAAK,CAAC;EAC1B,IAAIsE,GAAG,KAAK3Q,SAAS,EAAE;IACrB,OAAOgR,YAAY;EACrB;EACA,OAAO/R,eAAe,CAAC0R,GAAG,CAACvN,GAAG,CAACqJ,CAAC,IAAIsE,KAAK,CAACtE,CAAC,CAAC,CAAC,CAAC;AAChD;AACO,SAAS4F,iBAAiBA,CAAChG,KAAc,EAA6B;EAC3E,MAAMsE,GAAG,GAAGsB,cAAc,CAAC5F,KAAK,CAAC;EACjC,OAAOsE,GAAG,CAACvN,GAAG,CAACqJ,CAAC,IAAI0E,YAAY,CAAC1E,CAAC,CAAC,CAAC;AACtC;AAIO,SAAS6F,QAAQA,CACtBjG,KAAc,EACd2E,YAAqB,EACN;EACf,IAAI,OAAO3E,KAAK,KAAK,QAAQ,EAAE;IAC7B,OAAQ,CAACkG,KAAK,CAAClG,KAAK,CAAC,GAAGA,KAAK,GAAG2E,YAAY;EAC9C;EACA,IAAI,OAAO3E,KAAK,KAAK,QAAQ,EAAE;IAC7B,IAAI;MACF,MAAMmG,WAAW,GAAGC,UAAU,CAACpG,KAAK,CAAC;MACrC,OAAQ,CAACkG,KAAK,CAACC,WAAW,CAAC,GAAGA,WAAW,GAAGxB,YAAY;IAC1D,CAAC,CAAC,MAAM;MACN,OAAOA,YAAY;IACrB;EACF;EACA,OAAOA,YAAY;AACrB;AACO,SAAS0B,eAAeA,CAA4BrG,KAAc,EAAK;EAC5E,MAAMsG,aAAa,GAAGL,QAAQ,CAACjG,KAAK,CAAC;EACrC,IAAIsG,aAAa,KAAK3S,SAAS,EAAE;IAC/B,MAAM,IAAIvE,KAAK,CAAC,oBAAoB4Q,KAAK,oBAAoB,CAAC;EAChE;EACA,OAAOsG,aAAa;AACtB;AAIO,SAASC,SAASA,CAACvG,KAAc,EAAE2E,YAAsB,EAAuB;EACrF,IAAI,OAAO3E,KAAK,KAAK,SAAS,EAAE;IAC9B,OAAOA,KAAK;EACd;EACA,IAAI,OAAOA,KAAK,KAAK,QAAQ,EAAE;IAC7B,OAAO,CAACkG,KAAK,CAAClG,KAAK,CAAC,GAAGA,KAAK,KAAK,CAAC,GAAG,KAAK;EAC5C;EACA,IAAI,OAAOA,KAAK,KAAK,QAAQ,EAAE;IAC7B,IAAIA,KAAK,KAAK,GAAG,IAAIA,KAAK,KAAK,OAAO,EAAE;MACtC,OAAO,KAAK;IACd,CAAC,MAAM,IAAIA,KAAK,KAAK,GAAG,IAAIA,KAAK,KAAK,MAAM,EAAE;MAC5C,OAAO,IAAI;IACb;IACA,OAAO2E,YAAY;EACrB;EACA,OAAOA,YAAY;AACrB;AAEO,SAAS6B,gBAAgBA,CAACxG,KAAc,EAAW;EACxD,MAAMyG,cAAc,GAAGF,SAAS,CAACvG,KAAK,CAAC;EACvC,IAAIyG,cAAc,KAAK9S,SAAS,EAAE;IAChC,MAAM,IAAIvE,KAAK,CAAC,oBAAoB4Q,KAAK,qBAAqB,CAAC;EACjE;EACA,OAAOyG,cAAc;AACvB;AAEA,MAAMC,eAAe,GAAG,gBAAgB;AAGjC,SAASC,MAAMA,CAAC3G,KAAc,EAAE2E,YAAmB,EAAoB;EAC5E,MAAMiC,IAAI,GACR5G,KAAK,YAAY6G,IAAI,GACjB7G,KAAK,GACL,IAAI6G,IAAI,CACN,OAAO7G,KAAK,KAAK,QAAQ,IAAI0G,eAAe,CAACI,IAAI,CAAC9G,KAAK,CAAC,GACpDoG,UAAU,CAACpG,KAAK,CAAC,GACjB1Q,MAAM,CAAC0Q,KAAK,CAClB,CAAC;EACP,OAAOkG,KAAK,CAACU,IAAI,CAACG,OAAO,CAAC,CAAC,CAAC,GAAGpC,YAAY,GAAGiC,IAAI;AACpD;AAEO,SAASI,aAAaA,CAAChH,KAAc,EAAQ;EAClD,MAAMiH,WAAW,GAAGN,MAAM,CAAC3G,KAAK,CAAC;EACjC,IAAIiH,WAAW,KAAKtT,SAAS,EAAE;IAC7B,MAAM,IAAIvE,KAAK,CAAC,oBAAoB4Q,KAAK,+BAA+B,CAAC;EAC3E;EACA,OAAOiH,WAAW;AACpB;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEO,SAASC,MAAMA,CAAIjY,GAAa,EAAe;EACpD,OAAOA,GAAG,KAAK,IAAI;AACrB;AAEO,SAASkY,OAAOA,CAAC1Y,GAAY,EAAS;EAC3C,OAAOA,GAAG,YAAYW,KAAK,GAAGX,GAAG,GAAG,IAAIW,KAAK,CAAC,OAAOX,GAAG,KAAK,QAAQ,GAAGA,GAAG,GAAGa,MAAM,CAACb,GAAG,CAAC,CAAC;AAC5F;AAEO,SAAS2Y,aAAaA,CAAC3Y,GAAY,EAAU;EAClD,MAAM4Y,QAAQ,GAAG3C,KAAK,CAACjW,GAAG,CAAC;EAC3B,IAAI4Y,QAAQ,KAAK1T,SAAS,EAAE;IAC1B,OAAOyR,QAAQ,CAAC3W,GAAG,CAAC,IAAIa,MAAM,CAACb,GAAG,CAAC;EACrC;EAEA,MAAMgW,YAAY,GAAGW,QAAQ,CAACiC,QAAQ,CAAC,SAAS,CAAC,CAAC;EAClD,IAAI5C,YAAY,KAAK9Q,SAAS,EAAE;IAC9B,OAAOrE,MAAM,CAACb,GAAG,CAAC;EACpB;EACA,OAAOgW,YAAY;AACrB;AAEO,SAAS6C,qBAAqBA,CAAC7Y,GAAY,EAAU;EAC1D,MAAM4Y,QAAQ,GAAG3C,KAAK,CAACjW,GAAG,CAAC;EAC3B,IAAI4Y,QAAQ,KAAK1T,SAAS,EAAE;IAC1B,OAAOyR,QAAQ,CAAC3W,GAAG,CAAC,IAAIa,MAAM,CAACb,GAAG,CAAC;EACrC;EAEA,MAAMY,KAAK,GAAG+V,QAAQ,CAACiC,QAAQ,CAAC,OAAO,CAAC,CAAC;EACzC,IAAIhY,KAAK,KAAKsE,SAAS,EAAE;IACvB,OAAOrE,MAAM,CAACb,GAAG,CAAC;EACpB;EACA,OAAOY,KAAK;AACd;AAEO,SAASkY,iBAAiBA,CAAIvH,KAAc,EAAEwH,QAAW,EAAK;EACnE,IAAIxH,KAAK,KAAKwH,QAAQ,EAAE;IACtB,MAAM,IAAIpY,KAAK,CAAC,oBAAoB4Q,KAAK,kBAAkBwH,QAAQ,IAAI,CAAC;EAC1E;EACA,OAAOxH,KAAK;AACd;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO,SAASyH,SAASA,CACvB5M,IAAY,EACqD;EACjE,IAAI;IACF,OAAO;MAACrD,GAAG,EAAEjI,IAAI,CAACoO,KAAK,CAAC9C,IAAI,CAAC;MAAEpM,GAAG,EAAEkF;IAAS,CAAC;EAChD,CAAC,CAAC,OAAOlF,GAAY,EAAE;IACrB,OAAO;MAACA,GAAG;MAAE+I,GAAG,EAAE7D;IAAS,CAAC;EAC9B;AACF;;AAKA;;AA4BA;;AAUA;;AAIO,SAAS+T,eAAeA,CAAIzY,GAAQ,EAA2B;EACpE,OAAOA,GAAG,CAACwQ,MAAM,GAAG,CAAC;AACvB;AACO,SAASkI,aAAaA,CAAI1Y,GAAQ,EAAgC;EACvE,OAAOA,GAAG,CAACwQ,MAAM,KAAK,CAAC,GAAG9L,SAAS,GAAI1E,GAAwB;AACjE;AAKO,SAAS2Y,SAASA,CACvBC,IAAO,EACP7G,MAAc,EACQ;EACtB,OAAOlD,MAAM,CAACwE,WAAW,CACvBxE,MAAM,CAACC,OAAO,CAAC8J,IAAI,CAAC,CAAC9Q,GAAG,CAAC,CAAC,CAAC+Q,GAAG,EAAE9H,KAAK,CAAC,KAAK,CAAC,GAAGgB,MAAM,GAAG8G,GAAG,EAAE,EAAE9H,KAAK,CAAC,CACvE,CAAC;AACH;;;;;;;;;;;AC7ZwD;AAEjD,SAAS3N,2BAA2BA,CAACkE,aAA4B,EAAET,OAAe,EAAU;EACjG,MAAMiS,WAAW,GAAGtV,4DAAS,CAACqD,OAAO,CAAC;EACtC,MAAMkS,YAAY,GAAG,GAAGtV,6DAAU,CAAC6D,aAAa,CAAC,GAAG7D,6DAAU,CAACoD,OAAO,CAAC,EAAE;EACzE,OAAO;AACT,UAAUiS,WAAW;AACrB,+BAA+BA,WAAW;AAC1C;AACA;AACA,UAAUA,WAAW;AACrB;AACA,oCAAoCA,WAAW,yCAAyCA,WAAW;AACnG;AACA;AACA;AACA,iCAAiCA,WAAW;AAC5C,oBAAoBC,YAAY;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE,CAACnI,IAAI,CAAC,CAAC;AACT;;;;;;;;;;;AC1BwD;AAEjD,SAASvN,kCAAkCA,CAChDiE,aAA4B,EAC5BT,OAAe,EACP;EACR,MAAMiS,WAAW,GAAGtV,4DAAS,CAACqD,OAAO,CAAC;EACtC,MAAMkS,YAAY,GAAG,GAAGtV,6DAAU,CAAC6D,aAAa,CAAC,GAAG7D,6DAAU,CAACoD,OAAO,CAAC,EAAE;EACzE,OAAO,WAAWiS,WAAW;AAC/B,+BAA+BA,WAAW;AAC1C;AACA;AACA,UAAUA,WAAW;AACrB;AACA,oCAAoCA,WAAW,iDAAiDA,WAAW;AAC3G;AACA;AACA;AACA,iCAAiCA,WAAW;AAC5C,oBAAoBC,YAAY;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE,CAACnI,IAAI,CAAC,CAAC;AACT;;;;;;;;;;;;;;;;;;AClC+B;AAEiC;AACkB;AACe;AASxE;AAElB,SAAStN,qBAAqBA,CACnCgE,aAAqB,EACrBC,kBAAuC,EACd;EACzB,MAAMG,QAAQ,GAAGH,kBAAkB,CAACI,OAAO,CAACpD,CAAC,IAAIe,iGAAgC,CAACf,CAAC,CAAC,CAAC;EACrF,MAAMyU,YAAY,GAAGtR,QAAQ,CAACI,GAAG,CAACmB,CAAC,IAAIA,CAAC,CAACxD,WAAW,CAAC;EACrD,OAAO;IACLwT,OAAO,EAAE,CACP,GAAGD,YAAY,CAAClR,GAAG,CAACmB,CAAC,KAAK;MAACf,IAAI,EAAEe;IAAC,CAAC,CAAC,CAAC,EACrC;MAACf,IAAI,EAAE;IAAW,CAAC,EACnB;MAACA,IAAI,EAAE,GAAG;MAAEgB,IAAI,EAAE;IAAM,CAAC,CAC1B;IACDgQ,QAAQ,EAAE;MACR,cAAc,EAAE,GAAG5R,aAAa,oCAAoC;MACpE,eAAe,EAAEuH,MAAM,CAACwE,WAAW,CAAC,CAClC,GAAG2F,YAAY,CAAClR,GAAG,CAACmB,CAAC,IAAI,CAACA,CAAC,EAAE,IAAI,CAAC,CAAC,EACnC,CAAC,WAAW,EAAE,IAAI,CAAC,CACpB,CAAC;MACF,0CAA0C,EAAE,KAAK;MACjD,yBAAyB,EAAE,OAAO;MAClC,8CAA8C,EAAE,mCAAmC;MACnF,wBAAwB,EAAE,KAAK;MAC/B,eAAe,EAAE,IAAI;MACrB,iBAAiB,EAAE,KAAK;MACxB,8CAA8C,EAAE,cAAc;MAC9D,wBAAwB,EAAE,IAAI;MAC9B,uBAAuB,EAAE,IAAI;MAC7B,qBAAqB,EAAE,IAAI;MAC3B,0BAA0B,EAAE;QAC1B,eAAe,EAAE,OAAO;QACxB,sBAAsB,EAAE;MAC1B,CAAC;MACD,yBAAyB,EAAE,wBAAwB;MACnD,sBAAsB,EAAE,IAAI;MAC5B,gCAAgC,EAAE,OAAO;MACzC,oBAAoB,EAAE;QACpB,MAAM,EAAE;MACV,CAAC;MACD,cAAc,EAAE;QACd,yBAAyB,EAAE;MAC7B,CAAC;MACD,mBAAmB,EAAE;QACnB,yBAAyB,EAAE;MAC7B,CAAC;MACD,aAAa,EAAE;QACb,yBAAyB,EAAE;MAC7B;IACF,CAAC;IACDkQ,UAAU,EAAE;MACVC,eAAe,EAAE,CACf,wBAAwB,EACxB,wBAAwB,EACxB,wCAAwC,EACxC,4CAA4C,EAC5C,yBAAyB,EACzB,iBAAiB,EACjB,qBAAqB;IAEzB;EACF,CAAC;AACH;AAkBO,eAAeC,aAAaA,CAACC,aAAqB,EAAkC;EACzF,MAAMC,gBAAgB,GAAG,MAAMxM,sDAAa,CAAC1K,+CAAI,CAACiX,aAAa,EAAE,YAAY,CAAC,CAAC;EAC/E,IAAIC,gBAAgB,KAAK7U,SAAS,EAAE;IAClC,OAAOA,SAAS;EAClB;EACA,MAAM8U,aAAa,GAAG/D,sDAAK,CAACnV,IAAI,CAACoO,KAAK,CAAC6K,gBAAgB,CAAC,EAAE,CAAC,CAAC,CAAC;EAE7D,MAAMlQ,SAAS,GAAG1F,gEAAe,CAC/BmT,2DAAU,CAAC0C,aAAa,CAAC,WAAW,CAAC,EAAE,EAAE,CAAC,CAAC1R,GAAG,CAAgC2R,QAAQ,IAAI;IACxF,MAAMxX,IAAI,GAAGkU,yDAAQ,CAAwBsD,QAAQ,CAAC,MAAM,CAAC,CAAC;IAC9D,IAAIxX,IAAI,KAAKyC,SAAS,EAAE;MACtB,OAAOA,SAAS;IAClB,CAAC,MAAM,IAAIzC,IAAI,KAAKJ,8DAAqB,CAACJ,MAAM,EAAE;MAChD,MAAMU,IAAuB,GAAG;QAACF,IAAI,EAAEJ,8DAAqB,CAACJ;MAAM,CAAC;MACpE,OAAOU,IAAI;IACb,CAAC,MAAM,IAAIF,IAAI,KAAKJ,8DAAqB,CAACD,SAAS,EAAE;MACnD,MAAMO,IAAuB,GAAG;QAACF,IAAI,EAAEJ,8DAAqB,CAACD;MAAS,CAAC;MACvE,OAAOO,IAAI;IACb,CAAC,MAAM,IAAIF,IAAI,KAAKJ,8DAAqB,CAACF,UAAU,EAAE;MACpD,MAAMQ,IAAuB,GAAG;QAACF,IAAI,EAAEJ,8DAAqB,CAACF;MAAU,CAAC;MACxE,OAAOQ,IAAI;IACb,CAAC,MAAM,IAAIF,IAAI,KAAKJ,8DAAqB,CAAC4C,MAAM,EAAE;MAChD,MAAM+B,UAAU,GAAG2P,yDAAQ,CAACsD,QAAQ,CAAC,YAAY,CAAC,CAAC;MACnD,MAAM5S,OAAO,GAAGwP,gEAAe,CAACoD,QAAQ,CAAC,SAAS,CAAC,CAAC;MACpD,MAAMC,kBAAkB,GAAGjE,sDAAK,CAACgE,QAAQ,CAAC,gBAAgB,CAAC,EAAE,CAAC,CAAC,CAAC;MAChE,MAAMvS,OAAO,GAAGoQ,0DAAS,CAACoC,kBAAkB,CAAC,SAAS,CAAC,EAAE,KAAK,CAAC;MAC/D,MAAMzT,MAAM,GAAGkQ,yDAAQ,CAACsD,QAAQ,CAAC,QAAQ,CAAC,CAAC;MAC3C,MAAMtX,IAAuB,GAAG;QAC9BF,IAAI,EAAEJ,8DAAqB,CAAC4C,MAAM;QAClC+B,UAAU;QACVK,OAAO;QACPH,cAAc,EAAE;UAACQ;QAAO,CAAC;QACzBjB;MACF,CAAC;MACD,OAAO9D,IAAI;IACb,CAAC,MAAM,IAAIF,IAAI,KAAKJ,8DAAqB,CAAC2D,aAAa,EAAE;MACvD,MAAME,WAAW,GAAG2Q,gEAAe,CAAcoD,QAAQ,CAAC,aAAa,CAAC,CAAC;MACzE,MAAMxT,MAAM,GAAGkQ,yDAAQ,CAACsD,QAAQ,CAAC,QAAQ,CAAC,CAAC;MAC3C,MAAMtX,IAAuB,GAAG;QAC9BF,IAAI,EAAEJ,8DAAqB,CAAC2D,aAAa;QACzCE,WAAW;QACXO;MACF,CAAC;MACD,OAAO9D,IAAI;IACb,CAAC,MAAM,IAAIF,IAAI,KAAKJ,8DAAqB,CAAC2C,SAAS,EAAE;MACnD,MAAMgC,UAAU,GAAG2P,yDAAQ,CAACsD,QAAQ,CAAC,YAAY,CAAC,CAAC;MACnD,MAAM9S,OAAO,GAAG0P,gEAAe,CAAcoD,QAAQ,CAAC,SAAS,CAAC,CAAC;MACjE,MAAMxT,MAAM,GAAGkQ,yDAAQ,CAACsD,QAAQ,CAAC,QAAQ,CAAC,CAAC;MAC3C,MAAMtX,IAAuB,GAAG;QAC9BF,IAAI,EAAEJ,8DAAqB,CAAC2C,SAAS;QACrCgC,UAAU;QACVG,OAAO;QACPV;MACF,CAAC;MACD,OAAO9D,IAAI;IACb,CAAC,MAAM,IAAIF,IAAI,KAAKJ,8DAAqB,CAACL,UAAU,EAAE;MACpD,MAAM2F,UAAU,GAAGkP,gEAAe,CAAcoD,QAAQ,CAAC,YAAY,CAAC,CAAC;MACvE,MAAMtX,IAAuB,GAAG;QAC9BF,IAAI,EAAEJ,8DAAqB,CAACL,UAAU;QACtC2F;MACF,CAAC;MACD,OAAOhF,IAAI;IACb;IACA;IAAA,KACK,IAAIF,IAAI,KAAKJ,8DAAqB,CAACqE,gBAAgB,EAAE;MACxD,MAAMC,UAAU,GAAGkQ,gEAAe,CAAcoD,QAAQ,CAAC,YAAY,CAAC,CAAC;MACvE,MAAMjT,UAAU,GAAG2P,yDAAQ,CAACsD,QAAQ,CAAC,YAAY,CAAC,CAAC;MACnD,MAAMhT,wBAAwB,GAAGuQ,yDAAQ,CAACyC,QAAQ,CAAC,0BAA0B,CAAC,CAAC;MAC/E,MAAMtX,IAAuB,GAAG;QAC9BF,IAAI,EAAEJ,8DAAqB,CAACqE,gBAAgB;QAC5CC,UAAU;QACVK,UAAU;QACVC;MACF,CAAC;MACD,OAAOtE,IAAI;IACb;IACA,OAAOuC,SAAS;EAClB,CAAC,CACH,CAAC;EAED,MAAM4E,OAAO,GAAG+M,gEAAe,CAACmD,aAAa,CAAC,SAAS,CAAC,CAAC;EACzD,MAAMrQ,KAAK,GAAGxF,gEAAe,CAC3BmT,2DAAU,CAAC0C,aAAa,CAAC,OAAO,CAAC,EAAE,EAAE,CAAC,CAAC1R,GAAG,CAAuB6R,QAAQ,IAAI;IAC3E,MAAMzR,IAAI,GAAGiO,yDAAQ,CAACwD,QAAQ,CAAC,MAAM,CAAC,CAAC;IACvC,MAAMzP,IAAI,GAAGiM,yDAAQ,CAACwD,QAAQ,CAAC,MAAM,CAAC,CAAC;IACvC,IAAIzR,IAAI,KAAKxD,SAAS,IAAIwF,IAAI,KAAKxF,SAAS,EAAE;MAC5C,OAAOA,SAAS;IAClB;IACA,OAAO;MAACwD,IAAI;MAAEgC;IAAI,CAAC;EACrB,CAAC,CACH,CAAC;EAED,MAAM0P,WAAW,GAAGnE,sDAAK,CAAC+D,aAAa,CAAC,SAAS,CAAC,EAAE,CAAC,CAAC,CAAC;EACvD,MAAMjF,MAAM,GAAG4B,yDAAQ,CAACyD,WAAW,CAAC,QAAQ,CAAC,EAAE/V,2EAAc,CAAC;EAC9D,MAAM0F,OAAyB,GAAG;IAACgL;EAAM,CAAC;EAE1C,OAAO;IAAClL,SAAS;IAAEC,OAAO;IAAEH,KAAK;IAAEI;EAAO,CAAC;AAC7C;AAEO,eAAehG,cAAcA,CAAC+V,aAAqB,EAAE7R,SAAoB,EAAiB;EAC/FA,SAAS,CAAC0B,KAAK,CAACqK,IAAI,CAAC,CAACqG,EAAE,EAAEC,EAAE,KAAKD,EAAE,CAAC3R,IAAI,CAACyL,aAAa,CAACmG,EAAE,CAAC5R,IAAI,CAAC,CAAC;EAChE,MAAMrF,qDAAY,CAACR,+CAAI,CAACiX,aAAa,EAAE,YAAY,CAAC,EAAE,MAAM5W,mDAAU,CAAC+E,SAAS,CAAC,CAAC;AACpF;;;;;;;;;;;;;;;;;;;;;;;ACnMuC;AAC6B;AAC5B;AAEF;AACN;AAQzB,SAASsS,MAAMA,CAAA,EAAY;EAChC,OAAOta,OAAO,CAACua,GAAG,CAAC,UAAU,CAAC,KAAK,YAAY,CAAC,CAAC;AACnD;AAEO,SAASC,UAAUA,CAAA,EAAY;EACpC,OAAOxa,OAAO,CAACua,GAAG,CAAC,aAAa,CAAC,KAAK,GAAG,CAAC,CAAC;AAC7C;AAEO,SAASE,MAAMA,CAAA,EAAiC;EACrD,OAAOH,MAAM,CAAC,CAAC,GAAG,YAAY,GAAG,aAAa;AAChD;AAEA,MAAMI,gBAAgB,GAAG,IAAIC,GAAG,CAA8C,CAAC;AAExE,eAAeC,eAAeA,CAACpR,CAAS,EAAgD;EAC7F,IAAIkR,gBAAgB,CAACG,GAAG,CAACrR,CAAC,CAAC,EAAE;IAC3B,OAAOkR,gBAAgB,CAACI,GAAG,CAACtR,CAAC,CAAC;EAChC;EACA,IAAI;IACF,MAAMuR,KAAK,GAAG,MAAM3P,sDAAI,CAAC5B,CAAC,CAAC;IAC3B,IAAIuR,KAAK,CAAClN,WAAW,CAAC,CAAC,EAAE;MACvB,MAAMmN,GAAG,GAAG,MAAM7P,yDAAO,CAAC3B,CAAC,CAAC;MAC5B,IAAIwR,GAAG,CAAChL,QAAQ,CAAC,cAAc,CAAC,EAAE;QAChC,MAAMzC,WAAW,GAAG,MAAMpK,0DAAQ,CAACP,+CAAI,CAAC4G,CAAC,EAAE,cAAc,CAAC,CAAC;QAC3D,MAAM2C,IAAI,GAAGtL,IAAI,CAACoO,KAAK,CAAC1B,WAAW,CAAC/B,QAAQ,CAAC,CAAC,CAA4B;QAC1EkP,gBAAgB,CAAC7I,GAAG,CAACrI,CAAC,EAAE2C,IAAI,CAAC;QAC7B,OAAOA,IAAI;MACb;MACA,IAAI3C,CAAC,KAAK,GAAG,EAAE;QACb,OAAOvE,SAAS;MAClB;IACF;IACA,MAAM6D,GAAG,GAAG,MAAM8R,eAAe,CAAC/a,kDAAO,CAAC,GAAG2J,CAAC,KAAK,CAAC,CAAC;IACrDkR,gBAAgB,CAAC7I,GAAG,CAACrI,CAAC,EAAEV,GAAG,CAAC;IAC5B,OAAOA,GAAG;EACZ,CAAC,CAAC,OAAO/I,GAAY,EAAE;IACrBiB,gDAAG,CAAC,iBAAiB,CAAC;IACtBA,gDAAG,CAACjB,GAAG,CAAC;IACR2a,gBAAgB,CAAC7I,GAAG,CAACrI,CAAC,EAAEvE,SAAS,CAAC;IAClC,OAAOA,SAAS;EAClB;AACF;AAEO,SAASgW,OAAOA,CAACC,OAAe,EAAU;EAC/C;EACA,MAAMC,OAAO,GAAGnN,uDAAU,CAAC,KAAK,CAAC,CAACC,MAAM,CAACiN,OAAO,CAAC,CAAChN,MAAM,CAAC,KAAK,CAAC,CAACvI,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC;EAC3E,MAAMyV,IAAI,GAAG,IAAI,GAAGlJ,IAAI,CAACC,KAAK,CAACkJ,QAAQ,CAACF,OAAO,EAAE,EAAE,CAAC,GAAG,CAAC,CAAC;EACzD,OAAOC,IAAI;AACb;AAEO,eAAeE,WAAWA,CAACJ,OAAe,EAAEK,WAAmB,EAAmB;EACvF;EACA,IAAI;IACF,MAAMrR,IAAI,GAAG,MAAMsR,UAAU,CAACN,OAAO,CAAC;IACtC,MAAMO,MAAM,GAAG7Y,+CAAI,CAACsH,IAAI,EAAE,KAAK,CAAC;IAChC,MAAM4C,8CAAK,CAAC2O,MAAM,CAAC;IACnB,MAAMpQ,uDAAK,CAACoQ,MAAM,EAAE;MAACvP,SAAS,EAAE;IAAI,CAAC,CAAC;IACtC,MAAMwP,OAAO,GAAG9Y,+CAAI,CAAC6Y,MAAM,EAAEF,WAAW,CAAC;IACzC,IAAI,MAAM1O,+CAAM,CAAC6O,OAAO,CAAC,EAAE;MACzB,MAAMpQ,oDAAE,CAACoQ,OAAO,CAAC;IACnB;IACA,OAAOA,OAAO;EAChB,CAAC,CAAC,MAAM;IACN,MAAM,IAAIhb,KAAK,CAAC,yCAAyCwa,OAAO,EAAE,CAAC;EACrE;AACF;AAEA,eAAeM,UAAUA,CAACG,QAAgB,EAAmB;EAC3D,IAAI,MAAM9O,+CAAM,CAACjK,+CAAI,CAAC+Y,QAAQ,EAAE,cAAc,CAAC,CAAC,EAAE;IAChD,OAAOA,QAAQ;EACjB;EACA,MAAMC,MAAM,GAAGhZ,+CAAI,CAAC+Y,QAAQ,EAAE,IAAI,CAAC;EACnC,IAAIC,MAAM,KAAKD,QAAQ,EAAE;IACvB,MAAM,IAAIjb,KAAK,CAAC,wBAAwB,CAAC;EAC3C;EACA,OAAO,MAAM8a,UAAU,CAACI,MAAM,CAAC;AACjC;;;;;;ACzFA;;;;;;;;;;;;;;;;;;;ACA4C;AACH;AACV;AAEe;AACE;AACN;AAEnC,eAAeC,eAAeA,CACnC3R,IAAY,EACZ4R,SAAiC,EAClB;EACf;EACA,MAAMC,aAAa,GAAGnZ,+CAAI,CAACsH,IAAI,EAAE,WAAW,CAAC;EAC7C,MAAMpB,GAAwE,GAAGjI,IAAI,CAACoO,KAAK,CACzFtM,4DAAQ,CAAC,wBAAwB,EAAE;IAACsH,GAAG,EAAE8R;EAAa,CAAC,CAAC,CAACvQ,QAAQ,CAAC,CACpE,CAAC;EACD,MAAMwQ,cAAc,GAAG9X,gEAAe,CACpCkL,MAAM,CAACC,OAAO,CAACvG,GAAG,CAAC,CAACT,GAAG,CAAC,CAAC,CAAC+Q,GAAG,EAAE9H,KAAK,CAAC,KAAK;IACxC,IAAIA,KAAK,CAAC2K,SAAS,EAAE;MACnB,OAAOhX,SAAS;IAClB;IACA,IACEiR,KAAK,CAACC,OAAO,CAAC7E,KAAK,CAAC9O,IAAI,CAAC,IACzB8O,KAAK,CAAC9O,IAAI,CAAC,CAAC,CAAC,KAAK,QAAQ,IAC1B,OAAO8O,KAAK,CAACA,KAAK,KAAK,QAAQ,IAC/BA,KAAK,CAACA,KAAK,KAAK,IAAI,EACpB;MACA,OAAO,CACL8H,GAAG,CAACxS,WAAW,CAAC,CAAC,EACjBwI,MAAM,CAACwE,WAAW,CAACxE,MAAM,CAACC,OAAO,CAACiC,KAAK,CAACA,KAAK,CAAC,CAACjJ,GAAG,CAAC,CAAC,CAAC6T,CAAC,EAAEC,CAAC,CAAC,KAAK,CAACD,CAAC,CAACtV,WAAW,CAAC,CAAC,EAAEuV,CAAC,CAAC,CAAC,CAAC,CACtF;IACH;IACA,IAAI7K,KAAK,CAAC9O,IAAI,KAAK,QAAQ,IAAI,OAAO8O,KAAK,CAACA,KAAK,KAAK,QAAQ,EAAE;MAC9D,OAAO,CAAC8H,GAAG,CAACxS,WAAW,CAAC,CAAC,EAAE0K,KAAK,CAACA,KAAK,CAAC;IACzC;IACA,OAAOrM,SAAS;EAClB,CAAC,CACH,CAAC;;EAED;EACA,MAAMmX,YAAY,GAAG,MAAMjR,yDAAO,CAAC4Q,aAAa,CAAC;EACjD,MAAMzS,cAAc,GAAG8S,YAAY,CAAC3Z,MAAM,CAACqC,CAAC,IAAIA,CAAC,CAACwF,QAAQ,CAAC,KAAK,CAAC,CAAC;EAClE,MAAM+R,qBAAqB,GAAG,MAAMzc,OAAO,CAACwI,GAAG,CAC7CkB,cAAc,CAACjB,GAAG,CAAC,MAAMvD,CAAC,IAAI,MAAM3B,iDAAQ,CAACP,+CAAI,CAACmZ,aAAa,EAAEjX,CAAC,CAAC,CAAC,CACtE,CAAC;EACD,MAAMwX,YAAY,GAAGD,qBAAqB,CAACzZ,IAAI,CAAC,IAAI,CAAC;EACrD,MAAM2Z,aAAa,GAAGD,YAAY,CAAC9M,QAAQ,CAAC,oCAAoC,CAAC;EACjF,MAAMgN,cAAc,GAAGpN,MAAM,CAACwE,WAAW,CACvC,CAAC,GAAG2I,aAAa,CAAC,CACflU,GAAG,CAACoU,CAAC,IAAIA,CAAC,CAAC5M,MAAM,GAAG,YAAY,CAAC,CAAC,CAClCpN,MAAM,CAACga,CAAC,IAAIA,CAAC,KAAKxX,SAAS,CAAC,CAC5BoD,GAAG,CAACoU,CAAC,IAAI,CAACA,CAAC,CAAC7V,WAAW,CAAC,CAAC,EAAE,qBAAqB,CAAC,CACtD,CAAC;EAED,MAAM8V,YAAqC,GAAG;IAC5C,GAAGF,cAAc;IACjB,GAAGpN,MAAM,CAACwE,WAAW,CAACoI,cAAc,CAAC;IACrC,GAAGF,SAAS;IACZa,QAAQ,EAAElC,0DAAM,CAAC;EACnB,CAAC;EAED,MAAM9N,oDAAW,CACf/J,+CAAI,CAACsH,IAAI,EAAE,QAAQ,EAAE,KAAK,EAAE,QAAQ,CAAC,EACrCkF,MAAM,CAACC,OAAO,CAACqN,YAAY,CAAC,CACzBrU,GAAG,CACF,CAAC,CAAC+Q,GAAG,EAAE9H,KAAK,CAAC,KACX,gBAAgB8H,GAAG,MAAMvY,IAAI,CAACC,SAAS,CAACwQ,KAAK,CAAC,GAC5C,OAAOA,KAAK,KAAK,QAAQ,GAAG,YAAY,GAAG,EAAE,GAEnD,CAAC,CACA1O,IAAI,CAAC,IAAI,CACd,CAAC;AACH;;;;;;;;;;AClEO,SAASga,kBAAkBA,CAACC,MAAqB,EAAiB;EACvE,MAAMC,qBAAqB,GAAG,IAAInC,GAAG,CAAuC,CAAC;EAC7E,MAAMoC,YAA2B,GAAG,EAAE;EACtC,KAAK,MAAMhd,GAAG,IAAI8c,MAAM,EAAE;IACxB,IAAI,EAAE,MAAM,IAAI9c,GAAG,CAAC,EAAE;MACpBgd,YAAY,CAAC3c,IAAI,CAACL,GAAG,CAAC;IACxB,CAAC,MAAM;MACL,IAAIid,aAAa,GAAGF,qBAAqB,CAAChC,GAAG,CAAC/a,GAAG,CAACuI,OAAO,CAAC;MAC1D,IAAI,CAAC0U,aAAa,EAAE;QAClBA,aAAa,GAAG,IAAIrC,GAAG,CAA0B,CAAC;QAClDmC,qBAAqB,CAACjL,GAAG,CAAC9R,GAAG,CAACuI,OAAO,EAAE0U,aAAa,CAAC;MACvD;MACA,IAAIC,UAAU,GAAGD,aAAa,CAAClC,GAAG,CAAC/a,GAAG,CAACmd,GAAG,CAACC,YAAY,CAAC;MACxD,IAAI,CAACF,UAAU,EAAE;QACfA,UAAU,GAAG,EAAE;QACfD,aAAa,CAACnL,GAAG,CAAC9R,GAAG,CAACmd,GAAG,CAACC,YAAY,EAAEF,UAAU,CAAC;MACrD;MACAA,UAAU,CAAC7c,IAAI,CAACL,GAAG,CAAC;IACtB;EACF;EACA,KAAK,MAAMqd,MAAM,IAAIN,qBAAqB,CAAChK,MAAM,CAAC,CAAC,EAAE;IACnD,KAAK,MAAM+J,MAAM,IAAIO,MAAM,CAACtK,MAAM,CAAC,CAAC,EAAE;MACpC+J,MAAM,CAAC9I,IAAI,CAAC,CAACsJ,IAAI,EAAEC,IAAI,KAAK;QAC1B,IAAI,CAACD,IAAI,CAACH,GAAG,CAACK,KAAK,EAAE;UACnB,OAAO,CAAC,CAAC;QACX,CAAC,MAAM,IAAI,CAACD,IAAI,CAACJ,GAAG,CAACK,KAAK,EAAE;UAC1B,OAAO,CAAC;QACV;QACA,MAAMC,QAAQ,GAAGH,IAAI,CAACH,GAAG,CAACK,KAAK,CAAClT,IAAI,GAAGiT,IAAI,CAACJ,GAAG,CAACK,KAAK,CAAClT,IAAI;QAC1D,IAAImT,QAAQ,KAAK,CAAC,EAAE;UAClB,OAAOA,QAAQ;QACjB;QACA,IAAIH,IAAI,CAACH,GAAG,CAACK,KAAK,CAACE,MAAM,KAAKxY,SAAS,EAAE;UACvC,OAAO,CAAC,CAAC;QACX,CAAC,MAAM,IAAIqY,IAAI,CAACJ,GAAG,CAACK,KAAK,CAACE,MAAM,KAAKxY,SAAS,EAAE;UAC9C,OAAO,CAAC;QACV;QACA,MAAMyY,UAAU,GAAGL,IAAI,CAACH,GAAG,CAACK,KAAK,CAACE,MAAM,GAAGH,IAAI,CAACJ,GAAG,CAACK,KAAK,CAACE,MAAM;QAChE,IAAIC,UAAU,KAAK,CAAC,EAAE;UACpB,OAAOA,UAAU;QACnB;QACA,OAAOL,IAAI,CAACM,OAAO,CAACzJ,aAAa,CAACoJ,IAAI,CAACK,OAAO,CAAC;MACjD,CAAC,CAAC;IACJ;EACF;EACA,OAAO;IAACb,qBAAqB;IAAEC;EAAY,CAAC;AAC9C;;;;;;;;;;;;ACrDwC;AAqCxC,SAASc,aAAaA,CAAC3T,IAAY,EAAEzB,IAAY,EAA2C;EAC1F,MAAMU,YAAY,GAAGtG,mDAAQ,CAACqH,IAAI,EAAEzB,IAAI,CAAC;EACzC,MAAMH,OAAO,GAAGa,YAAY,CAAC1D,KAAK,CAACmY,0CAAG,CAAC,CAAC,CAAC,CAAC,IAAI,EAAE;EAChD,OAAO;IAACtV,OAAO;IAAEa;EAAY,CAAC;AAChC;AAEO,SAAS2U,UAAUA,CACxB/d,GAAiB,EACjBqM,IAA6C,EAChC;EACb,MAAM;IAAClC,IAAI;IAAE6T;EAAQ,CAAC,GAAG3R,IAAI;EAC7B,IAAIrM,GAAG,CAAC0J,IAAI,KAAK,oBAAoB,EAAE;IACrC,MAAMuU,WAAW,GAAGje,GAAyB;IAC7C,MAAMod,YAAY,GAAGpd,GAAG,CAAC2I,IAAI;IAC7B,IAAIyU,YAAY,KAAKlY,SAAS,EAAE;MAC9B,OAAO;QAAC8Y,QAAQ;QAAEJ,OAAO,EAAE5d,GAAG,CAAC4d;MAAO,CAAC;IACzC;IACA,MAAM;MAACxU,YAAY;MAAEb;IAAO,CAAC,GAAGuV,aAAa,CAAC3T,IAAI,EAAEiT,YAAY,CAAC;IACjE,OAAO;MACL7U,OAAO;MACP9F,IAAI,EAAE,QAAQ;MACdub,QAAQ;MACRJ,OAAO,EAAE5d,GAAG,CAAC4d,OAAO;MACpBM,IAAI,EAAED,WAAW,CAACE,MAAM;MACxBhB,GAAG,EAAE;QACH/T,YAAY;QACZgU,YAAY;QACZI,KAAK,EAAExd,GAAG,CAACmd,GAAG,IAAI,OAAO,IAAInd,GAAG,CAACmd,GAAG,GAAGnd,GAAG,CAACmd,GAAG,CAACK,KAAK,GAAGtY,SAAS;QAChEkZ,GAAG,EAAEpe,GAAG,CAACmd,GAAG,IAAI,KAAK,IAAInd,GAAG,CAACmd,GAAG,GAAGnd,GAAG,CAACmd,GAAG,CAACiB,GAAG,GAAGlZ;MACnD;IACF,CAAC;EACH,CAAC,MAAM,IAAI,OAAO,IAAIlF,GAAG,EAAE;IACzB;IACA,MAAMqe,KAAK,GAAIre,GAAG,CAAS,OAAO,CAAU;IAC5C,MAAMod,YAAY,GAAGiB,KAAK,CAAC1V,IAAI;IAC/B,IAAIyU,YAAY,KAAKlY,SAAS,EAAE;MAC9B,OAAO;QAAC8Y,QAAQ;QAAEJ,OAAO,EAAE5d,GAAG,CAAC4d;MAAO,CAAC;IACzC;IACA,MAAM;MAACxU,YAAY;MAAEb;IAAO,CAAC,GAAGuV,aAAa,CAAC3T,IAAI,EAAEiT,YAAY,CAAC;IACjE,OAAO;MACL7U,OAAO;MACP9F,IAAI,EAAE,KAAK;MACXub,QAAQ;MACRJ,OAAO,EAAES,KAAK,CAACT,OAAO;MACtBM,IAAI,EAAEG,KAAK,CAACH,IAAI;MAChBf,GAAG,EAAE;QACH/T,YAAY;QACZgU,YAAY;QACZ,GAAGiB,KAAK,CAACC;MACX;IACF,CAAC;EACH,CAAC,MAAM,IAAIte,GAAG,CAAC0J,IAAI,KAAK,qBAAqB,EAAE;IAC7C;IACA,MAAM6U,GAAG,GAAIve,GAAG,CAASO,KAAK,CAACqd,OAAiB;IAChD,MAAMY,KAAK,GAAG,oDAAoD,CAAC3T,IAAI,CAAC0T,GAAG,CAAC;IAE5E,IAAI,CAACC,KAAK,EAAE;MACV,OAAO;QAACR,QAAQ;QAAEJ,OAAO,EAAE5d,GAAG,CAAC4d;MAAO,CAAC;IACzC;IACA,MAAM,CAACa,CAAC,EAAEb,OAAO,EAAER,YAAY,CAAC,GAAGoB,KAAK;IACxC,IAAIpB,YAAY,KAAKlY,SAAS,IAAI0Y,OAAO,KAAK1Y,SAAS,EAAE;MACvD,OAAO;QAAC8Y,QAAQ;QAAEJ,OAAO,EAAE5d,GAAG,CAAC4d;MAAO,CAAC;IACzC;IACA,MAAM;MAACxU,YAAY;MAAEb;IAAO,CAAC,GAAGuV,aAAa,CAAC3T,IAAI,EAAEiT,YAAY,CAAC;IACjE,OAAO;MACL7U,OAAO;MACP9F,IAAI,EAAE,KAAK;MACXub,QAAQ;MACRJ,OAAO;MACPT,GAAG,EAAE;QACH/T,YAAY;QACZgU;MACF;IACF,CAAC;EACH;EACA,OAAO;IAACY,QAAQ;IAAEJ,OAAO,EAAE5d,GAAG,CAAC4d;EAAO,CAAC;AACzC;;;;;;;;;;;;;;;;;;ACjHuC;AACY;AACqB;AAC/B;AAOzC,SAASgB,SAASA,CAACvS,IAIlB,EAAuB;EACtB,MAAM;IAAClC,IAAI;IAAE0U,WAAW;IAAEC;EAAY,CAAC,GAAGzS,IAAI;EAC9C,MAAM0S,IAAc,GAAG,CAAC5U,IAAI,CAAC;EAC7B,MAAMR,KAAe,GAAG,EAAE;EAE1B,eAAeqV,IAAIA,CAAA,EAA6C;IAC9D;IACA,MAAMC,QAAQ,GAAGtV,KAAK,CAACuV,KAAK,CAAC,CAAC;IAC9B,IAAID,QAAQ,KAAK/Z,SAAS,EAAE;MAC1B,MAAMsG,MAAM,GAAG,MAAMpI,0DAAQ,CAAC6b,QAAQ,CAAC;MACvC,OAAO;QAACE,IAAI,EAAE,KAAK;QAAE5N,KAAK,EAAE;UAAC7I,IAAI,EAAEuW,QAAQ;UAAE3V,OAAO,EAAEkC,MAAM,CAACC,QAAQ,CAAC;QAAC;MAAC,CAAC;IAC3E;IACA;IACA;IACA,MAAM2T,OAAO,GAAGL,IAAI,CAACG,KAAK,CAAC,CAAC;IAC5B,IAAIE,OAAO,KAAKla,SAAS,EAAE;MACzB,OAAO;QAACia,IAAI,EAAE,IAAI;QAAE5N,KAAK,EAAErM;MAAS,CAAC;IACvC;IACA;IACA,MAAMma,OAAO,GAAG,MAAMjU,yDAAO,CAACgU,OAAO,EAAE;MAACzR,aAAa,EAAE;IAAI,CAAC,CAAC;IAC7D,KAAK,MAAM2R,MAAM,IAAID,OAAO,EAAE;MAC5B,MAAM3W,IAAI,GAAG7F,+CAAI,CAACuc,OAAO,EAAEE,MAAM,CAAC5V,IAAI,CAAC;MACvC,IAAI4V,MAAM,CAACxR,WAAW,CAAC,CAAC,EAAE;QACxB,IAAI+Q,WAAW,GAAGnW,IAAI,CAAC,EAAE;UACvB;QACF;QACAqW,IAAI,CAAC1e,IAAI,CAACqI,IAAI,CAAC;MACjB,CAAC,MAAM,IAAI4W,MAAM,CAACtR,MAAM,CAAC,CAAC,EAAE;QAC1B,IAAI8Q,YAAY,GAAGpW,IAAI,CAAC,EAAE;UACxB;QACF;QACAiB,KAAK,CAACtJ,IAAI,CAACqI,IAAI,CAAC;MAClB;IACF;IACA;IACA,OAAO,MAAMsW,IAAI,CAAC,CAAC;EACrB;EAEA,OAAO;IACL,CAACO,MAAM,CAACC,aAAa,IAAI;MACvB,OAAO;QAACR;MAAI,CAAC;IACf;EACF,CAAC;AACH;AAQA,MAAMS,SAAS,GAAG,MAAM;AAExB,eAAeC,SAASA,CAACvV,IAAY,EAAmB;EACtD,MAAMwV,KAAa,GAAG,EAAE;EACxB,WAAW,MAAM5a,CAAC,IAAI6Z,SAAS,CAAC;IAC9BzU,IAAI;IACJ0U,WAAW,EAAEpV,CAAC,IAAIA,CAAC,CAACwG,QAAQ,CAAC,cAAc,CAAC,IAAIxG,CAAC,CAACwG,QAAQ,CAAC,IAAI,CAAC;IAChE6O,YAAY,EAAErV,CAAC,IAAI,CAACA,CAAC,CAACc,QAAQ,CAACkV,SAAS;EAC1C,CAAC,CAAC,EAAE;IACF,IAAI1a,CAAC,CAACuE,OAAO,CAAC2G,QAAQ,CAAC,aAAa,CAAC,EAAE;MACrC,MAAM,CAAC2P,OAAO,EAAEC,OAAO,CAAC,GACtB,uEAAuE,CACpEhV,IAAI,CAAC9F,CAAC,CAACuE,OAAO,CAAC,EACd1D,KAAK,CAAC,CAAC,CAAC,IAAI,EAAE;MACpB,IAAIga,OAAO,KAAK1a,SAAS,EAAE;QACzB;MACF;MACA,IAAI2a,OAAO,KAAK3a,SAAS,EAAE;QACzB;MACF;MACA,IAAI4a,OAAO,GAAGD,OAAO;MACrB,OAAO,IAAI,EAAE;QACX,IAAIC,OAAO,CAAC7P,QAAQ,CAAC,IAAI,CAAC,EAAE;UAC1B6P,OAAO,GAAGA,OAAO,CAAC7K,OAAO,CAAC,IAAI,EAAE,EAAE,CAAC;QACrC,CAAC,MAAM,IAAI6K,OAAO,CAACC,UAAU,CAAC,GAAG,CAAC,IAAID,OAAO,CAACC,UAAU,CAAC,IAAI,CAAC,IAAID,OAAO,CAACC,UAAU,CAAC,GAAG,CAAC,EAAE;UACzFD,OAAO,GAAGA,OAAO,CAACla,KAAK,CAAC,CAAC,CAAC;QAC5B,CAAC,MAAM,IACLka,OAAO,CAACvV,QAAQ,CAAC,GAAG,CAAC,IACrBuV,OAAO,CAACvV,QAAQ,CAAC,IAAI,CAAC,IACtBuV,OAAO,CAACvV,QAAQ,CAAC,GAAG,CAAC,IACrBuV,OAAO,CAACvV,QAAQ,CAAC,GAAG,CAAC,IACrBuV,OAAO,CAACvV,QAAQ,CAAC,GAAG,CAAC,EACrB;UACAuV,OAAO,GAAGA,OAAO,CAACla,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;QAChC,CAAC,MAAM;UACL;QACF;MACF;MACA+Z,KAAK,CAACtf,IAAI,CAAC;QAACqJ,IAAI,EAAEiV,mDAAQ,CAAC5Z,CAAC,CAAC2D,IAAI,CAAC,CAAC9C,KAAK,CAAC,CAAC,EAAE,CAAC6Z,SAAS,CAACzO,MAAM,CAAC;QAAE4O,OAAO;QAAEC,OAAO,EAAEC;MAAO,CAAC,CAAC;IAC7F;EACF;EACA,OAAOH,KAAK;AACd;AAEA,SAASK,IAAIA,CAACC,IAAY,EAAU;EAClC,OAAO;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAUA,IAAI;AACd;AACA;AACA;AACA,GAAG,CAAC7O,IAAI,CAAC,CAAC;AACV;AAQO,eAAe8O,eAAeA,CAAC/V,IAAY,EAAuB;EACvE;EACA,MAAMiR,OAAO,GAAGnN,uDAAU,CAAC,KAAK,CAAC,CAACC,MAAM,CAAC/D,IAAI,CAAC,CAACgE,MAAM,CAAC,KAAK,CAAC,CAACvI,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC;EACxE,MAAMyV,IAAI,GAAG,IAAI,GAAGlJ,IAAI,CAACC,KAAK,CAACkJ,QAAQ,CAACF,OAAO,EAAE,EAAE,CAAC,GAAG,CAAC,CAAC;EACzD,MAAM+E,YAAY,GAAG,MAAMT,SAAS,CAACvV,IAAI,CAAC;EAE1C,MAAMiW,MAAM,GAAG1B,uDAAY,CAAC,CAAC2B,GAAoB,EAAEtX,GAAmB,KAAK;IACzE2W,SAAS,CAACvV,IAAI,CAAC,CACZrB,IAAI,CAAC6W,KAAK,IAAI;MACb,MAAMM,IAAI,GAAGD,IAAI,CACf,wBAAwBL,KAAK,CAC1BrX,GAAG,CACFgY,IAAI,IAAI;AACtB;AACA,kCAAkCA,IAAI,CAACV,OAAO,4BAA4BU,IAAI,CAACT,OAAO;AACtF,mDAAmDS,IAAI,CAAC5W,IAAI,KAAK4W,IAAI,CAAC5W,IAAI;AAC1E;AACA,WACY,CAAC,CACA7G,IAAI,CAAC,EAAE,CAAC,QACb,CAAC;MACDkG,GAAG,CAACwX,KAAK,CAACN,IAAI,CAAC;MACflX,GAAG,CAACqV,GAAG,CAAC,CAAC;IACX,CAAC,CAAC,CACDre,KAAK,CAAEC,GAAY,IAAK;MACvB+I,GAAG,CAACwX,KAAK,CAACP,IAAI,CAAC,0BAA0Bnf,MAAM,CAACb,GAAG,CAAC,EAAE,CAAC,CAAC;MACxD+I,GAAG,CAACqV,GAAG,CAAC,CAAC;IACX,CAAC,CAAC;EACN,CAAC,CAAC,CAACoC,MAAM,CAACnF,IAAI,CAAC;EAEf,OAAO;IACLA,IAAI;IACJoF,QAAQ,EAAEN,YAAY,CAACnP,MAAM,GAAG,CAAC;IACjC0P,UAAU,EAAEA,CAAA,KAAMN,MAAM,CAACO,KAAK,CAAC;EACjC,CAAC;AACH;;;;;;ACnMA;;;;;;;;;;;;ACA0C;AAEnC,SAASE,UAAUA,CAAA,EAAW;EACnC,OACExR,MAAM,CAAC0D,MAAM,CAAC6N,0DAAiB,CAAC,CAAC,CAAC,CAC/BhX,IAAI,CAAC,CAAC,CACN9E,IAAI,CAACgc,GAAG,IAAIA,GAAG,KAAK5b,SAAS,IAAI4b,GAAG,CAACC,MAAM,KAAK,MAAM,IAAID,GAAG,CAACE,OAAO,CAACjB,UAAU,CAAC,UAAU,CAAC,CAAC,EAC5FiB,OAAO,IAAI,WAAW;AAE9B;;;;;;ACTA;;;;;;;;;;;;;;ACAyC;AAEc;AACvB;AAEzB,SAASE,SAASA,CAACC,QAAgB,EAAE/gB,EAAgC,EAAc;EACxF,MAAMqJ,CAAC,GAAGwX,yDAAK,CAAC,MAAM,EAAE,CAAC,IAAI,EAAEE,QAAQ,CAAC,EAAE;IAAClX,KAAK,EAAE;EAAM,CAAC,CAAC;EAC1D,MAAMmX,OAAO,GAAGA,CAAA,KAAY;IAC1B,IAAI,CAAC3X,CAAC,CAAC4X,MAAM,EAAE;MACb5X,CAAC,CAAC6X,IAAI,CAAC,CAAC;IACV;EACF,CAAC;EACDnhB,uEAAoB,CAACihB,OAAO,CAAC;EAC7B,IAAI3gB,IAAI,GAAG,EAAE;EACbgJ,CAAC,CAAC8X,MAAM,CAACrhB,EAAE,CAAC,MAAM,EAAEshB,KAAK,IAAI;IAC3B/gB,IAAI,IAAI+gB,KAAK;IACb,MAAMC,KAAK,GAAGhhB,IAAI,CAACiF,KAAK,CAAC,IAAI,CAAC;IAC9B;IACAtF,EAAE,CAACqhB,KAAK,CAAC7b,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;IACtBnF,IAAI,GAAGghB,KAAK,CAACrR,EAAE,CAAC,CAAC,CAAC,CAAC,IAAI,EAAE;EAC3B,CAAC,CAAC;EACF3G,CAAC,CAACvJ,EAAE,CAAC,OAAO,EAAEF,GAAG,IAAI;IACnBiB,gDAAG,CAACjB,GAAG,CAAC;EACV,CAAC,CAAC;EACF,OAAOohB,OAAO;AAChB;;;;;;;;;;;;;;;;;;;;ACzBoE;AAElB;AAEL;AAGkD;AAG7C;AAG3C,SAASe,YAAYA,CAACrF,MAAqB,EAAU;EAC1D,MAAM;IAACC,qBAAqB;IAAEC;EAAY,CAAC,GAAGF,MAAM;EACpD,MAAMsF,MAAgB,GAAG,EAAE;EAE3B,KAAK,MAAM5iB,WAAW,IAAIwd,YAAY,EAAE;IACtCoF,MAAM,CAAC/hB,IAAI,CAAC2hB,gFAAW,CAACxiB,WAAW,CAAC,CAAC;EACvC;EAEA,KAAK,MAAM,CAACyG,WAAW,EAAEgX,aAAa,CAAC,IAAIF,qBAAqB,CAACzN,OAAO,CAAC,CAAC,EAAE;IAC1E8S,MAAM,CAAC/hB,IAAI,CAACuhB,iDAAI,CAAC3b,WAAW,CAAC,CAAC;IAC9B,KAAK,MAAM,CAAC0C,IAAI,EAAEmU,MAAM,CAAC,IAAIG,aAAa,CAAC3N,OAAO,CAAC,CAAC,EAAE;MACpD8S,MAAM,CAAC/hB,IAAI,CAAC,CAAC4hB,mFAAc,CAACtZ,IAAI,CAAC,EAAE,GAAGmU,MAAM,CAACxU,GAAG,CAACtI,GAAG,IAAIgiB,gFAAW,CAAChiB,GAAG,CAAC,CAAC,CAAC,CAAC6C,IAAI,CAAC,IAAI,CAAC,CAAC;IACxF;EACF;EAEA,OAAOuf,MAAM,CAACvf,IAAI,CAAC,MAAM,CAAC;AAC5B;AAEO,SAASwf,mBAAmBA,CACjC9Z,OAAyB,EACzB+Z,QAAiB,EACjBC,SAAkB,EAClBzF,MAAqB,EACrB0F,kBAAsC,EACtCC,kBAAsC,EACtCC,sBAA8C,EACpC;EACV;EACA,MAAMC,OAAO,GAAGT,kFAAa,CAAC3Z,OAAO,CAAC;;EAEtC;EACA,IAAIqa,OAAO,GAAG,EAAE;EAChB,MAAM3F,aAAa,GAAGH,MAAM,CAACC,qBAAqB,CAAChC,GAAG,CAACxS,OAAO,CAACtC,WAAW,CAAC;EAC3E,IAAIgX,aAAa,EAAE;IACjB2F,OAAO,GAAGC,uBAAuB,CAAC,CAAC,GAAG5F,aAAa,CAAClK,MAAM,CAAC,CAAC,CAAC,CAACnJ,IAAI,CAAC,CAAC,CAAC;EACvE,CAAC,MAAM,IAAI,CAAC0Y,QAAQ,EAAE;IACpBM,OAAO,GAAGd,kDAAK,CAAC,SAAS,CAAC;EAC5B,CAAC,MAAM,IAAIS,SAAS,EAAE;IACpBK,OAAO,GAAGf,iDAAI,CAAC,aAAa,CAAC;EAC/B;;EAEA;EACA,MAAMiB,OAAiB,GAAG,EAAE;EAC5B,IAAIL,kBAAkB,CAACM,UAAU,EAAE;IACjCD,OAAO,CAACziB,IAAI,CAAC2iB,uBAAuB,CAACP,kBAAkB,CAACM,UAAU,CAAC,CAAC;EACtE;EACA,IACEL,sBAAsB,CAACK,UAAU,IACjCxa,OAAO,CAACpC,YAAY,CAAC1D,IAAI,KAAKJ,8DAAqB,CAAC4C,MAAM,EAC1D;IACA6d,OAAO,CAACziB,IAAI,CAAC4iB,2BAA2B,CAACP,sBAAsB,CAACK,UAAU,CAAC,CAAC;EAC9E;EACA,IAAIP,kBAAkB,KAAKtd,SAAS,EAAE;IACpC4d,OAAO,CAACziB,IAAI,CAAC0hB,gDAAG,CAACS,kBAAkB,CAAC,CAAC;EACvC;EACA,IAAIC,kBAAkB,CAACS,SAAS,EAAE;IAChCJ,OAAO,CAACziB,IAAI,CAAC2iB,uBAAuB,CAACP,kBAAkB,CAACS,SAAS,CAAC,CAAC;EACrE;EAEA,OAAO,CAACP,OAAO,EAAEC,OAAO,EAAEE,OAAO,CAACjgB,IAAI,CAAC,GAAG,CAAC,CAAC;AAC9C;AAEO,SAASggB,uBAAuBA,CAAC/F,MAAqB,EAAU;EACrE,MAAMqG,UAAU,GAAGrG,MAAM,CAACpa,MAAM,CAAC1C,GAAG,IAAIA,GAAG,CAACge,QAAQ,KAAK,OAAO,CAAC,CAAChN,MAAM;EACxE,MAAMoS,SAAS,GAAGtG,MAAM,CAACpa,MAAM,CAAC1C,GAAG,IAAIA,GAAG,CAACge,QAAQ,KAAK,SAAS,CAAC,CAAChN,MAAM;EACzE,MAAMqS,IAAc,GAAG,EAAE;EAEzB,IAAIF,UAAU,GAAG,CAAC,EAAE;IAClB,MAAMG,MAAM,GAAGH,UAAU,GAAG,CAAC,GAAG,GAAG,GAAG,EAAE;IACxCE,IAAI,CAAChjB,IAAI,CAACqhB,8CAAK,CAAC6B,WAAW,CAAC,IAAIJ,UAAU,SAASG,MAAM,GAAG,CAAC,CAAC;EAChE;EACA,IAAIF,SAAS,GAAG,CAAC,EAAE;IACjB,MAAME,MAAM,GAAGF,SAAS,GAAG,CAAC,GAAG,GAAG,GAAG,EAAE;IACvCC,IAAI,CAAChjB,IAAI,CAACshB,iDAAQ,CAAC4B,WAAW,CAAC,IAAIH,SAAS,WAAWE,MAAM,GAAG,CAAC,CAAC;EACpE;EACA,OAAOD,IAAI,CAACxgB,IAAI,CAAC,GAAG,CAAC;AACvB;AAEO,SAASmgB,uBAAuBA,CAACQ,KAAwB,EAAU;EACxE,MAAM/gB,IAAI,GAAG+gB,KAAK,CAACA,KAAK;EACxB,IAAI/gB,IAAI,KAAK,OAAO,EAAE;IACpB,OAAO,UAAUoe,kEAAU,CAAC,CAAC,IAAI2C,KAAK,CAACnI,IAAI,EAAE;EAC/C;EACA,MAAMgF,GAAG,GAAGwB,iDAAI,CAAC,GAAG2B,KAAK,CAACC,MAAM,IAAID,KAAK,CAAC9a,IAAI,EAAE,CAAC;EACjD,IAAIjG,IAAI,KAAK,OAAO,EAAE;IACpB,OAAO,GAAG4d,GAAG,IAAI0B,gDAAG,CAACyB,KAAK,CAACxjB,GAAG,CAAC,EAAE;EACnC,CAAC,MAAM,IAAIyC,IAAI,KAAK,SAAS,EAAE;IAC7B,OAAO,GAAG4d,GAAG,IAAIwB,iDAAI,CAAC,mBAAmB,CAAC,EAAE;IAC5C;EACF,CAAC,MAAM,IAAIpf,IAAI,KAAK,UAAU,EAAE;IAC9B,MAAMihB,QAAQ,GAAG,SAASF,KAAK,CAACG,UAAU,GAAG;IAC7C,MAAMC,IAAI,GAAG,IAAIJ,KAAK,CAACK,UAAU,CAACC,cAAc,CAAC,CAAC,IAAI;IACtD,MAAMC,QAAQ,GAAG,IAAIP,KAAK,CAACO,QAAQ,CAACD,cAAc,CAAC,CAAC,KAAK;IACzD;IACA,MAAME,KAAK,GAAGR,KAAK,CAACG,UAAU,IAAI,GAAG,GAAG5B,4CAAG,GAAGD,8CAAK;IACnD,OAAO,GAAGzB,GAAG,IAAI2D,KAAK,CAAC,GAAGN,QAAQ,IAAIE,IAAI,IAAIG,QAAQ,EAAE,CAAC,EAAE;EAC7D;EACA7f,6DAAY,CAACzB,IAAI,CAAC;AACpB;AAEO,SAASwgB,2BAA2BA,CAACO,KAA4B,EAAU;EAChF,MAAM/gB,IAAI,GAAG+gB,KAAK,CAACA,KAAK;EACxB;EACA,IAAI/gB,IAAI,KAAK,OAAO,EAAE;IACpB,OAAO,UAAUoe,kEAAU,CAAC,CAAC,IAAI2C,KAAK,CAACnI,IAAI,EAAE;EAC/C;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACAnX,6DAAY,CAACzB,IAAI,CAAC;AACpB;;;;;;;;;;;;;;ACtI+D;AAKxD,SAASyf,aAAaA,CAAC3Z,OAAyB,EAAU;EAC/D,OAAO,GAAGqZ,iDAAI,CAACrZ,OAAO,CAACtC,WAAW,CAAC,IAAI4b,iDAAI,CAACtZ,OAAO,CAAC9F,IAAI,CAAC,EAAE;AAC7D;AAEO,SAASwf,cAAcA,CAACd,QAAgB,EAAU;EACvD,OAAO8C,sDAAS,CAAC9C,QAAQ,CAAC;AAC5B;AAEA,SAASgD,aAAaA,CAAC5F,GAAW,EAAEP,QAAuB,EAAU;EACnE,OAAOA,QAAQ,KAAK,SAAS,GAAGkG,mDAAM,CAAC3F,GAAG,CAAC,GAAGwD,gDAAG,CAACxD,GAAG,CAAC;AACxD;AAEA,MAAM6F,OAAO,GAAGA,CAAC7S,KAAa,EAAEqS,IAAY,KAC1CrS,KAAK,CAACP,MAAM,IAAI4S,IAAI,GAAGrS,KAAK,GAAG6S,OAAO,CAAC,IAAI7S,KAAK,EAAE,EAAEqS,IAAI,CAAC;AAC3D,MAAMS,QAAQ,GAAGA,CAAC9S,KAAa,EAAEqS,IAAY,KAC3CrS,KAAK,CAACP,MAAM,IAAI4S,IAAI,GAAGrS,KAAK,GAAG8S,QAAQ,CAAC,GAAG9S,KAAK,GAAG,EAAEqS,IAAI,CAAC;AAE5D,SAASU,cAAcA,CAACnH,GAAqC,EAAU;EACrE,MAAM;IAAC7S,IAAI;IAAEoT;EAAM,CAAC,GAAGP,GAAG,IAAI,CAAC,CAAC;EAChC,MAAMoH,QAAQ,GAAG,CAAC;EAClB,MAAMC,OAAO,GAAG3jB,MAAM,CAACyJ,IAAI,IAAI,EAAE,CAAC;EAClC,MAAMma,SAAS,GAAG5jB,MAAM,CAAC6c,MAAM,IAAI,EAAE,CAAC;EACtC,IAAI8G,OAAO,CAACxT,MAAM,KAAK,CAAC,IAAIyT,SAAS,CAACzT,MAAM,KAAK,CAAC,EAAE;IAClD,OAAOoT,OAAO,CAAC,EAAE,EAAE,CAAC,GAAGG,QAAQ,GAAG,CAAC,CAAC;EACtC;EACA,OAAO1C,iDAAI,CAAC,GAAGuC,OAAO,CAACI,OAAO,EAAED,QAAQ,CAAC,IAAIF,QAAQ,CAACI,SAAS,EAAEF,QAAQ,CAAC,EAAE,CAAC;AAC/E;;AAEA;AACA,SAASG,WAAWA,CAACxG,IAAY,EAAEzb,IAAe,EAAU;EAC1D,OAAOof,iDAAI,CAAC3D,IAAI,CAAC;AACnB;AAEO,SAAS8D,WAAWA,CAAChiB,GAAgB,EAAU;EACpD,IAAI,MAAM,IAAIA,GAAG,EAAE;IACjB,OAAO,GAAGskB,cAAc,CAACtkB,GAAG,CAACmd,GAAG,CAACK,KAAK,CAAC,IAAI2G,aAAa,CACtDnkB,GAAG,CAAC4d,OAAO,EACX5d,GAAG,CAACge,QACN,CAAC,IAAI0G,WAAW,CAAC1kB,GAAG,CAACke,IAAI,EAAEle,GAAG,CAACyC,IAAI,CAAC,EAAE;EACxC;EACA,OAAO0hB,aAAa,CAAC,IAAInkB,GAAG,CAACge,QAAQ,KAAKhe,GAAG,CAAC4d,OAAO,EAAE,EAAE5d,GAAG,CAACge,QAAQ,CAAC;AACxE;;;;;;;;;;;;;;;;;;;AC9CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAC+B;AACY;AACZ;AAEO;AACG;AAEzC,MAAM4G,eAAe,GAAG,KAAK,CAAC,CAAC;AAC/B,MAAMC,qBAAqB,GAAG,IAAI,CAAC,CAAC;;AAOpC,SAASC,YAAYA,CAAC3a,IAAY,EAAU;EAC1C,OAAOtH,+CAAI,CAACsH,IAAI,EAAE,aAAa,CAAC;AAClC;AAEA,eAAe4a,QAAQA,CAAC5a,IAAY,EAA6B;EAC/D;EACA,MAAM6a,eAAe,GAAG,MAAMzX,sDAAa,CAACuX,YAAY,CAAC3a,IAAI,CAAC,CAAC;EAC/D,IAAI6a,eAAe,KAAK9f,SAAS,EAAE;IACjC,OAAOA,SAAS;EAClB;;EAEA;EACA,MAAM,CAAC+f,KAAK,EAAEC,KAAK,CAAC,GAAGF,eAAe,CAACtf,KAAK,CAAC,GAAG,CAAC;EACjD,MAAMyf,GAAG,GAAG3N,yDAAQ,CAACyN,KAAK,CAAC;EAC3B,MAAMtY,EAAE,GAAG6K,yDAAQ,CAAC0N,KAAK,CAAC;EAC1B,IAAIC,GAAG,KAAKjgB,SAAS,IAAIyH,EAAE,KAAKzH,SAAS,EAAE;IACzC,OAAOA,SAAS;EAClB;EAEA,OAAO;IAACigB,GAAG;IAAExY;EAAE,CAAC;AAClB;AAEA,eAAeyY,SAASA,CAACjb,IAAY,EAAiB;EACpD,MAAM1B,2DAAS,CAACqc,YAAY,CAAC3a,IAAI,CAAC,EAAE,GAAGlK,OAAO,CAACklB,GAAG,IAAI/M,IAAI,CAACiN,GAAG,CAAC,CAAC,EAAE,CAAC;AACrE;AAEA,eAAeC,SAASA,CAACnb,IAAY,EAAiB;EACpD,MAAMob,IAAI,GAAG,MAAMR,QAAQ,CAAC5a,IAAI,CAAC;EACjC,IAAIob,IAAI,IAAIA,IAAI,CAACJ,GAAG,KAAKllB,OAAO,CAACklB,GAAG,IAAI/M,IAAI,CAACiN,GAAG,CAAC,CAAC,GAAGE,IAAI,CAAC5Y,EAAE,GAAGiY,eAAe,EAAE;IAC9E5jB,OAAO,CAACT,KAAK,CAAC,QAAQukB,YAAY,CAAC3a,IAAI,CAAC,4BAA4Bob,IAAI,CAACJ,GAAG,EAAE,CAAC;IAC/E;IACAllB,OAAO,CAACulB,IAAI,CAAC,CAAC,CAAC;EACjB;AACF;AAEA,IAAIC,YAAwC;AACrC,SAASC,WAAWA,CAACvb,IAAY,EAAQ;EAC9C,IAAIsb,YAAY,EAAE;IAChBE,aAAa,CAACF,YAAY,CAAC;EAC7B;EACAd,+CAAM,CAACG,YAAY,CAAC3a,IAAI,CAAC,EAAE;IAAC8C,KAAK,EAAE;EAAI,CAAC,CAAC;AAC3C;AAEO,eAAe2Y,QAAQA,CAACzb,IAAY,EAAiB;EAC1D;EACA,MAAMmb,SAAS,CAACnb,IAAI,CAAC;EACrB;EACAsb,YAAY,GAAGI,WAAW,CAAC,MAAM;IAC/BP,SAAS,CAACnb,IAAI,CAAC,CACZrB,IAAI,CAAC,MAAM;MACVsc,SAAS,CAACjb,IAAI,CAAC,CAACpK,KAAK,CAAC,MAAM,CAAC,CAAC,CAAC;IACjC,CAAC,CAAC,CACDA,KAAK,CAAC,MAAM,CAAC,CAAC,CAAC;EACpB,CAAC,EAAE8kB,qBAAqB,CAAC;AAC3B;;;;;;;;;;AC7EA,MAAMiB,SAAS,GAAG,IAAIC,MAAM,CAC1B,CACE,6FAA6F,EAC7F,0DAA0D,CAC3D,CAACljB,IAAI,CAAC,GAAG,CAAC,EACX,IACF,CAAC;AACD,MAAMmjB,SAAS,GAAIrU,CAAS,IAAaA,CAAC,CAACsD,OAAO,CAAC6Q,SAAS,EAAE,EAAE,CAAC;AASjE,SAASG,UAAUA,CAACC,IAAU,EAAU;EACtC,OAAO,OAAOA,IAAI,KAAK,QAAQ,GAAGA,IAAI,GAAGA,IAAI,CAACpC,cAAc,CAAC,CAAC;AAChE;AAEA,SAASqC,SAASA,CAAC5U,KAAa,EAAE6U,MAAc,EAAEC,KAAc,EAAU;EACxE,IAAIC,QAAQ,GAAG/U,KAAK;EACpB,KAAK,IAAIgV,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGH,MAAM,EAAEG,CAAC,EAAE,EAAE;IAC/BD,QAAQ,GAAGD,KAAK,GAAG,GAAGC,QAAQ,GAAG,GAAG,IAAIA,QAAQ,EAAE;EACpD;EACA,OAAOA,QAAQ;AACjB;AAEO,SAASE,KAAKA,CAAC/lB,IAAc,EAAEsJ,OAA0B,EAAU;EACxE,IAAItJ,IAAI,CAACuQ,MAAM,KAAK,CAAC,EAAE;IACrB,OAAO,EAAE;EACX;EACA,MAAM;IAACyV,KAAK,GAAG;EAAE,CAAC,GAAG1c,OAAO,IAAI,CAAC,CAAC;EAClC,MAAM2c,SAAmB,GAAG,EAAE;EAC9B,KAAK,MAAMpc,IAAI,IAAI7J,IAAI,EAAE;IACvB,KAAK,MAAM,CAACkmB,WAAW,EAAET,IAAI,CAAC,IAAI5b,IAAI,CAACgF,OAAO,CAAC,CAAC,EAAE;MAChDoX,SAAS,CAACC,WAAW,CAAC,GAAGxU,IAAI,CAACyU,GAAG,CAC/BF,SAAS,CAACC,WAAW,CAAC,IAAI,CAAC,EAC3BX,SAAS,CAACC,UAAU,CAACC,IAAI,CAAC,CAAC,CAAClV,MAC9B,CAAC;IACH;EACF;EAEA,OAAOvQ,IAAI,CACR6H,GAAG,CAACgC,IAAI,IACPA,IAAI,CACDhC,GAAG,CAAC,CAAC4d,IAAI,EAAEW,QAAQ,EAAEhR,GAAG,KAAK;IAC5B,MAAMvM,OAAO,GAAG2c,UAAU,CAACC,IAAI,CAAC;IAChC,OAAOW,QAAQ,KAAKhR,GAAG,CAAC7E,MAAM,GAAG,CAAC,IAAIyV,KAAK,CAACI,QAAQ,CAAC,KAAK,GAAG,GACzDvd,OAAO,GACP6c,SAAS,CACP7c,OAAO,EACP,CAACod,SAAS,CAACG,QAAQ,CAAC,IAAI,CAAC,IAAIb,SAAS,CAAC1c,OAAO,CAAC,CAAC0H,MAAM,EACtDyV,KAAK,CAACI,QAAQ,CAAC,KAAK,GACtB,CAAC;EACP,CAAC,CAAC,CACDhkB,IAAI,CAAC,GAAG,CACb,CAAC,CACAA,IAAI,CAAC,IAAI,CAAC;AACf;;;;;SC3DA;SACA;;SAEA;SACA;SACA;SACA;SACA;SACA;SACA;SACA;SACA;SACA;SACA;SACA;SACA;;SAEA;SACA;;SAEA;SACA;SACA;;;;;UCtBA;UACA;UACA;UACA;UACA;UACA,iCAAiC,WAAW;UAC5C;UACA;;;;;UCPA;UACA;UACA;UACA;UACA,yCAAyC,wCAAwC;UACjF;UACA;UACA;;;;;UCPA;;;;;UCAA;UACA;UACA;UACA,uDAAuD,iBAAiB;UACxE;UACA,gDAAgD,aAAa;UAC7D;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACN4C;AACb;AAEO;AACgB;AACJ;AAEK;AACT;AACP;AACiC;AAC2B;AACvC;AACE;AAUX;AACqB;AACH;AACI;AACG;AAC1B;AACQ;AAKpB;AACgC;AACjB;AA4BrD,MAAM6G,IAAI,GAAG,eAAe;AAE5B,IAAIqd,UAAU,GAAG,EAAE;AACnB,IAAIC,cAAwC;AAC5C,SAASxB,IAAIA,CAAA,EAAS;EACpBwB,cAAc,GAAG,CAAC;EAClBtB,6EAAW,CAACqB,UAAU,CAAC;EACvB9mB,OAAO,CAACgnB,KAAK,CAACC,UAAU,CAAC,KAAK,CAAC;EAC/BjmB,gDAAG,CAAC,eAAe,CAAC;EACpB;EACAhB,OAAO,CAACulB,IAAI,CAAC,CAAC,CAAC;AACjB;AAEO,eAAe2B,WAAWA,CAAC9a,IAAwB,EAAiB;EACzE,MAAM;IAAClC,IAAI;IAAEpC,kBAAkB;IAAE2L;EAAK,CAAC,GAAGrH,IAAI;EAC9C,MAAM+a,QAAQ,GAAG,IAAIxM,GAAG,CAA6B,CAAC;EACtD,MAAM1S,QAAQ,GAAGH,kBAAkB,CAACI,OAAO,CAACpD,CAAC,IAAIe,iGAAgC,CAACf,CAAC,CAAC,CAAC;EAErF,eAAesiB,iBAAiBA,CAAA,EAAkB;IAChD,MAAMtL,SAAiC,GAAG,CAAC,CAAC;IAC5C,IAAIrB,2DAAM,CAAC,CAAC,KAAK,aAAa,EAAE;MAC9B,KAAK,MAAM;QAACzU,WAAW;QAAExD;MAAI,CAAC,IAAIyF,QAAQ,EAAE;QAC1C,IAAIzF,IAAI,KAAKvB,oDAAW,CAACY,SAAS,IAAIW,IAAI,KAAKvB,oDAAW,CAACa,YAAY,EAAE;UACvE,MAAMulB,MAAM,GAAGF,QAAQ,CAACrM,GAAG,CAAC9U,WAAW,CAAC;UACxC,MAAMoV,IAAI,GACRiM,MAAM,EAAE7E,kBAAkB,CAACM,UAAU,EAAE1H,IAAI,IAAIH,4DAAO,CAACrY,+CAAI,CAACsH,IAAI,EAAElE,WAAW,CAAC,CAAC;UACjF8V,SAAS,CAAC,GAAG9V,WAAW,CAACY,WAAW,CAAC,CAAC,MAAM,CAAC,GAAG,UAAUga,mEAAU,CAAC,CAAC,IAAIxF,IAAI,GAAG;QACnF;QACA,IAAI5Y,IAAI,KAAKvB,oDAAW,CAACK,GAAG,EAAE;UAC5B,MAAM+lB,MAAM,GAAGF,QAAQ,CAACrM,GAAG,CAAC9U,WAAW,CAAC;UACxC,MAAMoV,IAAI,GACRiM,MAAM,EAAE5E,sBAAsB,CAACK,UAAU,EAAE1H,IAAI,IAAIH,4DAAO,CAACrY,+CAAI,CAACsH,IAAI,EAAElE,WAAW,CAAC,CAAC;UACrF8V,SAAS,CAAC,GAAG9V,WAAW,CAACY,WAAW,CAAC,CAAC,yBAAyB,CAAC,GAC9D,GAAGga,mEAAU,CAAC,CAAC,IAAIxF,IAAI,EAAE;QAC7B;MACF;IACF;IACA,MAAMS,yFAAe,CAAC3R,IAAI,EAAE4R,SAAS,CAAC;EACxC;EACA,MAAMsL,iBAAiB,CAAC,CAAC;EAEzB,IAAIE,UAAkC;EACtC,IAAI7T,KAAK,EAAE;IACT6T,UAAU,GAAG,MAAMrH,iFAAe,CAAC/V,IAAI,CAAC;IACxC6c,cAAc,GAAGO,UAAU,CAAC7G,UAAU;EACxC;EAEA,SAAS8G,WAAWA,CAACjf,OAAyB,EAAQ;IACpD,MAAM;MAACtC;IAAW,CAAC,GAAGsC,OAAO;IAC7B,MAAMkf,OAAO,GAAGL,QAAQ,CAACrM,GAAG,CAAC9U,WAAW,CAAC,IAAI;MAC3CsC,OAAO;MACP+Z,QAAQ,EAAE,IAAI;MACdC,SAAS,EAAE,IAAI;MACfzF,MAAM,EAAE,EAAE;MACV2F,kBAAkB,EAAE,CAAC,CAAC;MACtBC,sBAAsB,EAAE,CAAC;IAC3B,CAAC;IACD0E,QAAQ,CAACtV,GAAG,CAAC7L,WAAW,EAAE;MAAC,GAAGwhB,OAAO;MAAElF,SAAS,EAAE;IAAI,CAAC,CAAC;IACxDmF,QAAQ,CAAC;MAACC,WAAW,EAAE,KAAK;MAAE1hB;IAAW,CAAC,CAAC;EAC7C;EAEA,SAAS2hB,aAAaA,CAACrf,OAAyB,EAAEsf,KAAY,EAAQ;IACpE,MAAM;MAAC5hB;IAAW,CAAC,GAAGsC,OAAO;IAC7B,MAAMuU,MAAM,GAAG,CACb,GAAG+K,KAAK,CAACC,WAAW,CAAChL,MAAM,CAACxU,GAAG,CAACtI,GAAG,IAAI+d,6EAAU,CAAC/d,GAAG,EAAE;MAACmK,IAAI;MAAE6T,QAAQ,EAAE;IAAO,CAAC,CAAC,CAAC,EAClF,GAAG6J,KAAK,CAACC,WAAW,CAACC,QAAQ,CAACzf,GAAG,CAAC0f,IAAI,IAAIjK,6EAAU,CAACiK,IAAI,EAAE;MAAC7d,IAAI;MAAE6T,QAAQ,EAAE;IAAS,CAAC,CAAC,CAAC,CACzF;IACD,MAAMyE,kBAAkB,GAAG2E,QAAQ,CAACrM,GAAG,CAAC9U,WAAW,CAAC,EAAEwc,kBAAkB,IAAI,CAAC,CAAC;IAC9E,MAAMC,sBAAsB,GAAG0E,QAAQ,CAACrM,GAAG,CAAC9U,WAAW,CAAC,EAAEyc,sBAAsB,IAAI,CAAC,CAAC;IACtF,MAAMF,kBAAkB,GAAG4E,QAAQ,CAACrM,GAAG,CAAC9U,WAAW,CAAC,EAAEuc,kBAAkB;IACxE4E,QAAQ,CAACtV,GAAG,CAAC7L,WAAW,EAAE;MACxBsC,OAAO;MACP+Z,QAAQ,EAAE,KAAK;MACfC,SAAS,EAAE,KAAK;MAChBzF,MAAM;MACN0F,kBAAkB;MAClBC,kBAAkB;MAClBC;IACF,CAAC,CAAC;IACFgF,QAAQ,CAAC;MAACC,WAAW,EAAE,KAAK;MAAE1hB;IAAW,CAAC,CAAC;EAC7C;EAEA,SAASgiB,MAAMA,CAAA,EAAS;IACtB,MAAMnL,MAAM,GAAG,CAAC,GAAGsK,QAAQ,CAACrU,MAAM,CAAC,CAAC,CAAC,CAAC5K,OAAO,CAACiU,CAAC,IAAIA,CAAC,CAACU,MAAM,CAAC;IAC5D,MAAMoL,aAAa,GAAGrL,sFAAkB,CAACC,MAAM,CAAC;IAEhD,MAAMqL,OAAO,GAAG,CAAC,GAAGf,QAAQ,CAACrU,MAAM,CAAC,CAAC,CAAC,CAACzK,GAAG,CAACgf,MAAM,IAAI;MACnD,OAAOjF,kFAAmB,CACxBiF,MAAM,CAAC/e,OAAO,EACd+e,MAAM,CAAChF,QAAQ,EACfgF,MAAM,CAAC/E,SAAS,EAChB2F,aAAa,EACbZ,MAAM,CAAC9E,kBAAkB,EACzB8E,MAAM,CAAC7E,kBAAkB,EACzB6E,MAAM,CAAC5E,sBACT,CAAC;IACH,CAAC,CAAC;IACFyF,OAAO,CAACC,OAAO,CAAC,CACdnE,sDAAS,CAAC,aAAa/b,QAAQ,CAAC8I,MAAM,GAAG,CAAC,EAC1CiT,sDAAS,CAAC,QAAQ,CAAC,EACnBA,sDAAS,CAAC,KAAK,CAAC,CACjB,CAAC;IACF,MAAMoE,MAAM,GAAGlG,2EAAY,CAAC+F,aAAa,CAAC;IAE1C,IAAIxU,KAAK,EAAE;MACTzT,OAAO,CAACshB,MAAM,CAAChB,KAAK,CAAC,4BAA4B,CAAC,CAAC,CAAC;IACtD;IACAtf,gDAAG,CAACulB,sEAAK,CAAC2B,OAAO,CAAC,CAAC;IACnB,IAAIZ,UAAU,EAAE9G,QAAQ,EAAE;MACxBxf,gDAAG,CAAC,iBAAiB4f,mEAAU,CAAC,CAAC,IAAI0G,UAAU,CAAClM,IAAI,EAAE,CAAC;IACzD;IACA,IAAIgN,MAAM,CAACrX,MAAM,GAAG,CAAC,EAAE;MACrB/P,gDAAG,CAAC,0BAA0B4hB,sFAAuB,CAAC/F,MAAM,CAAC,IAAI,CAAC;MAClE7b,gDAAG,CAAConB,MAAM,CAAC;IACb;EACF;EAEA,MAAMC,SAAS,GAAG,IAAIxV,GAAG,CAAc,CAAC;EACxC,SAAS4U,QAAQA,CAACrb,IAAsD,EAAQ;IAC9E,IAAIqH,KAAK,EAAE;MACTuU,MAAM,CAAC,CAAC;MACR;IACF;IAEA,MAAM;MAAChiB,WAAW;MAAE0hB;IAAW,CAAC,GAAGtb,IAAI;IACvC,IAAIsb,WAAW,EAAE;MACfW,SAAS,CAACC,GAAG,CAACtiB,WAAW,CAAC;IAC5B;IACA,MAAMuiB,OAAO,GAAG,CAAC,GAAGpB,QAAQ,CAACqB,IAAI,CAAC,CAAC,CAAC,CAACC,KAAK,CAACziB,WAAW,IAAIqiB,SAAS,CAACxN,GAAG,CAAC7U,WAAW,CAAC,CAAC;IACrF,IAAI,CAACuiB,OAAO,EAAE;MACZ;IACF;IAEA,MAAM1L,MAAM,GAAG,CAAC,GAAGsK,QAAQ,CAACrU,MAAM,CAAC,CAAC,CAAC,CAAC5K,OAAO,CAACiU,CAAC,IAAIA,CAAC,CAACU,MAAM,CAAC;IAC5D,MAAM;MAACE;IAAY,CAAC,GAAGH,sFAAkB,CAACC,MAAM,CAAC;IACjD,MAAM6L,cAAc,GAClB3L,YAAY,CAAChM,MAAM,KAAK,CAAC,IACzB,CAAC,GAAGoW,QAAQ,CAACrU,MAAM,CAAC,CAAC,CAAC,CAAC2V,KAAK,CAACpB,MAAM,IAAIA,MAAM,CAAC9E,kBAAkB,KAAKtd,SAAS,CAAC;IACjF,IAAIyjB,cAAc,EAAE;MAClB7oB,OAAO,CAAC,CAAC;IACX,CAAC,MAAM;MACLwN,MAAM,CAAC,CAAC;IACV;EACF;EAEA,MAAMsb,gBAAgB,GAAG,MAAM/oB,OAAO,CAACwI,GAAG,CACxCH,QAAQ,CAACI,GAAG,CAAC,MAAMC,OAAO,IAAI;IAC5B,MAAM;MAACtC;IAAW,CAAC,GAAGsC,OAAO;IAC7B,MAAMsgB,WAAW,GAAGhmB,+CAAI,CAACsH,IAAI,EAAElE,WAAW,CAAC;IAC3C,MAAM6iB,YAAY,GAAG;MACnBvgB,OAAO;MACP+Z,QAAQ,EAAE,IAAI;MACdC,SAAS,EAAE,IAAI;MACfzF,MAAM,EAAE,EAAE;MACV2F,kBAAkB,EAAE,CAAC,CAAC;MACtBC,sBAAsB,EAAE,CAAC;IAC3B,CAAC;IAED,SAASqG,YAAYA,CAACnpB,EAAiC,EAAQ;MAC7D,IAAI6nB,OAAO,GAAGL,QAAQ,CAACrM,GAAG,CAAC9U,WAAW,CAAC;MACvC,IAAI,CAACwhB,OAAO,EAAE;QACZA,OAAO,GAAGqB,YAAY;QACtB1B,QAAQ,CAACtV,GAAG,CAAC7L,WAAW,EAAEwhB,OAAO,CAAC;MACpC;MACA7nB,EAAE,CAAC6nB,OAAO,CAAC;IACb;IAEA,SAASuB,wBAAwBA,CAACzoB,KAAa,EAAQ;MACrDwoB,YAAY,CAACE,IAAI,IAAI;QACnBA,IAAI,CAACzG,kBAAkB,GAAGjiB,KAAK;MACjC,CAAC,CAAC;IACJ;IAEA6mB,QAAQ,CAACtV,GAAG,CAAC7L,WAAW,EAAE6iB,YAAY,CAAC;IACvC;IACA,MAAMI,MAAM,GAAG,MAAM,MAAM,EAAC,uBAAwBrmB,+CAAI,CAACgmB,WAAW,EAAE,mBAAmB,CAAC,CAAC,CACxF/f,IAAI,CAAC,CAAC;MAACqgB;IAAS,CAAC,KAAKA,SAAS,CAAC;MAAChO,OAAO,EAAE0N,WAAW;MAAEnV;IAAK,CAAC,CAAkB,CAAC,CAChF3T,KAAK,CAAEC,GAAY,IAAK;MACvBgpB,wBAAwB,CAACnoB,MAAM,CAACb,GAAG,CAAC,CAAC;MACrC,OAAOkF,SAAS;IAClB,CAAC,CAAC;IAEJ,MAAMkkB,wBAAwB,GAAIxpB,EAAsC,IAAW;MACjFmpB,YAAY,CAACE,IAAI,IAAIrpB,EAAE,CAACqpB,IAAI,CAACxG,kBAAkB,CAAC,CAAC;IACnD,CAAC;IAED,MAAM4G,4BAA4B,GAAIzpB,EAA0C,IAAW;MACzFmpB,YAAY,CAACE,IAAI,IAAIrpB,EAAE,CAACqpB,IAAI,CAACvG,sBAAsB,CAAC,CAAC;IACvD,CAAC;;IAED;IACA,IAAI4G,sBAAsB,GAAGlR,IAAI,CAACiN,GAAG,CAAC,CAAC;IACvC,MAAMkE,uBAAuB,GAAG7V,KAAK,GACjCwN,2EAAS,CAACre,+CAAI,CAACgmB,WAAW,EAAE,KAAK,EAAE,2BAA2B,CAAC,EAAEpH,KAAK,IAAI;MACxE,MAAM+H,IAAI,GAAG/H,KAAK,CACfnZ,GAAG,CAACsC,CAAC,IAAIA,CAAC,CAACwG,IAAI,CAAC,CAAC,CAAC,CAClB1O,MAAM,CAACkI,CAAC,IAAIA,CAAC,CAACoG,MAAM,GAAG,CAAC,CAAC,CACzB1I,GAAG,CAACsC,CAAC,IAAI9J,IAAI,CAACoO,KAAK,CAACtE,CAAC,CAA0B,CAAC;MACnD,IAAI6e,YAAY,GAAG,KAAK;MACxB,KAAK,MAAMxoB,GAAG,IAAIuoB,IAAI,EAAE;QACtB,MAAMrR,IAAI,GAAG,IAAIC,IAAI,CAACnX,GAAG,CAACyoB,CAAC,CAAC,CAACpR,OAAO,CAAC,CAAC;QACtC,IAAIH,IAAI,GAAGmR,sBAAsB,EAAE;UACjC;QACF;QACAA,sBAAsB,GAAGnR,IAAI;QAC7BsR,YAAY,GAAG,IAAI;QACnB,IAAIxoB,GAAG,CAACuiB,KAAK,KAAK,OAAO,EAAE;UACzB4F,wBAAwB,CAACH,IAAI,IAAI;YAC/BA,IAAI,CAAClG,UAAU,GAAG9hB,GAAG;UACvB,CAAC,CAAC;UACF;UACA;UACAomB,iBAAiB,CAAC,CAAC;QACrB,CAAC,MAAM;UACL+B,wBAAwB,CAACH,IAAI,IAAI;YAC/BA,IAAI,CAAC/F,SAAS,GAAGjiB,GAAG;UACtB,CAAC,CAAC;QACJ;MACF;MACA,IAAIwoB,YAAY,EAAE;QAChBxB,MAAM,CAAC,CAAC;MACV;IACF,CAAC,CAAC,GACF/iB,SAAS;;IAEb;IACA,IAAIykB,yBAAyB,GAAGvR,IAAI,CAACiN,GAAG,CAAC,CAAC;IAC1C,MAAMuE,wBAAwB,GAAGlW,KAAK,GAClCwN,2EAAS,CAACre,+CAAI,CAACgmB,WAAW,EAAE,KAAK,EAAE,wBAAwB,CAAC,EAAEpH,KAAK,IAAI;MACrE,MAAM+H,IAAI,GAAG/H,KAAK,CACfnZ,GAAG,CAACsC,CAAC,IAAIA,CAAC,CAACwG,IAAI,CAAC,CAAC,CAAC,CAClB1O,MAAM,CAACkI,CAAC,IAAIA,CAAC,CAACoG,MAAM,GAAG,CAAC,CAAC,CACzB1I,GAAG,CAACsC,CAAC,IAAI9J,IAAI,CAACoO,KAAK,CAACtE,CAAC,CAA8B,CAAC;MACvD,IAAI6e,YAAY,GAAG,KAAK;MACxB,KAAK,MAAMxoB,GAAG,IAAIuoB,IAAI,EAAE;QACtB,MAAMrR,IAAI,GAAG,IAAIC,IAAI,CAACnX,GAAG,CAACyoB,CAAC,CAAC,CAACpR,OAAO,CAAC,CAAC;QACtC,IAAIH,IAAI,GAAGwR,yBAAyB,EAAE;UACpC;QACF;QACAA,yBAAyB,GAAGxR,IAAI;QAChCsR,YAAY,GAAG,IAAI;QACnB;QACA,IAAIxoB,GAAG,CAACuiB,KAAK,KAAK,OAAO,EAAE;UACzB6F,4BAA4B,CAACJ,IAAI,IAAI;YACnCA,IAAI,CAAClG,UAAU,GAAG9hB,GAAG;UACvB,CAAC,CAAC;QACJ,CAAC,MAAM;UACLiD,8DAAY,CAACjD,GAAG,CAACuiB,KAAK,CAAC;UACvB;UACA;UACA;QACF;MACF;MACA,IAAIiG,YAAY,EAAE;QAChBxB,MAAM,CAAC,CAAC;MACV;IACF,CAAC,CAAC,GACF/iB,SAAS;IAEb,IAAI,CAACgkB,MAAM,EAAE;MACX;IACF;IAEA,MAAMW,QAAQ,GAAGnoB,gDAAO,CAAC;MAAC,GAAGwnB,MAAM;MAAExV;IAAK,CAAC,EAAE,CAAC1T,GAAiB,EAAE+I,GAAW,KAAK;MAC/E,IAAI/I,GAAG,IAAI,CAAC+I,GAAG,EAAE;QACfigB,wBAAwB,CAAChpB,GAAG,GAAGa,MAAM,CAACb,GAAG,CAAC,GAAG,6BAA6B,CAAC;QAC3E,IAAI,CAAC0T,KAAK,EAAE;UACVgU,QAAQ,CAAC;YAACC,WAAW,EAAE,IAAI;YAAE1hB;UAAW,CAAC,CAAC;UAC1CnG,OAAO,CAAC,CAAC;UACT;QACF;MACF;MACA4nB,QAAQ,CAAC;QAACC,WAAW,EAAE,IAAI;QAAE1hB;MAAW,CAAC,CAAC;IAC5C,CAAC,CAAC;IACF4jB,QAAQ,CAACC,KAAK,CAACC,SAAS,CAACC,GAAG,CAACtgB,IAAI,EAAE,MAAM8d,WAAW,CAACjf,OAAO,CAAC,CAAC;IAC9DshB,QAAQ,CAACC,KAAK,CAACG,QAAQ,CAACD,GAAG,CAACtgB,IAAI,EAAE,MAAM8d,WAAW,CAACjf,OAAO,CAAC,CAAC;IAC7DshB,QAAQ,CAACC,KAAK,CAAC3K,IAAI,CAAC6K,GAAG,CAACtgB,IAAI,EAAEme,KAAK,IAAID,aAAa,CAACrf,OAAO,EAAEsf,KAAK,CAAC,CAAC;IAErE,IAAIqC,SAAuC;IAC3C,IAAIhB,MAAM,CAACgB,SAAS,EAAE;MACpBA,SAAS,GAAG,IAAIpD,2DAAgB,CAACoC,MAAM,CAACgB,SAAS,EAAEL,QAAQ,CAAC;MAC5D,MAAMK,SAAS,CAAC1M,KAAK,CAAC,CAAC;IACzB;IACA,OAAO,YAA2B;MAChC,OAAO,MAAM,IAAI3d,OAAO,CAAO,CAACC,OAAO,EAAEwN,MAAM,KAAK;QAClD,MAAM6c,aAAa,GAAGA,CAAA,KAAY;UAChCZ,uBAAuB,GAAG,CAAC;UAC3BK,wBAAwB,GAAG,CAAC;UAC5BC,QAAQ,CAAClJ,KAAK,CAAC3gB,GAAG,IAAKA,GAAG,GAAGsN,MAAM,CAACtN,GAAG,CAAC,GAAGF,OAAO,CAAC,CAAE,CAAC;QACxD,CAAC;QACD,IAAIoqB,SAAS,EAAE;UACbA,SAAS,CACNE,IAAI,CAAC,CAAC,CACNthB,IAAI,CAACqhB,aAAa,CAAC,CACnBpqB,KAAK,CAAEC,GAAY,IAAK;YACvBsN,MAAM,CAACtN,GAAG,YAAYW,KAAK,GAAGX,GAAG,GAAG,IAAIW,KAAK,CAACE,MAAM,CAACb,GAAG,CAAC,CAAC,CAAC;UAC7D,CAAC,CAAC;QACN,CAAC,MAAM;UACLmqB,aAAa,CAAC,CAAC;QACjB;MACF,CAAC,CAAC;IACJ,CAAC;EACH,CAAC,CACH,CAAC;EAED,IAAIE,cAA0B;EAC9B,IAAIC,aAAsC;EAC1C,MAAMC,aAAa,GAAG,IAAI1qB,OAAO,CAAO,CAACC,OAAO,EAAEwN,MAAM,KAAK;IAC3D+c,cAAc,GAAGvqB,OAAO;IACxBwqB,aAAa,GAAGhd,MAAM;EACxB,CAAC,CAAC;EAEF,IAAIkd,aAAa,GAAG,KAAK;EACzB,MAAMpJ,OAAO,GAAG,MAAAA,CAAA,KAA2B;IACzC,IAAIoJ,aAAa,EAAE;MACjB;IACF;IACAA,aAAa,GAAG,IAAI;IACpB,MAAM3qB,OAAO,CAACwI,GAAG,CAACugB,gBAAgB,CAACtgB,GAAG,CAAC,MAAM1I,EAAE,IAAI,MAAMA,EAAE,GAAG,CAAC,CAAC,CAAC;IACjEqoB,MAAM,CAAC,CAAC;IACRvC,6EAAW,CAACqB,UAAU,CAAC;IACvB9mB,OAAO,CAACgnB,KAAK,CAACC,UAAU,CAAC,KAAK,CAAC;EACjC,CAAC;EAED,MAAM5Z,MAAM,GAAItN,GAAa,IAAW;IACtCohB,OAAO,CAAC,CAAC,CACNtY,IAAI,CAAC,MAAMwhB,aAAa,CAACtqB,GAAG,CAAC,CAAC,CAC9BD,KAAK,CAAE0qB,UAAmB,IAAK;MAC9BjrB,8DAAW,CAAC,8BAA8B,EAAEirB,UAAU,CAAC;MACvDH,aAAa,CAACtqB,GAAG,CAAC;IACpB,CAAC,CAAC;EACN,CAAC;EACD,MAAMF,OAAO,GAAGA,CAAA,KAAY;IAC1BshB,OAAO,CAAC,CAAC,CACNtY,IAAI,CAACuhB,cAAc,CAAC,CACpBtqB,KAAK,CAAE0qB,UAAmB,IAAK;MAC9BjrB,8DAAW,CAAC,8BAA8B,EAAEirB,UAAU,CAAC;MACvDJ,cAAc,CAAC,CAAC;IAClB,CAAC,CAAC;EACN,CAAC;EAED,IAAI3W,KAAK,EAAE;IACTzT,OAAO,CAACgnB,KAAK,CAACC,UAAU,CAAC,IAAI,CAAC;IAC9BjnB,OAAO,CAACgnB,KAAK,CAAC/mB,EAAE,CAAC,MAAM,EAAEO,IAAI,IAAI;MAC/B,MAAMC,GAAG,GAAGD,IAAI,CAACgL,QAAQ,CAAC,CAAC;MAC3B;MACA,IAAI/K,GAAG,KAAK,QAAQ,EAAE;QACpBM,OAAO,CAACC,GAAG,CAAC,iCAAiC,CAAC;QAC9CmgB,OAAO,CAAC,CAAC,CACNtY,IAAI,CAAC,MAAM;UACV7I,OAAO,CAACyqB,IAAI,CAAC,QAAQ,EAAE,QAAQ,CAAC;QAClC,CAAC,CAAC,CACD3qB,KAAK,CAAC,MAAM;UACXE,OAAO,CAACyqB,IAAI,CAAC,QAAQ,EAAE,QAAQ,CAAC;QAClC,CAAC,CAAC;MACN,CAAC,MAAM,IAAIhqB,GAAG,KAAK,GAAG,EAAE;QACtB,MAAMiqB,UAAU,GAAGxmB,iEAAe,CAChC,CAAC,GAAGijB,QAAQ,CAACrU,MAAM,CAAC,CAAC,CAAC,CACnB5K,OAAO,CAACmf,MAAM,IAAIA,MAAM,CAACxK,MAAM,CAAC,CAChCxU,GAAG,CAACtI,GAAG,IAAK,KAAK,IAAIA,GAAG,GAAGA,GAAG,CAACmd,GAAG,CAACC,YAAY,GAAGlY,SAAU,CACjE,CAAC;QACD,MAAMyE,KAAK,GAAG,CAAC,GAAG,IAAImJ,GAAG,CAAC,CAAC,GAAG6X,UAAU,CAAC,CAAC,CAAC5X,MAAM,CAAC,CAAC,CAAC;QACpD,MAAM6X,WAAW,GAAG,QAAQjhB,KAAK,CAAC9G,IAAI,CAAC,GAAG,CAAC,EAAE;QAC7CD,4DAAQ,CAACgoB,WAAW,CAAC;MACvB;IACF,CAAC,CAAC;IAEF3qB,OAAO,CAACC,EAAE,CAAC,QAAQ,EAAE,MAAM;MACzBslB,IAAI,CAAC,CAAC;IACR,CAAC,CAAC;IACFvlB,OAAO,CAACC,EAAE,CAAC,YAAY,EAAE,MAAM;MAC7BslB,IAAI,CAAC,CAAC;IACR,CAAC,CAAC;;IAEF;IACAvlB,OAAO,CAACC,EAAE,CAAC,mBAAmB,EAAEF,GAAG,IAAI;MACrCO,kDAAK,CAAC,oBAAoB,CAAC;MAC3BA,kDAAK,CAACP,GAAG,CAAC;MACVwlB,IAAI,CAAC,CAAC;IACR,CAAC,CAAC;;IAEF;IACAvlB,OAAO,CAACC,EAAE,CAAC,oBAAoB,EAAEF,GAAG,IAAI;MACtCO,kDAAK,CAAC,qBAAqB,CAAC;MAC5BA,kDAAK,CAACP,GAAG,CAAC;MACVwlB,IAAI,CAAC,CAAC;IACR,CAAC,CAAC;EACJ;EAEArlB,uEAAoB,CAACihB,OAAO,CAAC;EAC7B,OAAO,MAAMmJ,aAAa;AAC5B;AAEO,eAAeM,cAAcA,CAClC9gB,OAAiD,EAClC;EACf,MAAM;IAACI,IAAI;IAAEuJ;EAAK,CAAC,GAAG3J,OAAO;EAC7Bgd,UAAU,GAAG5c,IAAI;EACjB,MAAMyb,0EAAQ,CAACzb,IAAI,CAAC;EAEpB,MAAM;IAACN;EAAS,CAAC,GAAG,CAAC,MAAMgQ,6EAAa,CAAC1P,IAAI,CAAC,KAAK,CAAC,CAAC;EACrD,IAAI,CAACN,SAAS,EAAE;IACd,MAAM,IAAIlJ,KAAK,CAAC,iCAAiCwJ,IAAI,EAAE,CAAC;EAC1D;EACA,MAAMgd,WAAW,CAAC;IAChBhd,IAAI;IACJpC,kBAAkB,EAAE8B,SAAS;IAC7B6J;EACF,CAAC,CAAC;AACJ,C","sources":["webpack://b/external node-commonjs \"node:child_process\"","webpack://b/external node-commonjs \"node:path\"","webpack://b/external node-commonjs \"ansi-colors\"","webpack://b/external node-commonjs \"webpack\"","webpack://b/external node-commonjs \"webpack-dev-server\"","webpack://b/./src/exit_handler.ts","webpack://b/./src/global_error.ts","webpack://b/external node-commonjs \"node:fs\"","webpack://b/./src/logger.ts","webpack://b/./src/models.ts","webpack://b/./src/project/generate_workspace.ts","webpack://b/external node-commonjs \"node:url\"","webpack://b/./src/fs.ts","webpack://b/external node-commonjs \"prettier\"","webpack://b/./src/hash.ts","webpack://b/external node-commonjs \"node:crypto\"","webpack://b/./src/project/generate_project.ts","webpack://b/./src/project/dynamic_template.ts","webpack://b/./src/string_utils.ts","webpack://b/./src/rand_safe.ts","webpack://b/./src/project/gitignore.ts","webpack://b/./src/project/package_json.ts","webpack://b/./src/versions.ts","webpack://b/./src/project/terraform/all.ts","webpack://b/./src/project/terraform/frontend.ts","webpack://b/./src/project/terraform/lambda.ts","webpack://b/./src/project/terraform/provider.ts","webpack://b/./src/project/terraform/s3.ts","webpack://b/./src/type_utils.ts","webpack://b/./src/project/terraform/dynamo_user.ts","webpack://b/./src/project/terraform/dynamo_user_session.ts","webpack://b/./src/project/vscode_workspace.ts","webpack://b/./src/webpack/utils.ts","webpack://b/external node-commonjs \"node:fs/promises\"","webpack://b/./src/webpack-runner/env_definition_file.ts","webpack://b/./src/webpack-runner/error_grouper.ts","webpack://b/./src/webpack-runner/error_parser.ts","webpack://b/./src/webpack-runner/icon_server.ts","webpack://b/external node-commonjs \"node:http\"","webpack://b/./src/webpack-runner/ip.ts","webpack://b/external node-commonjs \"node:os\"","webpack://b/./src/webpack-runner/line_reader.ts","webpack://b/./src/webpack-runner/renderer.ts","webpack://b/./src/webpack-runner/error_formatter.ts","webpack://b/./src/webpack-runner/runner_lock.ts","webpack://b/./src/webpack-runner/text_table.ts","webpack://b/webpack/bootstrap","webpack://b/webpack/runtime/compat get default export","webpack://b/webpack/runtime/define property getters","webpack://b/webpack/runtime/hasOwnProperty shorthand","webpack://b/webpack/runtime/make namespace object","webpack://b/./src/webpack-runner/runner.ts"],"sourcesContent":["module.exports = __WEBPACK_EXTERNAL_createRequire(import.meta.url)(\"node:child_process\");","module.exports = __WEBPACK_EXTERNAL_createRequire(import.meta.url)(\"node:path\");","module.exports = __WEBPACK_EXTERNAL_createRequire(import.meta.url)(\"ansi-colors\");","module.exports = __WEBPACK_EXTERNAL_createRequire(import.meta.url)(\"webpack\");","module.exports = __WEBPACK_EXTERNAL_createRequire(import.meta.url)(\"webpack-dev-server\");","import {globalError} from '@src/global_error';\n\nlet called = false;\nconst callbacks: (() => void | Promise<void>)[] = [];\n\nfunction runCallbacks(): void {\n  if (called) {\n    return;\n  }\n  called = true;\n  for (const fn of callbacks) {\n    Promise.resolve(fn()).catch((err: unknown) =>\n      globalError('Failure to run exit cleanup callback', err)\n    );\n  }\n}\n\nprocess.on('beforeExit', () => runCallbacks());\nprocess.on('exit', () => runCallbacks());\nprocess.on('SIGTERM', () => runCallbacks());\nprocess.on('SIGINT', () => runCallbacks());\nprocess.on('uncaughtException', err => {\n  globalError('uncaughtException', err);\n  runCallbacks();\n});\n\nexport function registerExitCallback(cb: () => void | Promise<void>): void {\n  callbacks.push(cb);\n}\n","import {appendFileSync} from 'node:fs';\n\nimport {error} from '@src/logger';\n\nexport function globalError(...val: unknown[]): void {\n  for (const data of val) {\n    try {\n      const str =\n        typeof data === 'string'\n          ? data\n          : data instanceof Error\n            ? (data.stack ?? String(data))\n            : JSON.stringify(data);\n      error(str);\n      appendFileSync('error.log', str);\n    } catch {\n      // Don't log anything that went wrong during logging to prevent infinite loops\n    }\n  }\n}\n","module.exports = __WEBPACK_EXTERNAL_createRequire(import.meta.url)(\"node:fs\");","export const error: (message?: unknown, ...optionalParams: unknown[]) => void = console.error;\nexport const log: (message?: unknown, ...optionalParams: unknown[]) => void = console.log;\n","import {Brand} from '@src/type_utils';\n\nexport type WorkspaceName = Brand<string, 'WorkspaceName'>;\nexport type ProjectName = Brand<string, 'ProjectName'>;\n\n//\n// Project type\n//\n\nexport enum ProjectType {\n  Web = 'web',\n  LambdaFunction = 'lambda_function',\n  LambdaApi = 'lambda_api',\n  LambdaWebApi = 'lambda_web_api',\n  NodeScript = 'node_script',\n  Shared = 'shared',\n  SharedNode = 'shared-node',\n  SharedWeb = 'shared-web',\n}\n\nexport enum EslintType {\n  Web = 'web',\n  Node = 'node',\n  Lib = 'lib',\n}\n\nexport enum TsConfigType {\n  Web = 'web',\n  Node = 'node',\n  Lib = 'lib',\n}\nexport enum WebpackType {\n  Web = 'web',\n  Lib = 'lib', // shared\n  Lambda = 'lambda',\n  NodeScript = 'node-script',\n}\n\nexport interface ProjectTypeMetadata {\n  eslint: EslintType;\n  tsconfig: TsConfigType;\n  webpack?: WebpackType;\n}\n\nexport const PROJECT_TYPE_TO_METADATA = {\n  [ProjectType.Web]: {\n    eslint: EslintType.Web,\n    tsconfig: TsConfigType.Web,\n    webpack: WebpackType.Web,\n  },\n  [ProjectType.LambdaFunction]: {\n    eslint: EslintType.Node,\n    tsconfig: TsConfigType.Node,\n    webpack: WebpackType.Lambda,\n  },\n  [ProjectType.LambdaApi]: {\n    eslint: EslintType.Node,\n    tsconfig: TsConfigType.Node,\n    webpack: WebpackType.Lambda,\n  },\n  [ProjectType.LambdaWebApi]: {\n    eslint: EslintType.Node,\n    tsconfig: TsConfigType.Node,\n    webpack: WebpackType.Lambda,\n  },\n  [ProjectType.NodeScript]: {\n    eslint: EslintType.Node,\n    tsconfig: TsConfigType.Node,\n    webpack: WebpackType.NodeScript,\n  },\n  [ProjectType.Shared]: {\n    eslint: EslintType.Lib,\n    tsconfig: TsConfigType.Lib,\n    webpack: WebpackType.Lib,\n  },\n  [ProjectType.SharedNode]: {\n    eslint: EslintType.Node,\n    tsconfig: TsConfigType.Node,\n    webpack: WebpackType.Lib,\n  },\n  [ProjectType.SharedWeb]: {\n    eslint: EslintType.Web,\n    tsconfig: TsConfigType.Web,\n    webpack: WebpackType.Lib,\n  },\n} satisfies Record<ProjectType, ProjectTypeMetadata>;\n\n//\n// Workspace Fragment type\n//\n\nexport enum WorkspaceFragmentType {\n  StaticWebsite = 'static-website',\n  StandaloneLambda = 'standalone-lambda',\n  ApiLambda = 'api-lambda',\n  WebApp = 'web-app',\n  NodeScript = 'node-script',\n  Shared = 'shared',\n  SharedNode = 'shared-node',\n  SharedWeb = 'shared-web',\n}\n\ninterface WorkspaceFragmentBase {\n  type: WorkspaceFragmentType;\n}\n\nexport interface WebAppAuthentication {\n  enabled: boolean;\n}\n\nexport interface WorkspaceFragmentRegistry {\n  [WorkspaceFragmentType.StaticWebsite]: {\n    type: WorkspaceFragmentType.StaticWebsite;\n    websiteName: ProjectName;\n    domain: string | undefined;\n  };\n  [WorkspaceFragmentType.StandaloneLambda]: {\n    type: WorkspaceFragmentType.StandaloneLambda;\n    lambdaName: ProjectName;\n    alarmEmail: string | undefined;\n    cloudwatchTriggerMinutes: number | undefined;\n  };\n  [WorkspaceFragmentType.ApiLambda]: {\n    type: WorkspaceFragmentType.ApiLambda;\n    apiName: ProjectName;\n    alarmEmail: string | undefined;\n    domain: string | undefined;\n  };\n  [WorkspaceFragmentType.WebApp]: {\n    type: WorkspaceFragmentType.WebApp;\n    appName: string;\n    alarmEmail: string | undefined;\n    domain: string | undefined;\n    authentication: WebAppAuthentication;\n  };\n  [WorkspaceFragmentType.NodeScript]: {\n    type: WorkspaceFragmentType.NodeScript;\n    scriptName: ProjectName;\n  };\n  [WorkspaceFragmentType.Shared]: {\n    type: WorkspaceFragmentType.Shared;\n  };\n  [WorkspaceFragmentType.SharedNode]: {\n    type: WorkspaceFragmentType.SharedNode;\n  };\n  [WorkspaceFragmentType.SharedWeb]: {\n    type: WorkspaceFragmentType.SharedWeb;\n  };\n}\n\ntype RegistryIsValid =\n  WorkspaceFragmentRegistry extends Record<WorkspaceFragmentType, WorkspaceFragmentBase>\n    ? boolean\n    : never;\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nfunction validateRegistry(): RegistryIsValid {\n  return true;\n}\n\nexport function filterFragments<T extends WorkspaceFragmentType>(\n  frags: WorkspaceFragment[],\n  type: T\n): WorkspaceFragmentRegistry[T][] {\n  return frags.filter(frag => frag.type === type) as WorkspaceFragmentRegistry[T][];\n}\n\nexport type WorkspaceFragment = WorkspaceFragmentRegistry[keyof WorkspaceFragmentRegistry];\n","import {execSync} from 'node:child_process';\nimport {join, relative} from 'node:path';\nimport {fileURLToPath} from 'node:url';\n\nimport {listFiles, prettyJs, prettyJson, prettyJsonc, readFile, writeRawFile} from '@src/fs';\nimport {md5} from '@src/hash';\nimport {log} from '@src/logger';\nimport {\n  ProjectName,\n  ProjectType,\n  WorkspaceFragment,\n  WorkspaceFragmentType,\n  WorkspaceName,\n} from '@src/models';\nimport {generateProject} from '@src/project/generate_project';\nimport {generateGitIgnore} from '@src/project/gitignore';\nimport {generateWorkspacePackageJson} from '@src/project/package_json';\nimport {\n  AppDomain,\n  generateCommonTerraform,\n  generateWorkspaceProjectTerraform,\n} from '@src/project/terraform/all';\nimport {generateDynamoUserTerraform} from '@src/project/terraform/dynamo_user';\nimport {generateDynamoUserSessionTerraform} from '@src/project/terraform/dynamo_user_session';\nimport {WorkspaceProjectTerraformFrontend} from '@src/project/terraform/frontend';\nimport {WorkspaceProjectTerraformLambda} from '@src/project/terraform/lambda';\nimport {\n  FileHash,\n  generateCodeWorkspace,\n  Workspace,\n  WorkspaceOptions,\n  writeWorkspace,\n} from '@src/project/vscode_workspace';\nimport {lowerCase, pascalCase} from '@src/string_utils';\nimport {neverHappens, removeUndefined} from '@src/type_utils';\nimport {PACKAGE_VERSIONS} from '@src/versions';\n\nexport const DEFAULT_REGION = 'eu-west-3';\nconst TEMPLATES_PATH = join(fileURLToPath(import.meta.url), '../templates');\n\ntype Flag = Record<string, string>;\nconst booleanFlag = (bool: boolean): string => (bool ? 'true' : 'false');\n\nexport function hasApi(allFragments: WorkspaceFragment[]): boolean {\n  return (\n    allFragments.find(\n      f => f.type === WorkspaceFragmentType.ApiLambda || f.type === WorkspaceFragmentType.WebApp\n    ) !== undefined\n  );\n}\n\nexport type WorkspaceProjectTerraform =\n  | WorkspaceProjectTerraformLambda\n  | WorkspaceProjectTerraformFrontend\n  | {type: 'no-terraform'};\n\nexport interface WorkspaceProject {\n  projectName: ProjectName;\n  type: ProjectType;\n  fromFragment: WorkspaceFragment;\n  vars: Record<string, string>;\n  flags: (allFragments: WorkspaceFragment[]) => Flag;\n  terraform: WorkspaceProjectTerraform;\n}\n\nfunction fragmentFlags(baseFlags: Flag): (allFragments: WorkspaceFragment[]) => Flag {\n  return (allFragments: WorkspaceFragment[]): Flag => {\n    const workspaceFlags: Flag = {\n      HAS_API: booleanFlag(hasApi(allFragments)),\n    };\n    return {...workspaceFlags, ...baseFlags};\n  };\n}\n\n// Parse a string into its domain/subdomain.\n// We assume the root domain (the hosted zone registered in AWS)\n// is the in form of <second-level-domain>.<first-level-domain> (eg: \"matthis.link\")\nfunction parseDomain(domainStr?: string): AppDomain | undefined {\n  if (domainStr === undefined) {\n    return undefined;\n  }\n  const parts = domainStr.split('.');\n  const rootDomain = parts.slice(-2).join('.'); // eslint-disable-line @typescript-eslint/no-magic-numbers\n  const subDomain = parts.slice(0, -2).join('.'); // eslint-disable-line @typescript-eslint/no-magic-numbers\n  return {subDomain, rootDomain};\n}\n\nexport function getProjectsFromWorkspaceFragment(fragment: WorkspaceFragment): WorkspaceProject[] {\n  if (fragment.type === WorkspaceFragmentType.StaticWebsite) {\n    return [\n      {\n        projectName: fragment.websiteName,\n        type: ProjectType.Web,\n        fromFragment: fragment,\n        vars: {\n          __PROJECT_NAME__: fragment.websiteName,\n          __APP_NAME__: fragment.websiteName,\n        },\n        flags: fragmentFlags({}),\n        terraform: {\n          type: 'frontend',\n          domain: parseDomain(fragment.domain),\n        },\n      },\n    ];\n  } else if (fragment.type === WorkspaceFragmentType.StandaloneLambda) {\n    return [\n      {\n        projectName: fragment.lambdaName,\n        type: ProjectType.LambdaFunction,\n        fromFragment: fragment,\n        vars: {\n          __PROJECT_NAME__: fragment.lambdaName,\n          __PROJECT_NAME_UPPERCASE__: fragment.lambdaName.toUpperCase(),\n        },\n        flags: fragmentFlags({}),\n        terraform: {\n          type: 'lambda',\n          api: false,\n          webAppName: undefined,\n          alarmEmail: fragment.alarmEmail,\n          cloudwatchTriggerMinutes: fragment.cloudwatchTriggerMinutes,\n          domain: undefined,\n          authentication: undefined,\n        },\n      },\n    ];\n  } else if (fragment.type === WorkspaceFragmentType.ApiLambda) {\n    return [\n      {\n        projectName: fragment.apiName,\n        type: ProjectType.LambdaApi,\n        fromFragment: fragment,\n        vars: {\n          __PROJECT_NAME__: fragment.apiName,\n          __PROJECT_NAME_UPPERCASE__: fragment.apiName.toUpperCase(),\n        },\n        flags: fragmentFlags({}),\n        terraform: {\n          type: 'lambda',\n          api: true,\n          webAppName: undefined,\n          alarmEmail: fragment.alarmEmail,\n          cloudwatchTriggerMinutes: undefined,\n          domain: parseDomain(fragment.domain),\n          authentication: undefined,\n        },\n      },\n    ];\n  } else if (fragment.type === WorkspaceFragmentType.WebApp) {\n    const backendName = `${fragment.appName}_backend` as ProjectName;\n    const frontendName = `${fragment.appName}_frontend` as ProjectName;\n    const vars = {\n      __APP_NAME__: fragment.appName,\n      __APP_NAME_UPPERCASE__: fragment.appName.toUpperCase(),\n      __APP_NAME_PASCALCASE__: pascalCase(fragment.appName),\n    };\n    const flags = fragmentFlags({\n      AUTHENTICATION: booleanFlag(fragment.authentication.enabled),\n    });\n    return [\n      {\n        projectName: frontendName,\n        type: ProjectType.Web,\n        fromFragment: fragment,\n        vars,\n        flags,\n        terraform: {\n          type: 'frontend',\n          domain:\n            fragment.domain === undefined ? undefined : parseDomain(`static.${fragment.domain}`),\n        },\n      },\n      {\n        projectName: backendName,\n        type: ProjectType.LambdaWebApi,\n        fromFragment: fragment,\n        vars,\n        flags,\n        terraform: {\n          type: 'lambda',\n          api: true,\n          webAppName: fragment.appName,\n          alarmEmail: fragment.alarmEmail,\n          cloudwatchTriggerMinutes: undefined,\n          domain: parseDomain(fragment.domain),\n          authentication: fragment.authentication,\n        },\n      },\n    ];\n  } else if (fragment.type === WorkspaceFragmentType.NodeScript) {\n    return [\n      {\n        projectName: fragment.scriptName,\n        type: ProjectType.NodeScript,\n        fromFragment: fragment,\n        vars: {\n          __PROJECT_NAME__: fragment.scriptName,\n        },\n        flags: fragmentFlags({}),\n        terraform: {\n          type: 'no-terraform',\n        },\n      },\n    ];\n  } else if (fragment.type === WorkspaceFragmentType.SharedNode) {\n    const projectName = 'shared-node' as ProjectName;\n    return [\n      {\n        projectName,\n        type: ProjectType.SharedNode,\n        fromFragment: fragment,\n        vars: {\n          __PROJECT_NAME__: projectName,\n        },\n        flags: fragmentFlags({}),\n        terraform: {\n          type: 'no-terraform',\n        },\n      },\n    ];\n  } else if (fragment.type === WorkspaceFragmentType.SharedWeb) {\n    const projectName = 'shared-web' as ProjectName;\n    return [\n      {\n        projectName,\n        type: ProjectType.SharedWeb,\n        fromFragment: fragment,\n        vars: {\n          __PROJECT_NAME__: projectName,\n        },\n        flags: fragmentFlags({}),\n        terraform: {\n          type: 'no-terraform',\n        },\n      },\n    ];\n    // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n  } else if (fragment.type === WorkspaceFragmentType.Shared) {\n    const projectName = 'shared' as ProjectName;\n    return [\n      {\n        projectName,\n        type: ProjectType.Shared,\n        fromFragment: fragment,\n        vars: {\n          __PROJECT_NAME__: projectName,\n        },\n        flags: fragmentFlags({}),\n        terraform: {\n          type: 'no-terraform',\n        },\n      },\n    ];\n  }\n  neverHappens(fragment, `Unknown ProjectType ${(fragment as WorkspaceFragment).type}`);\n}\n\nexport async function generateWorkspace(\n  dst: string,\n  workspaceName: WorkspaceName,\n  workspaceFragments: WorkspaceFragment[],\n  workspaceOptions: WorkspaceOptions,\n  workspace: Workspace | undefined\n): Promise<void> {\n  const projects = workspaceFragments.flatMap(f => getProjectsFromWorkspaceFragment(f));\n\n  // Create projects files from templates\n  const projectFiles = await Promise.all(\n    projects.map(\n      async project =>\n        await generateProject({\n          dst,\n          project,\n          allFragments: workspaceFragments,\n          workspace,\n          workspaceName,\n        })\n    )\n  );\n\n  // Generate workspace root files\n  const SCRIPTS_PATH = join(fileURLToPath(import.meta.url), '../scripts');\n  const writeFile = async (path: string, file: string): Promise<FileHash> =>\n    await writeWorkspaceFile(workspace, dst, path, file);\n  const workspaceFiles = await Promise.all([\n    // package.json\n    writeFile(\n      'package.json',\n      await prettyJson(generateWorkspacePackageJson(workspaceName, projects))\n    ),\n    // app.code-workspace\n    writeFile(\n      'app.code-workspace',\n      await prettyJsonc(generateCodeWorkspace(workspaceName, workspaceFragments))\n    ),\n    // .gitignore\n    writeFile('.gitignore', generateGitIgnore()),\n    // setup.js\n    writeFile('setup.js', await prettyJs(await readFile(join(SCRIPTS_PATH, 'setup.js')))),\n    // deploy.js\n    writeFile(\n      'deploy.js',\n      await prettyJs(\n        await readFile(join(SCRIPTS_PATH, 'deploy.js')).then(res =>\n          res.replaceAll('__WORKSPACE_NAME__', workspaceName)\n        )\n      )\n    ),\n    // build.js\n    writeFile('build.js', await prettyJs(await readFile(join(SCRIPTS_PATH, 'build.js')))),\n  ]);\n\n  // Vscode folder\n  const vscodePath = join(TEMPLATES_PATH, '.vscode');\n  const vscodeFileList = await listFiles(vscodePath);\n  const vscodeFiles = await Promise.all(\n    vscodeFileList.map(async file => {\n      const relativePath = relative(vscodePath, file);\n      const dstPath = join('.vscode', relativePath);\n      const content = await readFile(file);\n      return await writeFile(dstPath, content);\n    })\n  );\n\n  // Terraform folder generation\n  const terraformFiles = await Promise.all([\n    ...workspaceFragments\n      .filter(frag => frag.type === WorkspaceFragmentType.WebApp)\n      .filter(frag => frag.authentication.enabled)\n      .flatMap(frag => {\n        return [\n          writeFile(\n            join('terraform', `dynamo_table_${lowerCase(frag.appName)}_user.tf`),\n            addLineBreak(generateDynamoUserTerraform(workspaceName, frag.appName))\n          ),\n          writeFile(\n            join('terraform', `dynamo_table_${lowerCase(frag.appName)}_user_session.tf`),\n            addLineBreak(generateDynamoUserSessionTerraform(workspaceName, frag.appName))\n          ),\n        ];\n      }),\n    writeFile(\n      join('terraform', 'base.tf'),\n      addLineBreak(generateCommonTerraform(workspaceName, projects, workspaceOptions))\n    ),\n    ...projects.map(async p => {\n      const content = generateWorkspaceProjectTerraform(workspaceName, p);\n      if (content === undefined) {\n        return;\n      }\n      const name = `${p.projectName}_terraform`;\n      return await writeFile(join('terraform', `${name}.tf`), addLineBreak(content));\n    }),\n  ]);\n\n  await writeWorkspace(dst, {\n    files: removeUndefined([\n      ...projectFiles.flat(),\n      ...workspaceFiles,\n      ...terraformFiles,\n      ...vscodeFiles,\n    ]),\n    fragments: workspaceFragments,\n    version: PACKAGE_VERSIONS.project,\n    options: workspaceOptions,\n  });\n\n  // Run setup.js\n  log('Running post install script');\n  const commands = [`cd ${dst}`, `node setup.js`, `git init`];\n  execSync(commands.join(' && '), {stdio: ['ignore', 'inherit', 'inherit']});\n\n  // Final instructions\n  log(`Run the following to get started:`);\n  log(`cd ${relative(process.cwd(), dst)}; code app.code-workspace; yarn watch`);\n}\n\nexport async function writeWorkspaceFile(\n  workspace: Workspace | undefined,\n  root: string,\n  path: string,\n  file: string\n): Promise<FileHash> {\n  const fileLines = file.split('\\n');\n  const fileToHash = fileLines.filter(line => !line.endsWith(' // @matthis/ignore')).join('\\n');\n  const newHash = md5(fileToHash);\n  const oldHash = workspace?.files.find(f => f.path === path)?.hash;\n  // Only write the file if it is different since last time we've generated the project.\n  // Prevent needlessly overwriting changes made in the project in between.\n  if (newHash !== oldHash) {\n    const fileToWrite = fileLines.map(l => l.replaceAll(' // @matthis/ignore', '')).join('\\n');\n    await writeRawFile(join(root, path), fileToWrite);\n  }\n  return {path, hash: newHash};\n}\n\nconst addLineBreak = (content: string): string =>\n  content.endsWith('\\n') ? content : `${content}\\n`;\n","module.exports = __WEBPACK_EXTERNAL_createRequire(import.meta.url)(\"node:url\");","import {exec} from 'node:child_process';\nimport {promises, readFileSync} from 'node:fs';\nimport {dirname, join} from 'node:path';\n\nimport {BuiltInParserName, format} from 'prettier';\n\nexport const {access, readFile: readFileInternal, readdir, stat} = promises;\nconst {writeFile, mkdir, rm} = promises;\n\nexport async function readFile(path: string): Promise<string> {\n  const buffer = await readFileInternal(path);\n  return buffer.toString();\n}\n\nconst prettierConfig = (parser: BuiltInParserName) =>\n  ({\n    parser,\n    printWidth: 100,\n    singleQuote: true,\n    trailingComma: 'es5',\n    bracketSpacing: false,\n    arrowParens: 'avoid',\n    endOfLine: 'auto',\n  }) as const;\n\nexport async function prettierFormat(str: string, parser: BuiltInParserName): Promise<string> {\n  return await format(str, prettierConfig(parser));\n}\n\nexport async function writeRawFile(path: string, content: string): Promise<void> {\n  await mkdir(dirname(path), {recursive: true});\n  await writeFile(path, content);\n}\n\nexport async function prettyJson(json: unknown, opts?: {compact?: boolean}): Promise<string> {\n  const {compact} = opts ?? {};\n  return await format(\n    compact ? JSON.stringify(json) : JSON.stringify(json, undefined, 2),\n    prettierConfig('json')\n  );\n}\nexport async function prettyJsonc(json: unknown, opts?: {compact?: boolean}): Promise<string> {\n  const {compact} = opts ?? {};\n  return await format(\n    compact ? JSON.stringify(json) : JSON.stringify(json, undefined, 2),\n    prettierConfig('jsonc')\n  );\n}\nexport async function writeJsonFile(path: string, json: unknown): Promise<void> {\n  await writeRawFile(path, await prettyJson(json));\n}\n\nexport async function prettyJs(js: string): Promise<string> {\n  return await format(js, prettierConfig('babel'));\n}\nexport async function writeJsFile(path: string, js: string): Promise<void> {\n  await writeRawFile(path, await prettyJs(js));\n}\n\nexport async function prettyTs(ts: string): Promise<string> {\n  return await format(ts, prettierConfig('typescript'));\n}\nexport async function writeTsFile(path: string, ts: string): Promise<void> {\n  await writeRawFile(path, await prettyTs(ts));\n}\n\nexport async function writeRawFileIfNotExists(path: string, content: string): Promise<void> {\n  if (await exists(path)) {\n    return;\n  }\n  await writeRawFile(path, content);\n}\n\nexport async function rmDir(dirPath: string): Promise<void> {\n  await rm(dirPath, {recursive: true, force: true});\n}\n\nexport async function cleanDir(dirPath: string): Promise<void> {\n  try {\n    await rmDir(dirPath);\n  } finally {\n    await mkdir(dirPath, {recursive: true});\n  }\n}\n\nexport async function cp(from: string, to: string): Promise<void> {\n  return await new Promise((resolve, reject) => {\n    exec(`cp -R ${from} ${to}`, err => (err ? reject(err) : resolve()));\n  });\n}\n\nexport async function exists(path: string): Promise<boolean> {\n  try {\n    await access(path);\n    return true;\n  } catch {\n    return false;\n  }\n}\n\nexport async function maybeReadFile(path: string): Promise<string | undefined> {\n  try {\n    const fileContent = await readFile(path);\n    return fileContent.toString();\n  } catch {\n    return undefined;\n  }\n}\n\nexport function maybeReadFileSync(path: string): string | undefined {\n  try {\n    const fileContent = readFileSync(path);\n    return fileContent.toString();\n  } catch {\n    return undefined;\n  }\n}\n\nexport async function listFiles(path: string): Promise<string[]> {\n  const files: string[] = [];\n  const ents = await readdir(path, {withFileTypes: true});\n  const promises: Promise<void>[] = [];\n  for (const ent of ents) {\n    const entPath = join(path, ent.name);\n    if (ent.isDirectory()) {\n      promises.push(\n        listFiles(entPath).then(subFiles => {\n          files.push(...subFiles);\n        })\n      );\n    } else if (ent.isFile()) {\n      files.push(entPath);\n    }\n  }\n  await Promise.all(promises);\n  return files;\n}\n","module.exports = __WEBPACK_EXTERNAL_createRequire(import.meta.url)(\"prettier\");","import {createHash} from 'node:crypto';\n\nexport function md5(data: string | Buffer): string {\n  const content = typeof data === 'string' ? data : data.toString();\n  return createHash('md5').update(content).digest('hex');\n}\n\nexport function hashPassword(password: string, salt: string): string {\n  return createHash('sha256').update(`${password}${salt}`).digest('base64');\n}\n","module.exports = __WEBPACK_EXTERNAL_createRequire(import.meta.url)(\"node:crypto\");","import {join, relative} from 'node:path';\nimport {fileURLToPath} from 'node:url';\n\nimport {listFiles, prettierFormat, readFile} from '@src/fs';\nimport {ProjectType, WorkspaceFragment} from '@src/models';\nimport {generateSharedFiles} from '@src/project/dynamic_template';\nimport {WorkspaceProject, writeWorkspaceFile} from '@src/project/generate_workspace';\nimport {FileHash, Workspace} from '@src/project/vscode_workspace';\nimport {randomStringSafe} from '@src/rand_safe';\nimport {upperCase} from '@src/string_utils';\n\nconst TEMPLATES_PATH = join(fileURLToPath(import.meta.url), '../templates');\n\nexport async function generateProject(opts: {\n  dst: string;\n  project: WorkspaceProject;\n  allFragments: WorkspaceFragment[];\n  workspace: Workspace | undefined;\n  workspaceName: string;\n}): Promise<FileHash[]> {\n  const {dst, project, allFragments, workspace, workspaceName} = opts;\n\n  const written: FileHash[] = [];\n  const {projectName, type, vars} = project;\n  const defaultVars = {\n    __WORKSPACE_NAME__: workspaceName,\n    __WORKSPACE_NAME_UPPERCASE__: upperCase(workspaceName),\n    // eslint-disable-next-line @typescript-eslint/no-magic-numbers\n    __COOKIE_ENCRYPTION_KEY__: randomStringSafe(32),\n  };\n\n  // Copy template files\n  const templatePath = join(TEMPLATES_PATH, type);\n  const files = await listFiles(templatePath);\n  const filesToWrite = [\n    ...(await Promise.all(\n      files.map(async file => {\n        const relativePath = relative(templatePath, file);\n        const dstPath = join(projectName, relativePath);\n\n        let content = await readFile(file);\n        if (file.endsWith('package.json')) {\n          const packageJson = JSON.parse(await readFile(file));\n          packageJson['name'] = projectName;\n          content = JSON.stringify(packageJson, undefined, 2);\n        }\n        for (const [varName, varValue] of Object.entries({...vars, ...defaultVars})) {\n          content = content.replaceAll(varName, varValue);\n        }\n\n        return {path: dstPath, content};\n      })\n    )),\n  ];\n  if (type === ProjectType.Shared) {\n    filesToWrite.push(...generateSharedFiles(allFragments));\n  }\n\n  await Promise.all(\n    filesToWrite.map(async ({path, content}) => {\n      let formattedContent = content;\n\n      // Handle @matthis/skip-file directives\n      const skipFileMatches = content.matchAll(\n        /\\/\\/ @matthis\\/skip-file:(?<flagName>[^:]+)(?<negate>:not)?:(?<flagValue>[^\\s]*)/gu\n      );\n      for (const skipFileMatch of skipFileMatches) {\n        const {flagName, negate, flagValue} = skipFileMatch.groups ?? {};\n        if (flagMatch({flagName, negate, flagValue}, project, allFragments)) {\n          return;\n        }\n      }\n      // Remove the lines that contain the @matthis/skip-file directives\n      formattedContent = formattedContent.replaceAll(\n        / *\\/\\/ @matthis\\/skip-file:[^:]+(?::not)?:[^\\n]*\\n/gu,\n        ''\n      );\n\n      // Handle @matthis/start and @matthis/end directives\n      const fileLines: string[] = [];\n      const depth: ('include' | 'exclude')[] = ['include'];\n      for (const line of formattedContent.split('\\n')) {\n        // Look for @matthis/end\n        if (line.includes('@matthis/end')) {\n          depth.pop();\n          continue;\n        }\n\n        // Look for @matthis/start\n        const matchStart =\n          /.*\\/\\/ @matthis\\/start:(?<flagName>[^:]+)(?<negate>:not)?:(?<flagValue>[^\\s]*).*/u.exec(\n            line\n          );\n        if (matchStart) {\n          const {flagName, negate, flagValue} = matchStart.groups ?? {};\n          depth.push(\n            flagMatch({flagName, negate, flagValue}, project, allFragments) ? 'include' : 'exclude'\n          );\n          continue;\n        }\n\n        if (depth.at(-1) === 'include') {\n          fileLines.push(line);\n        }\n      }\n      formattedContent = fileLines.join('\\n');\n\n      if (path.endsWith('.ts') || path.endsWith('.tsx')) {\n        formattedContent = await prettierFormat(formattedContent, 'typescript');\n      }\n      if (path.endsWith('.json')) {\n        formattedContent = await prettierFormat(formattedContent, 'json');\n      }\n      written.push(await writeWorkspaceFile(workspace, dst, path, formattedContent));\n    })\n  );\n\n  return written;\n}\n\nfunction flagMatch(\n  flag: {flagName?: string; negate?: string; flagValue?: string},\n  project: WorkspaceProject,\n  allFragments: WorkspaceFragment[]\n): boolean {\n  const {flagName, negate, flagValue} = flag;\n  if (flagName === undefined || flagValue === undefined) {\n    return false;\n  }\n  const projectFlagValue = project.flags(allFragments)[flagName];\n  const projectFlagMatchValue = projectFlagValue === flagValue;\n  return negate !== undefined ? !projectFlagMatchValue : projectFlagMatchValue;\n}\n","import {\n  filterFragments,\n  WorkspaceFragment,\n  WorkspaceFragmentRegistry,\n  WorkspaceFragmentType,\n} from '@src/models';\nimport {hasApi} from '@src/project/generate_workspace';\nimport {pascalCase} from '@src/string_utils';\n\ninterface TemplateFile {\n  path: string;\n  content: string;\n}\n\nexport function generateSharedFiles(allFragments: WorkspaceFragment[]): TemplateFile[] {\n  const webApps = filterFragments(allFragments, WorkspaceFragmentType.WebApp);\n  const apiLambdas = filterFragments(allFragments, WorkspaceFragmentType.ApiLambda);\n  const webAppsWithAuth = webApps.filter(app => app.authentication.enabled);\n  return [\n    ...(hasApi(allFragments) ? [generateSharedApiFile({webApps, apiLambdas})] : []),\n    ...webApps.map(webApp => {\n      const userType = `${pascalCase(webApp.appName)}User`;\n      return {\n        path: `shared/src/api/${webApp.appName}_api.ts`,\n        content: webApp.authentication.enabled\n          ? `\nimport {Obj, SchemaToType, Str} from '@shared/api/core/api_schema';\nimport {${userType}Id} from '@shared/models';\n\nconst Frontend${userType}Schema = Obj({\n    id: Str<${userType}Id>(),\n});\nexport type Frontend${userType} = SchemaToType<typeof Frontend${userType}Schema>;\n\nexport const ${webApp.appName.toUpperCase()}_API = {\n    '/login': {\n        POST: {\n            req: Obj({id: Str(), password: Str()}),\n            res: Frontend${userType}Schema,\n        },\n    },\n    '/test': {\n        POST: {\n            req: Obj({query: Str()}),\n            res: Obj({data: Str()}),\n        },\n    },\n};\n      `\n          : `\nimport {Obj, Str} from '@shared/api/core/api_schema';\n\nexport const ${webApp.appName.toUpperCase()}_API = {\n    '/test': {\n        POST: {\n            req: Obj({query: Str()}),\n            res: Obj({data: Str()}),\n        },\n    },\n};\n          `,\n      };\n    }),\n    ...apiLambdas.map(apiLambda => ({\n      path: `shared/src/api/${apiLambda.apiName}.ts`,\n      content: `\n  import {Unknown} from '@shared/api/core/api_schema';\n  \n  export const ${apiLambda.apiName.toUpperCase()} = {\n      '/test': {\n          GET: {\n              req: Unknown(),\n              res: Unknown(),\n          },\n      },\n  };\n        `,\n    })),\n    ...(webAppsWithAuth.length === 0 ? [] : [generateSharedModelFile(webAppsWithAuth)]),\n  ];\n}\n\nfunction generateSharedApiFile(opts: {\n  webApps: WorkspaceFragmentRegistry['web-app'][];\n  apiLambdas: WorkspaceFragmentRegistry['api-lambda'][];\n}): TemplateFile {\n  const {webApps, apiLambdas} = opts;\n\n  // IMPORTS\n  const imports = [\n    ...webApps.map(\n      webApp =>\n        `import {${webApp.appName.toUpperCase()}_API} from '@shared/api/${webApp.appName}_api';`\n    ),\n    ...apiLambdas.map(\n      apiLambda =>\n        `import {${apiLambda.apiName.toUpperCase()}} from '@shared/api/${apiLambda.apiName}';`\n    ),\n    `import {AllApiSchema} from '@shared/api/core/api_schema';`,\n    `import {ApiConfig, ApiName} from '@shared/api/core/api_types';`,\n    `import {${[\n      ...webApps.map(webApp => `${webApp.appName.toUpperCase()}_BACKEND_URL`),\n      ...apiLambdas.map(apiLambda => `${apiLambda.apiName.toUpperCase()}_URL`),\n    ].join(', ')}} from '@shared/env';`,\n  ].join('\\n');\n\n  // APIs DEF\n  const apisDef = `\n    export const ALL = {\n      ${[\n        ...webApps.map(webApp => `${webApp.appName}_backend: ${webApp.appName.toUpperCase()}_API,`),\n        ...apiLambdas.map(apiLambda => `${apiLambda.apiName}: ${apiLambda.apiName.toUpperCase()},`),\n      ].join('\\n')}\n    } satisfies AllApiSchema;\n  `.trim();\n\n  // APIs CONFIG\n  const apisConfig = `\n    export const API_CONFIGS = {\n      ${[\n        ...webApps.map(\n          webApp =>\n            `${webApp.appName}_backend: {host: ${webApp.appName.toUpperCase()}_BACKEND_URL},`\n        ),\n        ...apiLambdas.map(\n          apiLambda => `${apiLambda.apiName}: {host: ${apiLambda.apiName.toUpperCase()}_URL},`\n        ),\n      ].join('\\n')}\n    } satisfies Record<ApiName, ApiConfig>;\n  `.trim();\n\n  return {\n    path: 'shared/src/api/api.ts',\n    content: [imports, apisDef, apisConfig].join('\\n\\n'),\n  };\n}\n\nfunction generateSharedModelFile(\n  webAppsWithAuth: WorkspaceFragmentRegistry['web-app'][]\n): TemplateFile {\n  return {\n    path: 'shared/src/models.ts',\n    content: `\nimport {Brand} from '@shared/lib/type_utils';\n\n${webAppsWithAuth\n  .map(webApp => {\n    const userType = `${pascalCase(webApp.appName)}User`;\n    return `\nexport type ${userType}Id = Brand<'${userType}Id', string>;\n\nexport interface ${userType}Item {\nid: ${userType}Id;\nhash: string;\nsalt: string;\nsessionDuration: number; // in seconds\n}\n`.trim();\n  })\n  .join('\\n\\n')}\n`,\n  };\n}\n","export function capitalize(value: string): string {\n  const [firstChar] = value;\n  return firstChar === undefined ? '' : firstChar.toUpperCase() + value.slice(1);\n}\n\nexport function uncapitalize(value: string): string {\n  const [firstChar] = value;\n  return firstChar === undefined ? '' : firstChar.toLowerCase() + value.slice(1);\n}\n\nexport function pascalCase(str: string): string {\n  return str\n    .toLowerCase()\n    .split(/[^a-z]+/u)\n    .map(s => capitalize(s))\n    .join('');\n}\n\nexport function upperCase(str: string): string {\n  return str\n    .toUpperCase()\n    .split(/[^A-Z]+/u)\n    .join('_');\n}\n\nexport function lowerCase(str: string): string {\n  return str\n    .toLowerCase()\n    .split(/[^a-z]+/u)\n    .join('_');\n}\n","import {randomBytes} from 'node:crypto';\n\nconst ALPHANUM = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';\nexport function randomStringSafe(length: number, set?: string): string {\n  let result = '';\n  const characters = set ?? ALPHANUM;\n  const bytes = randomBytes(length);\n  for (const byte of bytes) {\n    // eslint-disable-next-line @typescript-eslint/no-magic-numbers\n    result += characters[Math.floor((byte / 255) * (characters.length - 1))];\n  }\n  return result;\n}\n\nconst UID_LENGTH = 16;\nexport function uidSafe(prefix?: string): string {\n  const id = randomStringSafe(UID_LENGTH);\n  return prefix === undefined ? id : `${prefix}${id}`;\n}\n\nconst NONCE_BYTE_SIZE = 16;\nexport function generateNonce(): string {\n  return randomBytes(NONCE_BYTE_SIZE).toString('base64');\n}\n","export function generateGitIgnore(): string {\n  return `\n.DS_Store\nnode_modules\nbuild\ndist\ntmp\nyarn-error.log\n.yarn-warnings.log\nyarn.lock\nterraform/.terraform\nterraform/.terraform*\nterraform/*.tfstate.backup\nterraform/archives\n*/log\n/shared/src/env.ts\n/.build.lock\n    `.trim();\n}\n","import {PROJECT_TYPE_TO_METADATA, WorkspaceName} from '@src/models';\nimport {WorkspaceProject} from '@src/project/generate_workspace';\nimport {NODE_VERSION, PACKAGE_VERSIONS, TYPESCRIPT_VERSION} from '@src/versions';\n\nfunction uniq<T>(val: T[]): T[] {\n  return [...new Set(val).values()];\n}\n\nexport function generateWorkspacePackageJson(\n  workspaceName: WorkspaceName,\n  projects: WorkspaceProject[]\n): Record<string, unknown> {\n  const eslintRuntimes = uniq(projects.map(p => PROJECT_TYPE_TO_METADATA[p.type].eslint));\n  const tsconfigRuntimes = uniq(projects.map(p => PROJECT_TYPE_TO_METADATA[p.type].tsconfig));\n  const webpackRuntimes = uniq(projects.map(p => PROJECT_TYPE_TO_METADATA[p.type].webpack));\n\n  return {\n    name: workspaceName,\n    license: 'UNLICENSED',\n    type: 'module',\n    engines: {\n      node: NODE_VERSION,\n    },\n    scripts: {\n      setup: 'node ./setup.js',\n      deploy: 'node ./deploy.js',\n      build: 'NODE_ENV=production node ./build.js',\n      watch: 'NODE_ENV=development node ./build.js --watch',\n    },\n    prettier: '@matthis/prettier-config',\n    devDependencies: Object.fromEntries(\n      (\n        [\n          ...eslintRuntimes.map(runtime => [\n            `@matthis/eslint-config-${runtime}`,\n            PACKAGE_VERSIONS.eslint,\n          ]),\n          ['@matthis/prettier-config', PACKAGE_VERSIONS.prettier],\n          ...tsconfigRuntimes.map(runtime => [\n            `@matthis/tsconfig-${runtime}`,\n            PACKAGE_VERSIONS.tsconfig,\n          ]),\n          ...webpackRuntimes.map(runtime => [\n            `@matthis/webpack-${runtime}`,\n            PACKAGE_VERSIONS.webpack,\n          ]),\n          ['@matthis/webpack-runner', PACKAGE_VERSIONS.runner],\n          ['typescript', TYPESCRIPT_VERSION],\n        ] as [string, string][]\n      ).sort((d1, d2) => d1[0].localeCompare(d2[0]))\n    ),\n  };\n}\n","export const PACKAGE_VERSIONS = {\n  project: '1.11.42',\n  eslint: '1.8.5',\n  prettier: '1.5.0',\n  tsconfig: '1.7.4',\n  webpack: '1.7.7',\n  runner: '1.5.31',\n  lambdaServerRuntime: '1.0.7',\n};\n\nexport const ESLINT_VERSION = '9.8.x';\nexport const PRETTIER_VERSION = '3.3.3';\nexport const TYPESCRIPT_VERSION = '5.5.x';\nexport const MIN_NODE_VERSION = '20.10';\nexport const NODE_VERSION = `>=${MIN_NODE_VERSION}`;\nexport const CORE_JS_VERSION = '3.37';\n\nexport const LIB_VERSIONS = {\n  '@types/react': '18.2.x',\n  '@types/react-dom': '18.2.x',\n  react: '18.2.x',\n  'react-dom': '18.2.x',\n  'styled-components': '6.1.x',\n};\n","import {ProjectType, WorkspaceName} from '@src/models';\nimport {WorkspaceProject} from '@src/project/generate_workspace';\nimport {generateFrontendTerraform} from '@src/project/terraform/frontend';\nimport {generateLambdaTerraform} from '@src/project/terraform/lambda';\nimport {generateAwsProviderTerraform} from '@src/project/terraform/provider';\nimport {generateS3BucketTerraform} from '@src/project/terraform/s3';\nimport {WorkspaceOptions} from '@src/project/vscode_workspace';\nimport {neverHappens} from '@src/type_utils';\n\nexport interface AppDomain {\n  rootDomain: string;\n  subDomain: string;\n}\n\nexport function generateCommonTerraform(\n  workspaceName: WorkspaceName,\n  projects: WorkspaceProject[],\n  workspaceOptions: WorkspaceOptions\n): string {\n  const {region} = workspaceOptions;\n  return [\n    generateAwsProviderTerraform(workspaceName, {region}),\n    generateS3BucketTerraform(\n      workspaceName,\n      projects.filter(p => p.type === ProjectType.Web).map(p => p.projectName)\n    ),\n  ].join('\\n\\n');\n}\n\nexport function generateWorkspaceProjectTerraform(\n  workspaceName: WorkspaceName,\n  project: WorkspaceProject\n): string | undefined {\n  const {projectName, terraform} = project;\n\n  if (terraform.type === 'frontend') {\n    return generateFrontendTerraform(projectName, terraform);\n  } else if (terraform.type === 'lambda') {\n    return generateLambdaTerraform(workspaceName, projectName, terraform);\n  }\n  // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n  else if (terraform.type === 'no-terraform') {\n    return undefined;\n  }\n  neverHappens(terraform, 'Terraform type');\n}\n","import {ProjectName} from '@src/models';\nimport {AppDomain} from '@src/project/terraform/all';\n\nexport interface WorkspaceProjectTerraformFrontend {\n  type: 'frontend';\n  domain: AppDomain | undefined;\n}\n\nexport function generateFrontendTerraform(\n  projectName: ProjectName,\n  opts: WorkspaceProjectTerraformFrontend\n): string {\n  const {domain} = opts;\n  const bucketName = projectName.toLowerCase().replace(/[^\\d.a-z-]+/gu, '-');\n  const originId = `${bucketName}-origin-id`;\n  return `\noutput \"${projectName}_cloudfront_domain_name\" {\n  value       = ${\n    domain\n      ? `\"${domain.subDomain}.${domain.rootDomain}\"`\n      : `aws_cloudfront_distribution.${projectName}.domain_name`\n  }\n  description = \"Domain (from cloudfront) where the \\\\\"${projectName}\\\\\" is available.\"\n}${\n    domain !== undefined\n      ? `\n\n# Domain\n\ndata \"aws_route53_zone\" \"${projectName}\" {\n  name = \"${domain.rootDomain}\"\n}\n\nresource \"aws_route53_record\" \"${projectName}_a\" {\n  zone_id = data.aws_route53_zone.${projectName}.zone_id\n  name    = \"${domain.subDomain}.${domain.rootDomain}\"\n  type    = \"A\"\n\n  alias {\n    name                   = aws_cloudfront_distribution.${projectName}.domain_name\n    zone_id                = aws_cloudfront_distribution.${projectName}.hosted_zone_id\n    evaluate_target_health = false\n  }\n}\n\nresource \"aws_route53_record\" \"${projectName}_aaaa\" {\n  zone_id = data.aws_route53_zone.${projectName}.zone_id\n  name    = \"${domain.subDomain}.${domain.rootDomain}\"\n  type    = \"AAAA\"\n\n  alias {\n    name                   = aws_cloudfront_distribution.${projectName}.domain_name\n    zone_id                = aws_cloudfront_distribution.${projectName}.hosted_zone_id\n    evaluate_target_health = false\n  }\n}\n\nresource \"aws_acm_certificate\" \"${projectName}\" {\n  domain_name               = \"*.${domain.subDomain}.${domain.rootDomain}\"\n  subject_alternative_names = [\"${domain.subDomain}.${domain.rootDomain}\"]\n  validation_method         = \"DNS\"\n  provider                  = aws.us-east-1\n}\n\nresource \"aws_route53_record\" \"${projectName}_certificate_validation\" {\n  for_each = {\n    for dvo in aws_acm_certificate.${projectName}.domain_validation_options : dvo.domain_name => {\n      name   = dvo.resource_record_name\n      record = dvo.resource_record_value\n      type   = dvo.resource_record_type\n    }\n  }\n  provider        = aws.us-east-1\n  allow_overwrite = true\n  name            = each.value.name\n  records         = [each.value.record]\n  ttl             = 60\n  type            = each.value.type\n  zone_id         = data.aws_route53_zone.${projectName}.zone_id\n}\n\nresource \"aws_acm_certificate_validation\" \"${projectName}\" {\n  provider                = aws.us-east-1\n  certificate_arn         = aws_acm_certificate.${projectName}.arn\n  validation_record_fqdns = [for record in aws_route53_record.${projectName}_certificate_validation : record.fqdn]\n}`\n      : ''\n  }\n\n# Cloudfront Distribution\n\nresource \"aws_cloudfront_origin_access_identity\" \"${projectName}\" {}\n  \nresource \"aws_cloudfront_distribution\" \"${projectName}\" {\n  origin {\n    domain_name = aws_s3_bucket.code.bucket_regional_domain_name\n    origin_id   = \"${originId}\"\n    origin_path = \"/${projectName}\"\n\n    s3_origin_config {\n      origin_access_identity = aws_cloudfront_origin_access_identity.${projectName}.cloudfront_access_identity_path\n    }\n  }\n  \n  enabled             = true\n  wait_for_deployment = false\n  is_ipv6_enabled     = true\n  price_class         = \"PriceClass_100\"${\n    domain\n      ? `\n  aliases             = [\"${domain.subDomain}.${domain.rootDomain}\"]`\n      : ''\n  }\n  \n  default_root_object = \"/index.html\"\n  custom_error_response {\n    error_code         = 400\n    response_code      = 200\n    response_page_path = \"/index.html\"\n  }\n  custom_error_response {\n    error_code         = 403\n    response_code      = 200\n    response_page_path = \"/index.html\"\n  }\n  custom_error_response {\n    error_code         = 404\n    response_code      = 200\n    response_page_path = \"/index.html\"\n  }\n\n  default_cache_behavior {\n    allowed_methods        = [\"HEAD\", \"GET\"]\n    cached_methods         = [\"HEAD\", \"GET\"]\n    compress               = true\n    target_origin_id       = \"${originId}\"\n    viewer_protocol_policy = \"redirect-to-https\"\n    \n    forwarded_values {\n      query_string = false\n      cookies {\n        forward = \"none\"\n      }\n    }\n  }\n\n  restrictions {\n    geo_restriction {\n      restriction_type = \"none\"\n    }\n  }\n\n  viewer_certificate {${\n    domain\n      ? `\n    acm_certificate_arn      = aws_acm_certificate.${projectName}.arn\n    ssl_support_method       = \"sni-only\"\n    minimum_protocol_version = \"TLSv1.2_2021\"`\n      : `\n    cloudfront_default_certificate = true`\n  }\n  }\n}\n  `.trim();\n}\n","import {ProjectName, WebAppAuthentication, WorkspaceName} from '@src/models';\nimport {AppDomain} from '@src/project/terraform/all';\nimport {lowerCase} from '@src/string_utils';\n\nexport interface WorkspaceProjectTerraformLambda {\n  type: 'lambda';\n  api: boolean;\n  webAppName: string | undefined;\n  alarmEmail: string | undefined;\n  cloudwatchTriggerMinutes: number | undefined;\n  domain: AppDomain | undefined;\n  authentication: WebAppAuthentication | undefined;\n}\n\nexport function generateLambdaTerraform(\n  workspaceName: WorkspaceName,\n  projectName: ProjectName,\n  opts: WorkspaceProjectTerraformLambda\n): string {\n  const {api, webAppName, alarmEmail, cloudwatchTriggerMinutes, domain, authentication} = opts;\n  return `\n# Define any extra role for the lambda here\ndata \"aws_iam_policy_document\" \"${projectName}_extra_policy\" {\n  ${\n    authentication?.enabled\n      ? `statement {\n    actions = [\n      \"dynamodb:GetItem\",\n      \"dynamodb:BatchGetItem\",\n      \"dynamodb:Query\",\n      \"dynamodb:Scan\",\n      \"dynamodb:PutItem\",\n      \"dynamodb:UpdateItem\",\n      \"dynamodb:DeleteItem\",\n    ]\n    resources = [${\n      webAppName === undefined\n        ? ''\n        : `\n      \"\\${aws_dynamodb_table.${lowerCase(webAppName)}_user_table.arn}\",\n      \"\\${aws_dynamodb_table.${lowerCase(webAppName)}_user_table.arn}/index/*\",\n      \"\\${aws_dynamodb_table.${lowerCase(webAppName)}_user_session_table.arn}\",\n      \"\\${aws_dynamodb_table.${lowerCase(webAppName)}_user_session_table.arn}/index/*\",\n    `\n    }]\n  }`\n      : ''\n  }${\n    webAppName !== undefined\n      ? `\n\n  statement {\n    actions = [\n      \"s3:GetObject\",\n      \"s3:GetObjectTagging\"\n    ]\n    resources = [\n      \"\\${aws_s3_bucket.code.arn}/*\"\n    ]\n  }`\n      : ''\n  }\n}\n\nresource \"aws_lambda_function\" \"${projectName}\" {\n  function_name = \"${workspaceName}-${projectName}\"\n  s3_bucket     = aws_s3_object.${projectName}_archive.bucket\n  s3_key        = aws_s3_object.${projectName}_archive.key\n  handler       = \"index.handler\"\n  runtime       = \"nodejs20.x\"\n  role          = aws_iam_role.${projectName}_role.arn\n  timeout       = 900 // 15 minutes\n  memory_size   = 128 // Mo\n  environment {\n    variables = {${\n      api\n        ? `\n      NODE_OPTIONS            = \"--enable-source-maps\"\n      CLOUDFRONT_HEADER_NAME  = random_string.${projectName}_cloudfront_header_name.result\n      CLOUDFRONT_HEADER_VALUE = random_string.${projectName}_cloudfront_header_value.result`\n        : `\n      NODE_OPTIONS = \"--enable-source-maps\"`\n    }\n    }\n  }\n}\n\noutput \"${projectName}_function_name\" {\n  value       = aws_lambda_function.${projectName}.function_name\n  description = \"Function name of the \\\\\"${workspaceName}-${projectName}\\\\\" lambda\"\n}\n${\n  api\n    ? `\n# Lambda URL\n\nresource \"aws_lambda_function_url\" \"${projectName}\" {\n  function_name      = aws_lambda_function.${projectName}.function_name\n  authorization_type = \"NONE\"\n}\n\noutput \"${projectName}_url\" {\n  value       = \"${\n    domain\n      ? `https://${domain.subDomain}.${domain.rootDomain}/`\n      : `https://\\${aws_cloudfront_distribution.${projectName}.domain_name}/`\n  }\"\n  description = \"URL of \\\\\"${projectName}\\\\\"\"\n}${\n        domain !== undefined\n          ? `\n\n# Domain\n\ndata \"aws_route53_zone\" \"${projectName}\" {\n  name = \"${domain.rootDomain}\"\n}\n\nresource \"aws_route53_record\" \"${projectName}_a\" {\n  zone_id = data.aws_route53_zone.${projectName}.zone_id\n  name    = \"${domain.subDomain}.${domain.rootDomain}\"\n  type    = \"A\"\n\n  alias {\n    name                   = aws_cloudfront_distribution.${projectName}.domain_name\n    zone_id                = aws_cloudfront_distribution.${projectName}.hosted_zone_id\n    evaluate_target_health = false\n  }\n}\n\nresource \"aws_route53_record\" \"${projectName}_aaaa\" {\n  zone_id = data.aws_route53_zone.${projectName}.zone_id\n  name    = \"${domain.subDomain}.${domain.rootDomain}\"\n  type    = \"AAAA\"\n\n  alias {\n    name                   = aws_cloudfront_distribution.${projectName}.domain_name\n    zone_id                = aws_cloudfront_distribution.${projectName}.hosted_zone_id\n    evaluate_target_health = false\n  }\n}\n\nresource \"aws_acm_certificate\" \"${projectName}\" {\n  domain_name               = \"*.${domain.subDomain}.${domain.rootDomain}\"\n  subject_alternative_names = [\"${domain.subDomain}.${domain.rootDomain}\"]\n  validation_method         = \"DNS\"\n  provider                  = aws.us-east-1\n}\n\nresource \"aws_route53_record\" \"${projectName}_certificate_validation\" {\n  for_each = {\n    for dvo in aws_acm_certificate.${projectName}.domain_validation_options : dvo.domain_name => {\n      name   = dvo.resource_record_name\n      record = dvo.resource_record_value\n      type   = dvo.resource_record_type\n    }\n  }\n  provider        = aws.us-east-1\n  allow_overwrite = true\n  name            = each.value.name\n  records         = [each.value.record]\n  ttl             = 60\n  type            = each.value.type\n  zone_id         = data.aws_route53_zone.${projectName}.zone_id\n}\n\nresource \"aws_acm_certificate_validation\" \"${projectName}\" {\n  provider                = aws.us-east-1\n  certificate_arn         = aws_acm_certificate.${projectName}.arn\n  validation_record_fqdns = [for record in aws_route53_record.${projectName}_certificate_validation : record.fqdn]\n}`\n          : ''\n      }\n\n# Cloudfront Distribution\n\nresource \"random_string\" \"${projectName}_cloudfront_header_name\" {\n  length  = 16\n  upper   = false\n  numeric = false\n  special = false\n}\n\nresource \"random_string\" \"${projectName}_cloudfront_header_value\" {\n  length  = 32\n  special = false\n}\n\nresource \"aws_cloudfront_distribution\" \"${projectName}\" {\n  origin {\n    # Remove \"https://\" prefix and \"/\" suffix\n    domain_name = replace(replace(aws_lambda_function_url.${projectName}.function_url, \"https://\", \"\"), \"/\", \"\")\n    origin_id   = aws_lambda_function.${projectName}.function_name\n\n    custom_origin_config {\n      https_port             = 443\n      http_port              = 80\n      origin_protocol_policy = \"https-only\"\n      origin_ssl_protocols   = [\"TLSv1.2\"]\n    }\n\n    custom_header {\n      name  = random_string.${projectName}_cloudfront_header_name.result\n      value = random_string.${projectName}_cloudfront_header_value.result\n    }\n  }\n\n  enabled             = true\n  wait_for_deployment = false\n  is_ipv6_enabled     = true\n  price_class         = \"PriceClass_100\"${\n    domain\n      ? `\n  aliases             = [\"${domain.subDomain}.${domain.rootDomain}\"]`\n      : ''\n  }\n\n  default_cache_behavior {\n    allowed_methods        = [\"DELETE\", \"GET\", \"HEAD\", \"OPTIONS\", \"PATCH\", \"POST\", \"PUT\"]\n    cached_methods         = [\"HEAD\", \"GET\"]\n    compress               = true\n    target_origin_id       = aws_lambda_function.${projectName}.function_name\n    viewer_protocol_policy = \"redirect-to-https\"\n    # Managed-CachingDisabled\n    cache_policy_id = \"4135ea2d-6df8-44a3-9df3-4b5a84be39ad\"\n    # Managed-AllViewerExceptHostHeader\n    origin_request_policy_id = \"b689b0a8-53d0-40ab-baf2-68738e2966ac\"\n  }\n\n  restrictions {\n    geo_restriction {\n      restriction_type = \"none\"\n    }\n  }\n\n  viewer_certificate {${\n    domain\n      ? `\n    acm_certificate_arn      = aws_acm_certificate.${projectName}.arn\n    ssl_support_method       = \"sni-only\"\n    minimum_protocol_version = \"TLSv1.2_2021\"`\n      : `\n    cloudfront_default_certificate = true`\n  }\n  }\n}`\n    : ''\n}\n${\n  cloudwatchTriggerMinutes !== undefined\n    ? `# Cloudwatch trigger\n\nresource \"aws_lambda_permission\" \"cloudwatch_invoke_${projectName}\" {\n  statement_id  = \"AllowExecutionFromCloudWatch\"\n  action        = \"lambda:InvokeFunction\"\n  function_name = aws_lambda_function.${projectName}.arn\n  principal     = \"events.amazonaws.com\"\n  source_arn    = aws_cloudwatch_event_rule.${projectName}_trigger_rate.arn\n}\n\nresource \"aws_cloudwatch_event_rule\" \"${projectName}_trigger_rate\" {\n  name_prefix         = \"${projectName}.rate-${cloudwatchTriggerMinutes}-minutes.\"\n  schedule_expression = \"rate(${cloudwatchTriggerMinutes} minute${\n    cloudwatchTriggerMinutes > 1 ? 's' : ''\n  })\"\n}\n\nresource \"aws_cloudwatch_event_target\" \"${projectName}_trigger_target\" {\n  rule = aws_cloudwatch_event_rule.${projectName}_trigger_rate.name\n  arn  = aws_lambda_function.${projectName}.arn\n}\n`\n    : ''\n}\n# IAM role\n\nresource \"aws_iam_role\" \"${projectName}_role\" {\n  name = \"${workspaceName}-${projectName}-role\"\n  assume_role_policy = jsonencode({\n    Version = \"2012-10-17\"\n    Statement = [\n      {\n        Action = \"sts:AssumeRole\"\n        Principal = {\n          Service = \"lambda.amazonaws.com\"\n          AWS     = data.aws_iam_roles.administrator_roles.arns\n        }\n        Effect = \"Allow\"\n      },\n    ]\n  })\n  \n  inline_policy {\n    name   = \"${workspaceName}-${projectName}-extra-policy\"\n    policy = data.aws_iam_policy_document.${projectName}_extra_policy.json\n  }\n}\n\noutput \"${projectName}_role_arn\" {\n  value = aws_iam_role.${projectName}_role.arn\n}\n\n# Cloudwatch logging\n\nresource \"aws_cloudwatch_log_group\" \"${projectName}\" {\n  name = \"/aws/lambda/${workspaceName}-${projectName}\"\n}\n\nresource \"aws_iam_policy\" \"${projectName}_cloudwatch\" {\n  name = \"${workspaceName}-${projectName}-cloudwatch-policy\"\n  policy = jsonencode({\n    Version = \"2012-10-17\"\n    Statement = [\n      {\n        Action = [\n          \"logs:CreateLogStream\",\n          \"logs:PutLogEvents\",\n        ]\n        Effect = \"Allow\"\n        Resource = [\n          \"\\${aws_cloudwatch_log_group.${projectName}.arn}\",\n          \"\\${aws_cloudwatch_log_group.${projectName}.arn}:*\",\n        ]\n      }\n    ]\n  })\n}\n\nresource \"aws_iam_role_policy_attachment\" \"${projectName}_cloudwatch\" {\n  role       = aws_iam_role.${projectName}_role.name\n  policy_arn = aws_iam_policy.${projectName}_cloudwatch.arn\n}\n${\n  alarmEmail !== undefined\n    ? `\n# Cloudwatch error monitoring\n\nresource \"aws_cloudwatch_log_metric_filter\" \"${projectName}_log_errors\" {\n  name           = \"${workspaceName}-${projectName}-log-error-metric-filter\"\n  pattern        = \"[ts, id, level = \\\\\"ERROR\\\\\", msg]\"\n  log_group_name = aws_cloudwatch_log_group.${projectName}.name\n\n  metric_transformation {\n    name          = \"${workspaceName}-${projectName}-errors\"\n    namespace     = \"${workspaceName}\"\n    value         = \"1\"\n    default_value = \"0\"\n    unit          = \"Count\"\n  }\n}\n\nresource \"aws_cloudwatch_metric_alarm\" \"${projectName}_log_errors\" {\n  alarm_name          = \"${workspaceName}-${projectName}-log-error-metric-alarm\"\n  metric_name         = aws_cloudwatch_log_metric_filter.${projectName}_log_errors.metric_transformation[0].name\n  namespace           = aws_cloudwatch_log_metric_filter.${projectName}_log_errors.metric_transformation[0].namespace\n  evaluation_periods  = 1\n  period              = 3600\n  statistic           = \"Sum\"\n  comparison_operator = \"GreaterThanOrEqualToThreshold\"\n  threshold           = 1\n  actions_enabled     = true\n  alarm_actions       = [aws_sns_topic.${projectName}_log_errors.arn]\n  ok_actions          = [aws_sns_topic.${projectName}_log_errors.arn]\n  treat_missing_data  = \"notBreaching\"\n}\n\nresource \"aws_sns_topic\" \"${projectName}_log_errors\" {\n  name = \"${workspaceName}-${projectName}-log-error-sns-topic\"\n}\n\nresource \"aws_sns_topic_subscription\" \"${projectName}_log_errors\" {\n  endpoint  = \"${alarmEmail}\"\n  protocol  = \"email\"\n  topic_arn = aws_sns_topic.${projectName}_log_errors.arn\n}\n`\n    : ''\n}\n# Dummy source code useful only during the initial setup\nresource \"aws_s3_object\" \"${projectName}_archive\" {\n  bucket         = aws_s3_bucket.code.id\n  key            = \"${projectName}/dist.zip\"\n  content_base64 = \"UEsDBBQACAAIAGaKwlYAAAAAAAAAADYAAAAIACAAaW5kZXguanNVVA0AB3AIemRyCHpkcAh6ZHV4CwABBPUBAAAEFAAAAEutKMgvKinWy0jMS8lJLVKwVUgsrsxLVkgrzUsuyczPU9DQVKjmUlAoSi0pLcpTUFe35qq15gIAUEsHCP0ak1o4AAAANgAAAFBLAQIUAxQACAAIAGaKwlb9GpNaOAAAADYAAAAIACAAAAAAAAAAAACkgQAAAABpbmRleC5qc1VUDQAHcAh6ZHIIemRwCHpkdXgLAAEE9QEAAAQUAAAAUEsFBgAAAAABAAEAVgAAAI4AAAAAAA==\"\n}\n\n`.trim();\n}\n","import {WorkspaceName} from '@src/models';\n\nexport function generateAwsProviderTerraform(\n  workspaceName: WorkspaceName,\n  opts: {region: string}\n): string {\n  const {region} = opts;\n  return `\nterraform {\n  required_providers {\n    aws = {\n      source  = \"hashicorp/aws\"\n      version = \"~> 5.1\"\n    }\n  }\n}\n\nprovider \"aws\" {\n  region                   = \"${region}\"\n  default_tags {\n    tags = {\n      Project = \"${workspaceName}\"\n    }\n  }\n}\n\nprovider \"aws\" {\n  alias                    = \"us-east-1\"\n  region                   = \"us-east-1\"\n  default_tags {\n    tags = {\n      Project = \"${workspaceName}\"\n    }\n  }\n}\n\ndata \"aws_region\" \"current\" {}\noutput \"region\" {\n  value = data.aws_region.current.id\n}\n\ndata \"aws_caller_identity\" \"current\" {}\noutput \"account_id\" {\n  value = data.aws_caller_identity.current.account_id\n}\n\ndata \"aws_iam_roles\" \"administrator_roles\" {\n  name_regex = \"AdministratorAccess\"\n}\noutput \"administrator_role_arn\" {\n  value = tolist(data.aws_iam_roles.administrator_roles.arns)[0]\n}\n`.trim();\n}\n","import {ProjectName, WorkspaceName} from '@src/models';\n\nexport function generateS3BucketTerraform(\n  workspaceName: WorkspaceName,\n  webProjectNames: ProjectName[]\n): string {\n  const bucketName = workspaceName.toLowerCase().replace(/[^a-z0-9.-]+/gu, '-');\n\n  const CODE_BUCKET = `\nresource \"aws_s3_bucket\" \"code\" {\n  bucket_prefix = \"${bucketName}-code-\"\n}\n\noutput \"code_bucket\" {\n  value = aws_s3_bucket.code.id\n}\n`.trim();\n\n  const CLOUDFRONT_ACCESS = `\ndata \"aws_iam_policy_document\" \"cloudfront_access_to_code_policy\" {\n  ${webProjectNames\n    .map(p =>\n      `\n  statement {\n    actions = [\"s3:GetObject\"]\n    resources = [\n      \"\\${aws_s3_bucket.code.arn}/${p}/*\",\n    ]\n    principals {\n      type        = \"AWS\"\n      identifiers = [aws_cloudfront_origin_access_identity.${p}.iam_arn]\n    }\n  }\n`.trim()\n    )\n    .join('\\n\\n')}\n}\n\nresource \"aws_s3_bucket_policy\" \"cloudfront_access_to_code\" {\n  bucket = aws_s3_bucket.code.id\n  policy = data.aws_iam_policy_document.cloudfront_access_to_code_policy.json\n}\n`.trim();\n\n  const out = [CODE_BUCKET];\n  if (webProjectNames.length > 0) {\n    out.push(CLOUDFRONT_ACCESS);\n  }\n  return out.join('\\n\\n');\n}\n","function notUndefined<T>(val: T | undefined): val is T {\n  return val !== undefined;\n}\n\nexport function isString(val: unknown): val is string {\n  return typeof val === 'string';\n}\n\nexport function isNumber(val: unknown): val is number {\n  return typeof val === 'number';\n}\n\nexport function iterNumberEnum<T extends Record<string, string | number>>(e: T): T[keyof T][] {\n  return Object.values(e).filter(isNumber) as unknown as T[keyof T][];\n}\n\nexport function iterStringEnum<T extends Record<string, string>>(e: T): T[keyof T][] {\n  return Object.values(e).filter(isString) as unknown as T[keyof T][];\n}\n\nexport function removeUndefined<T>(arr: (T | undefined)[]): T[] {\n  return arr.filter(notUndefined);\n}\n\nexport function removeUndefinedOrNullProps<T extends Record<string, unknown>>(obj: T): {} {\n  return Object.fromEntries(\n    Object.entries(obj).filter(e => e[1] !== undefined && e[1] !== null)\n  ) as T;\n}\n\nexport function neverHappens(value: never, errorMessage?: string): never {\n  throw new Error(errorMessage);\n}\n\nexport type AnyInterface<T> = {[K in keyof T]: unknown};\n\nexport function asMap(value: unknown): Record<string, unknown> | undefined;\nexport function asMap(\n  value: unknown,\n  defaultValue: Record<string, unknown>\n): Record<string, unknown>;\nexport function asMap(\n  value: unknown,\n  defaultValue?: Record<string, unknown>\n): Record<string, unknown> | undefined {\n  return typeof value === 'object' && value !== null && !Array.isArray(value)\n    ? (value as Record<string, unknown>)\n    : defaultValue;\n}\nexport function asMapOrThrow(value: unknown): Record<string, unknown> {\n  const valueAsMap = asMap(value);\n  if (valueAsMap === undefined) {\n    throw new Error(`Invalid value: \\`${value}\\` is not a map`);\n  }\n  return valueAsMap;\n}\n\nexport function asJson(value: string): Record<string, unknown> | undefined;\nexport function asJson(\n  value: string,\n  defaultValue: Record<string, unknown>\n): Record<string, unknown>;\nexport function asJson(\n  value: string,\n  defaultValue?: Record<string, unknown>\n): Record<string, unknown> | undefined {\n  try {\n    const json = JSON.parse(value);\n    const res = asMap(json);\n    return res ?? defaultValue;\n  } catch {\n    return defaultValue;\n  }\n}\nexport function asJsonOrThrow(value: string): Record<string, unknown> {\n  const valueAsJson = asJson(value);\n  if (valueAsJson === undefined) {\n    throw new Error(`Invalid value: \\`${value}\\` is not a valid JSON string of a map`);\n  }\n  return valueAsJson;\n}\n\nexport function asJsonString(value: unknown): Record<string, unknown> | undefined;\nexport function asJsonString(\n  value: unknown,\n  defaultValue: Record<string, unknown>\n): Record<string, unknown>;\nexport function asJsonString(\n  value: unknown,\n  defaultValue?: Record<string, unknown>\n): Record<string, unknown> | undefined {\n  const str = asString(value);\n  return str === undefined\n    ? defaultValue\n    : defaultValue === undefined\n      ? asJson(str)\n      : asJson(str, defaultValue);\n}\nexport function asJsonStringOrThrow(value: unknown): Record<string, unknown> {\n  return asJsonOrThrow(asStringOrThrow(value));\n}\n\nexport function asString<T extends string = string>(value: unknown): T | undefined;\nexport function asString<T extends string = string>(value: unknown, defaultValue: string): T;\nexport function asString<T extends string = string>(\n  value: unknown,\n  defaultValue?: string\n): T | undefined {\n  return (typeof value === 'string' ? value : defaultValue) as T;\n}\nexport function asStringOrThrow<T extends string = string>(value: unknown): T {\n  const valueAsString = asString<T>(value);\n  if (valueAsString === undefined) {\n    throw new Error(`Invalid value: \\`${value}\\` is not a string`);\n  }\n  return valueAsString;\n}\n\nexport function asStringEnum<T extends Record<string, string>>(\n  value: unknown,\n  enu: T\n): T[keyof T] | undefined;\nexport function asStringEnum<T extends Record<string, string>>(\n  value: unknown,\n  enu: T,\n  defaultValue: T[keyof T]\n): T[keyof T];\nexport function asStringEnum<T extends Record<string, string>>(\n  value: unknown,\n  enu: T,\n  defaultValue?: T[keyof T]\n): T[keyof T] | undefined {\n  return (\n    typeof value === 'string' && Object.values(enu).includes(value as T[keyof T])\n      ? value\n      : defaultValue\n  ) as T[keyof T];\n}\nexport function asStringEnumOrThrow<T extends Record<string, string>>(\n  value: unknown,\n  enu: T\n): T[keyof T] {\n  const valueAsString = asStringEnum<T>(value, enu);\n  if (valueAsString === undefined) {\n    throw new Error(\n      `Invalid value: \\`${value}\\` is not a string or not one of ${JSON.stringify(\n        Object.values(enu)\n      )}`\n    );\n  }\n  return valueAsString;\n}\n\nexport function asArray<T = unknown>(value: unknown): T[] | undefined;\nexport function asArray<T = unknown>(value: unknown, defaultValue: unknown[]): T[];\nexport function asArray<T = unknown>(value: unknown, defaultValue?: unknown[]): T[] | undefined {\n  return (Array.isArray(value) ? value : defaultValue) as T[];\n}\nexport function asArrayOrThrow<T = unknown>(value: unknown): T[] {\n  if (!Array.isArray(value)) {\n    throw new Error(`Invalid value: \\`${value}\\` is not an array`);\n  }\n  return value as T[];\n}\n\nexport function asStringArray<T extends string = string>(value: unknown): T[] | undefined;\nexport function asStringArray<T extends string = string>(\n  value: unknown,\n  defaultValue: string[]\n): T[];\nexport function asStringArray<T extends string = string>(\n  value: unknown,\n  defaultValue?: string[]\n): T[] | undefined {\n  const arr = asArray(value);\n  if (arr === undefined) {\n    return defaultValue as T[];\n  }\n  return removeUndefined(arr.map(s => asString<T>(s)));\n}\n\nexport function asStringArrayOrThrow<T extends string = string>(value: unknown): T[] {\n  const arr = asArrayOrThrow(value);\n  return arr.map(s => asStringOrThrow<T>(s));\n}\n\nexport function asMapArray(value: unknown): Record<string, unknown>[] | undefined;\nexport function asMapArray(\n  value: unknown,\n  defaultValue: Record<string, unknown>[]\n): Record<string, unknown>[];\nexport function asMapArray(\n  value: unknown,\n  defaultValue?: Record<string, unknown>[]\n): Record<string, unknown>[] | undefined {\n  const arr = asArray(value);\n  if (arr === undefined) {\n    return defaultValue;\n  }\n  return removeUndefined(arr.map(s => asMap(s)));\n}\nexport function asMapArrayOrThrow(value: unknown): Record<string, unknown>[] {\n  const arr = asArrayOrThrow(value);\n  return arr.map(s => asMapOrThrow(s));\n}\n\nexport function asNumber<T extends number = number>(value: unknown): T | undefined;\nexport function asNumber<T extends number = number>(value: unknown, defaultValue: number): T;\nexport function asNumber<T extends number = number>(\n  value: unknown,\n  defaultValue?: number\n): T | undefined {\n  if (typeof value === 'number') {\n    return (!isNaN(value) ? value : defaultValue) as T;\n  }\n  if (typeof value === 'string') {\n    try {\n      const parsedValue = parseFloat(value);\n      return (!isNaN(parsedValue) ? parsedValue : defaultValue) as T;\n    } catch {\n      return defaultValue as T;\n    }\n  }\n  return defaultValue as T;\n}\nexport function asNumberOrThrow<T extends number = number>(value: unknown): T {\n  const valueAsNumber = asNumber(value);\n  if (valueAsNumber === undefined) {\n    throw new Error(`Invalid value: \\`${value}\\` is not a number`);\n  }\n  return valueAsNumber as T;\n}\n\nexport function asBoolean(value: unknown): boolean | undefined;\nexport function asBoolean(value: unknown, defaultValue: boolean): boolean;\nexport function asBoolean(value: unknown, defaultValue?: boolean): boolean | undefined {\n  if (typeof value === 'boolean') {\n    return value;\n  }\n  if (typeof value === 'number') {\n    return !isNaN(value) ? value !== 0 : false;\n  }\n  if (typeof value === 'string') {\n    if (value === '0' || value === 'false') {\n      return false;\n    } else if (value === '1' || value === 'true') {\n      return true;\n    }\n    return defaultValue;\n  }\n  return defaultValue;\n}\n\nexport function asBooleanOrThrow(value: unknown): boolean {\n  const valueAsBoolean = asBoolean(value);\n  if (valueAsBoolean === undefined) {\n    throw new Error(`Invalid value: \\`${value}\\` is not a boolean`);\n  }\n  return valueAsBoolean;\n}\n\nconst TIMESTAMP_REGEX = /^[0-9]{1,15}$/u;\nexport function asDate(value: unknown): Date | undefined;\nexport function asDate(value: unknown, defaultValue: Date): Date;\nexport function asDate(value: unknown, defaultValue?: Date): Date | undefined {\n  const date =\n    value instanceof Date\n      ? value\n      : new Date(\n          typeof value === 'string' && TIMESTAMP_REGEX.test(value)\n            ? parseFloat(value)\n            : String(value)\n        );\n  return isNaN(date.getTime()) ? defaultValue : date;\n}\n\nexport function asDateOrThrow(value: unknown): Date {\n  const valueAsDate = asDate(value);\n  if (valueAsDate === undefined) {\n    throw new Error(`Invalid value: \\`${value}\\` cannot be parsed as a Date`);\n  }\n  return valueAsDate;\n}\n\n// export function asDate(value: unknown): Date | undefined;\n// export function asDate(value: unknown, defaultValue: Date): Date;\n// export function asDate(value: unknown, defaultValue?: Date): Date | undefined {\n//   if (typeof value === 'number') {\n//     return new Date(value);\n//   }\n//   return value instanceof Date ? value : defaultValue;\n// }\n\nexport function isNull<T>(val: T | null): val is null {\n  return val === null;\n}\n\nexport function asError(err: unknown): Error {\n  return err instanceof Error ? err : new Error(typeof err === 'string' ? err : String(err));\n}\n\nexport function errorAsString(err: unknown): string {\n  const errorMap = asMap(err);\n  if (errorMap === undefined) {\n    return asString(err) ?? String(err);\n  }\n\n  const errorMessage = asString(errorMap['message']);\n  if (errorMessage === undefined) {\n    return String(err);\n  }\n  return errorMessage;\n}\n\nexport function errorAndStackAsString(err: unknown): string {\n  const errorMap = asMap(err);\n  if (errorMap === undefined) {\n    return asString(err) ?? String(err);\n  }\n\n  const stack = asString(errorMap['stack']);\n  if (stack === undefined) {\n    return String(err);\n  }\n  return stack;\n}\n\nexport function asConstantOrThrow<T>(value: unknown, expected: T): T {\n  if (value !== expected) {\n    throw new Error(`Invalid value: \\`${value}\\`, expected \\`${expected}\\``);\n  }\n  return value as T;\n}\n\n// export function asParsedJson<T>(json: string): T {\n//   try {\n//     return JSON.parse(json) as T;\n//   } catch {\n//     const defaultValue = {};\n//     return defaultValue as T;\n//   }\n// }\nexport function parseJson(\n  json: string\n): {res: unknown; err: undefined} | {res: undefined; err: unknown} {\n  try {\n    return {res: JSON.parse(json), err: undefined};\n  } catch (err: unknown) {\n    return {err, res: undefined};\n  }\n}\nexport type Brand<Type, Name> = Type & {__brand: Name};\nexport type StringBrand = string & {__brand: string};\nexport type NumberBrand = number & {__brand: number};\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nexport type AnyBrand = (string | number) & {__brand: any};\n\nexport type Untrusted<T> = T extends\n  | Function\n  | Date\n  | boolean\n  | number\n  | string\n  | undefined\n  | null\n  | unknown[]\n  ? unknown\n  : {[P in keyof T]?: Untrusted<T[P]>};\n\nexport type DeepPartial<T> = T extends\n  | Function\n  | Date\n  | boolean\n  | number\n  | string\n  | undefined\n  | null\n  | unknown[]\n  ? T\n  : {[P in keyof T]?: DeepPartial<T[P]>};\n\nexport type MapInterface<I, Type> = {[Key in keyof I]: Type};\n// Get all the keys of a type including the optional attributes\ntype NonHomomorphicKeys<T> = ({[P in keyof T]: P} & None)[keyof T];\nexport type MapInterfaceStrict<I, Type> = {[Key in NonHomomorphicKeys<I>]: Type};\n\ntype KeysOfType<T, Type> = {[Key in keyof T]: T[Key] extends Type ? Key : never}[keyof T];\nexport type RestrictInterface<T, Type> = Pick<T, KeysOfType<T, Type>>;\n\ninterface RecursiveArray<T> extends Array<T | RecursiveArray<T>> {}\nexport type NestedArray<T> = (T | RecursiveArray<T>)[];\n\n// Type for an empty object (ie: {})\nexport type None = Record<string, never>;\n\nexport type NonEmptyArray<T> = [T, ...T[]];\nexport function isNonEmptyArray<T>(val: T[]): val is NonEmptyArray<T> {\n  return val.length > 0;\n}\nexport function nonEmptyArray<T>(val: T[]): NonEmptyArray<T> | undefined {\n  return val.length === 0 ? undefined : (val as NonEmptyArray<T>);\n}\n\nexport type AddPrefix<T, P extends string> = {\n  [K in keyof T as K extends string ? `${P}${K}` : never]: T[K];\n};\nexport function addPrefix<T extends Record<string, unknown>, Prefix extends string>(\n  attr: T,\n  prefix: Prefix\n): AddPrefix<T, Prefix> {\n  return Object.fromEntries(\n    Object.entries(attr).map(([key, value]) => [`${prefix}${key}`, value])\n  ) as AddPrefix<T, Prefix>;\n}\n\nexport type WithNull<T> = {\n  [Key in keyof T]: T[Key] extends Exclude<T[Key], undefined> ? T[Key] : T[Key] | null;\n};\ntype Id<T> = T;\nexport type Flatten<T> = Id<{[k in keyof T]: T[k]}>;\n\nexport type Defined<T> = Exclude<T, undefined>;\n","import {WorkspaceName} from '@src/models';\nimport {lowerCase, pascalCase} from '@src/string_utils';\n\nexport function generateDynamoUserTerraform(workspaceName: WorkspaceName, appName: string): string {\n  const prefixLower = lowerCase(appName);\n  const prefixPascal = `${pascalCase(workspaceName)}${pascalCase(appName)}`;\n  return `\noutput \"${prefixLower}_user_table_name\" {\n  value = aws_dynamodb_table.${prefixLower}_user_table.name\n}\n\noutput \"${prefixLower}_user_index_name\" {\n  value = {\n    for obj in aws_dynamodb_table.${prefixLower}_user_table.global_secondary_index : \"${prefixLower}_user_by_\\${obj.hash_key}\\${length(obj.range_key) > 0 ? \"_sorted_by_\\${obj.range_key}\" : \"\"}\" => obj.name\n  }\n}\n\nresource \"aws_dynamodb_table\" \"${prefixLower}_user_table\" {\n  name         = \"${prefixPascal}User\"\n  billing_mode = \"PAY_PER_REQUEST\"\n  hash_key     = \"id\"\n\n  attribute {\n    name = \"id\"\n    type = \"S\"\n  }\n}`.trim();\n}\n","import {WorkspaceName} from '@src/models';\nimport {lowerCase, pascalCase} from '@src/string_utils';\n\nexport function generateDynamoUserSessionTerraform(\n  workspaceName: WorkspaceName,\n  appName: string\n): string {\n  const prefixLower = lowerCase(appName);\n  const prefixPascal = `${pascalCase(workspaceName)}${pascalCase(appName)}`;\n  return `output \"${prefixLower}_user_session_table_name\" {\n  value = aws_dynamodb_table.${prefixLower}_user_session_table.name\n}\n\noutput \"${prefixLower}_user_session_index_name\" {\n  value = {\n    for obj in aws_dynamodb_table.${prefixLower}_user_session_table.global_secondary_index : \"${prefixLower}_user_session_by_\\${obj.hash_key}\\${ length(obj.range_key) > 0 ? \"_sorted_by_\\${obj.range_key}\" : \"\" }\" => obj.name\n  }\n}\n\nresource \"aws_dynamodb_table\" \"${prefixLower}_user_session_table\" {\n  name         = \"${prefixPascal}UserSession\"\n  billing_mode = \"PAY_PER_REQUEST\"\n  hash_key     = \"token\"\n\n  attribute {\n    name = \"token\"\n    type = \"S\"\n  }\n\n  ttl {\n    attribute_name = \"expiresAt\"\n    enabled        = true\n  }\n}`.trim();\n}\n","import {join} from 'node:path';\n\nimport {maybeReadFile, prettyJson, writeRawFile} from '@src/fs';\nimport {ProjectName, WorkspaceFragment, WorkspaceFragmentType} from '@src/models';\nimport {DEFAULT_REGION, getProjectsFromWorkspaceFragment} from '@src/project/generate_workspace';\nimport {\n  asBoolean,\n  asMap,\n  asMapArray,\n  asNumber,\n  asString,\n  asStringOrThrow,\n  removeUndefined,\n} from '@src/type_utils';\n\nexport function generateCodeWorkspace(\n  workspaceName: string,\n  workspaceFragments: WorkspaceFragment[]\n): Record<string, unknown> {\n  const projects = workspaceFragments.flatMap(f => getProjectsFromWorkspaceFragment(f));\n  const projectNames = projects.map(p => p.projectName);\n  return {\n    folders: [\n      ...projectNames.map(p => ({path: p})),\n      {path: 'terraform'},\n      {path: '.', name: 'root'},\n    ],\n    settings: {\n      'window.title': `${workspaceName}\\${separator}\\${activeEditorShort}`,\n      'files.exclude': Object.fromEntries([\n        ...projectNames.map(p => [p, true]),\n        ['terraform', true],\n      ]),\n      'editor.acceptSuggestionOnCommitCharacter': false,\n      'editor.suggestSelection': 'first',\n      'vsintellicode.modify.editor.suggestSelection': 'automaticallyOverrodeDefaultValue',\n      'explorer.confirmDelete': false,\n      'git.autofetch': true,\n      'git.confirmSync': false,\n      'typescript.preferences.importModuleSpecifier': 'non-relative',\n      'eslint.lintTask.enable': true,\n      'eslint.useESLintClass': true,\n      'editor.formatOnSave': true,\n      'editor.codeActionsOnSave': {\n        'source.fixAll': 'never',\n        'source.fixAll.eslint': 'explicit',\n      },\n      'editor.defaultFormatter': 'esbenp.prettier-vscode',\n      'editor.linkedEditing': true,\n      'emmet.showExpandedAbbreviation': 'never',\n      'files.associations': {\n        '*.tf': 'terraform',\n      },\n      '[typescript]': {\n        'editor.defaultFormatter': 'esbenp.prettier-vscode',\n      },\n      '[typescriptreact]': {\n        'editor.defaultFormatter': 'esbenp.prettier-vscode',\n      },\n      '[terraform]': {\n        'editor.defaultFormatter': 'hashicorp.terraform',\n      },\n    },\n    extensions: {\n      recommendations: [\n        'dbaeumer.vscode-eslint',\n        'esbenp.prettier-vscode',\n        'VisualStudioExptTeam.vscodeintellicode',\n        'styled-components.vscode-styled-components',\n        'naumovs.color-highlight',\n        'eamodio.gitlens',\n        'hashicorp.terraform',\n      ],\n    },\n  };\n}\n\nexport interface FileHash {\n  path: string;\n  hash: string;\n}\n\nexport interface WorkspaceOptions {\n  region: string;\n}\n\nexport interface Workspace {\n  fragments: WorkspaceFragment[];\n  version: string;\n  files: FileHash[];\n  options: WorkspaceOptions;\n}\n\nexport async function readWorkspace(workspacePath: string): Promise<Workspace | undefined> {\n  const workspaceContent = await maybeReadFile(join(workspacePath, '.workspace'));\n  if (workspaceContent === undefined) {\n    return undefined;\n  }\n  const workspaceData = asMap(JSON.parse(workspaceContent), {});\n\n  const fragments = removeUndefined(\n    asMapArray(workspaceData['fragments'], []).map<WorkspaceFragment | undefined>(fragData => {\n      const type = asString<WorkspaceFragmentType>(fragData['type']);\n      if (type === undefined) {\n        return undefined;\n      } else if (type === WorkspaceFragmentType.Shared) {\n        const frag: WorkspaceFragment = {type: WorkspaceFragmentType.Shared};\n        return frag;\n      } else if (type === WorkspaceFragmentType.SharedWeb) {\n        const frag: WorkspaceFragment = {type: WorkspaceFragmentType.SharedWeb};\n        return frag;\n      } else if (type === WorkspaceFragmentType.SharedNode) {\n        const frag: WorkspaceFragment = {type: WorkspaceFragmentType.SharedNode};\n        return frag;\n      } else if (type === WorkspaceFragmentType.WebApp) {\n        const alarmEmail = asString(fragData['alarmEmail']);\n        const appName = asStringOrThrow(fragData['appName']);\n        const authenticationData = asMap(fragData['authentication'], {});\n        const enabled = asBoolean(authenticationData['enabled'], false);\n        const domain = asString(fragData['domain']);\n        const frag: WorkspaceFragment = {\n          type: WorkspaceFragmentType.WebApp,\n          alarmEmail,\n          appName,\n          authentication: {enabled},\n          domain,\n        };\n        return frag;\n      } else if (type === WorkspaceFragmentType.StaticWebsite) {\n        const websiteName = asStringOrThrow<ProjectName>(fragData['websiteName']);\n        const domain = asString(fragData['domain']);\n        const frag: WorkspaceFragment = {\n          type: WorkspaceFragmentType.StaticWebsite,\n          websiteName,\n          domain,\n        };\n        return frag;\n      } else if (type === WorkspaceFragmentType.ApiLambda) {\n        const alarmEmail = asString(fragData['alarmEmail']);\n        const apiName = asStringOrThrow<ProjectName>(fragData['apiName']);\n        const domain = asString(fragData['domain']);\n        const frag: WorkspaceFragment = {\n          type: WorkspaceFragmentType.ApiLambda,\n          alarmEmail,\n          apiName,\n          domain,\n        };\n        return frag;\n      } else if (type === WorkspaceFragmentType.NodeScript) {\n        const scriptName = asStringOrThrow<ProjectName>(fragData['scriptName']);\n        const frag: WorkspaceFragment = {\n          type: WorkspaceFragmentType.NodeScript,\n          scriptName,\n        };\n        return frag;\n      }\n      // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n      else if (type === WorkspaceFragmentType.StandaloneLambda) {\n        const lambdaName = asStringOrThrow<ProjectName>(fragData['lambdaName']);\n        const alarmEmail = asString(fragData['alarmEmail']);\n        const cloudwatchTriggerMinutes = asNumber(fragData['cloudwatchTriggerMinutes']);\n        const frag: WorkspaceFragment = {\n          type: WorkspaceFragmentType.StandaloneLambda,\n          lambdaName,\n          alarmEmail,\n          cloudwatchTriggerMinutes,\n        };\n        return frag;\n      }\n      return undefined;\n    })\n  );\n\n  const version = asStringOrThrow(workspaceData['version']);\n  const files = removeUndefined(\n    asMapArray(workspaceData['files'], []).map<FileHash | undefined>(fileData => {\n      const path = asString(fileData['path']);\n      const hash = asString(fileData['hash']);\n      if (path === undefined || hash === undefined) {\n        return undefined;\n      }\n      return {path, hash};\n    })\n  );\n\n  const optionsData = asMap(workspaceData['options'], {});\n  const region = asString(optionsData['region'], DEFAULT_REGION);\n  const options: WorkspaceOptions = {region};\n\n  return {fragments, version, files, options};\n}\n\nexport async function writeWorkspace(workspacePath: string, workspace: Workspace): Promise<void> {\n  workspace.files.sort((f1, f2) => f1.path.localeCompare(f2.path));\n  await writeRawFile(join(workspacePath, '.workspace'), await prettyJson(workspace));\n}\n","import {createHash} from 'node:crypto';\nimport {mkdir, readdir, readFile, rm, stat} from 'node:fs/promises';\nimport {join, resolve} from 'node:path';\n\nimport {exists, rmDir} from '@src/fs';\nimport {log} from '@src/logger';\n\nexport interface WebpackConfigFragment {\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  config: () => any;\n  dependencies: Record<string, string>;\n}\n\nexport function isProd(): boolean {\n  return process.env['NODE_ENV'] === 'production'; // eslint-disable-line n/no-process-env\n}\n\nexport function isSelenium(): boolean {\n  return process.env['IS_SELENIUM'] === '1'; // eslint-disable-line n/no-process-env\n}\n\nexport function getEnv(): 'production' | 'development' {\n  return isProd() ? 'production' : 'development';\n}\n\nconst packageJsonCache = new Map<string, Record<string, unknown> | undefined>();\n\nexport async function findPackageJson(p: string): Promise<Record<string, unknown> | undefined> {\n  if (packageJsonCache.has(p)) {\n    return packageJsonCache.get(p);\n  }\n  try {\n    const pStat = await stat(p);\n    if (pStat.isDirectory()) {\n      const dir = await readdir(p);\n      if (dir.includes('package.json')) {\n        const fileContent = await readFile(join(p, 'package.json'));\n        const json = JSON.parse(fileContent.toString()) as Record<string, unknown>;\n        packageJsonCache.set(p, json);\n        return json;\n      }\n      if (p === '/') {\n        return undefined;\n      }\n    }\n    const res = await findPackageJson(resolve(`${p}/..`));\n    packageJsonCache.set(p, res);\n    return res;\n  } catch (err: unknown) {\n    log('findPackageJson');\n    log(err);\n    packageJsonCache.set(p, undefined);\n    return undefined;\n  }\n}\n\nexport function getPort(context: string): number {\n  // eslint-disable-next-line @typescript-eslint/no-magic-numbers\n  const hexHash = createHash('md5').update(context).digest('hex').slice(0, 4);\n  const port = 1024 + Math.floor(parseInt(hexHash, 16) / 2);\n  return port;\n}\n\nexport async function initLogFile(context: string, logFileName: string): Promise<string> {\n  // Find the root of the project and create the log dir there\n  try {\n    const root = await lookupRoot(context);\n    const logDir = join(root, 'log');\n    await rmDir(logDir);\n    await mkdir(logDir, {recursive: true});\n    const logFile = join(logDir, logFileName);\n    if (await exists(logFile)) {\n      await rm(logFile);\n    }\n    return logFile;\n  } catch {\n    throw new Error(`Failure to identify project root from ${context}`);\n  }\n}\n\nasync function lookupRoot(fromPath: string): Promise<string> {\n  if (await exists(join(fromPath, 'package.json'))) {\n    return fromPath;\n  }\n  const parent = join(fromPath, '..');\n  if (parent === fromPath) {\n    throw new Error('Failure to lookup root');\n  }\n  return await lookupRoot(parent);\n}\n","module.exports = __WEBPACK_EXTERNAL_createRequire(import.meta.url)(\"node:fs/promises\");","import {execSync} from 'node:child_process';\nimport {readdir} from 'node:fs/promises';\nimport {join} from 'node:path';\n\nimport {readFile, writeTsFile} from '@src/fs';\nimport {removeUndefined} from '@src/type_utils';\nimport {getEnv} from '@src/webpack/utils';\n\nexport async function generateEnvFile(\n  root: string,\n  overrides: Record<string, string>\n): Promise<void> {\n  // Get the outputs generated by terraform\n  const terraformPath = join(root, 'terraform');\n  const res: Record<string, {type: unknown; value: unknown; sensitive: boolean}> = JSON.parse(\n    execSync(`terraform output -json`, {cwd: terraformPath}).toString()\n  );\n  const outputsEntries = removeUndefined(\n    Object.entries(res).map(([key, value]) => {\n      if (value.sensitive) {\n        return undefined;\n      }\n      if (\n        Array.isArray(value.type) &&\n        value.type[0] === 'object' &&\n        typeof value.value === 'object' &&\n        value.value !== null\n      ) {\n        return [\n          key.toUpperCase(),\n          Object.fromEntries(Object.entries(value.value).map(([k, v]) => [k.toUpperCase(), v])),\n        ];\n      }\n      if (value.type === 'string' && typeof value.value === 'string') {\n        return [key.toUpperCase(), value.value];\n      }\n      return undefined;\n    })\n  );\n\n  // Parse the outputs from the tf files to create defaults\n  const terraformDir = await readdir(terraformPath);\n  const terraformFiles = terraformDir.filter(f => f.endsWith('.tf'));\n  const terraformFilesContent = await Promise.all(\n    terraformFiles.map(async f => await readFile(join(terraformPath, f)))\n  );\n  const allTerraform = terraformFilesContent.join('\\n');\n  const outputMatches = allTerraform.matchAll(/output \"(?<outputName>[^\"]+)\" \\{/gu);\n  const defaultOutputs = Object.fromEntries(\n    [...outputMatches]\n      .map(o => o.groups?.['outputName'])\n      .filter(o => o !== undefined)\n      .map(o => [o.toUpperCase(), 'RUN_TERRAFORM_APPLY'])\n  );\n\n  const envConstants: Record<string, unknown> = {\n    ...defaultOutputs,\n    ...Object.fromEntries(outputsEntries),\n    ...overrides,\n    NODE_ENV: getEnv(),\n  };\n\n  await writeTsFile(\n    join(root, 'shared', 'src', 'env.ts'),\n    Object.entries(envConstants)\n      .map(\n        ([key, value]) =>\n          `export const ${key} = ${JSON.stringify(value)}${\n            typeof value === 'string' ? ' as string' : ''\n          };`\n      )\n      .join('\\n')\n  );\n}\n","import {DetailedError, GlobalError, ParsedError} from '@src/webpack-runner/error_parser';\n\nexport interface GroupedErrors {\n  errorsByProjectByFile: Map<string, Map<string, DetailedError[]>>;\n  globalErrors: GlobalError[];\n}\n\nexport function groupAndSortErrors(errors: ParsedError[]): GroupedErrors {\n  const errorsByProjectByFile = new Map<string, Map<string, DetailedError[]>>();\n  const globalErrors: GlobalError[] = [];\n  for (const err of errors) {\n    if (!('type' in err)) {\n      globalErrors.push(err);\n    } else {\n      let projectErrors = errorsByProjectByFile.get(err.project);\n      if (!projectErrors) {\n        projectErrors = new Map<string, DetailedError[]>();\n        errorsByProjectByFile.set(err.project, projectErrors);\n      }\n      let fileErrors = projectErrors.get(err.loc.absolutePath);\n      if (!fileErrors) {\n        fileErrors = [];\n        projectErrors.set(err.loc.absolutePath, fileErrors);\n      }\n      fileErrors.push(err);\n    }\n  }\n  for (const byFile of errorsByProjectByFile.values()) {\n    for (const errors of byFile.values()) {\n      errors.sort((err1, err2) => {\n        if (!err1.loc.start) {\n          return -1;\n        } else if (!err2.loc.start) {\n          return 1;\n        }\n        const diffLine = err1.loc.start.line - err2.loc.start.line;\n        if (diffLine !== 0) {\n          return diffLine;\n        }\n        if (err1.loc.start.column === undefined) {\n          return -1;\n        } else if (err2.loc.start.column === undefined) {\n          return 1;\n        }\n        const diffColumn = err1.loc.start.column - err2.loc.start.column;\n        if (diffColumn !== 0) {\n          return diffColumn;\n        }\n        return err1.message.localeCompare(err2.message);\n      });\n    }\n  }\n  return {errorsByProjectByFile, globalErrors};\n}\n","import {relative, sep} from 'node:path';\n\nimport {Issue} from 'fork-ts-checker-webpack-plugin/lib/issue';\nimport {WebpackError} from 'webpack';\n\nimport {EslintWebpackError} from '@src/webpack/plugins/eslint_plugin';\n\nexport type ErrorSeverity = 'warning' | 'error';\nexport type ErrorType = 'eslint' | 'tsc' | 'module-not-found';\n\nexport interface DetailedError {\n  project: string;\n  type: 'eslint' | 'tsc' | 'module-not-found';\n  severity: ErrorSeverity;\n  message: string;\n  code: string;\n  loc: {\n    relativePath: string;\n    absolutePath: string;\n    start?: {\n      line: number;\n      column?: number;\n    };\n    end?: {\n      line: number;\n      column?: number;\n    };\n  };\n}\n\nexport interface GlobalError {\n  severity: ErrorSeverity;\n  message: string;\n}\n\nexport type ParsedError = DetailedError | GlobalError;\n\nfunction parseFilePath(root: string, path: string): {project: string; relativePath: string} {\n  const relativePath = relative(root, path);\n  const project = relativePath.split(sep)[0] ?? '';\n  return {project, relativePath};\n}\n\nexport function parseError(\n  err: WebpackError,\n  opts: {root: string; severity: ErrorSeverity}\n): ParsedError {\n  const {root, severity} = opts;\n  if (err.name === 'EslintWebpackError') {\n    const eslintError = err as EslintWebpackError;\n    const absolutePath = err.file;\n    if (absolutePath === undefined) {\n      return {severity, message: err.message};\n    }\n    const {relativePath, project} = parseFilePath(root, absolutePath);\n    return {\n      project,\n      type: 'eslint',\n      severity,\n      message: err.message,\n      code: eslintError.ruleId,\n      loc: {\n        relativePath,\n        absolutePath,\n        start: err.loc && 'start' in err.loc ? err.loc.start : undefined,\n        end: err.loc && 'end' in err.loc ? err.loc.end : undefined,\n      },\n    };\n  } else if ('issue' in err) {\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    const issue = (err as any)['issue'] as Issue;\n    const absolutePath = issue.file;\n    if (absolutePath === undefined) {\n      return {severity, message: err.message};\n    }\n    const {relativePath, project} = parseFilePath(root, absolutePath);\n    return {\n      project,\n      type: 'tsc',\n      severity,\n      message: issue.message,\n      code: issue.code,\n      loc: {\n        relativePath,\n        absolutePath,\n        ...issue.location,\n      },\n    };\n  } else if (err.name === 'ModuleNotFoundError') {\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    const msg = (err as any).error.message as string;\n    const match = /(?<msg>Can't resolve '[^']+') in '(?<file>[^']+)'/u.exec(msg);\n\n    if (!match) {\n      return {severity, message: err.message};\n    }\n    const [_, message, absolutePath] = match;\n    if (absolutePath === undefined || message === undefined) {\n      return {severity, message: err.message};\n    }\n    const {relativePath, project} = parseFilePath(root, absolutePath);\n    return {\n      project,\n      type: 'tsc',\n      severity,\n      message,\n      loc: {\n        relativePath,\n        absolutePath,\n      },\n    };\n  }\n  return {severity, message: err.message};\n}\n","import {createHash} from 'node:crypto';\nimport {readdir, readFile} from 'node:fs/promises';\nimport {createServer, IncomingMessage, ServerResponse} from 'node:http';\nimport {basename, join} from 'node:path';\n\ninterface File {\n  path: string;\n  content: string;\n}\n\nfunction iterFiles(opts: {\n  root: string;\n  excludeDirs?: (path: string) => boolean;\n  excludeFiles?: (path: string) => boolean;\n}): AsyncIterable<File> {\n  const {root, excludeDirs, excludeFiles} = opts;\n  const dirs: string[] = [root];\n  const files: string[] = [];\n\n  async function next(): Promise<IteratorResult<File, undefined>> {\n    // If we have a file in the queue, we process it\n    const nextFile = files.shift();\n    if (nextFile !== undefined) {\n      const buffer = await readFile(nextFile);\n      return {done: false, value: {path: nextFile, content: buffer.toString()}};\n    }\n    // Otherwise we need to find more files\n    // Check if we still have dir to walk\n    const nextDir = dirs.shift();\n    if (nextDir === undefined) {\n      return {done: true, value: undefined};\n    }\n    // List dir and add to queues\n    const dirEnts = await readdir(nextDir, {withFileTypes: true});\n    for (const dirEnt of dirEnts) {\n      const path = join(nextDir, dirEnt.name);\n      if (dirEnt.isDirectory()) {\n        if (excludeDirs?.(path)) {\n          continue;\n        }\n        dirs.push(path);\n      } else if (dirEnt.isFile()) {\n        if (excludeFiles?.(path)) {\n          continue;\n        }\n        files.push(path);\n      }\n    }\n    // Reprocess\n    return await next();\n  }\n\n  return {\n    [Symbol.asyncIterator]() {\n      return {next};\n    },\n  };\n}\n\ninterface Icon {\n  viewBox: string;\n  element: string;\n  name: string;\n}\n\nconst extension = '.tsx';\n\nasync function findIcons(root: string): Promise<Icon[]> {\n  const icons: Icon[] = [];\n  for await (const f of iterFiles({\n    root,\n    excludeDirs: p => p.includes('node_modules') || p.includes('/.'),\n    excludeFiles: p => !p.endsWith(extension),\n  })) {\n    if (f.content.includes('SvgIconData')) {\n      const [viewBox, element] =\n        /\\{\\s*viewBox:\\s*'(?<viewbox>[^']*)',\\s*element:\\s*(?<element>[^;]+);/u\n          .exec(f.content)\n          ?.slice(1) ?? [];\n      if (viewBox === undefined) {\n        continue;\n      }\n      if (element === undefined) {\n        continue;\n      }\n      let trimmed = element;\n      while (true) {\n        if (trimmed.includes('\\n')) {\n          trimmed = trimmed.replace('\\n', '');\n        } else if (trimmed.startsWith(' ') || trimmed.startsWith('\\t') || trimmed.startsWith('(')) {\n          trimmed = trimmed.slice(1);\n        } else if (\n          trimmed.endsWith(' ') ||\n          trimmed.endsWith('\\t') ||\n          trimmed.endsWith(')') ||\n          trimmed.endsWith(',') ||\n          trimmed.endsWith('}')\n        ) {\n          trimmed = trimmed.slice(0, -1);\n        } else {\n          break;\n        }\n      }\n      icons.push({name: basename(f.path).slice(0, -extension.length), viewBox, element: trimmed});\n    }\n  }\n  return icons;\n}\n\nfunction html(body: string): string {\n  return `\n<!DOCTYPE html>\n<html lang=\"en-US\">\n    <head>\n        <meta charset=\"utf-8\" />\n        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\" />\n        <title>ICONS</title>\n        <style>\n            .wrapper {\n                display: flex;\n                flex-wrap: wrap;\n                justify-content: center;\n                gap: 32px;\n                padding: 32px;\n            }\n            .icon {\n                width: 80px;\n                display: flex;\n                flex-direction: column;\n                gap: 8px;\n                align-items: center;\n                justify-content: center;\n            }\n            .icon svg {\n                fill: #000;\n            }\n            .icon-label {\n                color: #aaa;\n                white-space: nowrap;\n                text-overflow: ellipsis;\n                overflow: hidden;\n                width: 100%;\n                text-align: center;\n            }\n        </style>\n    </head>\n    <body>\n        ${body}\n    </body>\n</html>\n\n  `.trim();\n}\n\nexport interface IconServer {\n  port: number;\n  hasIcons: boolean;\n  stopServer: () => void;\n}\n\nexport async function startIconServer(root: string): Promise<IconServer> {\n  // eslint-disable-next-line @typescript-eslint/no-magic-numbers\n  const hexHash = createHash('md5').update(root).digest('hex').slice(0, 4);\n  const port = 1024 + Math.floor(parseInt(hexHash, 16) / 2);\n  const initialIcons = await findIcons(root);\n\n  const server = createServer((req: IncomingMessage, res: ServerResponse) => {\n    findIcons(root)\n      .then(icons => {\n        const body = html(\n          `<div class=\"wrapper\">${icons\n            .map(\n              icon => `\n              <div class=\"icon\">\n                  <svg viewbox=\"${icon.viewBox}\" width=\"48\" height=\"48\">${icon.element}</svg>\n                  <div class=\"icon-label\" title=\"${icon.name}\">${icon.name}</div>\n              </div>\n          `\n            )\n            .join('')}</div>`\n        );\n        res.write(body);\n        res.end();\n      })\n      .catch((err: unknown) => {\n        res.write(html(`Failure to load icons: ${String(err)}`));\n        res.end();\n      });\n  }).listen(port);\n\n  return {\n    port,\n    hasIcons: initialIcons.length > 0,\n    stopServer: () => server.close(),\n  };\n}\n","module.exports = __WEBPACK_EXTERNAL_createRequire(import.meta.url)(\"node:http\");","import {networkInterfaces} from 'node:os';\n\nexport function getLocalIp(): string {\n  return (\n    Object.values(networkInterfaces())\n      .flat()\n      .find(net => net !== undefined && net.family === 'IPv4' && net.address.startsWith('192.168.'))\n      ?.address ?? '127.0.0.1'\n  );\n}\n","module.exports = __WEBPACK_EXTERNAL_createRequire(import.meta.url)(\"node:os\");","import {spawn} from 'node:child_process';\n\nimport {registerExitCallback} from '@src/exit_handler';\nimport {log} from '@src/logger';\n\nexport function readLines(filePath: string, cb: (newLines: string[]) => void): () => void {\n  const p = spawn('tail', ['-F', filePath], {stdio: 'pipe'});\n  const cleanup = (): void => {\n    if (!p.killed) {\n      p.kill();\n    }\n  };\n  registerExitCallback(cleanup);\n  let data = '';\n  p.stdout.on('data', chunk => {\n    data += chunk;\n    const lines = data.split('\\n');\n    // eslint-disable-next-line n/callback-return\n    cb(lines.slice(0, -1));\n    data = lines.at(-1) ?? '';\n  });\n  p.on('error', err => {\n    log(err);\n  });\n  return cleanup;\n}\n","import {bgRed, bgYellow, cyan, gray, green, red} from 'ansi-colors';\n\nimport {WorkspaceFragmentType} from '@src/models';\nimport {WorkspaceProject} from '@src/project/generate_workspace';\nimport {neverHappens} from '@src/type_utils';\nimport {LambdaServerEvent} from '@src/webpack/plugins/lambda_server_plugin';\nimport {WebpackDevServerEvent} from '@src/webpack/plugins/webpack_dev_server';\nimport {formatError, formatFilePath, formatProject} from '@src/webpack-runner/error_formatter';\nimport {GroupedErrors} from '@src/webpack-runner/error_grouper';\nimport {ParsedError} from '@src/webpack-runner/error_parser';\nimport {getLocalIp} from '@src/webpack-runner/ip';\nimport {LambdaServerEvents, WebpackDevServerEvents} from '@src/webpack-runner/runner';\n\nexport function renderErrors(errors: GroupedErrors): string {\n  const {errorsByProjectByFile, globalErrors} = errors;\n  const blocks: string[] = [];\n\n  for (const globalError of globalErrors) {\n    blocks.push(formatError(globalError));\n  }\n\n  for (const [projectName, projectErrors] of errorsByProjectByFile.entries()) {\n    blocks.push(cyan(projectName));\n    for (const [file, errors] of projectErrors.entries()) {\n      blocks.push([formatFilePath(file), ...errors.map(err => formatError(err))].join('\\n'));\n    }\n  }\n\n  return blocks.join('\\n\\n');\n}\n\nexport function renderProjectStatus(\n  project: WorkspaceProject,\n  firstRun: boolean,\n  isRunning: boolean,\n  errors: GroupedErrors,\n  compilationFailure: string | undefined,\n  lambdaServerEvents: LambdaServerEvents,\n  webpackDevServerEvents: WebpackDevServerEvents\n): string[] {\n  // First column\n  const column1 = formatProject(project);\n\n  // Second column\n  let column2 = '';\n  const projectErrors = errors.errorsByProjectByFile.get(project.projectName);\n  if (projectErrors) {\n    column2 = renderErrorWarningCount([...projectErrors.values()].flat());\n  } else if (!firstRun) {\n    column2 = green('success');\n  } else if (isRunning) {\n    column2 = gray('in progress');\n  }\n\n  // Third column\n  const column3: string[] = [];\n  if (lambdaServerEvents.startEvent) {\n    column3.push(renderLambdaServerEvent(lambdaServerEvents.startEvent));\n  }\n  if (\n    webpackDevServerEvents.startEvent &&\n    project.fromFragment.type !== WorkspaceFragmentType.WebApp\n  ) {\n    column3.push(renderWebpackDevServerEvent(webpackDevServerEvents.startEvent));\n  }\n  if (compilationFailure !== undefined) {\n    column3.push(red(compilationFailure));\n  }\n  if (lambdaServerEvents.lastEvent) {\n    column3.push(renderLambdaServerEvent(lambdaServerEvents.lastEvent));\n  }\n\n  return [column1, column2, column3.join(' ')];\n}\n\nexport function renderErrorWarningCount(errors: ParsedError[]): string {\n  const errorCount = errors.filter(err => err.severity === 'error').length;\n  const warnCount = errors.filter(err => err.severity === 'warning').length;\n  const diag: string[] = [];\n\n  if (errorCount > 0) {\n    const plural = errorCount > 1 ? 's' : '';\n    diag.push(bgRed.whiteBright(` ${errorCount} error${plural} `));\n  }\n  if (warnCount > 0) {\n    const plural = warnCount > 1 ? 's' : '';\n    diag.push(bgYellow.whiteBright(` ${warnCount} warning${plural} `));\n  }\n  return diag.join(' ');\n}\n\nexport function renderLambdaServerEvent(event: LambdaServerEvent): string {\n  const type = event.event;\n  if (type === 'start') {\n    return `http://${getLocalIp()}:${event.port}`;\n  }\n  const req = gray(`${event.method} ${event.path}`);\n  if (type === 'error') {\n    return `${req} ${red(event.err)}`;\n  } else if (type === 'request') {\n    return `${req} ${gray('running lambda...')}`;\n    // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n  } else if (type === 'response') {\n    const httpCode = `[HTTP ${event.statusCode}]`;\n    const size = `[${event.bodyLength.toLocaleString()}b]`;\n    const duration = `[${event.duration.toLocaleString()}ms]`;\n    // eslint-disable-next-line @typescript-eslint/no-magic-numbers\n    const color = event.statusCode >= 400 ? red : green;\n    return `${req} ${color(`${httpCode} ${size} ${duration}`)}`;\n  }\n  neverHappens(type);\n}\n\nexport function renderWebpackDevServerEvent(event: WebpackDevServerEvent): string {\n  const type = event.event;\n  // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n  if (type === 'start') {\n    return `http://${getLocalIp()}:${event.port}`;\n  }\n  // const req = gray(`${event.method} ${event.path}`);\n  // if (type === 'error') {\n  //   return `${req} ${red(event.err)}`;\n  // } else if (type === 'request') {\n  //   return `${req} ${gray('running lambda...')}`;\n  //   // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n  // } else if (type === 'response') {\n  //   const httpCode = `[HTTP ${event.statusCode}]`;\n  //   const size = `[${event.byteLength.toLocaleString()}b]`;\n  //   const duration = `[${event.duration.toLocaleString()}ms]`;\n  //   // eslint-disable-next-line @typescript-eslint/no-magic-numbers\n  //   const color = event.statusCode >= 400 ? red : green;\n  //   return `${req} ${color(`${httpCode} ${size} ${duration}`)}`;\n  // }\n  neverHappens(type);\n}\n","import {cyan, gray, red, underline, yellow} from 'ansi-colors';\n\nimport {WorkspaceProject} from '@src/project/generate_workspace';\nimport {ErrorSeverity, ErrorType, ParsedError} from '@src/webpack-runner/error_parser';\n\nexport function formatProject(project: WorkspaceProject): string {\n  return `${cyan(project.projectName)} ${gray(project.type)}`;\n}\n\nexport function formatFilePath(filePath: string): string {\n  return underline(filePath);\n}\n\nfunction formatMessage(msg: string, severity: ErrorSeverity): string {\n  return severity === 'warning' ? yellow(msg) : red(msg);\n}\n\nconst padLeft = (value: string, size: number): string =>\n  value.length >= size ? value : padLeft(` ${value}`, size);\nconst padRight = (value: string, size: number): string =>\n  value.length >= size ? value : padRight(`${value} `, size);\n\nfunction formatLocation(loc?: {line: number; column?: number}): string {\n  const {line, column} = loc ?? {};\n  const padValue = 3;\n  const lineStr = String(line ?? '');\n  const columnStr = String(column ?? '');\n  if (lineStr.length === 0 && columnStr.length === 0) {\n    return padLeft('', 2 * padValue + 1);\n  }\n  return gray(`${padLeft(lineStr, padValue)}:${padRight(columnStr, padValue)}`);\n}\n\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nfunction formatLabel(code: string, type: ErrorType): string {\n  return gray(code);\n}\n\nexport function formatError(err: ParsedError): string {\n  if ('type' in err) {\n    return `${formatLocation(err.loc.start)} ${formatMessage(\n      err.message,\n      err.severity\n    )} ${formatLabel(err.code, err.type)}`;\n  }\n  return formatMessage(`[${err.severity}] ${err.message}`, err.severity);\n}\n","// Handle the locking logic.\n// We write a file /.build.lock with the current process and timestamp.\n// We continuously update the lock timestamp throughout runtime.\n// Before exiting we delete the lock file.\n// If at any point the lock file contains another pid, we know another process\n// is running the build and we exit. Except when the timestamp is older than\n// `MIN_LOCK_AGE_MS`, in this case it means another build process was running\n// and got killed without getting a chance to delete the lock file.\nimport {rmSync} from 'node:fs';\nimport {writeFile} from 'node:fs/promises';\nimport {join} from 'node:path';\n\nimport {maybeReadFile} from '@src/fs';\nimport {asNumber} from '@src/type_utils';\n\nconst MIN_LOCK_AGE_MS = 10000; // 10 seconds\nconst LOCK_UPDATE_PERIOD_MS = 1000; // 1 second\n\ninterface Lock {\n  pid: number;\n  ts: number;\n}\n\nfunction lockFilePath(root: string): string {\n  return join(root, '.build.lock');\n}\n\nasync function readLock(root: string): Promise<Lock | undefined> {\n  // Read the lock file\n  const lockFileContent = await maybeReadFile(lockFilePath(root));\n  if (lockFileContent === undefined) {\n    return undefined;\n  }\n\n  // Parse the content\n  const [pidTs, tsStr] = lockFileContent.split('-');\n  const pid = asNumber(pidTs);\n  const ts = asNumber(tsStr);\n  if (pid === undefined || ts === undefined) {\n    return undefined;\n  }\n\n  return {pid, ts};\n}\n\nasync function writeLock(root: string): Promise<void> {\n  await writeFile(lockFilePath(root), `${process.pid}-${Date.now()}`);\n}\n\nasync function checkLock(root: string): Promise<void> {\n  const lock = await readLock(root);\n  if (lock && lock.pid !== process.pid && Date.now() - lock.ts < MIN_LOCK_AGE_MS) {\n    console.error(`Lock ${lockFilePath(root)} is taken by the process ${lock.pid}`);\n    // eslint-disable-next-line n/no-process-exit\n    process.exit(1);\n  }\n}\n\nlet lockInterval: NodeJS.Timeout | undefined;\nexport function releaseLock(root: string): void {\n  if (lockInterval) {\n    clearInterval(lockInterval);\n  }\n  rmSync(lockFilePath(root), {force: true});\n}\n\nexport async function takelock(root: string): Promise<void> {\n  // Ensure the lock is available\n  await checkLock(root);\n  // Check and update the lock periodically\n  lockInterval = setInterval(() => {\n    checkLock(root)\n      .then(() => {\n        writeLock(root).catch(() => {});\n      })\n      .catch(() => {});\n  }, LOCK_UPDATE_PERIOD_MS);\n}\n","const ansiRegex = new RegExp(\n  [\n    '[\\\\u001B\\\\u009B][[\\\\]()#;?]*(?:(?:(?:[a-zA-Z\\\\d]*(?:;[-a-zA-Z\\\\d\\\\/#&.:=?%@~_]*)*)?\\\\u0007)',\n    '(?:(?:\\\\d{1,4}(?:;\\\\d{0,4})*)?[\\\\dA-PR-TZcf-ntqry=><~]))',\n  ].join('|'),\n  'gu'\n);\nconst stripAnsi = (s: string): string => s.replace(ansiRegex, '');\n\ntype AlignType = 'l' | 'r';\ntype Cell = string | number;\n\ninterface TextTableOptions {\n  align?: AlignType[];\n}\n\nfunction formatCell(cell: Cell): string {\n  return typeof cell === 'string' ? cell : cell.toLocaleString();\n}\n\nfunction padString(value: string, indent: number, right: boolean): string {\n  let valueStr = value;\n  for (let i = 0; i < indent; i++) {\n    valueStr = right ? `${valueStr} ` : ` ${valueStr}`;\n  }\n  return valueStr;\n}\n\nexport function table(data: Cell[][], options?: TextTableOptions): string {\n  if (data.length === 0) {\n    return '';\n  }\n  const {align = []} = options ?? {};\n  const maxWidths: number[] = [];\n  for (const line of data) {\n    for (const [columnIndex, cell] of line.entries()) {\n      maxWidths[columnIndex] = Math.max(\n        maxWidths[columnIndex] ?? 0,\n        stripAnsi(formatCell(cell)).length\n      );\n    }\n  }\n\n  return data\n    .map(line =>\n      line\n        .map((cell, colIndex, arr) => {\n          const content = formatCell(cell);\n          return colIndex === arr.length - 1 && align[colIndex] !== 'r'\n            ? content\n            : padString(\n                content,\n                (maxWidths[colIndex] ?? 0) - stripAnsi(content).length,\n                align[colIndex] !== 'r'\n              );\n        })\n        .join(' ')\n    )\n    .join('\\n');\n}\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import {execSync} from 'node:child_process';\nimport {join} from 'node:path';\n\nimport {underline} from 'ansi-colors';\nimport {Configuration, Stats, webpack} from 'webpack';\nimport WebpackDevServer from 'webpack-dev-server';\n\nimport {registerExitCallback} from '@src/exit_handler';\nimport {globalError} from '@src/global_error';\nimport {error, log} from '@src/logger';\nimport {ProjectName, ProjectType, WorkspaceFragment} from '@src/models';\nimport {getProjectsFromWorkspaceFragment, WorkspaceProject} from '@src/project/generate_workspace';\nimport {readWorkspace} from '@src/project/vscode_workspace';\nimport {neverHappens, removeUndefined} from '@src/type_utils';\nimport {\n  FullLambdaServerEvent,\n  LambdaServerEvent,\n  LambdaServerStartEvent,\n} from '@src/webpack/plugins/lambda_server_plugin';\nimport {\n  FullWebpackDevServerEvent,\n  WebpackDevServerStartEvent,\n} from '@src/webpack/plugins/webpack_dev_server';\nimport {getEnv, getPort} from '@src/webpack/utils';\nimport {generateEnvFile} from '@src/webpack-runner/env_definition_file';\nimport {groupAndSortErrors} from '@src/webpack-runner/error_grouper';\nimport {ParsedError, parseError} from '@src/webpack-runner/error_parser';\nimport {IconServer, startIconServer} from '@src/webpack-runner/icon_server';\nimport {getLocalIp} from '@src/webpack-runner/ip';\nimport {readLines} from '@src/webpack-runner/line_reader';\nimport {\n  renderErrors,\n  renderErrorWarningCount,\n  renderProjectStatus,\n} from '@src/webpack-runner/renderer';\nimport {releaseLock, takelock} from '@src/webpack-runner/runner_lock';\nimport {table} from '@src/webpack-runner/text_table';\n\ninterface RunWebpacksOptions {\n  root: string;\n  workspaceFragments: WorkspaceFragment[];\n  watch: boolean;\n}\n\nexport interface LambdaServerEvents {\n  startEvent?: LambdaServerStartEvent;\n  lastEvent?: Exclude<LambdaServerEvent, LambdaServerStartEvent>;\n}\n\nexport interface WebpackDevServerEvents {\n  startEvent?: WebpackDevServerStartEvent;\n  // lastEvent?: Exclude<WebpackDevServerEvent, WebpackDevServerStartEvent>;\n}\n\ninterface ProjectStatus {\n  project: WorkspaceProject;\n  firstRun: boolean;\n  isRunning: boolean;\n  errors: ParsedError[];\n  compilationFailure?: string;\n  lambdaServerEvents: LambdaServerEvents;\n  webpackDevServerEvents: WebpackDevServerEvents;\n}\n\nconst name = 'WebpackRunner';\n\nlet globalRoot = '';\nlet stopIconServer: (() => void) | undefined;\nfunction exit(): void {\n  stopIconServer?.();\n  releaseLock(globalRoot);\n  process.stdin.setRawMode(false);\n  log('See you soon!');\n  // eslint-disable-next-line n/no-process-exit\n  process.exit(0);\n}\n\nexport async function runWebpacks(opts: RunWebpacksOptions): Promise<void> {\n  const {root, workspaceFragments, watch} = opts;\n  const statuses = new Map<ProjectName, ProjectStatus>();\n  const projects = workspaceFragments.flatMap(f => getProjectsFromWorkspaceFragment(f));\n\n  async function regenerateEnvFile(): Promise<void> {\n    const overrides: Record<string, string> = {};\n    if (getEnv() === 'development') {\n      for (const {projectName, type} of projects) {\n        if (type === ProjectType.LambdaApi || type === ProjectType.LambdaWebApi) {\n          const status = statuses.get(projectName);\n          const port =\n            status?.lambdaServerEvents.startEvent?.port ?? getPort(join(root, projectName));\n          overrides[`${projectName.toUpperCase()}_URL`] = `http://${getLocalIp()}:${port}/`;\n        }\n        if (type === ProjectType.Web) {\n          const status = statuses.get(projectName);\n          const port =\n            status?.webpackDevServerEvents.startEvent?.port ?? getPort(join(root, projectName));\n          overrides[`${projectName.toUpperCase()}_CLOUDFRONT_DOMAIN_NAME`] =\n            `${getLocalIp()}:${port}`;\n        }\n      }\n    }\n    await generateEnvFile(root, overrides);\n  }\n  await regenerateEnvFile();\n\n  let iconServer: IconServer | undefined;\n  if (watch) {\n    iconServer = await startIconServer(root);\n    stopIconServer = iconServer.stopServer;\n  }\n\n  function handleStart(project: WorkspaceProject): void {\n    const {projectName} = project;\n    const current = statuses.get(projectName) ?? {\n      project,\n      firstRun: true,\n      isRunning: true,\n      errors: [],\n      lambdaServerEvents: {},\n      webpackDevServerEvents: {},\n    };\n    statuses.set(projectName, {...current, isRunning: true});\n    onChange({isCompleted: false, projectName});\n  }\n\n  function handleResults(project: WorkspaceProject, stats: Stats): void {\n    const {projectName} = project;\n    const errors = [\n      ...stats.compilation.errors.map(err => parseError(err, {root, severity: 'error'})),\n      ...stats.compilation.warnings.map(warn => parseError(warn, {root, severity: 'warning'})),\n    ];\n    const lambdaServerEvents = statuses.get(projectName)?.lambdaServerEvents ?? {};\n    const webpackDevServerEvents = statuses.get(projectName)?.webpackDevServerEvents ?? {};\n    const compilationFailure = statuses.get(projectName)?.compilationFailure;\n    statuses.set(projectName, {\n      project,\n      firstRun: false,\n      isRunning: false,\n      errors,\n      compilationFailure,\n      lambdaServerEvents,\n      webpackDevServerEvents,\n    });\n    onChange({isCompleted: false, projectName});\n  }\n\n  function redraw(): void {\n    const errors = [...statuses.values()].flatMap(v => v.errors);\n    const groupedErrors = groupAndSortErrors(errors);\n\n    const summary = [...statuses.values()].map(status => {\n      return renderProjectStatus(\n        status.project,\n        status.firstRun,\n        status.isRunning,\n        groupedErrors,\n        status.compilationFailure,\n        status.lambdaServerEvents,\n        status.webpackDevServerEvents\n      );\n    });\n    summary.unshift([\n      underline(`Projects (${projects.length})`),\n      underline('Status'),\n      underline('Run'),\n    ]);\n    const report = renderErrors(groupedErrors);\n\n    if (watch) {\n      process.stdout.write('\\u001B[2J\\u001B[3J\\u001B[H'); // clear terminal\n    }\n    log(table(summary));\n    if (iconServer?.hasIcons) {\n      log(`icons: http://${getLocalIp()}:${iconServer.port}`);\n    }\n    if (report.length > 0) {\n      log(`\\nBuild completed with ${renderErrorWarningCount(errors)}\\n`);\n      log(report);\n    }\n  }\n\n  const completed = new Set<ProjectName>();\n  function onChange(opts: {projectName: ProjectName; isCompleted: boolean}): void {\n    if (watch) {\n      redraw();\n      return;\n    }\n\n    const {projectName, isCompleted} = opts;\n    if (isCompleted) {\n      completed.add(projectName);\n    }\n    const allDone = [...statuses.keys()].every(projectName => completed.has(projectName));\n    if (!allDone) {\n      return;\n    }\n\n    const errors = [...statuses.values()].flatMap(v => v.errors);\n    const {globalErrors} = groupAndSortErrors(errors);\n    const noGlobalErrors =\n      globalErrors.length === 0 &&\n      [...statuses.values()].every(status => status.compilationFailure === undefined);\n    if (noGlobalErrors) {\n      resolve();\n    } else {\n      reject();\n    }\n  }\n\n  const cleanupFunctions = await Promise.all(\n    projects.map(async project => {\n      const {projectName} = project;\n      const projectPath = join(root, projectName);\n      const intialStatus = {\n        project,\n        firstRun: true,\n        isRunning: true,\n        errors: [],\n        lambdaServerEvents: {},\n        webpackDevServerEvents: {},\n      };\n\n      function updateStatus(fn: (curr: ProjectStatus) => void): void {\n        let current = statuses.get(projectName);\n        if (!current) {\n          current = intialStatus;\n          statuses.set(projectName, current);\n        }\n        fn(current);\n      }\n\n      function reportCompilationFailure(error: string): void {\n        updateStatus(curr => {\n          curr.compilationFailure = error;\n        });\n      }\n\n      statuses.set(projectName, intialStatus);\n      // eslint-disable-next-line import/dynamic-import-chunkname\n      const config = await import(/*webpackIgnore: true*/ join(projectPath, 'webpack.config.js'))\n        .then(({getConfig}) => getConfig({context: projectPath, watch}) as Configuration)\n        .catch((err: unknown) => {\n          reportCompilationFailure(String(err));\n          return undefined;\n        });\n\n      const updateLambdaServerEvents = (fn: (curr: LambdaServerEvents) => void): void => {\n        updateStatus(curr => fn(curr.lambdaServerEvents));\n      };\n\n      const updateWebpackDevServerEvents = (fn: (curr: WebpackDevServerEvents) => void): void => {\n        updateStatus(curr => fn(curr.webpackDevServerEvents));\n      };\n\n      // Read events in the lambda server logs to update the globalInfo\n      let lastProcessedLambdaLog = Date.now();\n      const tailLambdaServerCleanup = watch\n        ? readLines(join(projectPath, 'log', 'lambda_server_runtime.txt'), lines => {\n            const logs = lines\n              .map(l => l.trim())\n              .filter(l => l.length > 0)\n              .map(l => JSON.parse(l) as FullLambdaServerEvent);\n            let shouldRedraw = false;\n            for (const log of logs) {\n              const date = new Date(log.t).getTime();\n              if (date < lastProcessedLambdaLog) {\n                continue;\n              }\n              lastProcessedLambdaLog = date;\n              shouldRedraw = true;\n              if (log.event === 'start') {\n                updateLambdaServerEvents(curr => {\n                  curr.startEvent = log;\n                });\n                // Send and forget\n                // eslint-disable-next-line @typescript-eslint/no-floating-promises\n                regenerateEnvFile();\n              } else {\n                updateLambdaServerEvents(curr => {\n                  curr.lastEvent = log;\n                });\n              }\n            }\n            if (shouldRedraw) {\n              redraw();\n            }\n          })\n        : undefined;\n\n      // Read events in the webpack dev server logs to update the globalInfo\n      let lastProcessedDevServerLog = Date.now();\n      const tailWebpackServerCleanup = watch\n        ? readLines(join(projectPath, 'log', 'webpack_dev_server.txt'), lines => {\n            const logs = lines\n              .map(l => l.trim())\n              .filter(l => l.length > 0)\n              .map(l => JSON.parse(l) as FullWebpackDevServerEvent);\n            let shouldRedraw = false;\n            for (const log of logs) {\n              const date = new Date(log.t).getTime();\n              if (date < lastProcessedDevServerLog) {\n                continue;\n              }\n              lastProcessedDevServerLog = date;\n              shouldRedraw = true;\n              // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n              if (log.event === 'start') {\n                updateWebpackDevServerEvents(curr => {\n                  curr.startEvent = log;\n                });\n              } else {\n                neverHappens(log.event);\n                //   updateWebpackDevServerEvents(curr => {\n                //     curr.lastEvent = log;\n                //   });\n              }\n            }\n            if (shouldRedraw) {\n              redraw();\n            }\n          })\n        : undefined;\n\n      if (!config) {\n        return;\n      }\n\n      const compiler = webpack({...config, watch}, (err: Error | null, res?: Stats) => {\n        if (err || !res) {\n          reportCompilationFailure(err ? String(err) : 'No result after compilation');\n          if (!watch) {\n            onChange({isCompleted: true, projectName});\n            resolve();\n            return;\n          }\n        }\n        onChange({isCompleted: true, projectName});\n      });\n      compiler.hooks.beforeRun.tap(name, () => handleStart(project));\n      compiler.hooks.watchRun.tap(name, () => handleStart(project));\n      compiler.hooks.done.tap(name, stats => handleResults(project, stats));\n\n      let devServer: WebpackDevServer | undefined;\n      if (config.devServer) {\n        devServer = new WebpackDevServer(config.devServer, compiler);\n        await devServer.start();\n      }\n      return async (): Promise<void> => {\n        return await new Promise<void>((resolve, reject) => {\n          const closeCompiler = (): void => {\n            tailLambdaServerCleanup?.();\n            tailWebpackServerCleanup?.();\n            compiler.close(err => (err ? reject(err) : resolve()));\n          };\n          if (devServer) {\n            devServer\n              .stop()\n              .then(closeCompiler)\n              .catch((err: unknown) => {\n                reject(err instanceof Error ? err : new Error(String(err)));\n              });\n          } else {\n            closeCompiler();\n          }\n        });\n      };\n    })\n  );\n\n  let resolvePromise: () => void;\n  let rejectPromise: (err?: unknown) => void;\n  const globalPromise = new Promise<void>((resolve, reject) => {\n    resolvePromise = resolve;\n    rejectPromise = reject;\n  });\n\n  let cleanupCalled = false;\n  const cleanup = async (): Promise<void> => {\n    if (cleanupCalled) {\n      return;\n    }\n    cleanupCalled = true;\n    await Promise.all(cleanupFunctions.map(async fn => await fn?.()));\n    redraw();\n    releaseLock(globalRoot);\n    process.stdin.setRawMode(false);\n  };\n\n  const reject = (err?: unknown): void => {\n    cleanup()\n      .then(() => rejectPromise(err))\n      .catch((cleanupErr: unknown) => {\n        globalError('webpack runner cleanup error', cleanupErr);\n        rejectPromise(err);\n      });\n  };\n  const resolve = (): void => {\n    cleanup()\n      .then(resolvePromise)\n      .catch((cleanupErr: unknown) => {\n        globalError('webpack runner cleanup error', cleanupErr);\n        resolvePromise();\n      });\n  };\n\n  if (watch) {\n    process.stdin.setRawMode(true);\n    process.stdin.on('data', data => {\n      const str = data.toString();\n      // Handle ctrl+c\n      if (str === '\\u0003') {\n        console.log('ctrl-c received, cleaning up...');\n        cleanup()\n          .then(() => {\n            process.emit('SIGINT', 'SIGINT');\n          })\n          .catch(() => {\n            process.emit('SIGINT', 'SIGINT');\n          });\n      } else if (str === 'o') {\n        const errorPaths = removeUndefined(\n          [...statuses.values()]\n            .flatMap(status => status.errors)\n            .map(err => ('loc' in err ? err.loc.absolutePath : undefined))\n        );\n        const files = [...new Set([...errorPaths]).values()];\n        const openCommand = `code ${files.join(' ')}`;\n        execSync(openCommand);\n      }\n    });\n\n    process.on('SIGINT', () => {\n      exit();\n    });\n    process.on('beforeExit', () => {\n      exit();\n    });\n\n    // Handle uncaught error and exceptions\n    process.on('uncaughtException', err => {\n      error('Uncaught Exception');\n      error(err);\n      exit();\n    });\n\n    // Handle unhandled failing promises\n    process.on('unhandledRejection', err => {\n      error('Unhandled Rejection');\n      error(err);\n      exit();\n    });\n  }\n\n  registerExitCallback(cleanup);\n  return await globalPromise;\n}\n\nexport async function runAllWebpacks(\n  options: Omit<RunWebpacksOptions, 'projectPaths'>\n): Promise<void> {\n  const {root, watch} = options;\n  globalRoot = root;\n  await takelock(root);\n\n  const {fragments} = (await readWorkspace(root)) ?? {};\n  if (!fragments) {\n    throw new Error(`No workspace projects at path ${root}`);\n  }\n  await runWebpacks({\n    root,\n    workspaceFragments: fragments,\n    watch,\n  });\n}\n"],"names":["globalError","called","callbacks","runCallbacks","fn","Promise","resolve","catch","err","process","on","registerExitCallback","cb","push","appendFileSync","error","val","data","str","Error","stack","String","JSON","stringify","console","log","ProjectType","EslintType","TsConfigType","WebpackType","PROJECT_TYPE_TO_METADATA","Web","eslint","tsconfig","webpack","LambdaFunction","Node","Lambda","LambdaApi","LambdaWebApi","NodeScript","Shared","Lib","SharedNode","SharedWeb","WorkspaceFragmentType","validateRegistry","filterFragments","frags","type","filter","frag","execSync","join","relative","fileURLToPath","listFiles","prettyJs","prettyJson","prettyJsonc","readFile","writeRawFile","md5","generateProject","generateGitIgnore","generateWorkspacePackageJson","generateCommonTerraform","generateWorkspaceProjectTerraform","generateDynamoUserTerraform","generateDynamoUserSessionTerraform","generateCodeWorkspace","writeWorkspace","lowerCase","pascalCase","neverHappens","removeUndefined","PACKAGE_VERSIONS","DEFAULT_REGION","TEMPLATES_PATH","import","meta","url","booleanFlag","bool","hasApi","allFragments","find","f","ApiLambda","WebApp","undefined","fragmentFlags","baseFlags","workspaceFlags","HAS_API","parseDomain","domainStr","parts","split","rootDomain","slice","subDomain","getProjectsFromWorkspaceFragment","fragment","StaticWebsite","projectName","websiteName","fromFragment","vars","__PROJECT_NAME__","__APP_NAME__","flags","terraform","domain","StandaloneLambda","lambdaName","__PROJECT_NAME_UPPERCASE__","toUpperCase","api","webAppName","alarmEmail","cloudwatchTriggerMinutes","authentication","apiName","backendName","appName","frontendName","__APP_NAME_UPPERCASE__","__APP_NAME_PASCALCASE__","AUTHENTICATION","enabled","scriptName","generateWorkspace","dst","workspaceName","workspaceFragments","workspaceOptions","workspace","projects","flatMap","projectFiles","all","map","project","SCRIPTS_PATH","writeFile","path","file","writeWorkspaceFile","workspaceFiles","then","res","replaceAll","vscodePath","vscodeFileList","vscodeFiles","relativePath","dstPath","content","terraformFiles","addLineBreak","p","name","files","flat","fragments","version","options","commands","stdio","cwd","root","fileLines","fileToHash","line","endsWith","newHash","oldHash","hash","fileToWrite","l","exec","promises","readFileSync","dirname","format","access","readFileInternal","readdir","stat","mkdir","rm","buffer","toString","prettierConfig","parser","printWidth","singleQuote","trailingComma","bracketSpacing","arrowParens","endOfLine","prettierFormat","recursive","json","opts","compact","writeJsonFile","js","writeJsFile","prettyTs","ts","writeTsFile","writeRawFileIfNotExists","exists","rmDir","dirPath","force","cleanDir","cp","from","to","reject","maybeReadFile","fileContent","maybeReadFileSync","ents","withFileTypes","ent","entPath","isDirectory","subFiles","isFile","createHash","update","digest","hashPassword","password","salt","generateSharedFiles","randomStringSafe","upperCase","written","defaultVars","__WORKSPACE_NAME__","__WORKSPACE_NAME_UPPERCASE__","__COOKIE_ENCRYPTION_KEY__","templatePath","filesToWrite","packageJson","parse","varName","varValue","Object","entries","formattedContent","skipFileMatches","matchAll","skipFileMatch","flagName","negate","flagValue","groups","flagMatch","depth","includes","pop","matchStart","at","flag","projectFlagValue","projectFlagMatchValue","webApps","apiLambdas","webAppsWithAuth","app","generateSharedApiFile","webApp","userType","apiLambda","length","generateSharedModelFile","imports","apisDef","trim","apisConfig","capitalize","value","firstChar","uncapitalize","toLowerCase","s","randomBytes","ALPHANUM","set","result","characters","bytes","byte","Math","floor","UID_LENGTH","uidSafe","prefix","id","NONCE_BYTE_SIZE","generateNonce","NODE_VERSION","TYPESCRIPT_VERSION","uniq","Set","values","eslintRuntimes","tsconfigRuntimes","webpackRuntimes","license","engines","node","scripts","setup","deploy","build","watch","prettier","devDependencies","fromEntries","runtime","runner","sort","d1","d2","localeCompare","lambdaServerRuntime","ESLINT_VERSION","PRETTIER_VERSION","MIN_NODE_VERSION","CORE_JS_VERSION","LIB_VERSIONS","react","generateFrontendTerraform","generateLambdaTerraform","generateAwsProviderTerraform","generateS3BucketTerraform","region","bucketName","replace","originId","webProjectNames","CODE_BUCKET","CLOUDFRONT_ACCESS","out","notUndefined","isString","isNumber","iterNumberEnum","e","iterStringEnum","arr","removeUndefinedOrNullProps","obj","errorMessage","asMap","defaultValue","Array","isArray","asMapOrThrow","valueAsMap","asJson","asJsonOrThrow","valueAsJson","asJsonString","asString","asJsonStringOrThrow","asStringOrThrow","valueAsString","asStringEnum","enu","asStringEnumOrThrow","asArray","asArrayOrThrow","asStringArray","asStringArrayOrThrow","asMapArray","asMapArrayOrThrow","asNumber","isNaN","parsedValue","parseFloat","asNumberOrThrow","valueAsNumber","asBoolean","asBooleanOrThrow","valueAsBoolean","TIMESTAMP_REGEX","asDate","date","Date","test","getTime","asDateOrThrow","valueAsDate","isNull","asError","errorAsString","errorMap","errorAndStackAsString","asConstantOrThrow","expected","parseJson","isNonEmptyArray","nonEmptyArray","addPrefix","attr","key","prefixLower","prefixPascal","projectNames","folders","settings","extensions","recommendations","readWorkspace","workspacePath","workspaceContent","workspaceData","fragData","authenticationData","fileData","optionsData","f1","f2","isProd","env","isSelenium","getEnv","packageJsonCache","Map","findPackageJson","has","get","pStat","dir","getPort","context","hexHash","port","parseInt","initLogFile","logFileName","lookupRoot","logDir","logFile","fromPath","parent","generateEnvFile","overrides","terraformPath","outputsEntries","sensitive","k","v","terraformDir","terraformFilesContent","allTerraform","outputMatches","defaultOutputs","o","envConstants","NODE_ENV","groupAndSortErrors","errors","errorsByProjectByFile","globalErrors","projectErrors","fileErrors","loc","absolutePath","byFile","err1","err2","start","diffLine","column","diffColumn","message","sep","parseFilePath","parseError","severity","eslintError","code","ruleId","end","issue","location","msg","match","_","createServer","basename","iterFiles","excludeDirs","excludeFiles","dirs","next","nextFile","shift","done","nextDir","dirEnts","dirEnt","Symbol","asyncIterator","extension","findIcons","icons","viewBox","element","trimmed","startsWith","html","body","startIconServer","initialIcons","server","req","icon","write","listen","hasIcons","stopServer","close","networkInterfaces","getLocalIp","net","family","address","spawn","readLines","filePath","cleanup","killed","kill","stdout","chunk","lines","bgRed","bgYellow","cyan","gray","green","red","formatError","formatFilePath","formatProject","renderErrors","blocks","renderProjectStatus","firstRun","isRunning","compilationFailure","lambdaServerEvents","webpackDevServerEvents","column1","column2","renderErrorWarningCount","column3","startEvent","renderLambdaServerEvent","renderWebpackDevServerEvent","lastEvent","errorCount","warnCount","diag","plural","whiteBright","event","method","httpCode","statusCode","size","bodyLength","toLocaleString","duration","color","underline","yellow","formatMessage","padLeft","padRight","formatLocation","padValue","lineStr","columnStr","formatLabel","rmSync","MIN_LOCK_AGE_MS","LOCK_UPDATE_PERIOD_MS","lockFilePath","readLock","lockFileContent","pidTs","tsStr","pid","writeLock","now","checkLock","lock","exit","lockInterval","releaseLock","clearInterval","takelock","setInterval","ansiRegex","RegExp","stripAnsi","formatCell","cell","padString","indent","right","valueStr","i","table","align","maxWidths","columnIndex","max","colIndex","WebpackDevServer","globalRoot","stopIconServer","stdin","setRawMode","runWebpacks","statuses","regenerateEnvFile","status","iconServer","handleStart","current","onChange","isCompleted","handleResults","stats","compilation","warnings","warn","redraw","groupedErrors","summary","unshift","report","completed","add","allDone","keys","every","noGlobalErrors","cleanupFunctions","projectPath","intialStatus","updateStatus","reportCompilationFailure","curr","config","getConfig","updateLambdaServerEvents","updateWebpackDevServerEvents","lastProcessedLambdaLog","tailLambdaServerCleanup","logs","shouldRedraw","t","lastProcessedDevServerLog","tailWebpackServerCleanup","compiler","hooks","beforeRun","tap","watchRun","devServer","closeCompiler","stop","resolvePromise","rejectPromise","globalPromise","cleanupCalled","cleanupErr","emit","errorPaths","openCommand","runAllWebpacks"],"sourceRoot":""}