{"version":3,"file":"index.js","mappings":"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","sources":["webpack://b/external node-commonjs \"node:crypto\"","webpack://b/external node-commonjs \"node:fs\"","webpack://b/external node-commonjs \"node:http\"","webpack://b/./src/type_utils.ts","webpack://b/webpack/bootstrap","webpack://b/webpack/runtime/compat get default export","webpack://b/webpack/runtime/define property getters","webpack://b/webpack/runtime/hasOwnProperty shorthand","webpack://b/webpack/runtime/make namespace object","webpack://b/./src/lambda-server-runtime/runtime.ts"],"sourcesContent":["module.exports = __WEBPACK_EXTERNAL_createRequire(import.meta.url)(\"node:crypto\");","module.exports = __WEBPACK_EXTERNAL_createRequire(import.meta.url)(\"node:fs\");","module.exports = __WEBPACK_EXTERNAL_createRequire(import.meta.url)(\"node:http\");","function notUndefined<T>(val: T | undefined): val is T {\n  return val !== undefined;\n}\n\nexport function isString(val: unknown): val is string {\n  return typeof val === 'string';\n}\n\nexport function isNumber(val: unknown): val is number {\n  return typeof val === 'number';\n}\n\nexport function iterNumberEnum<T extends Record<string, string | number>>(e: T): T[keyof T][] {\n  return Object.values(e).filter(isNumber) as unknown as T[keyof T][];\n}\n\nexport function iterStringEnum<T extends Record<string, string>>(e: T): T[keyof T][] {\n  return Object.values(e).filter(isString) as unknown as T[keyof T][];\n}\n\nexport function removeUndefined<T>(arr: (T | undefined)[]): T[] {\n  return arr.filter(notUndefined);\n}\n\nexport function removeUndefinedOrNullProps<T extends Record<string, unknown>>(obj: T): {} {\n  return Object.fromEntries(\n    Object.entries(obj).filter(e => e[1] !== undefined && e[1] !== null)\n  ) as T;\n}\n\nexport function neverHappens(value: never, errorMessage?: string): never {\n  throw new Error(errorMessage);\n}\n\nexport type AnyInterface<T> = {[K in keyof T]: unknown};\n\nexport function asMap(value: unknown): Record<string, unknown> | undefined;\nexport function asMap(\n  value: unknown,\n  defaultValue: Record<string, unknown>\n): Record<string, unknown>;\nexport function asMap(\n  value: unknown,\n  defaultValue?: Record<string, unknown>\n): Record<string, unknown> | undefined {\n  return typeof value === 'object' && value !== null && !Array.isArray(value)\n    ? (value as Record<string, unknown>)\n    : defaultValue;\n}\nexport function asMapOrThrow(value: unknown): Record<string, unknown> {\n  const valueAsMap = asMap(value);\n  if (valueAsMap === undefined) {\n    throw new Error(`Invalid value: \\`${value}\\` is not a map`);\n  }\n  return valueAsMap;\n}\n\nexport function asJson(value: string): Record<string, unknown> | undefined;\nexport function asJson(\n  value: string,\n  defaultValue: Record<string, unknown>\n): Record<string, unknown>;\nexport function asJson(\n  value: string,\n  defaultValue?: Record<string, unknown>\n): Record<string, unknown> | undefined {\n  try {\n    const json = JSON.parse(value);\n    const res = asMap(json);\n    return res ?? defaultValue;\n  } catch {\n    return defaultValue;\n  }\n}\nexport function asJsonOrThrow(value: string): Record<string, unknown> {\n  const valueAsJson = asJson(value);\n  if (valueAsJson === undefined) {\n    throw new Error(`Invalid value: \\`${value}\\` is not a valid JSON string of a map`);\n  }\n  return valueAsJson;\n}\n\nexport function asJsonString(value: unknown): Record<string, unknown> | undefined;\nexport function asJsonString(\n  value: unknown,\n  defaultValue: Record<string, unknown>\n): Record<string, unknown>;\nexport function asJsonString(\n  value: unknown,\n  defaultValue?: Record<string, unknown>\n): Record<string, unknown> | undefined {\n  const str = asString(value);\n  return str === undefined\n    ? defaultValue\n    : defaultValue === undefined\n      ? asJson(str)\n      : asJson(str, defaultValue);\n}\nexport function asJsonStringOrThrow(value: unknown): Record<string, unknown> {\n  return asJsonOrThrow(asStringOrThrow(value));\n}\n\nexport function asString<T extends string = string>(value: unknown): T | undefined;\nexport function asString<T extends string = string>(value: unknown, defaultValue: string): T;\nexport function asString<T extends string = string>(\n  value: unknown,\n  defaultValue?: string\n): T | undefined {\n  return (typeof value === 'string' ? value : defaultValue) as T;\n}\nexport function asStringOrThrow<T extends string = string>(value: unknown): T {\n  const valueAsString = asString<T>(value);\n  if (valueAsString === undefined) {\n    throw new Error(`Invalid value: \\`${value}\\` is not a string`);\n  }\n  return valueAsString;\n}\n\nexport function asStringEnum<T extends Record<string, string>>(\n  value: unknown,\n  enu: T\n): T[keyof T] | undefined;\nexport function asStringEnum<T extends Record<string, string>>(\n  value: unknown,\n  enu: T,\n  defaultValue: T[keyof T]\n): T[keyof T];\nexport function asStringEnum<T extends Record<string, string>>(\n  value: unknown,\n  enu: T,\n  defaultValue?: T[keyof T]\n): T[keyof T] | undefined {\n  return (\n    typeof value === 'string' && Object.values(enu).includes(value as T[keyof T])\n      ? value\n      : defaultValue\n  ) as T[keyof T];\n}\nexport function asStringEnumOrThrow<T extends Record<string, string>>(\n  value: unknown,\n  enu: T\n): T[keyof T] {\n  const valueAsString = asStringEnum<T>(value, enu);\n  if (valueAsString === undefined) {\n    throw new Error(\n      `Invalid value: \\`${value}\\` is not a string or not one of ${JSON.stringify(\n        Object.values(enu)\n      )}`\n    );\n  }\n  return valueAsString;\n}\n\nexport function asArray<T = unknown>(value: unknown): T[] | undefined;\nexport function asArray<T = unknown>(value: unknown, defaultValue: unknown[]): T[];\nexport function asArray<T = unknown>(value: unknown, defaultValue?: unknown[]): T[] | undefined {\n  return (Array.isArray(value) ? value : defaultValue) as T[];\n}\nexport function asArrayOrThrow<T = unknown>(value: unknown): T[] {\n  if (!Array.isArray(value)) {\n    throw new Error(`Invalid value: \\`${value}\\` is not an array`);\n  }\n  return value as T[];\n}\n\nexport function asStringArray<T extends string = string>(value: unknown): T[] | undefined;\nexport function asStringArray<T extends string = string>(\n  value: unknown,\n  defaultValue: string[]\n): T[];\nexport function asStringArray<T extends string = string>(\n  value: unknown,\n  defaultValue?: string[]\n): T[] | undefined {\n  const arr = asArray(value);\n  if (arr === undefined) {\n    return defaultValue as T[];\n  }\n  return removeUndefined(arr.map(s => asString<T>(s)));\n}\n\nexport function asStringArrayOrThrow<T extends string = string>(value: unknown): T[] {\n  const arr = asArrayOrThrow(value);\n  return arr.map(s => asStringOrThrow<T>(s));\n}\n\nexport function asMapArray(value: unknown): Record<string, unknown>[] | undefined;\nexport function asMapArray(\n  value: unknown,\n  defaultValue: Record<string, unknown>[]\n): Record<string, unknown>[];\nexport function asMapArray(\n  value: unknown,\n  defaultValue?: Record<string, unknown>[]\n): Record<string, unknown>[] | undefined {\n  const arr = asArray(value);\n  if (arr === undefined) {\n    return defaultValue;\n  }\n  return removeUndefined(arr.map(s => asMap(s)));\n}\nexport function asMapArrayOrThrow(value: unknown): Record<string, unknown>[] {\n  const arr = asArrayOrThrow(value);\n  return arr.map(s => asMapOrThrow(s));\n}\n\nexport function asNumber<T extends number = number>(value: unknown): T | undefined;\nexport function asNumber<T extends number = number>(value: unknown, defaultValue: number): T;\nexport function asNumber<T extends number = number>(\n  value: unknown,\n  defaultValue?: number\n): T | undefined {\n  if (typeof value === 'number') {\n    return (!isNaN(value) ? value : defaultValue) as T;\n  }\n  if (typeof value === 'string') {\n    try {\n      const parsedValue = parseFloat(value);\n      return (!isNaN(parsedValue) ? parsedValue : defaultValue) as T;\n    } catch {\n      return defaultValue as T;\n    }\n  }\n  return defaultValue as T;\n}\nexport function asNumberOrThrow<T extends number = number>(value: unknown): T {\n  const valueAsNumber = asNumber(value);\n  if (valueAsNumber === undefined) {\n    throw new Error(`Invalid value: \\`${value}\\` is not a number`);\n  }\n  return valueAsNumber as T;\n}\n\nexport function asBoolean(value: unknown): boolean | undefined;\nexport function asBoolean(value: unknown, defaultValue: boolean): boolean;\nexport function asBoolean(value: unknown, defaultValue?: boolean): boolean | undefined {\n  if (typeof value === 'boolean') {\n    return value;\n  }\n  if (typeof value === 'number') {\n    return !isNaN(value) ? value !== 0 : false;\n  }\n  if (typeof value === 'string') {\n    if (value === '0' || value === 'false') {\n      return false;\n    } else if (value === '1' || value === 'true') {\n      return true;\n    }\n    return defaultValue;\n  }\n  return defaultValue;\n}\n\nexport function asBooleanOrThrow(value: unknown): boolean {\n  const valueAsBoolean = asBoolean(value);\n  if (valueAsBoolean === undefined) {\n    throw new Error(`Invalid value: \\`${value}\\` is not a boolean`);\n  }\n  return valueAsBoolean;\n}\n\nconst TIMESTAMP_REGEX = /^[0-9]{1,15}$/u;\nexport function asDate(value: unknown): Date | undefined;\nexport function asDate(value: unknown, defaultValue: Date): Date;\nexport function asDate(value: unknown, defaultValue?: Date): Date | undefined {\n  const date =\n    value instanceof Date\n      ? value\n      : new Date(\n          typeof value === 'string' && TIMESTAMP_REGEX.test(value)\n            ? parseFloat(value)\n            : String(value)\n        );\n  return isNaN(date.getTime()) ? defaultValue : date;\n}\n\nexport function asDateOrThrow(value: unknown): Date {\n  const valueAsDate = asDate(value);\n  if (valueAsDate === undefined) {\n    throw new Error(`Invalid value: \\`${value}\\` cannot be parsed as a Date`);\n  }\n  return valueAsDate;\n}\n\n// export function asDate(value: unknown): Date | undefined;\n// export function asDate(value: unknown, defaultValue: Date): Date;\n// export function asDate(value: unknown, defaultValue?: Date): Date | undefined {\n//   if (typeof value === 'number') {\n//     return new Date(value);\n//   }\n//   return value instanceof Date ? value : defaultValue;\n// }\n\nexport function isNull<T>(val: T | null): val is null {\n  return val === null;\n}\n\nexport function asError(err: unknown): Error {\n  return err instanceof Error ? err : new Error(typeof err === 'string' ? err : String(err));\n}\n\nexport function errorAsString(err: unknown): string {\n  const errorMap = asMap(err);\n  if (errorMap === undefined) {\n    return asString(err) ?? String(err);\n  }\n\n  const errorMessage = asString(errorMap['message']);\n  if (errorMessage === undefined) {\n    return String(err);\n  }\n  return errorMessage;\n}\n\nexport function errorAndStackAsString(err: unknown): string {\n  const errorMap = asMap(err);\n  if (errorMap === undefined) {\n    return asString(err) ?? String(err);\n  }\n\n  const stack = asString(errorMap['stack']);\n  if (stack === undefined) {\n    return String(err);\n  }\n  return stack;\n}\n\nexport function asConstantOrThrow<T>(value: unknown, expected: T): T {\n  if (value !== expected) {\n    throw new Error(`Invalid value: \\`${value}\\`, expected \\`${expected}\\``);\n  }\n  return value as T;\n}\n\n// export function asParsedJson<T>(json: string): T {\n//   try {\n//     return JSON.parse(json) as T;\n//   } catch {\n//     const defaultValue = {};\n//     return defaultValue as T;\n//   }\n// }\nexport function parseJson(\n  json: string\n): {res: unknown; err: undefined} | {res: undefined; err: unknown} {\n  try {\n    return {res: JSON.parse(json), err: undefined};\n  } catch (err: unknown) {\n    return {err, res: undefined};\n  }\n}\nexport type Brand<Type, Name> = Type & {__brand: Name};\nexport type StringBrand = string & {__brand: string};\nexport type NumberBrand = number & {__brand: number};\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nexport type AnyBrand = (string | number) & {__brand: any};\n\nexport type Untrusted<T> = T extends\n  | Function\n  | Date\n  | boolean\n  | number\n  | string\n  | undefined\n  | null\n  | unknown[]\n  ? unknown\n  : {[P in keyof T]?: Untrusted<T[P]>};\n\nexport type DeepPartial<T> = T extends\n  | Function\n  | Date\n  | boolean\n  | number\n  | string\n  | undefined\n  | null\n  | unknown[]\n  ? T\n  : {[P in keyof T]?: DeepPartial<T[P]>};\n\nexport type MapInterface<I, Type> = {[Key in keyof I]: Type};\n// Get all the keys of a type including the optional attributes\ntype NonHomomorphicKeys<T> = ({[P in keyof T]: P} & None)[keyof T];\nexport type MapInterfaceStrict<I, Type> = {[Key in NonHomomorphicKeys<I>]: Type};\n\ntype KeysOfType<T, Type> = {[Key in keyof T]: T[Key] extends Type ? Key : never}[keyof T];\nexport type RestrictInterface<T, Type> = Pick<T, KeysOfType<T, Type>>;\n\ninterface RecursiveArray<T> extends Array<T | RecursiveArray<T>> {}\nexport type NestedArray<T> = (T | RecursiveArray<T>)[];\n\n// Type for an empty object (ie: {})\nexport type None = Record<string, never>;\n\nexport type NonEmptyArray<T> = [T, ...T[]];\nexport function isNonEmptyArray<T>(val: T[]): val is NonEmptyArray<T> {\n  return val.length > 0;\n}\nexport function nonEmptyArray<T>(val: T[]): NonEmptyArray<T> | undefined {\n  return val.length === 0 ? undefined : (val as NonEmptyArray<T>);\n}\n\nexport type AddPrefix<T, P extends string> = {\n  [K in keyof T as K extends string ? `${P}${K}` : never]: T[K];\n};\nexport function addPrefix<T extends Record<string, unknown>, Prefix extends string>(\n  attr: T,\n  prefix: Prefix\n): AddPrefix<T, Prefix> {\n  return Object.fromEntries(\n    Object.entries(attr).map(([key, value]) => [`${prefix}${key}`, value])\n  ) as AddPrefix<T, Prefix>;\n}\n\nexport type WithNull<T> = {\n  [Key in keyof T]: T[Key] extends Exclude<T[Key], undefined> ? T[Key] : T[Key] | null;\n};\ntype Id<T> = T;\nexport type Flatten<T> = Id<{[k in keyof T]: T[k]}>;\n\nexport type Defined<T> = Exclude<T, undefined>;\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import {randomUUID} from 'node:crypto';\nimport {appendFileSync, writeFileSync} from 'node:fs';\nimport {createServer, IncomingMessage, ServerResponse} from 'node:http';\n\nimport {asMap, errorAndStackAsString} from '@src/type_utils';\nimport {LambdaServerEvent} from '@src/webpack/plugins/lambda_server_plugin';\n\n//\n// ENV VARIABLES LOADING\n//\n\n// eslint-disable-next-line node/no-process-env\nconst {PORT, RUNTIME_LOG_FILE, APP_LOG_FILE, HANDLER_PATH, TIMEOUT_MS} = process.env;\n\nconst port = parseFloat(PORT ?? '');\nif (isNaN(port)) {\n  runtimeLog({event: 'error', err: `Invalid process.env.PORT: ${PORT}`, path: '', method: ''});\n  // eslint-disable-next-line node/no-process-exit\n  process.exit(0);\n}\n\nconst timeoutMs = parseFloat(TIMEOUT_MS ?? '');\nif (isNaN(timeoutMs)) {\n  runtimeLog({\n    event: 'error',\n    err: `Invalid process.env.TIMEOUT_MS: ${TIMEOUT_MS}`,\n    path: '',\n    method: '',\n  });\n  // eslint-disable-next-line node/no-process-exit\n  process.exit(0);\n}\n\nif (HANDLER_PATH === undefined) {\n  runtimeLog({event: 'error', err: `Missing process.env.HANDLER_PATH`, path: '', method: ''});\n  // eslint-disable-next-line node/no-process-exit\n  process.exit(0);\n}\n\n//\n// LOGGING FUNCTIONS\n//\n\nfunction appLog(\n  appendFileSync: (file: string, content: string) => void,\n  log: string | string[]\n): void {\n  const logs = Array.isArray(log) ? log : [log];\n  if (APP_LOG_FILE === undefined || logs.length === 0) {\n    return;\n  }\n  appendFileSync(APP_LOG_FILE, logs.map(log => `[${new Date().toISOString()}] ${log}\\n`).join(''));\n}\n\nfunction runtimeLog(event: LambdaServerEvent): void {\n  if (RUNTIME_LOG_FILE === undefined) {\n    return;\n  }\n  if (event.event === 'error') {\n    logger(event.err);\n  }\n  appendFileSync(RUNTIME_LOG_FILE, `${JSON.stringify({t: new Date().toISOString(), ...event})}\\n`);\n}\n\n// Clear all previous logs\nif (APP_LOG_FILE !== undefined) {\n  writeFileSync(APP_LOG_FILE, '');\n}\nif (RUNTIME_LOG_FILE !== undefined) {\n  writeFileSync(RUNTIME_LOG_FILE, '');\n}\n\n//\n// HANDLER LOADING\n//\n\nconst logger = appLog.bind(null, appendFileSync);\nfunction serialize(val: unknown): string {\n  return val instanceof Error\n    ? errorAndStackAsString(val)\n    : typeof val === 'string'\n      ? val\n      : JSON.stringify(val);\n}\nconsole.log = (...args: unknown[]) => logger(args.map(serialize));\nconsole.error = (...args: unknown[]) => logger(args.map(serialize));\n\nlet handler: Function | undefined;\n// eslint-disable-next-line import/dynamic-import-chunkname, node/no-unsupported-features/es-syntax\nimport(/* webpackIgnore: true */ HANDLER_PATH)\n  .then(imported => {\n    const importedHandler = asMap(imported)?.['handler'];\n    if (typeof importedHandler !== 'function') {\n      runtimeLog({\n        event: 'error',\n        err: `Lambda is not exporting a \"handler\" function`,\n        path: '',\n        method: '',\n      });\n      // eslint-disable-next-line node/no-process-exit\n      process.exit(0);\n    }\n    handler = importedHandler;\n  })\n  .catch(err => {\n    runtimeLog({\n      event: 'error',\n      err: `Failure to load lambda handler: ${errorAndStackAsString(err)}`,\n      path: '',\n      method: '',\n    });\n    // eslint-disable-next-line node/no-process-exit\n    process.exit(0);\n  });\n\n//\n// LAMBDA SERVER\n//\n\nlet currentRes: ServerResponse | undefined;\nfunction globalError(err: unknown): void {\n  runtimeLog({event: 'error', err: String(err), path: '', method: ''});\n  if (currentRes) {\n    currentRes.statusCode = 500;\n    currentRes.end();\n    currentRes = undefined;\n  }\n}\n\nconst server = createServer((req: IncomingMessage, res: ServerResponse) => {\n  currentRes = res;\n  const url = req.url ?? '';\n\n  if (url.startsWith('/favicon')) {\n    res.end();\n    currentRes = undefined;\n    return;\n  }\n\n  const method = req.method ?? '';\n\n  const internalError = (err: string): void => {\n    runtimeLog({event: 'error', err, path: url, method});\n    res.statusCode = 500;\n    res.end();\n    currentRes = undefined;\n  };\n\n  try {\n    // Parse body\n    let body = '';\n    req.on('data', chunk => {\n      body += chunk;\n    });\n\n    // Parse URL\n    const parsedUrl = new URL(`http://localhost${url}`);\n    const rawQueryString = parsedUrl.search.slice(1);\n    const queryStringParameters = Object.fromEntries([\n      ...new URLSearchParams(decodeURIComponent(rawQueryString)).entries(),\n    ]);\n\n    const sendRes = (\n      body: string | Buffer,\n      duration: number,\n      // eslint-disable-next-line @typescript-eslint/no-magic-numbers\n      statusCode = 200,\n      headers: Record<string, string> = {}\n    ): void => {\n      runtimeLog({\n        event: 'response',\n        path: url,\n        method,\n        statusCode,\n        duration,\n        headers,\n        bodyLength: body.length,\n      });\n      res.statusCode = statusCode;\n      for (const [headerName, headerValue] of Object.entries(headers)) {\n        res.setHeader(headerName, headerValue);\n      }\n      res.write(body);\n      res.end();\n      currentRes = undefined;\n    };\n\n    req.on('end', () => {\n      // Log the request\n      runtimeLog({event: 'request', path: url, method, bodyLength: body.length});\n\n      // Create the lambda event\n      const event = {\n        version: '2.0',\n        routeKey: '$default',\n        rawPath: parsedUrl.pathname,\n        rawQueryString,\n        headers: req.headers,\n        queryStringParameters,\n        requestContext: {\n          accountId: 'anonymous',\n          // apiId: 'rqez6mmiihukf4yvq2l7rrq2340xpkvp',\n          // domainName: 'rqez6mmiihukf4yvq2l7rrq2340xpkvp.lambda-url.eu-west-3.on.aws',\n          // domainPrefix: 'rqez6mmiihukf4yvq2l7rrq2340xpkvp',\n          http: {\n            method,\n            path: parsedUrl.pathname,\n            // protocol: 'HTTP/1.1',\n            // sourceIp: '88.138.164.86',\n            userAgent: req.headers['user-agent'],\n          },\n          requestId: randomUUID(),\n          routeKey: '$default',\n          stage: '$default',\n          timeEpoch: Date.now(),\n        },\n        body,\n        isBase64Encoded: false,\n      };\n\n      // Run the handler\n      if (!handler) {\n        // eslint-disable-next-line @typescript-eslint/no-magic-numbers\n        sendRes('Lambda handler not found', 0, 404);\n        return;\n      }\n      const startTs = Date.now();\n      try {\n        const context = {\n          getRemainingTimeInMillis: () => {\n            return timeoutMs - (Date.now() - startTs);\n          },\n        };\n        Promise.resolve(handler(event, context))\n          .then(handlerRes => {\n            const duration = Date.now() - startTs;\n            try {\n              if (handlerRes === undefined) {\n                return internalError(`Invalid response: ${JSON.stringify(handlerRes)}`);\n              }\n              res.setHeader('Content-Type', 'application/json');\n              if (\n                typeof handlerRes === 'object' &&\n                handlerRes !== null &&\n                !Array.isArray(handlerRes)\n              ) {\n                const {body, headers, statusCode, isBase64Encoded} = handlerRes;\n                if (!('statusCode' in handlerRes)) {\n                  return sendRes(JSON.stringify(handlerRes), duration);\n                } else if (typeof statusCode !== 'number') {\n                  return internalError(`statusCode ${JSON.stringify(statusCode)} is not a number`);\n                }\n                const resBody =\n                  typeof body === 'string'\n                    ? typeof isBase64Encoded === 'boolean' && isBase64Encoded\n                      ? Buffer.from(body, 'base64')\n                      : body\n                    : JSON.stringify(body);\n                // eslint-disable-next-line @typescript-eslint/no-unsafe-argument\n                return sendRes(resBody, duration, statusCode, headers);\n              } else if (typeof handlerRes === 'string') {\n                return sendRes(handlerRes, duration);\n              }\n              return sendRes(JSON.stringify(handlerRes), duration);\n            } catch (err: unknown) {\n              internalError(errorAndStackAsString(err));\n            }\n          })\n          .catch((err: unknown) => {\n            internalError(errorAndStackAsString(err));\n          });\n      } catch (err: unknown) {\n        internalError(errorAndStackAsString(err));\n      }\n    });\n  } catch (err: unknown) {\n    internalError(String(err));\n  }\n})\n  .listen(PORT)\n  .on('error', err => {\n    globalError(err);\n  })\n  .on('listening', () => {\n    runtimeLog({event: 'start', port});\n  });\n\nfunction cleanup(): void {\n  server.close();\n}\n\nprocess.on('SIGINT', () => cleanup());\nprocess.on('SIGTERM', () => cleanup());\nprocess.on('uncaughtException', err => {\n  globalError(err);\n  cleanup();\n});\nprocess.on('unhandledRejection', err => {\n  globalError(err);\n  cleanup();\n});\n"],"names":["notUndefined","val","undefined","isString","isNumber","iterNumberEnum","e","Object","values","filter","iterStringEnum","removeUndefined","arr","removeUndefinedOrNullProps","obj","fromEntries","entries","neverHappens","value","errorMessage","Error","asMap","defaultValue","Array","isArray","asMapOrThrow","valueAsMap","asJson","json","JSON","parse","res","asJsonOrThrow","valueAsJson","asJsonString","str","asString","asJsonStringOrThrow","asStringOrThrow","valueAsString","asStringEnum","enu","includes","asStringEnumOrThrow","stringify","asArray","asArrayOrThrow","asStringArray","map","s","asStringArrayOrThrow","asMapArray","asMapArrayOrThrow","asNumber","isNaN","parsedValue","parseFloat","asNumberOrThrow","valueAsNumber","asBoolean","asBooleanOrThrow","valueAsBoolean","TIMESTAMP_REGEX","asDate","date","Date","test","String","getTime","asDateOrThrow","valueAsDate","isNull","asError","err","errorAsString","errorMap","errorAndStackAsString","stack","asConstantOrThrow","expected","parseJson","isNonEmptyArray","length","nonEmptyArray","addPrefix","attr","prefix","key","randomUUID","appendFileSync","writeFileSync","createServer","PORT","RUNTIME_LOG_FILE","APP_LOG_FILE","HANDLER_PATH","TIMEOUT_MS","process","env","port","runtimeLog","event","path","method","exit","timeoutMs","appLog","log","logs","toISOString","join","logger","t","bind","serialize","console","args","error","handler","then","imported","_asMap","importedHandler","catch","currentRes","globalError","statusCode","end","server","req","url","startsWith","internalError","body","on","chunk","parsedUrl","URL","rawQueryString","search","slice","queryStringParameters","URLSearchParams","decodeURIComponent","sendRes","duration","headers","bodyLength","headerName","headerValue","setHeader","write","version","routeKey","rawPath","pathname","requestContext","accountId","http","userAgent","requestId","stage","timeEpoch","now","isBase64Encoded","startTs","context","getRemainingTimeInMillis","Promise","resolve","handlerRes","resBody","Buffer","from","listen","cleanup","close"],"sourceRoot":""}